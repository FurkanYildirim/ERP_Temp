// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/Config","sap/base/Log","sap/ushell/library","sap/ushell/components/pages/controller/PagesAndSpaceId"],function(e,t,n,r){"use strict";var a=n.ContentNodeType;var i=function(){};i.prototype.isMenuEnabled=function(){var t=e.last("/core/menu/enabled");var n=this._getAssignedSpaces().length;return Promise.resolve(t&&n>0)};i.prototype.getMenuEntries=function(){return r.getUserMyHomeEnablement().then(function(t){var n=e.last("/core/homeApp/enabled");var r=e.last("/core/spaces/myHome/enabled");var a=e.last("/core/spaces/myHome/myHomeSpaceId");var i=this._getAssignedSpaces();if(n&&r||r&&!t){for(var o=0;o<i.length;o++){if(i[o].id===a){i=i.slice(1);break}}}var s=this._buildMenuEntries(i);return s}.bind(this))};i.prototype.getMenuPersonalization=function(){var e=document.querySelector("meta[name='sap.ushell.menuPersonalization']");if(!e){return null}var t=JSON.parse(e.getAttribute("content"));return t};i.prototype.getContentNodeEntries=function(){var e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);var t=this._buildMenuEntries(e);return Promise.resolve(t)};i.prototype.getContentNodes=function(){var e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);var t=this._buildContentNodes(e);return Promise.resolve(t)};i.prototype._buildMenuEntries=function(t){var n=t.filter(this._isSpaceNotEmpty.bind(null,"FLP menu")).map(function(t,n){var r={id:t.id,title:t.title||t.id,"help-id":"Space-"+t.id,description:t.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:t.id},{name:"pageId",value:t.pages[0].id}],innerAppRoute:undefined},isHomeEntry:n===0&&t.id===e.last("/core/spaces/myHome/myHomeSpaceId"),menuEntries:[]};var a=t.pages.map(function(e){return{id:e.id,title:e.title||e.id,"help-id":"Page-"+e.id,description:e.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:t.id},{name:"pageId",value:e.id}],innerAppRoute:undefined},menuEntries:[]}});if(a.length>1){r.menuEntries=a}return r});return n};i.prototype._buildContentNodes=function(e){var t=e.filter(this._isSpaceNotEmpty.bind(null,"content nodes")).map(function(e){return{id:e.id,label:e.title||e.id,type:a.Space,isContainer:false,children:e.pages.map(function(e){return{id:e.id,label:e.title||e.id,type:a.Page,isContainer:true}})}});return t};i.prototype._isSpaceNotEmpty=function(e,n){if(!n.pages||n.pages.length===0){t.warning("FLP space "+n.id+" without page omitted in "+e+".","","sap.ushell_abap.adapters.abap.MenuAdapter");return false}return true};i.prototype._removeMyHomeForContentNodes=function(t){var n=e.last("/core/homeApp/enabled");var r=e.last("/core/spaces/myHome/enabled");var a=e.last("/core/spaces/myHome/userEnabled");var i=e.last("/core/spaces/myHome/myHomeSpaceId");if(n){return}if(r&&!a){if(t[0]&&t[0].id===i){t.shift()}}};i.prototype._getAssignedSpaces=function(){var e=document.querySelector("meta[name='sap.ushell.assignedSpaces']");if(!e){return[]}var t=JSON.parse(e.getAttribute("content"));return t};return i});
//# sourceMappingURL=MenuAdapter.js.map