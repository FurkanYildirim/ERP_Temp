/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/base/util/isEmptyObject","sap/ui/model/Filter","sap/ovp/cards/AnnotationHelper"],function(e,t,n){"use strict";function r(e){var t;if(e){if(e.settings.tabs){var n=0;var r=e.settings.selectedKey;if(r&&e.settings.tabs.length>=r){n=r-1}t=e.settings.tabs[n]["selectionAnnotationPath"]}else{t=e.settings["selectionAnnotationPath"]}}return t}return{_getEntityRelevantFilters:function(e,t){var n=[];if(t.length>0&&e){var r=this._checkRelevantFiltersRecursive(e,t[0]);if(r){n.push(r)}}return n},_checkRelevantFiltersRecursive:function(e,n){if(!n._bMultiFilter){n.sPath=n.sPath.split("/").pop();var r=this._getPropertyMapping(e,n.sPath);if(r){n.sPath=r;return n}}else{var i=n.aFilters;var a,s=[];if(i){for(var u=0;u<i.length;u++){a=this._checkRelevantFiltersRecursive(e,i[u]);if(a){s.push(a)}}if(s.length>0){return new t(s,n.bAnd)}}}},_getPropertyMapping:function(e,t){if(t in e){return t}},mergeFilters:function(n,r){if(r&&r.length===0&&r&&n.length===0){return[]}var i=[];if(r&&r.length>0){var a=[];var s={};r.forEach(function(e){if(s[e.path]){s[e.path].push(new t(e))}else{s[e.path]=[new t(e)]}});Object.keys(s).forEach(function(e){a.push(new t({filters:s[e],and:false}))});i.push(new t({filters:a,and:true}))}if(!e(n[0])){i.push(n[0])}return new t({filters:i,and:true})},getSelectionVariantFilters:function(e,t,i){var a=t.getData(),s=e.filter(function(e){return e.id===a.cardId})[0],u="@"+r(s),l=i[u];return l?n.getFilters(t,l,true):[]},formatLiteral:function(e,t){var n=/'/g;if(e===undefined){throw new Error("Illegal value: undefined")}if(e===null){return"null"}switch(t){case"Edm.Binary":return"binary'"+e+"'";case"Edm.Boolean":case"Edm.Byte":case"Edm.Double":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":case"Edm.Single":return String(e);case"Edm.Date":case"Edm.DateTimeOffset":case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.TimeOfDay":return e;case"Edm.Duration":return"duration'"+e+"'";case"Edm.String":return"'"+e.replace(n,"''")+"'";default:throw new Error("Unsupported type: "+t)}}}},true);
//# sourceMappingURL=Filterhelper.js.map