// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/library","sap/ui/core/mvc/Controller","sap/ushell/Config","sap/ushell/utils/WindowUtils","sap/ui/model/json/JSONModel","sap/m/library","sap/base/Log","sap/ushell/utils/UrlParsing"],function(e,t,i,r,o,n,s,a){"use strict";var l=n.GenericTileScope;var p=n.GenericTileMode;var c=e.DisplayFormat;var u=e.AppType;return t.extend("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{_aDoables:[],_getConfiguration:function(){var e=this.getView().getViewData();e.properties.sizeBehavior=i.last("/core/home/sizeBehavior");e.properties.wrappingType=i.last("/core/home/wrappingType");return e},_setShowContentProviderInfoOnVisualizations:function(e,t,i){if(!e){i.setProperty("/properties/showContentProviderInfoOnVisualizations",false);return Promise.resolve()}return sap.ushell.Container.getServiceAsync("ClientSideTargetResolution").then(function(e){return e.getSystemContext(t)}).then(function(e){i.setProperty("/properties/contentProviderLabel",e.label);i.setProperty("/properties/showContentProviderInfoOnVisualizations",true)}).catch(function(e){s.error("StaticTile.controller threw an error:",e)})},onInit:function(){var e=this.getView();var t=new o;t.setData(this._getConfiguration());e.setModel(t);this._aDoables.push(i.on("/core/home/sizeBehavior").do(function(e){t.setProperty("/properties/sizeBehavior",e)}));var r=this.getView().getViewData();var n=r.properties;var s=r.properties.contentProviderId;n.mode=n.mode||(n.icon?"ContentMode":"HeaderMode");if(n.displayFormat===c.Compact&&n.title&&n.targetURL){t.setProperty("/properties/mode",p.LineMode)}switch(n.displayFormat){case c.Flat:t.setProperty("/properties/frameType","OneByHalf");break;case c.FlatWide:t.setProperty("/properties/frameType","TwoByHalf");break;case c.StandardWide:t.setProperty("/properties/frameType","TwoByOne");break;default:{t.setProperty("/properties/frameType","OneByOne")}}this._setShowContentProviderInfoOnVisualizations(i.last("/core/contentProviders/providerInfo/showContentProviderInfoOnVisualizations"),s,t);this._aDoables.push(i.on("/core/contentProviders/providerInfo/showContentProviderInfoOnVisualizations").do(function(e){this._setShowContentProviderInfoOnVisualizations(e,s,t)}.bind(this)))},onExit:function(){this._aDoables.forEach(function(e){e.off()});this._aDoables=[]},editModeHandler:function(e){var t=e?l.ActionMore:l.Display;this.getView().getModel().setProperty("/properties/scope",t)},onPress:function(e){var t=this.getView().getViewData().properties;if(e.getSource().getScope&&e.getSource().getScope()===l.Display){var o=this._createTargetUrl();if(!o){return}if(o[0]==="#"){hasher.setHash(o)}else{var n=i.last("/core/shell/enableRecentActivity")&&i.last("/core/shell/enableRecentActivityLogging");if(n){var s={title:t.title,appType:u.URL,url:t.targetURL,appId:t.targetURL};sap.ushell.Container.getRenderer("fiori2").logRecentActivity(s)}r.openURL(o,"_blank")}}},updatePropertiesHandler:function(e){var t=this.getView().getContent()[0];var i=t.getTileContent()[0];if(typeof e.title!=="undefined"){t.setHeader(e.title)}if(typeof e.subtitle!=="undefined"){t.setSubheader(e.subtitle)}if(typeof e.icon!=="undefined"){i.getContent().setSrc(e.icon)}if(typeof e.info!=="undefined"){i.setFooter(e.info)}},_createTargetUrl:function(){var e=this.getView().getViewData().properties.targetURL;var t=this.getView().getViewData().configuration["sap-system"];var i;if(e&&t){if(a.isIntentUrl(e)){i=a.parseShellHash(e);if(!i.params){i.params={}}i.params["sap-system"]=t;e="#"+a.constructShellHash(i)}else{e+=(e.indexOf("?")<0?"?":"&")+"sap-system="+t}}return e},_getLeanUrl:function(){return r.getLeanURL(this._createTargetUrl())},_getTileContent:function(e,t){var i=t.getPath().split("/");i.pop();var r=t.getProperty(i.join("/"));if(r!==this.oLastBindingObject||this.oTileContent&&this.oTileContent.bIsDestroyed){this.oLastBindingObject=r;this.oTileContent=this.getView().byId(r.icon?"imageTileContent":"standardTileContent").clone()}return this.oTileContent},_getCurrentProperties:function(){var e=this.getView().getContent()[0];var t=e.getTileContent()[0];var r=i.last("/core/home/sizeBehavior");return{title:e.getHeader(),subtitle:e.getSubheader(),info:t.getFooter(),icon:t.getContent().getSrc(),mode:e.getMode(),sizeBehavior:r}}})},true);
//# sourceMappingURL=StaticTile.controller.js.map