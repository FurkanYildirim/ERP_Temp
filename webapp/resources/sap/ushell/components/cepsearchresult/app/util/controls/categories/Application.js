// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["../Category","sap/ushell/services/VisualizationInstantiation","../../jsSearch"],function(t,e,i){"use strict";var n=t.extend("sap.ushell.components.cepsearchresult.app.util.controls.categories.Application",{renderer:t.getMetadata().getRenderer()});var a=new e;var r=1200;n.prototype.getViewSettings=function(){return{views:[{key:"list",icon:"sap-icon://text-align-justified"},{key:"tile",icon:"sap-icon://grid"}],default:"tile"}};n.prototype.createListItemTemplate=function(){var e=t.prototype.createListItemTemplate.apply(this);e.attachModelContextChange(this.addTile.bind(this));return e};n.prototype.createCardItemTemplate=function(){var e=t.prototype.createListItemTemplate.apply(this);e.attachModelContextChange(this.addTile.bind(this));return e};n.prototype.createTileItemTemplate=function(){var e=new t.CustomListItem({});e.attachModelContextChange(this.addTile.bind(this));return e};n.prototype.addTile=function(t){var e=t.getSource();if(e.getBindingContext("data")){var i=e.getBindingContext("data").getObject(),n=i.visualization;if(!n){return}if(e._oViz){e._oViz.destroy()}var r=a.instantiateVisualization(n);r.addStyleClass(n.displayFormatHint);e._oViz=r;if(this.getCurrentView()==="tile"){this.activateTile(r);e.destroyContent();e.addContent(r)}else{e.addContent(r.addStyleClass("hiddentile"))}}};n.prototype.activateTile=function(t){setTimeout(function(){if(sap.ushell.Container){sap.ushell.Container.getServiceAsync("ReferenceResolver").then(function(){t.setActive(true,false)})}},r)};n.prototype.itemNavigate=function(t){if(this.isLoading()){return}var e=t.getSource();if(e.isA("sap.m.ObjectIdentifier")){e=e.getParent().getParent().getParent()}jQuery(e._oViz.getDomRef().querySelector("a")).trigger("tap")};n.prototype.fetchData=function(t,e,i){return this.getData(t,e,i)};n.prototype.fetchCount=function(t,e,i){return this.getData(t,e,i)};n.prototype.getPlaceholderData=function(){return{title:new Array(10).join(" "),description:new Array(35).join(" "),keywords:"",icon:"sap-icon://person-placeholder",label:new Array(17).join(" "),url:""}};n.prototype.normalize=function(t){if(!Array.isArray(t)){t=[]}var e=[];t.forEach(function(t){t.visualizations.forEach(function(i){var n=i.title;if(i.subtitle){n=n+" - "+i.subtitle}e.push({title:i.vizConfig&&i.vizConfig["sap.app"]&&i.vizConfig["sap.app"].title||i.title||t.title,description:i.vizConfig&&i.vizConfig["sap.app"]&&i.vizConfig["sap.app"].subTitle||i.subtitle||t.subtitle,keywords:i.keywords?i.keywords.join(" "):"",icon:i.icon||"",label:n,visualization:i,url:i.targetURL})})});return e};n.prototype.filter=function(t,e,n,a){this.searchEngine=new i({objects:t,fields:["text","title","keywords"],shouldNormalize:!String.prototype.normalize,algorithm:{id:"contains-ranked",options:[50,49,40,39,5,4,51]}});if(e){var r=this.searchEngine.search({searchFor:e,top:a,skip:n});return{data:r.results.map(function(t){return t.object}),count:r.totalCount}}var o={data:[],count:t.length};t.sort(function(t,e){return t.title.localeCompare(e.title)}).splice(n,a).forEach(function(t){o.data.push(t)});return o};n.prototype.getData=function(t,e,i){var n={data:[],totalCount:0};if(sap.ushell.Container&&sap.ushell.Container.getServiceAsync){return sap.ushell.Container.getServiceAsync("SearchableContent").then(function(n){n._changeVizType=function(){};return n.getApps().then(function(n){n=this.normalize(n);return this.filter(n,t,e,i)}.bind(this))}.bind(this))}return Promise.resolve(n)};return n});
//# sourceMappingURL=Application.js.map