// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ushell/components/shell/SearchCEP/SearchProviders/SearchProvider","sap/ushell/components/shell/SearchCEP/SearchProviders/NavigationSvcSearchProvider","sap/ushell/components/shell/SearchCEP/SearchProviders/FrequentActivityProvider","sap/ushell/components/shell/SearchCEP/SearchProviders/RecentSearchProvider","sap/base/Log","sap/ushell/utils/WindowUtils","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ushell/utils/UrlParsing","sap/ui/Device","sap/ui/core/Configuration","sap/base/util/UriParameters","sap/ui/core/Core"],function(e,t,s,i,r,o,n,l,a,jQuery,h,c,u,d,g,p){"use strict";return e.extend("sap.ushell.components.shell.SearchCEP.SearchCEP",{onInit:function(){this._bEscPressed=false;this._toggleSearchPopover(false);this._oPlaceHolderSF=p.byId("PlaceHolderSearchField");this._oPlaceHolderSF.oParent.getDomRef().firstChild.lastChild.setAttribute("tabindex","0");this._bIsMyHome=false;var e=sap.ushell.Container.getFLPPlatform(true),t=g.fromURL(document.URL);this._bOnInit=true;this.bNavigateToNewResultPage=t.get("cep-search-result-app")==="true";if(e==="MYHOME"){this._bIsMyHome=true}},onSuggest:function(e){if(this._bEscPressed){return}var t=sap.ushell.Container.getFLPUrl(true);var s=c.getHash(t),i=s.split("&/")[0];if(this.bOnNavigationToResultPage===true&&(i==="Action-search"||i==="WorkZoneSearchResult-display")){if(this._oPopover.isOpen()){this._oPopover.close()}return}this.bOnNavigationToResultPage=false;var r=e.getParameter("suggestValue");this.oSF.focus();if(this._recentSearchTermSelected===true){this._recentSearchTermSelected=false;return}if(this.bOpeningPopOver===true&&this._oPopover.isOpen()===true){this.bOpeningPopOver=false;return}this.testProviders(r)},onfocusin:function(e){if(this.oSF.getEnableSuggestions()&&u.system.phone){jQuery(this.oSF.getDomRef()).find("input").attr("inputmode","search");jQuery(this._oPlaceHolderSF.getDomRef()).find("input").attr("inputmode","search")}},getHomePageApps:function(){var e=this;r.execSearch().then(function(t){var s="homePageApplications";if(Array.isArray(t[s])&&t[s].length>0){e.oProducts=t[s].slice(0,12)}})},getScreenSize:function(){var e=u.media.getCurrentRange(u.media.RANGESETS.SAP_STANDARD_EXTENDED);if(e.from>=1440){return"XL"}else if(e.from>=1024){return"L"}else if(e.from>=600){return"M"}else if(e.from>=0){return"S"}},onSearch:function(e){if(this._bEscPressed){return}var t=e.getParameter("query"),s=e.getParameter("clearButtonPressed");if(s===true){this.oSF.setValue("");this._oPlaceHolderSF.setValue("");this.bOpeningPopOver=false;this.testProviders();if(this._oSearchHistoryList.getItems().length===0&&this._oFrequentlyUsedAppsList.getItems().length===0&&this._oProductsList.getItems().length===0){this._oPopover.close()}return}if(t){this._oPlaceHolderSF.setValue(this.oSF.getValue());this._saveSearchTerm(t);if(this._bIsMyHome===true){if(this._oSearchResultList.getItems().length>0){this._oSearchResultList.getItems()[0].focus();var i="searchResults";var r=this._oSearchResultList.getItems()[0].getBindingContext(i).getObject().semanticObject;var o=this._oSearchResultList.getItems()[0].getBindingContext(i).getObject().semanticObjectAction;this._navigateApp(r,o)}}else{this._navigateToResultPage(t)}}},onBeforeOpen:function(){this._oPopover.addStyleClass("sapUshellCEPSearchFieldPopover");var e=p.byId("shell-header").getSearchState();var t=false;if(e==="COL"){t=true}p.byId("shell-header").setSearchState("EXP",35,false);p.byId("shell-header").setSearchState("EXP_S",35,true);if(t===true){p.byId("shell-header").setSearchState("COL",35,false)}},onAfterOpen:function(){if(p.byId("SearchHistoryList-trigger")){p.byId("SearchHistoryList-trigger").addEventDelegate({onkeydown:this._keyDownSearchHistoryListMoreTrigger.bind(this),onmousedown:this._mouseDownSearchHistoryListMoreTrigger.bind(this)})}if(p.byId("FrequentlyUsedAppsList-trigger")){p.byId("FrequentlyUsedAppsList-trigger").addEventDelegate({onkeydown:this._keyDownFrequentlyUsedAppsListMoreTrigger.bind(this)})}if(p.byId("ProductsList-trigger")){p.byId("ProductsList-trigger").addEventDelegate({onkeydown:this._keyDownProductsListMoreTrigger.bind(this)})}if(this._oFrequentlyUsedAppsList.getItems().length>0){this._oFrequentlyUsedAppsList.getItems()[0].addEventDelegate({onkeyup:this._keyUpFrequentlyUsedAppsListMoreTrigger.bind(this)})}if(this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].addEventDelegate({onkeyup:this._keyUpProductsListMoreTrigger.bind(this)})}var e=document.getElementById("PlaceHolderSearchField").clientHeight;document.getElementById("CEPSearchField").style.height=e+"px";jQuery(this.oSF.getDomRef()).find("#CEPSearchField-search").attr("title",h.i18n.getText("search"))},onAfterClose:function(){this._oPlaceHolderSF.setValue(this.oSF.getValue());if(this._bEscPressed){this._bEscPressed=false;this._oPlaceHolderSF.focus()}var e=this.getScreenSize();if(e!=="XL"&&this.oSF.getValue()===""){p.byId("shell-header").setSearchState("COL",35,false);p.byId("sf").setVisible()}else{p.byId("shell-header").setSearchState("EXP",35,false);p.byId("shell-header").setSearchState("EXP_S",35,false)}},onGrowingStarted:function(e){var t=e.getParameter("actual");if(t>0){this._oSearchHistoryList.setGrowingThreshold(8)}},onGrowingFinishedResults:function(){this._boldResults(this._oSearchResultList,this.oSF.getValue())},onExit:function(){},testProviders:function(e){var s,l,a=this,c=false,u=false;if(e!==undefined&&e!==""&&e.trim().length!==0){this._setListsVisible(false,this._oSearchHistoryList);this._setListsVisible(false,this._oFrequentlyUsedAppsList);this._setListsVisible(false,this._oProductsList);s=[r];c=true}else{this._setListsVisible(false,this._oSearchResultList);this._setListsVisible(false,this._oExternalSearchResultList);if(this._bOnInit!==true){s=[o,n];if(this._oProductsList.getItems().length>0){this._setListsVisible(true,this._oProductsList);u=true}}else{if(Array.isArray(this.oProducts)&&this.oProducts.length>0){u=true;this._setListsVisible(true,this._oProductsList);this._oProductsList.setModel(new t(this.oProducts),"productsResults");s=[o,n]}else{s=[r,o,n]}this._bOnInit=false}}for(l=0;l<s.length;l++){(function(s){s.execSearch(e).then(function(s){for(var r in i.GROUP_TYPE){var o=i.GROUP_TYPE[r];if(Array.isArray(s[o])&&s[o].length>0){if(o==="recentSearches"){u=true;a._setListsVisible(true,a._oSearchHistoryList);a._oSearchHistoryList.setGrowingThreshold(2);a._oSearchHistoryList.setModel(new t(s[o].slice(0,10)),"searchTerms")}else if(o==="frequentApplications"){u=true;a._setListsVisible(true,a._oFrequentlyUsedAppsList);a._oFrequentlyUsedAppsList.setModel(new t(s[o].slice(0,12)),"freqUsedApps")}else if(c!==true&&o==="homePageApplications"){u=true;a._setListsVisible(true,a._oProductsList);a._oProductsList.setModel(new t(s[o].slice(0,12)),"productsResults")}else if(c===true&&o==="applications"){a._setListsVisible(true,a._oSearchResultList);a._oSearchResultList.setModel(new t(s[o].slice(0,12)),"searchResults");a._applyResultsAcc(s[o].length);setTimeout(function(){a._boldResults(a._oSearchResultList,e);if(p.byId("SearchResultList-trigger")){p.byId("SearchResultList-trigger").addEventDelegate({onkeydown:a._keyDownSearchResultListMoreTrigger.bind(a)})}},50)}else if(c===true&&o==="externalSearchApplications"){a._setListsVisible(true,a._oExternalSearchResultList);a._oExternalSearchResultList.setModel(new t(s[o].slice(0,12)),"externalSearchResults")}if(!a._oPopover.isOpen()&&(u===true||c===true)){a._toggleSearchPopover(true)}a.oSF.focus()}else if(!a._oPopover.isOpen()&&u===true&&a._oProductsList.getItems().length>0){a._toggleSearchPopover(true)}else if(c===true&&o==="applications"){if(!s[o]||s[o].length===0){a._setListsVisible(true,a._oSearchResultList);a._oSearchResultList.setModel(new t({}),"searchResults");a._applyResultsAcc(0);var n=h.i18n.getText("no_apps_found",[e]);a._oSearchResultList.setNoDataText(n);if(!a._oPopover.isOpen()){a._toggleSearchPopover(true)}}}}})})(s[l])}},_applyResultsAcc:function(e){var t="";if(e===1){t=h.i18n.getText("one_result_search_aria",e)}else if(e>1){t=h.i18n.getText("multiple_results_search_aria",e)}else{t=h.i18n.getText("no_results_search_aria")}this.oSF.$("SuggDescr").text(t)},_boldResults:function(e,t){var s=e.getItems(),i=e.$().find(".sapMSLITitleOnly");jQuery.each(i,function(e){var r=s[e].getTitle(),o=new RegExp(t,"gi");var n=r;n=n.replace(o,function(e){return"</b>"+e+"<b>"});n="<b>"+n+"</b>";i[e].innerHTML=n})},_toggleSearchPopover:function(e){if(!this._oPopover){s.load({name:"sap.ushell.components.shell.SearchCEP.SearchFieldFragment",type:"XML",controller:this}).then(function(t){this._oPopover=t;var s=this.getScreenSize();var i=document.getElementById("PlaceHolderSearchField").clientWidth;if(s==="S"){i=1.1*i}else{i=1.05*i}this._oPopover.setContentWidth(i+"px");if(d.getRTL()===true){var r=this._oPopover.getOffsetX();this._oPopover.setOffsetX(-1*r)}this._initializeSearchField();this._initializeSearchHistoryList();this._initializeFrequentlyUsedAppsList();this._initializeSearchResultList();this._initializeProductsList();this._initializeExternalSearchResultList();if(!u.support.touch){this._sContentDensityClass="sapUiSizeCompact"}else{this._sContentDensityClass="sapUiSizeCozy"}this._oSearchHistoryList.addStyleClass(this._sContentDensityClass);this._oFrequentlyUsedAppsList.addStyleClass(this._sContentDensityClass);this._oSearchResultList.addStyleClass(this._sContentDensityClass);this._oProductsList.addStyleClass(this._sContentDensityClass);this._oExternalSearchResultList.addStyleClass(this._sContentDensityClass);this.testProviders();this._toggleSearchPopover(e)}.bind(this))}else if(e){this._oPopover.openBy(this._oPlaceHolderSF);this.bOpeningPopOver=true;if(this._oPlaceHolderSF.getValue()!==""){this.oSF.setValue(this._oPlaceHolderSF.getValue())}}},_keyDownSearchField:function(e){if(e.code===40||e.code==="ArrowDown"){this.oSF.focus();if(!this._oPopover.isOpen()){this._toggleSearchPopover(true)}if(this._oSearchHistoryList.getVisible()===true&&this._oSearchHistoryList.getItems().length>0){this._oSearchHistoryList.getItems()[0].focus()}else if(this._oFrequentlyUsedAppsList.getVisible()===true&&this._oFrequentlyUsedAppsList.getItems().length>0){this._oFrequentlyUsedAppsList.getItems()[0].focus()}else if(this._oProductsList.getVisible()===true&&this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].focus()}else if(this._oSearchResultList.getVisible()===true&&this._oSearchResultList.getItems().length>0){this._oSearchResultList.getItems()[0].focus()}else if(this._oExternalSearchResultList.getVisible()===true&&this._oExternalSearchResultList.getItems().length>0){this._oExternalSearchResultList.getItems()[0].focus()}}else if(e.code===116||e.code==="F5"){window.location.reload()}else if(e.code===9||e.code==="Tab"){var t;if(e.shiftKey){t=this._oPlaceHolderSF.oParent.getDomRef().firstChild.lastChild.firstChild}else{t=this._oPlaceHolderSF.oParent.getDomRef().lastChild.firstChild;if(t&&getComputedStyle(t).display==="none"){t=this._oPlaceHolderSF.oParent.getDomRef().lastChild.firstChild.nextSibling}}setTimeout(function(){if(this.getScreenSize()==="S"||this.getScreenSize()==="M"){p.byId("shell-header").setSearchState("COL",35,false);p.byId("sf").setVisible(true)}if(t!==null){t.focus()}}.bind(this),0)}else if(e.code===27||e.code==="Escape"){this.oSF.setValue("");this._oPlaceHolderSF.setValue("");this._bEscPressed=true}},_keyDownSearchHistoryList:function(e){var t=this._oSearchHistoryList.getItems().length;if(e.code===40||e.code==="ArrowDown"){if(t>0&&this._oSearchHistoryList.getItems()[t-1]===e.srcControl){var s=window.getComputedStyle(document.getElementById("SearchHistoryList-triggerList"),"");if(s.display==="none"){if(this._oFrequentlyUsedAppsList.getVisible()===true&&this._oFrequentlyUsedAppsList.getItems().length>0){this._oFrequentlyUsedAppsList.getItems()[0].focus()}else if(this._oProductsList.getVisible()===true&&this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].focus()}}else{p.byId("SearchHistoryList-trigger").focus()}}}else if(e.code===38||e.code==="ArrowUp"){if(t>0&&this._oSearchHistoryList.getItems()[0]===e.srcControl){this.oSF.focus()}}},_keyDownFrequentlyUsedAppsList:function(e){var t,s=this._oFrequentlyUsedAppsList.getItems().length;if(e.code===40||e.code==="ArrowDown"){if(s>0&&this._oFrequentlyUsedAppsList.getItems()[s-1]===e.srcControl){t=window.getComputedStyle(document.getElementById("FrequentlyUsedAppsList-triggerList"),"");if(t.display==="none"){if(this._oProductsList.getVisible()===true&&this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].focus()}}else{p.byId("FrequentlyUsedAppsList-trigger").focus()}}}else if(e.code===38||e.code==="ArrowUp"){if(s>0&&this._oFrequentlyUsedAppsList.getItems()[0]===e.srcControl){var i=this._oSearchHistoryList.getItems().length;if(this._oSearchHistoryList.getVisible()===true&&i>0){var r=window.getComputedStyle(document.getElementById("SearchHistoryList-triggerList"),"");if(r.display==="none"){if(i>0){this._oSearchHistoryList.getItems()[i-1].focus()}}else{p.byId("SearchHistoryList-trigger").focus()}}else{this.oSF.focus()}}}else if(e.code===13||e.code==="Enter"){var o=e.srcControl.getBindingContext("freqUsedApps").getObject().appId;var n=o.split("-")[0];n=n.split("#")[1];var l=o.split("-")[1];this._navigateApp(n,l)}},_keyDownProductsList:function(e){var t,s=this._oProductsList.getItems().length,i=this._oFrequentlyUsedAppsList.getItems().length,r=this._oSearchHistoryList.getItems().length;if(e.code===40||e.code==="ArrowDown"){if(s>0&&this._oProductsList.getItems()[s-1]===e.srcControl){t=window.getComputedStyle(document.getElementById("ProductsList-triggerList"),"");if(t.display!=="none"){p.byId("ProductsList-trigger").focus()}}}else if(e.code===38||e.code==="ArrowUp"){if(s>0&&this._oProductsList.getItems()[0]===e.srcControl){if(this._oFrequentlyUsedAppsList.getVisible()===true&&i>0){t=window.getComputedStyle(document.getElementById("FrequentlyUsedAppsList-triggerList"),"");if(t.display==="none"){this._oFrequentlyUsedAppsList.getItems()[i-1].focus()}else{p.byId("FrequentlyUsedAppsList-trigger").focus()}}else if(this._oSearchHistoryList.getVisible()===true&&r>0){t=window.getComputedStyle(document.getElementById("SearchHistoryList-triggerList"),"");if(t.display==="none"){this._oSearchHistoryList.getItems()[r-1].focus()}else{p.byId("SearchHistoryList-trigger").focus()}}else{this.oSF.focus()}}}else if(e.code===13||e.code==="Enter"){this.onProductsPress(e)}},_keyUpFrequentlyUsedAppsListMoreTrigger:function(e){var t=e.srcControl.getDomRef(),s=t.getAttribute("aria-labelledby"),i=p.byId(s).getProperty("text"),r=h.i18n.getText("frequentAppsCEPSearch");jQuery(p.byId(s).getDomRef()).text(r+". "+i)},_keyUpProductsListMoreTrigger:function(e){var t=e.srcControl.getDomRef(),s=t.getAttribute("aria-labelledby"),i=p.byId(s).getProperty("text"),r=h.i18n.getText("products");jQuery(p.byId(s).getDomRef()).text(r+". "+i)},_keyDownSearchHistoryListMoreTrigger:function(e){if(e.code===40||e.code==="ArrowDown"){if(this._oFrequentlyUsedAppsList.getVisible()===true&&this._oFrequentlyUsedAppsList.getItems().length>0){this._oFrequentlyUsedAppsList.getItems()[0].focus()}else if(this._oProductsList.getVisible()===true&&this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].focus()}}else if(e.code===38||e.code==="ArrowUp"){var t=this._oSearchHistoryList.getItems().length;if(t>0){this._oSearchHistoryList.getItems()[t-1].focus()}}else if(e.code===13||e.code==="Enter"){this._oSearchHistoryList.setGrowingThreshold(8)}},_mouseDownSearchHistoryListMoreTrigger:function(e){this._oSearchHistoryList.setGrowingThreshold(8)},_keyDownFrequentlyUsedAppsListMoreTrigger:function(e){if(e.code===38||e.code==="ArrowUp"){var t=this._oFrequentlyUsedAppsList.getItems().length;if(t>0){this._oFrequentlyUsedAppsList.getItems()[t-1].focus()}}else if(e.code===40||e.code==="ArrowDown"){if(this._oProductsList.getVisible()===true&&this._oProductsList.getItems().length>0){this._oProductsList.getItems()[0].focus()}}},_keyDownProductsListMoreTrigger:function(e){if(e.code===38||e.code==="ArrowUp"){var t=this._oProductsList.getItems().length;if(t>0){this._oProductsList.getItems()[t-1].focus()}}},_keyDownSearchResultListMoreTrigger:function(e){if(e.code===38||e.code==="ArrowUp"){var t=this._oSearchResultList.getItems().length;if(t>0){this._oSearchResultList.getItems()[t-1].focus()}}else if(e.code===40||e.code==="ArrowDown"){if(this._oExternalSearchResultList.getVisible()===true&&this._oExternalSearchResultList.getItems().length>0){this._oExternalSearchResultList.getItems()[0].focus()}}},_keyDownSearchResultList:function(e){var t=this._oSearchResultList.getItems().length;if(e.code===40||e.code==="ArrowDown"){if(t>0&&this._oSearchResultList.getItems()[t-1]===e.srcControl){var s=window.getComputedStyle(document.getElementById("SearchResultList-triggerList"),"");if(s.display!=="none"){p.byId("SearchResultList-trigger").focus()}else if(this._oExternalSearchResultList.getVisible()===true&&this._oExternalSearchResultList.getItems().length>0){this._oExternalSearchResultList.getItems()[0].focus()}}}else if(e.code===38||e.code==="ArrowUp"){if(t>0&&this._oSearchResultList.getItems()[0]===e.srcControl){this.oSF.focus()}}},_keyDownExternalSearchResultList:function(e){var t=this._oExternalSearchResultList.getItems().length,s=this._oSearchResultList.getItems().length,i="";if(e.code===38||e.code==="ArrowUp"){if(t>0&&this._oExternalSearchResultList.getItems()[0]===e.srcControl){if(this._oSearchResultList.getVisible()===true&&s>0){i=window.getComputedStyle(document.getElementById("SearchResultList-triggerList"),"");if(i.display==="none"){this._oSearchResultList.getItems()[s-1].focus()}else{p.byId("SearchResultList-trigger").focus()}}else{this.oSF.focus()}}}},_initializeSearchField:function(){this.oSF=p.byId("CEPSearchField");var e=document.getElementById("PlaceHolderSearchField").clientWidth;this.oSF.setWidth(e+"px");this.oSF.addEventDelegate({onkeydown:this._keyDownSearchField.bind(this),onfocusin:this.onfocusin.bind(this)})},_initializeSearchHistoryList:function(){this._oSearchHistoryList=p.byId("SearchHistoryList");this._oSearchHistoryList.addEventDelegate({onkeydown:this._keyDownSearchHistoryList.bind(this),onsapdown:this._keyDownSearchHistoryList.bind(this)})},_initializeFrequentlyUsedAppsList:function(){this._oFrequentlyUsedAppsList=p.byId("FrequentlyUsedAppsList");this._oFrequentlyUsedAppsList.setHeaderText(h.i18n.getText("frequentAppsCEPSearch"));this._oFrequentlyUsedAppsList.addEventDelegate({onkeydown:this._keyDownFrequentlyUsedAppsList.bind(this),onsapdown:this._keyDownFrequentlyUsedAppsList.bind(this)})},_initializeSearchResultList:function(){this._oSearchResultList=p.byId("SearchResultList");this._oSearchResultList.addEventDelegate({onkeydown:this._keyDownSearchResultList.bind(this),onsapdown:this._keyDownSearchResultList.bind(this)})},_initializeProductsList:function(){this._oProductsList=p.byId("ProductsList");this._oProductsList.setHeaderText(h.i18n.getText("products"));this._oProductsList.addEventDelegate({onkeydown:this._keyDownProductsList.bind(this),onsapdown:this._keyDownProductsList.bind(this)})},_initializeExternalSearchResultList:function(){this._oExternalSearchResultList=p.byId("ExternalSearchAppsList");this._oExternalSearchResultList.setHeaderText(h.i18n.getText("searchWithin"));this._oExternalSearchResultList.addEventDelegate({onkeydown:this._keyDownExternalSearchResultList.bind(this)})},_saveSearchTerm:function(e){if(e){sap.ushell.Container.getServiceAsync("UserRecents").then(function(t){t.addSearchActivity({sTerm:e}).then(function(){return})})}},onRecentSearchPress:function(e){var t=e.getParameter("listItem").getProperty("title");this._recentSearchTermSelected=true;this.oSF.setValue(t);this.testProviders(t)},onSearchResultPress:function(e){var t=this.oSF.getValue();this._saveSearchTerm(t);var s="searchResults";var i=e.getParameter("listItem").getBindingContext(s).getObject().semanticObject;var r=e.getParameter("listItem").getBindingContext(s).getObject().semanticObjectAction;this._navigateApp(i,r)},onProductsPress:function(e){var t=this.oSF.getValue();this._saveSearchTerm(t);var s="productsResults";var i=e.getParameter("listItem").getBindingContext(s).getObject().semanticObject;var r=e.getParameter("listItem").getBindingContext(s).getObject().semanticObjectAction;this._navigateApp(i,r)},onExternalSearchResultPress:function(e){var t=this.oSF.getValue();this._saveSearchTerm(t);if(e.getParameter("listItem").getBindingContext("externalSearchResults").getObject().isEnterpriseSearch===true){this._navigateToResultPage(t,true)}else{var s=e.getParameter("listItem").getBindingContext("externalSearchResults").getObject().url;if(s!==undefined&&s!==null){this._navigateURL(s)}}},onFreqUsedAppsPress:function(e){var t=e.getParameter("listItem").getBindingContext("freqUsedApps").getObject().appId;var s=t.split("-")[0];s=s.split("#")[1];var i=t.split("-")[1];this._navigateApp(s,i);if(this._oPopover.isOpen()){this._oPopover.close()}},onFreqUsedProductsPress:function(e){var t=e.getParameter("listItem").getBindingContext("freqUsedProducts").getObject().appId;var s=t.split("-")[0];s=s.split("#")[1];var i=t.split("-")[1];this._navigateApp(s,i);if(this._oPopover.isOpen()){this._oPopover.close()}},_setListsVisible:function(e,t){t.setVisible(e);if(this._oSearchHistoryList.getVisible()===true){if(this._oFrequentlyUsedAppsList.getVisible()===true||this._oProductsList.getVisible()===true){this._oSearchHistoryList.addStyleClass("sapUshellCEPListDivider")}}if(this._oFrequentlyUsedAppsList.getVisible()===true){if(this._oProductsList.getVisible()===true){this._oFrequentlyUsedAppsList.addStyleClass("sapUshellCEPListDivider")}}if(this._oSearchResultList.getVisible()===true){if(this._oExternalSearchResultList.getVisible()===true){this._oSearchResultList.addStyleClass("sapUshellCEPListDivider")}}},_navigateURL:function(e){a.openURL(e);this.oSF.setValue("");setTimeout(function(){if(this._oPopover.isOpen()){this._oPopover.close()}}.bind(this),500)},_navigateApp:function(e,t){var s={};sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(i){i.toExternal({target:{semanticObject:e,action:t},params:s})});if(this.oSF.getValue()!==""){this.oSF.setValue("")}setTimeout(function(){if(this._oPopover.isOpen()){this._oPopover.close()}}.bind(this),500)},_navigateToResultPage:function(e,t){var s;if(e===""){return}if(t===true){s='#Action-search&/top=20&filter={"dataSource":{"type":"Category","id":"All","label":"All","labelPlural":"All"},"searchTerm":"'+e+'","rootCondition":{"type":"Complex","operator":"And","conditions":[]}}'}else if(this.bNavigateToNewResultPage===true){s="#WorkZoneSearchResult-display?searchTerm="+e+"&category=app"}else{s='#Action-search&/top=20&filter={"dataSource":{"type":"Category","id":"$$APPS$$","label":"Apps","labelPlural":"Apps"},"searchTerm":"'+e+'","rootCondition":{"type":"Complex","operator":"And","conditions":[]}}'}this.bOnNavigationToResultPage=true;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){e.toExternal({target:{shellHash:s}})});if(this.bNavigateToNewResultPage===true){setTimeout(function(){if(this._oPopover.isOpen()){this._oPopover.close()}}.bind(this),500)}setTimeout(function(){this.bOnNavigationToResultPage=false}.bind(this),3e3)}})});
//# sourceMappingURL=SearchCEP.controller.js.map