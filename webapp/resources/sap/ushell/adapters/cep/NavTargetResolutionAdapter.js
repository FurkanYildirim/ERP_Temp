// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/core/Configuration","sap/ui/thirdparty/jquery","sap/ushell/Container","sap/ushell/services/_ClientSideTargetResolution/VirtualInbounds","sap/ushell/utils/HttpClient","sap/ushell/Config"],function(t,e,jQuery,n,i,r,a){;"use strict";var o=function(t,e,n){this.oAdapterConfiguration=n;this._addVirtualInboundsToApplications();this._initializeHttpClient()};o.prototype._addVirtualInboundsToApplications=function(){var e=t.create("config.applications",this.oAdapterConfiguration);var n=i.getInbounds();n.forEach(function(t){var n=t.semanticObject+"-"+t.action;e[n]=t.resolutionResult})};o.prototype._getIntentForService=function(t){return sap.ushell.Container.getServiceAsync("URLParsing").then(function(e){var n=e.parseShellHash(t);return{semanticObject:n.semanticObject,semanticObjectAction:n.action,intentParameters:n.params,queryParameters:{siteId:a.last("/core/site/siteId")||""}}})};o.prototype._initializeHttpClient=function(){var t={"Content-Type":"application/json; utf-8",Accept:"application/json","Accept-Language":e.getLanguageTag()||""};var n=this.oAdapterConfiguration.config.navServiceUrl+"/";this.oHttpClient=new r(n,{headers:t})};o.prototype.toPromise=function(t){var e=this;return function(n){var i=new jQuery.Deferred;t.call(e,n).then(i.resolve).catch(i.reject).finally(i.always);return i.promise()}};o.prototype.resolveHashFragment=function(t){return this.toPromise(this._resolveHashFragment).call(this,t)};o.prototype._resolveHashFragment=function(t){return this._getIntentForService(t).then(function(t){var e=this.oAdapterConfiguration.config.navServiceUrl+"/resolve";return this.oHttpClient.post(e,{data:JSON.stringify(t)}).then(function(t){if(t.status<200||t.status>=300){return Promise.reject("HTTP request to GraphQL service failed with status: "+t.status+" - "+t.statusText)}return JSON.parse(t.responseText)}).then(function(t){var e=t.value||t;var n=Array.isArray(e)?e[0].url:e.url;return{additionalInformation:"",url:n,applicationType:"URL",navigationMode:"newWindow"}})}.bind(this))};return o},false);
//# sourceMappingURL=NavTargetResolutionAdapter.js.map