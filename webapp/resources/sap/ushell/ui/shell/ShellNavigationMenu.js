// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/m/FlexBox","sap/m/Bar","sap/ui/core/Icon","sap/m/Title","sap/m/Label","sap/m/List","sap/m/VBox","sap/ui/core/Control","sap/ui/core/Core","sap/ui/Device","sap/ui/thirdparty/jquery","sap/ui/events/KeyCodes","sap/ushell/library","sap/ushell/resources"],function(e,t,i,s,o,n,r,a,l,h,p,jQuery,d,u,c){"use strict";var f=l.extend("sap.ushell.ui.shell.ShellNavigationMenu",{metadata:{library:"sap.ushell",properties:{title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},showRelatedApps:{type:"boolean",defaultValue:true}},aggregations:{items:{type:"sap.m.ListItem",group:"Misc",defaultValue:null,singularName:"item"},miniTiles:{type:"sap.ushell.ui.shell.NavigationMiniTile",group:"Misc",defaultValue:null,singularName:"miniTile"}},events:{}},renderer:{apiVersion:2,render:function(e,t){var i;e.openStart("div",t);e.openEnd();e.renderControl(t.oTitleBar);if(t.oItemsList){e.renderControl(t.oItemsList)}if(t.getShowRelatedApps()){i=t.getMiniTiles();if(i&&i.length>0){e.renderControl(t.oRelatedAppsVbox)}}e.close("div")}}});var m=function(e){this.init(e)};m.prototype.init=function(e){this.keyCodes=d;this.jqElement=e.$();this.jqElement.on("keydown.keyboardNavigation",this.keydownHandler.bind(this))};m.prototype.destroy=function(){if(this.jqElement){this.jqElement.off(".keyboardNavigation")}delete this.jqElement};m.prototype.keydownHandler=function(e){switch(e.keyCode){case this.keyCodes.ARROW_UP:this.upDownHandler(e,true);break;case this.keyCodes.ARROW_DOWN:this.upDownHandler(e,false);break;case this.keyCodes.ARROW_LEFT:this.leftRightHandler(e,false);break;case this.keyCodes.ARROW_RIGHT:this.leftRightHandler(e,true);break;case this.keyCodes.HOME:this.homeEndHandler(e,true);break;case this.keyCodes.END:this.homeEndHandler(e,false);break;case this.keyCodes.PAGE_UP:this.homeEndHandler(e,true);break;case this.keyCodes.PAGE_DOWN:this.homeEndHandler(e,false);break;case this.keyCodes.TAB:if(e&&e.shiftKey){this._setItemFocus(e,jQuery("#sapUshellNavHierarchyItems li:[tabindex='0']"))}else{this._setItemFocus(e,jQuery("#allMyAppsButton"))}break;default:break}};m.prototype.upDownHandler=function(e,t){var i=jQuery(document.activeElement);if(!i.hasClass("sapUshellNavMiniTile")){return false}var s=i.parent().parent();var o=i.parent().index();var n=s.children();var r;if(t){r=o-3;if(r<0){r+=9}}else{r=(o+3)%n.length}var a=n[r].children[0];this._setItemFocus(e,jQuery(a))};m.prototype.leftRightHandler=function(e,t){var i=t?"next":"prev",s,o,n,r,a,l,h=jQuery(document.activeElement);if(!h.hasClass("sapUshellNavMiniTile")){return false}s=h.parent();o=s[i]();n=o.index();r=s.parent();if(n===-1){a=t?0:r.children().length-1}else{a=n}l=r.children()[a].children[0];if(!l){return false}this._setItemFocus(e,jQuery(l))};m.prototype.homeEndHandler=function(e,t){var i=t?"first":"last";var s=jQuery(document.activeElement);if(!s.hasClass("sapUshellNavMiniTile")){return false}e.preventDefault();var o=this.jqElement.find(".sapUshellNavMiniTile")[i]();this._setItemFocus(e,o)};m.prototype._setItemFocus=function(e,t){e.preventDefault();e.stopImmediatePropagation();jQuery(".sapUshellNavMiniTile").attr("tabindex",-1);t.attr("tabindex",0);t.focus()};m.prototype.setFocusToLastFocusedMiniTile=function(e){var t=jQuery(".sapUshellNavMiniTile[tabindex='0']");if(t&&t[0]){this._setItemFocus(e,jQuery(t))}else{this._setItemFocus(e,jQuery(jQuery(".sapUshellNavMiniTile")[0]))}};f.prototype.init=function(){};f.prototype._createItemsList=function(){this.oItemsList=new r("sapUshellNavHierarchyItems")};f.prototype._createMiniTilesBox=function(){this.oMiniTilesBox=new t("sapUshellNavRelatedAppsFlexBox",{justifyContent:"Center"})};f.prototype._beforeOpen=function(){if(!this.bInitialized){this.oTitle=new o("navMenuInnerTitle",{level:"H1"});this.oIconControl=new s;this.oTitleBar=new i("navMenuTitleBar",{contentLeft:[this.oIconControl,this.oTitle]});this.oRelatedAppsTitle=new n("sapUshellRelatedAppsLabel",{text:c.i18n.getText("shellNavMenu_relatedApps")});if(!this.oMiniTilesBox){this._createMiniTilesBox()}this.oRelatedAppsVbox=new a("sapUshellRelatedAppsItems",{items:[this.oRelatedAppsTitle,this.oMiniTilesBox]});this._extendInnerControlsForAccKeyboard();this.bInitialized=true}this.oTitle.setText(this.getTitle());this.oIconControl.setSrc(this.getIcon()||"sap-icon://folder")};f.prototype._afterOpen=function(){if(p.system.desktop){if(this.keyboardNavigation){this.keyboardNavigation.destroy()}this.keyboardNavigation=new m(this.oMiniTilesBox)}};f.prototype._extendInnerControlsForAccKeyboard=function(){if(p.system.desktop){this.oItemsList.addEventDelegate({onsaptabnext:function(e){if(jQuery(".sapUshellNavMiniTile").length){this.keyboardNavigation.setFocusToLastFocusedMiniTile(e)}else{var t=h.byId("allMyAppsButton");this.keyboardNavigation._setItemFocus(e,jQuery(t.getDomRef()))}}.bind(this)})}};f.prototype.getMiniTiles=function(){if(this.oMiniTilesBox){return this.oMiniTilesBox.getItems()}return[]};f.prototype.insertMiniTile=function(e,t){if(!this.oMiniTilesBox){this._createMiniTilesBox()}this.oMiniTilesBox.insertItem(e,t);return this};f.prototype.addMiniTile=function(t){if(!this.oMiniTilesBox){this._createMiniTilesBox()}if(this.oMiniTilesBox.getItems().length<9){this.oMiniTilesBox.addItem(t)}else{e.warning("ShellNavigationMenu.addMiniTile - miniTiles aggregation is already at maximum size of 9 elements "+"- current item was not added.")}return this};f.prototype.removeMiniTile=function(e){if(this.oMiniTilesBox){this.oMiniTilesBox.removeItem(e)}return this};f.prototype.removeAllMiniTiles=function(){if(this.oMiniTilesBox){this.oMiniTilesBox.removeAllItems()}return this};f.prototype.destroyMiniTiles=function(){if(this.oMiniTilesBox){this.oMiniTilesBox.destroyItems()}return this};f.prototype.indexOfMiniTile=function(e){if(this.oMiniTilesBox){return this.oMiniTilesBox.indexOfItem(e)}return-1};f.prototype.getItems=function(){if(this.oItemsList){return this.oItemsList.getItems()}return[]};f.prototype.insertItem=function(e,t){if(!this.oItemsList){this._createItemsList()}e=this._extendHierarchyItemForAcc(e);this.oItemsList.insertItem(e,t);return this};f.prototype.addItem=function(e){if(!this.oItemsList){this._createItemsList()}e=this._extendHierarchyItemForAcc(e);this.oItemsList.addItem(e);return this};f.prototype.removeItem=function(e){if(this.oItemsList){this.oItemsList.removeItem(e)}return this};f.prototype.removeAllItems=function(){if(this.oItemsList){this.oItemsList.removeAllItems()}return this};f.prototype.destroyItems=function(){if(this.oItemsList){this.oItemsList.destroyItems()}return this};f.prototype.indexOfItem=function(e){if(this.oItemsList){return this.oItemsList.indexOfItem(e)}return-1};f.prototype._extendHierarchyItemForAcc=function(e){if(p.system.desktop){e.addEventDelegate({onsapspace:function(e){this.firePress()}.bind(e)})}return e};f.prototype.exit=function(){if(this.oItemsList){this.oItemsList.destroy()}if(this.oMiniTilesBox){this.oMiniTilesBox.destroy()}if(this.bInitialized){this.oTitleBar.destroy();this.oRelatedAppsVbox.destroy();this.oRelatedAppsTitle.destroy()}if(this.keyboardNavigation){this.keyboardNavigation.destroy()}};f.prototype.onAfterRendering=function(){jQuery("#sapUshellAppTitlePopover-intHeader").css("height",0);var e=jQuery("#sapUshellNavHierarchyItems ul");e.attr("role","menu");e.attr("aria-label",c.i18n.getText("ShellNavigationMenu_HierarchyItemsAriaLabel"));jQuery("#sapUshellNavHierarchyItems li").attr("role","menuitem");var t=jQuery("#sapUshellNavRelatedAppsFlexBox");t.attr("role","list");t.attr("aria-labelledBy","sapUshellRelatedAppsLabel");var i=jQuery(".sapUshellNavMiniTile");for(var s=0;s<i.length;s++){jQuery(i[s]).attr("aria-setsize",i.length);jQuery(i[s]).attr("aria-posinset",s+1)}var o=this.oTitle.getDomRef();if(o){var n=o.firstChild;if(n){var r=o.getBoundingClientRect().right<n.getBoundingClientRect().right;var a=r?this.getTitle():null;if(this.oTitle.getTooltip()!==a){this.oTitle.setTooltip(a);this.oTitle.rerender()}}}};return f});
//# sourceMappingURL=ShellNavigationMenu.js.map