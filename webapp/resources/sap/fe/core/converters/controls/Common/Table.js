/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/Key","sap/fe/core/formatters/TableFormatter","sap/fe/core/formatters/TableFormatterTypes","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/EntitySetHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/internal/helpers/ActionHelper","sap/ui/core/Core","../../helpers/Aggregation","../../helpers/DataFieldHelper","../../helpers/ID","../../ManifestSettings","./Criticality","./table/StandardActions","sap/base/Log"],function(e,t,n,o,i,a,l,r,s,d,u,v,c,f,p,g,m,y,b,h,T,I,A,P,D,F){"use strict";var C={};var S=D.isInDisplayMode;var E=D.isDraftOrStickySupported;var O=D.getStandardActionPaste;var x=D.getStandardActionMassEdit;var M=D.getStandardActionInsights;var U=D.getStandardActionDelete;var $=D.getStandardActionCreate;var N=D.getRestrictions;var w=D.getMassEditVisibility;var V=D.getInsertUpdateActionsTemplating;var L=D.getDeleteVisibility;var R=D.getCreationRow;var k=D.generateStandardActionsContext;var H=P.getMessageTypeFromCriticalityType;var j=A.VisualizationType;var B=A.VariantManagementType;var z=A.TemplateType;var G=A.SelectionMode;var K=A.Importance;var W=A.HorizontalAlign;var Q=A.CreationMode;var q=A.ActionType;var _=I.getTableID;var Y=T.isReferencePropertyStaticallyHidden;var J=h.AggregationHelper;var X=m.isMultiValueField;var Z=g.isImageURL;var ee=g.getAssociatedUnitProperty;var te=g.getAssociatedTimezoneProperty;var ne=g.getAssociatedCurrencyProperty;var oe=p.getNonSortablePropertiesRestrictions;var ie=f.getDisplayMode;var ae=c.isPathUpdatable;var le=c.isPathSearchable;var re=c.isPathDeletable;var se=c.getTargetObjectPath;var de=c.enhanceDataModelPath;var ue=v.isTypeDefinition;var ve=v.isProperty;var ce=v.isPathAnnotationExpression;var fe=v.isNavigationProperty;var pe=v.isAnnotationOfType;var ge=u.replaceSpecialChars;var me=u.generate;var ye=s.resolveBindingString;var be=s.pathInModel;var he=s.or;var Te=s.not;var Ie=s.isConstant;var Ae=s.ifElse;var Pe=s.getExpressionFromAnnotation;var De=s.formatResult;var Fe=s.equal;var Ce=s.EDM_TYPE_MAPPING;var Se=s.constant;var Ee=s.compileExpression;var Oe=s.and;var xe=r.MessageType;var Me=a.KeyHelper;var Ue=i.IssueType;var $e=i.IssueSeverity;var Ne=i.IssueCategoryType;var we=i.IssueCategory;var Ve=o.Placement;var Le=o.OverrideType;var Re=o.insertCustomElements;var ke=n.UI;var He=n.Entity;var je=t.getEnabledForAnnotationAction;var Be=t.removeDuplicateActions;var ze=t.isActionNavigable;var Ge=t.getCopyAction;var Ke=t.getActionsFromManifest;var We=t.dataFieldIsCopyAction;var Qe=e.isDataPointFromDataFieldDefault;var qe=e.isDataFieldTypes;var _e=e.isDataFieldForActionAbstract;var Ye=e.getTargetValueOnDataPoint;var Je=e.getSemanticObjectPath;var Xe=e.getDataFieldDataType;var Ze=e.collectRelatedPropertiesRecursively;var et=e.collectRelatedProperties;var tt;(function(e){e["Default"]="Default";e["Annotation"]="Annotation";e["Slot"]="Slot"})(tt||(tt={}));function nt(e,t,n,o){const i=At(e,t,n);const a=i.tableActions;const l=i.hiddenTableActions;const r=Ke(n.getManifestControlConfiguration(t).actions,n,a,o,true,l);const s={isNavigable:Le.overwrite,enableOnSelect:Le.overwrite,enableAutoScroll:Le.overwrite,enabled:Le.overwrite,visible:Le.overwrite,defaultValuesExtensionFunction:Le.overwrite,command:Le.overwrite};const d=Re(a,r.actions,s);return{actions:d,commandActions:r.commandActions}}C.getTableActions=nt;function ot(e,t,n,o,i){const a=tn(e,t,n,i);const l=an(n.getManifestControlConfiguration(t).columns,a,n,n.getAnnotationEntityType(e),o);return Re(a,l,{width:Le.overwrite,importance:Le.overwrite,horizontalAlign:Le.overwrite,availability:Le.overwrite,isNavigable:Le.overwrite,settings:Le.overwrite,formatOptions:Le.overwrite})}C.getTableColumns=ot;const it=function(e,t,n){const o=new J(e,n);function i(e){return t.find(t=>{const n=t;return n.propertyInfos===undefined&&n.relativePath===e})}if(!o.isAnalyticsSupported()){return undefined}const a=new Set;t.forEach(e=>{const t=e;if(t.unit){a.add(t.unit)}});const l=o.getCustomAggregateDefinitions();const r={};l.forEach(e=>{const t=o._entityType.entityProperties.find(t=>t.name===e.qualifier);if(t){var n,i;const o=(n=e.annotations)===null||n===void 0?void 0:(i=n.Aggregation)===null||i===void 0?void 0:i.ContextDefiningProperties;r[t.name]=o?o.map(e=>e.value):[]}});const s={};t.forEach(e=>{const t=e;if(t.propertyInfos===undefined&&t.relativePath){const e=r[t.relativePath];if(e&&!a.has(t.name)){s[t.name]={defaultAggregate:{},relativePath:t.relativePath};const n=[];e.forEach(e=>{const t=i(e);if(t){n.push(t.name)}});if(n.length){s[t.name].defaultAggregate.contextDefiningProperties=n}}}});return s};C.getAggregateDefinitionsFromEntityType=it;function at(e,t,n,o){if(e.control.type==="AnalyticalTable"){const i=it(t,e.columns,n),a=new J(t,n);if(i){e.enableAnalytics=true;e.enable$select=false;e.enable$$getKeepAliveContext=false;e.aggregates=i;cn(e);const t=a.getAllowedTransformations();e.enableBasicSearch=t?t.indexOf("search")>=0:true;e.annotation.groupConditions=vn(o,e.columns,e.control.type);e.annotation.aggregateConditions=fn(o,e.columns)}e.control.type="GridTable"}else if(e.control.type==="ResponsiveTable"){e.annotation.groupConditions=vn(o,e.columns,e.control.type)}else if(e.control.type==="TreeTable"){const o=new J(t,n);const i=o.getAllowedTransformations();e.enableBasicSearch=i?i.includes("search"):true;e.enable$$getKeepAliveContext=true}}C.updateTableVisualizationForType=at;function lt(e,t){const n=e.getManifestWrapper();if(t&&n.getNavigationConfiguration(t)){const e=n.getNavigationConfiguration(t);if(Object.keys(e).length>0){return t}}const o=e.getDataModelObjectPath();const i=e.getContextPath();const a=n.getNavigationConfiguration(i);if(a&&Object.keys(a).length>0){return i}return o.targetEntitySet?o.targetEntitySet.name:o.startingEntitySet.name}function rt(e,t){function n(e){return t.find(t=>{const n=t;return n.propertyInfos===undefined&&n.relativePath===e})}t.forEach(t=>{const o=t;if(o.propertyInfos===undefined&&o.relativePath){const t=e.entityProperties.find(e=>e.name===o.relativePath);if(t){var i,a,l;const e=ne(t)||ee(t);const v=te(t);const c=t===null||t===void 0?void 0:(i=t.annotations)===null||i===void 0?void 0:(a=i.Common)===null||a===void 0?void 0:a.Timezone;if(e){const t=n(e.name);o.unit=t===null||t===void 0?void 0:t.name}else{var r,s,d,u;const e=(t===null||t===void 0?void 0:(r=t.annotations)===null||r===void 0?void 0:(s=r.Measures)===null||s===void 0?void 0:s.ISOCurrency)||(t===null||t===void 0?void 0:(d=t.annotations)===null||d===void 0?void 0:(u=d.Measures)===null||u===void 0?void 0:u.Unit);if(e){o.unitText=`${e}`}}if(v){const e=n(v.name);o.timezone=e===null||e===void 0?void 0:e.name}else if(c){o.timezoneText=c.toString()}const f=ie(t),p=(l=t.annotations.Common)===null||l===void 0?void 0:l.Text;if(ce(p)&&f!=="Value"){const e=n(p.path);if(e&&e.name!==o.name){o.textArrangement={textProperty:e.name,mode:f}}}}}})}C.updateLinkedProperties=rt;function st(e){var t,n,o,i,a,l,r,s,d,u,v,c,f;const p=(t=e.getAnnotationEntityType())===null||t===void 0?void 0:(n=t.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:(i=o.HeaderInfo)===null||i===void 0?void 0:(a=i.Title)===null||a===void 0?void 0:(l=a.Value)===null||l===void 0?void 0:l.path;const g=(r=e.getAnnotationEntityType())===null||r===void 0?void 0:(s=r.annotations)===null||s===void 0?void 0:(d=s.Common)===null||d===void 0?void 0:d.SemanticKey;const m=e===null||e===void 0?void 0:(u=e.getAnnotationEntityType())===null||u===void 0?void 0:(v=u.annotations)===null||v===void 0?void 0:(c=v.UI)===null||c===void 0?void 0:(f=c.HeaderInfo)===null||f===void 0?void 0:f.TypeName;const y=[];if(g){g.forEach(function(e){y.push(e.value)})}return{headerInfoTitlePath:p,semanticKeyColumns:y,headerInfoTypeName:m}}function dt(e,t,n,o,i,a,l){const r=xn(e,t,n,i);const{navigationPropertyPath:s}=mn(t);const d=lt(n,s);const u=n.getManifestWrapper().getNavigationConfiguration(d);const v=ot(e,t,n,u,l);const c=vt(e,n);const f=st(n);const p=nt(e,t,n,u);const g={type:j.Table,annotation:pn(e,t,n,r,v,o,a,l),control:r,actions:Be(p.actions),commandActions:p.commandActions,columns:v,operationAvailableMap:JSON.stringify(c),operationAvailableProperties:ft(c,n),headerInfoTitle:f.headerInfoTitlePath,semanticKeys:f.semanticKeyColumns,headerInfoTypeName:f.headerInfoTypeName,enable$select:true,enable$$getKeepAliveContext:true};rt(n.getAnnotationEntityType(e),v);at(g,n.getAnnotationEntityType(e),n,o);return g}C.createTableVisualization=dt;function ut(e,t){const n=xn(undefined,"",e,false);const o=Ct({},e.getEntityType(),[],[],e,n.type,[]);const i=vt(undefined,e);const a=st(e);const l={type:j.Table,annotation:pn(undefined,"",e,n,t?[]:o),control:n,actions:[],columns:o,operationAvailableMap:JSON.stringify(i),operationAvailableProperties:ft(i,e),headerInfoTitle:a.headerInfoTitlePath,semanticKeys:a.semanticKeyColumns,headerInfoTypeName:a.headerInfoTypeName,enable$select:true,enable$$getKeepAliveContext:true};rt(e.getEntityType(),o);at(l,e.getEntityType(),e);return l}C.createDefaultTableVisualization=ut;function vt(e,t){return y.getOperationAvailableMap(e,"table",t)}function ct(e){var t,n;const o=N(e);const i=e.getEntitySet();const a=o.isUpdatable;const l=!Ie(a.expression)&&a.navigationExpression._type==="Unresolvable";const r=i===null||i===void 0?void 0:(t=i.annotations.Capabilities)===null||t===void 0?void 0:(n=t.UpdateRestrictions)===null||n===void 0?void 0:n.Updatable;const s=ce(r)&&r.path;return l?s:""}function ft(e,t){const n=new Set;for(const t in e){const o=e[t];if(o===null){n.add(t)}else if(typeof o==="string"){n.add(o)}}if(n.size){var o,i,a,l,r;const e=t.getEntityType();const s=(o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:(a=i.HeaderInfo)===null||a===void 0?void 0:(l=a.Title)===null||l===void 0?void 0:(r=l.Value)===null||r===void 0?void 0:r.path;if(s){n.add(s)}}return Array.from(n).join(",")}function pt(e,t,n,o){const i=[];e.forEach(e=>{var a,l;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e!==null&&e!==void 0&&(a=e.ActionTarget)!==null&&a!==void 0&&a.isBound&&t===(e===null||e===void 0?void 0:e.ActionTarget.sourceEntityType)||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&e.RequiresContext&&(e===null||e===void 0?void 0:(l=e.Inline)===null||l===void 0?void 0:l.valueOf())!==true){var r,s,d;if(typeof((r=e.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:(d=s.Hidden)===null||d===void 0?void 0:d.valueOf())==="object"){i.push(Fe(gt(e,n,o),false))}}});return i}function gt(e,t,n){let o;if((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAction"||(e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var i,a;o=e===null||e===void 0?void 0:(i=e.annotations)===null||i===void 0?void 0:(a=i.UI)===null||a===void 0?void 0:a.Hidden}else{o=e===null||e===void 0?void 0:e.visible}let l;if(ce(o)){l=o.path}else{l=o}if(l){if(e!==null&&e!==void 0&&e.visible){l=l.substring(1,l.length-1)}if(l.indexOf("/")>0){const e=l.split("/");const n=e[0];if(fe(t===null||t===void 0?void 0:t.targetObject)&&t.targetObject.partner===n){return be(e.slice(1).join("/"))}else{return Se(true)}}else if(n){return be(l)}else{return Se(true)}}return Se(true)}function mt(e,t,n){return Object.keys(n).some(o=>{if(o===e){var i;if(t!==null&&t!==void 0&&(i=t.ActionTarget)!==null&&i!==void 0&&i.isBound||t!==null&&t!==void 0&&t.RequiresContext){n[e].requiresSelection=true}return true}return false})}function yt(e,t,n){return e.some(e=>{var o,i,a,l,r,s,d;if((e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&(e===null||e===void 0?void 0:(o=e.Inline)===null||o===void 0?void 0:o.valueOf())!==true&&(((i=e.annotations)===null||i===void 0?void 0:(a=i.UI)===null||a===void 0?void 0:(l=a.Hidden)===null||l===void 0?void 0:l.valueOf())===false||((r=e.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:(d=s.Hidden)===null||d===void 0?void 0:d.valueOf())===undefined)){if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){var u;const o=me(["DataFieldForAction",e.Action]);if(mt(o,e,t)){return false}return(e===null||e===void 0?void 0:(u=e.ActionTarget)===null||u===void 0?void 0:u.isBound)&&n===(e===null||e===void 0?void 0:e.ActionTarget.sourceEntityType)}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(mt(`DataFieldForIntentBasedNavigation::${e.SemanticObject}::${e.Action}`,e,t)){return false}return e.RequiresContext}}return false})}function bt(e){return Object.keys(e).some(t=>{var n;const o=e[t];if(o.requiresSelection&&((n=o.visible)===null||n===void 0?void 0:n.toString())==="true"){return true}return false})}function ht(e){const t=[];if(e){Object.keys(e).forEach(n=>{const o=e[n];if(o.requiresSelection===true&&o.visible!==undefined){if(typeof o.visible==="string"){var i;t.push(ye(o===null||o===void 0?void 0:(i=o.visible)===null||i===void 0?void 0:i.valueOf()))}}})}return t}function Tt(e){const t=re(e.getDataModelObjectPath());const n=ae(e.getDataModelObjectPath());return{isDeletable:!(Ie(t)&&t.value===false),isUpdatable:!(Ie(n)&&n.value===false)}}C.getCapabilityRestriction=Tt;function It(e,t,n,o,i,a){var l;let r=arguments.length>6&&arguments[6]!==undefined?arguments[6]:Se(false);const s=n.getManifestControlConfiguration(t);let d=(l=s.tableSettings)===null||l===void 0?void 0:l.selectionMode;if(!e||d===G.None){return G.None}let u=[],v=[];const c=Ke(n.getManifestControlConfiguration(t).actions,n,[],undefined,false);let f,p;if(n.getTemplateType()===z.ObjectPage){f=re(n.getDataModelObjectPath());p=f?Ee(f,true):f}const g=!Ie(r)||r.value!==false;if(!d||d===G.Auto){d=G.Multi}if(g){d=d===G.Single?G.Single:G.Multi}if(yt(e,c.actions,n.getEntityType())||bt(c.actions)){return d}u=pt(e,n.getEntityType(),n.getDataModelObjectPath(),o);v=ht(c.actions);if(u.length===0&&v.length===0&&(a||g)){if(!o){if(i.isDeletable||p!=="false"||g){const e=he(a||true,r);return Ee(Ae(Oe(ke.IsEditable,e),Se(d),Se(G.None)))}else{return G.None}}else if(g){return d}else if(i.isDeletable&&a){return Ee(Ae(a,Se(d),Se("None")))}else{return G.None}}else if(!o){if(i.isDeletable||p!=="false"||g){const e=Ae(g&&!i.isDeletable,r,Se(true));return Ee(Ae(Oe(ke.IsEditable,e),Se(d),Ae(he(...u.concat(v)),Se(d),Se(G.None))))}else{return Ee(Ae(he(...u.concat(v)),Se(d),Se(G.None)))}}else if(i.isDeletable||g){return d}else{return Ee(Ae(he(...u.concat(v),r),Se(d),Se(G.None)))}}C.getSelectionMode=It;function At(e,t,n){const o=[];const i=[];const a=Ge(e.filter(e=>We(e)));const l=n.getEntityType().fullyQualifiedName;if(a){var r,s,d;o.push({type:q.Copy,annotationPath:n.getEntitySetBasedAnnotationPath(a.fullyQualifiedName),key:Me.generateKeyFromDataField(a),enabled:Ee(Fe(be("numberOfSelectedContexts","internal"),1)),visible:Ee(Te(Fe(Pe((r=a.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:s.Hidden,[],undefined,n.getRelativeModelPathFunction()),true))),text:((d=a.Label)===null||d===void 0?void 0:d.toString())??b.getLibraryResourceBundle("sap.fe.core").getText("C_COMMON_COPY"),isNavigable:true})}e.filter(e=>!We(e)).forEach(e=>{var t,a,r,s,d,u,v,c,f,p,g,m;if(((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(r=a.Hidden)===null||r===void 0?void 0:r.valueOf())===true){i.push({type:q.Default,key:Me.generateKeyFromDataField(e)})}else if(_e(e)&&((s=e.Inline)===null||s===void 0?void 0:s.valueOf())!==true&&((d=e.Determining)===null||d===void 0?void 0:d.valueOf())!==true){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":let t=false;if(((u=e.ActionTarget)===null||u===void 0?void 0:(v=u.annotations)===null||v===void 0?void 0:(c=v.Core)===null||c===void 0?void 0:c.OperationAvailable)!==undefined){var y,b,h,T;if(!((y=e.ActionTarget)!==null&&y!==void 0&&y.isBound)){t=true}else if((b=e.ActionTarget)!==null&&b!==void 0&&b.isBound&&((h=e.ActionTarget)===null||h===void 0?void 0:h.sourceType)!==l){t=true}else if((T=e.ActionTarget)!==null&&T!==void 0&&T.parameters[0].isCollection){t=true}}const i={type:q.DataFieldForAction,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:Me.generateKeyFromDataField(e),visible:Ee(Te(Fe(Pe((f=e.annotations)===null||f===void 0?void 0:(p=f.UI)===null||p===void 0?void 0:p.Hidden,[],undefined,n.getRelativeModelPathFunction()),true))),isNavigable:true};if(t){i.enabled=je(n,e.ActionTarget)}o.push(i);break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":o.push({type:q.DataFieldForIntentBasedNavigation,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:Me.generateKeyFromDataField(e),visible:Ee(Te(Fe(Pe((g=e.annotations)===null||g===void 0?void 0:(m=g.UI)===null||m===void 0?void 0:m.Hidden,[],undefined,n.getRelativeModelPathFunction()),true)))});break;default:break}}});return{tableActions:o,hiddenTableActions:i}}function Pt(e,t,n){let o=xe.None;if(e){if(typeof e==="object"){o=Pe(e)}else{o=H(e)}}const i=[];n===null||n===void 0?void 0:n.keys.forEach(e=>{if(e.name!=="IsActiveEntity"){i.push(be(e.name,undefined))}});return De([o,be(`filteredMessages`,"internal"),t&&He.HasActive,t&&He.IsActive,`${t}`,...i],l.rowHighlighting,n)}function Dt(e,t,n,o,i){var a;const l=(o===null||o===void 0?void 0:o.create)||(o===null||o===void 0?void 0:o.detail);const r=n.getManifestControlConfiguration(i);const s=r&&r.tableSettings||{};if(l!==null&&l!==void 0&&l.outbound&&l.outboundDetail&&o!==null&&o!==void 0&&o.create){return{mode:"External",outbound:l.outbound,outboundDetail:l.outboundDetail,navigationSettings:o}}let d;if(e){var u,v,c;const e=(u=n.getEntitySet())===null||u===void 0?void 0:u.annotations;const o=e===null||e===void 0?void 0:e.Common,i=e===null||e===void 0?void 0:e.Session;d=(o===null||o===void 0?void 0:(v=o.DraftRoot)===null||v===void 0?void 0:v.NewAction)||(i===null||i===void 0?void 0:(c=i.StickySessionSupported)===null||c===void 0?void 0:c.NewAction);if(t.creationMode===Q.CreationRow&&d){throw Error(`Creation mode '${Q.CreationRow}' can not be used with a custom 'new' action (${d})`)}if(l!==null&&l!==void 0&&l.route){var f;return{mode:t.creationMode,append:t.createAtEnd,newAction:(f=d)===null||f===void 0?void 0:f.toString(),navigateToTarget:t.creationMode===Q.NewPage?l.route:undefined}}}if(t.creationMode===Q.NewPage){var p;t.creationMode=Q.Inline;if(((p=s.creationMode)===null||p===void 0?void 0:p.createAtEnd)===undefined){t.createAtEnd=false}}return{mode:t.creationMode,append:t.createAtEnd,newAction:(a=d)===null||a===void 0?void 0:a.toString()}}const Ft=function(e,t,n,o,i){let a,r;let s=Se(xe.None);const u=t.getEntityType();if(n&&e){var v,c,f,p,g;r=((v=n.display)===null||v===void 0?void 0:v.target)||((c=n.detail)===null||c===void 0?void 0:c.outbound);const l=t.getEntitySet();s=Pt((f=e.annotations)===null||f===void 0?void 0:(p=f.UI)===null||p===void 0?void 0:p.Criticality,!!d.getDraftRoot(l)||!!d.getDraftNode(l),u);if(r){a=".handlers.onChevronPressNavigateOutBound( $controller ,'"+r+"', ${$parameters>bindingContext})"}if(!r&&(g=n.detail)!==null&&g!==void 0&&g.route){a="API.onTableRowPress($event, $controller, ${$parameters>bindingContext}, { callExtension: true, targetPath: '"+o+"', editable : "+(d.getDraftRoot(l)||d.getDraftNode(l)?"!${$parameters>bindingContext}.getProperty('IsActiveEntity')":"undefined")+(i==="AnalyticalTable"||i==="TreeTable"?", bRecreateContext: true":"")+"})"}}const m=De([be("/deepestPath","internal")],l.navigatedRow,u);return{press:a,action:a?"Navigation":undefined,rowHighlighting:Ee(s),rowNavigated:Ee(m),visible:Ee(Te(ke.IsInactive))}};const Ct=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];let o=arguments.length>3?arguments[3]:undefined;let i=arguments.length>4?arguments[4]:undefined;let a=arguments.length>5?arguments[5]:undefined;let l=arguments.length>6?arguments[6]:undefined;const r=n;const s=new J(t,i);t.entityProperties.forEach(t=>{const d=n.some(e=>e.name===t.name);if(!t.targetType&&!d){const n=et(t.name,t,i,true,a);const d=Object.keys(n.properties);const u=Object.keys(n.additionalProperties);if(n.textOnlyPropertiesFromTextAnnotation.length>0){l.push(...n.textOnlyPropertiesFromTextAnnotation)}const v=St(t,i.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,true,true,o,s,i,l);if(d.length>0){v.propertyInfos=d;v.exportSettings={...v.exportSettings,template:n.exportSettingsTemplate,wrap:n.exportSettingsWrapping};v.exportSettings.type=gn(t.type,d.length>1);if(n.exportUnitName){v.exportSettings.unitProperty=n.exportUnitName;v.exportSettings.type="Currency"}else if(n.exportUnitString){v.exportSettings.unit=n.exportUnitString}if(n.exportTimezoneName){v.exportSettings.timezoneProperty=n.exportTimezoneName;v.exportSettings.utc=false}else if(n.exportTimezoneString){v.exportSettings.timezone=n.exportTimezoneString}if(n.exportDataPointTargetValue){v.exportDataPointTargetValue=n.exportDataPointTargetValue;v.exportSettings.type="String"}d.forEach(t=>{e[t]=n.properties[t]})}if(u.length>0){v.additionalPropertyInfos=u;u.forEach(t=>{e[t]=n.additionalProperties[t]})}r.push(v)}if(ie(t)==="Description"){o=o.concat(t.name);r.push(St(t,i.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,false,false,o,s,i,[]))}});const d=wt(e,r,o,i,t,l);return r.concat(d)};C.getColumnsFromEntityType=Ct;const St=function(e,t,n,o,i,a,l,r,s){var d,u,v,c,f;const p=o?n:`Property::${n}`;const g=(o?"DataField::":"Property::")+ge(n);const m=Je(r,e);const y=((d=e.annotations)===null||d===void 0?void 0:(u=d.UI)===null||u===void 0?void 0:(v=u.Hidden)===null||v===void 0?void 0:v.valueOf())===true;const b=e.name?Ht(e.name,true,false):undefined;const h=b!=e.name;const T=gn(e.type);const I=e.type==="Edm.Date"?"YYYY-MM-DD":undefined;const A=Xe(e);const P=Mn(e,A);const D=r.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[r.getEntityType()])[0];const F=s&&s.indexOf(n)>=0;const C=(!y||F)&&a.indexOf(n)===-1;const S={className:e.type||A,formatOptions:P.formatOptions,constraints:P.constraints};let E=null;if(Et(e)){var O,x,M,U,$,N;const t=ne(e)||ee(e);const n=te(e);const o=((O=e.annotations)===null||O===void 0?void 0:(x=O.Measures)===null||x===void 0?void 0:x.ISOCurrency)||((M=e.annotations)===null||M===void 0?void 0:(U=M.Measures)===null||U===void 0?void 0:U.Unit);const i=($=e.annotations)===null||$===void 0?void 0:(N=$.Common)===null||N===void 0?void 0:N.Timezone;E={type:T,inputFormat:I,scale:e.scale,delimiter:e.type==="Edm.Int64"};if(t){E.unitProperty=t.name;E.type="Currency"}else if(o){E.unit=`${o}`}if(n){E.timezoneProperty=n.name;E.utc=false}else if(i){E.timezone=i.toString()}}const w=On(n,r);const V={key:g,type:tt.Annotation,label:Ut(e,h),groupLabel:h?Ut(e):undefined,group:h?b:undefined,annotationPath:t,semanticObjectPath:m,availability:!i||y?"Hidden":"Adaptation",name:p,relativePath:n,sortable:C,isGroupable:l.isAnalyticsSupported()?!!l.isPropertyGroupable(e):C,isKey:e.isKey,exportSettings:E,caseSensitive:zt(r),typeConfig:S,importance:Zt((c=e.annotations)===null||c===void 0?void 0:(f=c.UI)===null||f===void 0?void 0:f.DataFieldDefault,D),additionalLabels:w};const L=$t(e)||Ut(e,h);if(L){V.tooltip=L}const R=Ye(e);if(Qe(e)&&typeof R==="string"&&V.exportSettings){V.exportDataPointTargetValue=R;V.exportSettings.template="{0}/"+R}return V};function Et(e){var t;let n,o;const i=(t=e.annotations.UI)===null||t===void 0?void 0:t.DataFieldDefault;if(ve(e)&&i!==null&&i!==void 0&&i.$Type){if(Y(i)===true){return false}n=i===null||i===void 0?void 0:i.$Type}else if(Y(e)===true){return false}else{var a,l,r,s,d,u,v,c,f,p,g;o=e;n=o.$Type;if(n==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(a=o.Target)!==null&&a!==void 0&&(l=a.$target)!==null&&l!==void 0&&l.$Type){var m,y;n=(m=o.Target)===null||m===void 0?void 0:(y=m.$target)===null||y===void 0?void 0:y.$Type;return"com.sap.vocabularies.UI.v1.ChartDefinitionType".indexOf(n)===-1}else if(((r=o.Value)===null||r===void 0?void 0:(s=r.$target)===null||s===void 0?void 0:(d=s.annotations)===null||d===void 0?void 0:(u=d.Core)===null||u===void 0?void 0:(v=u.MediaType)===null||v===void 0?void 0:v.term)==="Org.OData.Core.V1.MediaType"&&((c=o.Value)===null||c===void 0?void 0:(f=c.$target)===null||f===void 0?void 0:(p=f.annotations)===null||p===void 0?void 0:(g=p.Core)===null||g===void 0?void 0:g.isURL)!==true){return false}}return n?["com.sap.vocabularies.UI.v1.DataFieldForAction","com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation","com.sap.vocabularies.UI.v1.DataFieldForActionGroup"].indexOf(n)===-1:true}const Ot=function(e){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return!!e.Inline;case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":return true;default:}};const xt=function(e){var t,n,o,i,a,l;const r=e.targetObject;let s;if(r){switch(r.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataPointType":s=r.Value.$target;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if((r===null||r===void 0?void 0:(t=r.Target)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var d;s=(d=r.Target.$target)===null||d===void 0?void 0:d.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForAction":default:s=undefined}}const u=Se(false);const v=Se(false);return Oe(...[Te(Fe(Pe(r===null||r===void 0?void 0:(o=r.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:i.Hidden),true)),Ae(!!s,s&&Te(Fe(Pe((a=s.annotations)===null||a===void 0?void 0:(l=a.UI)===null||l===void 0?void 0:l.Hidden),true)),true),he(Te(u),v)])};C._getVisibleExpression=xt;const Mt=function(e){var t,n;const o=[];if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((t=e.Target)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){var i,a;if(e!==null&&e!==void 0&&(i=e.annotations)!==null&&i!==void 0&&(a=i.UI)!==null&&a!==void 0&&a.Hidden){return Ee(Te(Fe(Pe(e.annotations.UI.Hidden),true)))}else{var l;(l=e.Target.$target.Data)===null||l===void 0?void 0:l.forEach(e=>{o.push(xt({targetObject:e}))});return Ee(Ae(he(...o),Se(true),Se(false)))}}else{return undefined}};const Ut=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!e){return undefined}if(ve(e)||fe(e)){var n,o,i,a,l;const t=(n=e.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.DataFieldDefault;if(t&&!t.qualifier&&(i=t.Label)!==null&&i!==void 0&&i.valueOf()){var r;return Ee(Pe((r=t.Label)===null||r===void 0?void 0:r.valueOf()))}return Ee(Pe(((a=e.annotations.Common)===null||a===void 0?void 0:(l=a.Label)===null||l===void 0?void 0:l.valueOf())||e.name))}else if(qe(e)){var s,d,u,v,c,f,p,g;if(!!t&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){var m;return Ee(Pe((m=e.Label)===null||m===void 0?void 0:m.valueOf()))}return Ee(Pe(((s=e.Label)===null||s===void 0?void 0:s.valueOf())||((d=e.Value)===null||d===void 0?void 0:(u=d.$target)===null||u===void 0?void 0:(v=u.annotations)===null||v===void 0?void 0:(c=v.Common)===null||c===void 0?void 0:(f=c.Label)===null||f===void 0?void 0:f.valueOf())||((p=e.Value)===null||p===void 0?void 0:(g=p.$target)===null||g===void 0?void 0:g.name)))}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var y,b,h,T,I,A,P,D;return Ee(Pe(((y=e.Label)===null||y===void 0?void 0:y.valueOf())||((b=e.Target)===null||b===void 0?void 0:(h=b.$target)===null||h===void 0?void 0:(T=h.Value)===null||T===void 0?void 0:(I=T.$target)===null||I===void 0?void 0:(A=I.annotations)===null||A===void 0?void 0:(P=A.Common)===null||P===void 0?void 0:(D=P.Label)===null||D===void 0?void 0:D.valueOf())))}else{var F;return Ee(Pe((F=e.Label)===null||F===void 0?void 0:F.valueOf()))}};const $t=function(e){var t,n;if(!e){return undefined}if(ve(e)||(t=e.annotations)!==null&&t!==void 0&&(n=t.Common)!==null&&n!==void 0&&n.QuickInfo){var o,i;return(o=e.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&i.QuickInfo?Ee(Pe(e.annotations.Common.QuickInfo.valueOf())):undefined}else if(qe(e)){var a,l,r,s;return(a=e.Value)!==null&&a!==void 0&&(l=a.$target)!==null&&l!==void 0&&(r=l.annotations)!==null&&r!==void 0&&(s=r.Common)!==null&&s!==void 0&&s.QuickInfo?Ee(Pe(e.Value.$target.annotations.Common.QuickInfo.valueOf())):undefined}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var d,u,v,c,f;const t=(d=e.Target)===null||d===void 0?void 0:d.$target;return t!==null&&t!==void 0&&(u=t.Value)!==null&&u!==void 0&&(v=u.$target)!==null&&v!==void 0&&(c=v.annotations)!==null&&c!==void 0&&(f=c.Common)!==null&&f!==void 0&&f.QuickInfo?Ee(Pe(t.Value.$target.annotations.Common.QuickInfo.valueOf())):undefined}else{return undefined}};function Nt(e,t){return De([be(`semanticKeyHasDraftIndicator`,"internal"),be(`filteredMessages`,"internal"),e,t],l.getErrorStatusTextVisibilityFormatter)}C.getRowStatusVisibility=Nt;const wt=function(e,t,n,o,i,a){const l=[];const r={};const s=new J(i,o);Object.keys(e).forEach(i=>{const d=e[i],u=o.getAbsoluteAnnotationPath(i),v=t.find(e=>e.name===i);if(v===undefined){const e=St(d,u,i,true,false,n,s,o,a);e.isPartOfLineItem=t.some(e=>{var t;return((t=e.propertyInfos)===null||t===void 0?void 0:t.includes(i))&&e.isPartOfLineItem});l.push(e)}else if(v.annotationPath!==u||v.propertyInfos){const e=`Property::${i}`;if(!t.some(t=>t.name===e)){const t=St(d,u,i,false,false,n,s,o,a);t.isPartOfLineItem=v.isPartOfLineItem;l.push(t);r[i]=e}else if(t.some(t=>t.name===e)&&t.some(e=>{var t;return(t=e.propertyInfos)===null||t===void 0?void 0:t.includes(i)})){r[i]=e}}});t.forEach(e=>{var t,n;e.propertyInfos=(t=e.propertyInfos)===null||t===void 0?void 0:t.map(e=>r[e]??e);e.additionalPropertyInfos=(n=e.additionalPropertyInfos)===null||n===void 0?void 0:n.map(e=>r[e]??e)});return l};const Vt=function(e){var t,n,o,i;if(qe(e)&&(t=e.Value)!==null&&t!==void 0&&t.path){var a;return(a=e.Value)===null||a===void 0?void 0:a.path}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(n=e.Target)!==null&&n!==void 0&&(o=n.$target)!==null&&o!==void 0&&(i=o.Value)!==null&&i!==void 0&&i.path){var l,r;return(l=e.Target)===null||l===void 0?void 0:(r=l.$target)===null||r===void 0?void 0:r.Value.path}else{return Me.generateKeyFromDataField(e)}};const Lt=function(e,t,n){const o=`Property_Technical::${e}`;const i=t.find(e=>e.key===o);const a=!i&&t.find(t=>t.name===e&&!t.propertyInfos);if(a){const i={key:o,type:tt.Annotation,label:a.label,annotationPath:a.annotationPath,availability:"Hidden",name:o,relativePath:a.relativePath,sortable:false,isGroupable:false,isKey:false,exportSettings:null,caseSensitive:false,aggregatable:false,extension:{technicallyGroupable:true,technicallyAggregatable:true}};t.push(i);n[e]=i.name}};const Rt=function(e,t,n){var o;const i=(o=n.getManifestControlConfiguration(t))===null||o===void 0?void 0:o.columns;const a=i&&Object.keys(i);return a&&!!a.find(function(t){return t===e&&i[t].showDataFieldsLabel})};const kt=function(e){var t,n;let o="";switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":o=e===null||e===void 0?void 0:(t=e.Value)===null||t===void 0?void 0:t.path;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":o=e===null||e===void 0?void 0:(n=e.Target)===null||n===void 0?void 0:n.value;break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForActionGroup":case"com.sap.vocabularies.UI.v1.DataFieldWithActionGroup":o=Me.generateKeyFromDataField(e);break}return o};const Ht=function(e,t,n){const o=t?e.lastIndexOf("/"):e.indexOf("/");if(o===-1){return e}return n?e.substring(o+1,e.length):e.substring(0,o)};const jt=function(e,t){if(qe(e)&&ce(e.Value)){const n=de(t.getDataModelObjectPath(),e.Value.path);return X(n)}else{return false}};const Bt=function(e,t,n){return n.indexOf(t)===-1&&(e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")};const zt=function(e){const t=Gt(e);return Array.isArray(t)?t.indexOf("tolower")===-1:true};C.isFilteringCaseSensitive=zt;function Gt(e){const t=e.getEntitySet();if(v.isEntitySet(t)){var n,o;return((n=t.annotations.Capabilities)===null||n===void 0?void 0:n.FilterFunctions)??((o=e.getEntityContainer().annotations.Capabilities)===null||o===void 0?void 0:o.FilterFunctions)}return undefined}function Kt(e){return e===undefined?undefined:{textLinesEdit:4,...e}}function Wt(e,t){const n=[];let o=false;for(let i=0;i<e.length;i++){n.push(e[i].value);if(e[i].value===t){o=true}}return{values:n,semanticKeyFound:o}}function Qt(e,t){let n=false;let o;if(e&&e.length>=1&&t&&t.length>=1){for(let i=0;i<e.length;i++){if([e[i]].some(e=>t.indexOf(e)>=0)){n=true;o=e[i];break}}}return{semanticKeyHasPropertyInFieldGroup:n,fieldGroupPropertyPath:o}}function qt(e,t){var n,o;const i=[];let a={semanticKeyHasPropertyInFieldGroup:false,fieldGroupPropertyPath:undefined};if(e&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((n=e.Target)===null||n===void 0?void 0:(o=n.$target)===null||o===void 0?void 0:o.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){var l;(l=e.Target.$target.Data)===null||l===void 0?void 0:l.forEach(e=>{if((e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&e.Value){i.push(e.Value.path)}a=Qt(t,i)})}return{semanticKeyHasPropertyInFieldGroup:a.semanticKeyHasPropertyInFieldGroup,propertyPath:a.fieldGroupPropertyPath}}function _t(e,t,n,o){if(!t){return{}}const i=Wt(t,e);const a=qt(o,i.values);if(a.semanticKeyHasPropertyInFieldGroup){return{fieldGroupDraftIndicatorPropertyPath:a.propertyPath,fieldGroupName:e,showErrorObjectStatus:Ee(Nt(e,true))}}else if(i.semanticKeyFound){return{hasDraftIndicator:true,showErrorObjectStatus:Ee(Nt(e,false))}}return{}}function Yt(e){var t,n;const o=e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance;if(o&&o.includes("UI.ImportanceType/High")){return 3}if(o&&o.includes("UI.ImportanceType/Medium")){return 2}if(o&&o.includes("UI.ImportanceType/Low")){return 1}return 0}function Jt(e){var t,n;const o=e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance;return o?o.split("/")[1]:K.None}function Xt(e){if(e&&e.length>0){let t=-1;let n=-1;let o;for(const i of e){n=Yt(i);if(n>t){t=n;o=i}}return Jt(o)}return K.None}function Zt(e,t){var n;let o,i=[];if(t&&t.length>0){i=t.map(function(e){return e.value})}if(!e){return undefined}if(pe(e,"com.sap.vocabularies.UI.v1.DataFieldForAnnotation")){const t=e.Target.$target;if(pe(t,"com.sap.vocabularies.UI.v1.FieldGroupType")){const n=t.Data;const r=n&&n.some(function(e){var t,n;return(e===null||e===void 0?void 0:(t=e.Value)===null||t===void 0?void 0:t.path)&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.includes(e===null||e===void 0?void 0:(n=e.Value)===null||n===void 0?void 0:n.path)});if(r){return K.High}else{var a,l;if(e!==null&&e!==void 0&&(a=e.annotations)!==null&&a!==void 0&&(l=a.UI)!==null&&l!==void 0&&l.Importance){return Jt(e)}o=n&&n.filter(function(e){var t,n;return e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance});return Xt(o)}}}return e.Value&&e!==null&&e!==void 0&&(n=e.Value)!==null&&n!==void 0&&n.path&&i.includes(e.Value.path)?K.High:Jt(e)}C.getImportance=Zt;const en=function(e,t,n,o){const i=n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName);if(t&&t!==""&&i.indexOf("@com.sap.vocabularies.UI.v1.LineItem")!==-1&&qe(e)){var a;const t=(a=e.Value)!==null&&a!==void 0&&a.$target?Z(e.Value.$target):false;return!o&&!t}return false};const tn=function(e,t,n,o){var i;const a=n.getAnnotationEntityType(e),l=[],r={},s=oe(n.getEntitySet()),d=n.getManifestControlConfiguration(t),u=(d===null||d===void 0?void 0:(i=d.tableSettings)===null||i===void 0?void 0:i.type)||"ResponsiveTable";const v=[];const c=n.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[n.getEntityType()])[0];if(e){const i=n.getConverterContextFor(se(n.getDataModelObjectPath()));e.forEach(e=>{var a,d,f,p,g,m,y,b,h,T,I,A;if(!Ot(e)){return}let P=null;const D=qe(e)&&(a=e.Value)!==null&&a!==void 0&&(d=a.$target)!==null&&d!==void 0&&d.fullyQualifiedName?Je(n,e):undefined;const F=kt(e);const C=Ze(e,n,u);const S=Object.keys(C.properties);const E=Object.keys(C.additionalProperties);const O=F?Ht(F,true,false):undefined;const x=O!=F;const M=Ut(e,x);const U=Vt(e);const $=O?O.indexOf(`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`)>-1:false;const N=$?Rt(U,t,n):false;const w=Xe(e);const V=w==="Edm.Date"?"YYYY-MM-DD":undefined;const L=Kt(_t(U,c,$,e));let R;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((f=e.Target)===null||f===void 0?void 0:(p=f.$target)===null||p===void 0?void 0:p.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){R=Mt(e)}if(Et(e)){P={template:C.exportSettingsTemplate,wrap:C.exportSettingsWrapping,type:w?gn(w,S.length>1):undefined,inputFormat:V,delimiter:w==="Edm.Int64"};if(C.exportUnitName){P.unitProperty=C.exportUnitName;P.type="Currency"}else if(C.exportUnitString){P.unit=C.exportUnitString}if(C.exportTimezoneName){P.timezoneProperty=C.exportTimezoneName}else if(C.exportTimezoneString){P.timezone=C.exportTimezoneString}}let k;if(w){k=Mn(e,w)}const H={className:w,formatOptions:{...L,...(g=k)===null||g===void 0?void 0:g.formatOptions},constraints:{...(m=k)===null||m===void 0?void 0:m.constraints}};const j={};if(!w||!H){j.widthCalculation=null}const B=jt(e,i);const z=!B&&Bt(e,F,s);const G=n.getManifestControlConfiguration(t);const K=((y=G.tableSettings)===null||y===void 0?void 0:y.enableAddCardToInsights)??true;const W={key:Me.generateKeyFromDataField(e),type:tt.Annotation,label:M,groupLabel:x?Ut(e):undefined,group:x?O:undefined,FieldGroupHiddenExpressions:R,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),semanticObjectPath:D,availability:Y(e)?"Hidden":"Default",name:U,showDataFieldsLabel:N,relativePath:F,sortable:z,propertyInfos:S.length?S:undefined,additionalPropertyInfos:E.length>0?E:undefined,exportSettings:P,width:((b=e.annotations)===null||b===void 0?void 0:(h=b.HTML5)===null||h===void 0?void 0:(T=h.CssDefaults)===null||T===void 0?void 0:(I=T.width)===null||I===void 0?void 0:I.valueOf())||undefined,importance:Zt(e,c),isNavigable:true,formatOptions:L,caseSensitive:zt(n),typeConfig:H,visualSettings:j,timezoneText:(A=P)===null||A===void 0?void 0:A.timezone,isPartOfLineItem:true};W.isInsightsSupported=K===true&&o===true&&en(e,M,n,B);const Q=$t(e)||M;if(Q){W.tooltip=Q}if(C.textOnlyPropertiesFromTextAnnotation.length>0){v.push(...C.textOnlyPropertiesFromTextAnnotation)}if(C.exportDataPointTargetValue&&W.exportSettings){W.exportDataPointTargetValue=C.exportDataPointTargetValue;W.exportSettings.type="String"}l.push(W);S.forEach(e=>{r[e]=C.properties[e];if(B){s.push(e)}});E.forEach(e=>{r[e]=C.additionalProperties[e]})})}return Ct(r,a,l,s,n,u,v)};const nn=function(e,t,n,o){let i;if(e){i=e.map(function(e){const i=t.find(function(t){return t.relativePath===e&&t.propertyInfos===undefined});if(i){return i.name}else{const i=wt({[e]:o.resolvePath(e)},t,[],n,o,[]);t.push(i[0]);return i[0].name}})}return i};const on=function(e){return e.map(t=>`{${e.indexOf(t)}}`).join(`${"\n"}`)};const an=function(e,t,n,o,i){const a={};function l(e,n){return t.some(e=>e.key===n)}function r(e){return e.type===tt.Slot}function s(e){return e.type===undefined&&!!e.template}function d(e,t){const o=oe(n.getEntitySet());e.forEach(e=>{t.forEach(t=>{if(t.name===e){t.sortable=o.indexOf(e.replace("Property::",""))===-1;t.isGroupable=t.sortable}})})}for(const g in e){var u;const m=e[g];Me.validateKey(g);const y={key:g,width:m.width||undefined,position:{anchor:(u=m.position)===null||u===void 0?void 0:u.anchor,placement:m.position===undefined?Ve.After:m.position.placement},caseSensitive:zt(n)};if(l(m,g)){const e={...y,importance:m===null||m===void 0?void 0:m.importance,horizontalAlign:m===null||m===void 0?void 0:m.horizontalAlign,availability:m===null||m===void 0?void 0:m.availability,type:tt.Annotation,isNavigable:l(m,g)?undefined:ze(m,i,true),settings:m.settings,formatOptions:Kt(m.formatOptions)};a[g]=e}else{var v;const e=nn(m.properties,t,n,o);const i={...y,header:m.header,importance:(m===null||m===void 0?void 0:m.importance)||K.None,horizontalAlign:(m===null||m===void 0?void 0:m.horizontalAlign)||W.Begin,availability:(m===null||m===void 0?void 0:m.availability)||"Default",template:m.template,propertyInfos:e,exportSettings:e?{template:on(e),wrap:!!(e.length>1)}:null,id:`CustomColumn::${g}`,name:`CustomColumn::${g}`,formatOptions:{textLinesEdit:4},isGroupable:false,isNavigable:false,sortable:false,visualSettings:{widthCalculation:null},properties:m.properties,tooltip:m.header};if((v=m.header)!==null&&v!==void 0&&v.startsWith("{metaModel>")){var c,f;const e=(c=m.header)===null||c===void 0?void 0:c.substring(11,((f=m.header)===null||f===void 0?void 0:f.length)-1);try{i.header=n.getEntityTypeAnnotation(e).annotation.toString()}catch(t){F.info(`Unable to retrieve text from meta model using path ${e}`)}}if(e){d(e,t)}if(r(m)){const e={...i,type:tt.Slot};a[g]=e}else if(s(m)){const e={...i,type:tt.Default};a[g]=e}else{var p;const e=`The annotation column '${g}' referenced in the manifest is not found`;n.getDiagnostics().addIssue(we.Manifest,$e.Low,e,Ne,Ne===null||Ne===void 0?void 0:(p=Ne.AnnotationColumns)===null||p===void 0?void 0:p.InvalidKey)}}}return a};function ln(e,t,n){var o;const i=t.getManifestWrapper();const a=t.getManifestControlConfiguration(e);const l=i.getVariantManagement();const r=[];const s=n.type==="AnalyticalTable";const d=n.type==="ResponsiveTable";if((a===null||a===void 0?void 0:(o=a.tableSettings)===null||o===void 0?void 0:o.personalization)!==undefined){const e=a.tableSettings.personalization;if(e===true){switch(n.type){case"AnalyticalTable":return"Sort,Column,Filter,Group,Aggregate";case"ResponsiveTable":return"Sort,Column,Filter,Group";default:return"Sort,Column,Filter"}}else if(typeof e==="object"){if(e.sort){r.push("Sort")}if(e.column){r.push("Column")}if(e.filter){r.push("Filter")}if(e.group&&(s||d)){r.push("Group")}if(e.aggregate&&s){r.push("Aggregate")}return r.length>0?r.join(","):undefined}}else{r.push("Sort");r.push("Column");if(t.getTemplateType()===z.ListReport){if(l===B.Control||rn(i,t)){r.push("Filter")}}else{r.push("Filter")}if(s){r.push("Group");r.push("Aggregate")}if(d){r.push("Group")}return r.join(",")}return undefined}C.getP13nMode=ln;function rn(e,t){return e.isFilterBarHidden()&&!t.getManifestWrapper().hasMultipleVisualizations()&&t.getTemplateType()!==z.AnalyticalListPage}function sn(e,t,n){const o=oe(e.getEntitySet());let i;if(t!==null&&t!==void 0&&t.SortOrder){const e=[];const a={sorters:e};t.SortOrder.forEach(e=>{var t;const i=e.Property;if(i&&o.indexOf((t=i.$target)===null||t===void 0?void 0:t.name)===-1){const t=un([i],n)[0];if(t){a.sorters.push({name:t,descending:!!e.Descending})}}});i=a.sorters.length?JSON.stringify(a):undefined}return i}function dn(e){var t;if(!e){return undefined}const n=(t=e.InitialExpansionLevel)===null||t===void 0?void 0:t.valueOf();return typeof n==="number"?n:undefined}function un(e,t){const n=[];let o,i;e.forEach(e=>{if(e!==null&&e!==void 0&&e.value){o=t.find(t=>{i=t;return!i.propertyInfos&&i.relativePath===(e===null||e===void 0?void 0:e.value)});if(o){n.push(o.name)}}});return n}function vn(e,t,n){let o;if(e!==null&&e!==void 0&&e.GroupBy){let i=e.GroupBy;if(n==="ResponsiveTable"){i=i.slice(0,1)}const a=un(i,t).map(e=>({name:e}));o=a.length?JSON.stringify({groupLevels:a}):undefined}return o}function cn(e){const t={};e.columns.forEach(n=>{var o;n=n;const i=Object.keys(e.aggregates).find(e=>e===n.name);if(i){const t=e.aggregates[i];n.aggregatable=true;n.extension={customAggregate:t.defaultAggregate??{}}}if((o=n.additionalPropertyInfos)!==null&&o!==void 0&&o.length){n.additionalPropertyInfos.forEach(n=>{Lt(n,e.columns,t)})}});e.columns.forEach(e=>{e=e;if(e.additionalPropertyInfos){var n;e.additionalPropertyInfos=e.additionalPropertyInfos.map(e=>t[e]??e);e.propertyInfos=(n=e.propertyInfos)===null||n===void 0?void 0:n.concat(e.additionalPropertyInfos)}})}function fn(e,t){let n;if(e!==null&&e!==void 0&&e.Total){const o=e.Total;const i={};un(o,t).forEach(e=>{i[e]={}});n=JSON.stringify(i)}return n}function pn(e,t,n,o,i,a,l,r){var s,d,u;const{navigationPropertyPath:v}=mn(t);const c=(s=n.getDataModelObjectPath().targetEntityType.annotations)===null||s===void 0?void 0:(d=s.UI)===null||d===void 0?void 0:(u=d.HeaderInfo)===null||u===void 0?void 0:u.TypeNamePlural;const f=c&&Ee(Pe(c));const p=n.getDataModelObjectPath().targetEntitySet;const g=n.getManifestWrapper();const m=v.length===0,y=ln(t,n,o),b=v?_(t):_(n.getContextPath(),"LineItem");const h=Tt(n);const T=lt(n,v);const I=g.getNavigationConfiguration(T);const A=Dt(e,o,n,I,t);const P=k(n,A.mode,o,l,r);const D=L(n,P);const F=w(n,P);const C=V(P,E(n));const N=It(e,t,n,m,h,D,F);let H=v?10:30;if(a!==null&&a!==void 0&&a.MaxItems){H=a.MaxItems.valueOf()}const j=g.getVariantManagement();const G=le(n.getDataModelObjectPath());const K={create:$(n,P),delete:U(n,P),paste:O(n,P,C),massEdit:x(n,P),insights:M(n,P,t),creationRow:R(n,P)};return{id:b,entityName:p?p.name:"",collection:se(n.getDataModelObjectPath()),navigationPath:v,row:Ft(e,n,I,T,o.type),p13nMode:y,standardActions:{actions:K,isInsertUpdateTemplated:C,updatablePropertyPath:ct(n)},displayMode:S(n,l),create:A,selectionMode:N,autoBindOnInit:rn(g,n)||n.getTemplateType()!==z.ListReport&&n.getTemplateType()!==z.AnalyticalListPage&&!(l&&g.hasMultipleVisualizations(l)),variantManagement:j==="Control"&&!y?B.None:j,threshold:H,sortConditions:sn(n,a,i),title:f,searchable:o.type!=="AnalyticalTable"&&!(Ie(G)&&G.value===false),initialExpansionLevel:dn(a)}}C.getTableAnnotationConfiguration=pn;function gn(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n="String";if(t){if(e==="Edm.DateTimeOffset"){n="DateTime"}return n}else{switch(e){case"Edm.Decimal":case"Edm.Int32":case"Edm.Int64":case"Edm.Double":case"Edm.Byte":n="Number";break;case"Edm.DateOfTime":case"Edm.Date":n="Date";break;case"Edm.DateTimeOffset":n="DateTime";break;case"Edm.TimeOfDay":n="Time";break;case"Edm.Boolean":n="Boolean";break;default:n="String"}}return n}function mn(e){const[t,n]=e.split("@");let o=t;if(o.lastIndexOf("/")===o.length-1){o=o.substr(0,o.length-1)}return{navigationPropertyPath:o,annotationPath:n}}C.splitPath=mn;function yn(e,t){const n=t.getEntityTypeAnnotation(e);const o=n.annotation;if(o){var i,a;const e=[];(i=o.SelectOptions)===null||i===void 0?void 0:i.forEach(t=>{const n=t.PropertyName;const o=(n===null||n===void 0?void 0:n.value)??"";if(e.indexOf(o)===-1){e.push(o)}});return{text:o===null||o===void 0?void 0:(a=o.Text)===null||a===void 0?void 0:a.toString(),propertyNames:e}}return undefined}C.getSelectionVariantConfiguration=yn;function bn(e,t,n){let o=e.enableFullScreen??n;if(!n&&o&&t.getTemplateType()===z.ListReport){o=false;t.getDiagnostics().addIssue(we.Manifest,$e.Low,Ue.FULLSCREENMODE_NOT_ON_LISTREPORT)}return o}function hn(e,t,n){let o;if(t!=="ResponsiveTable"){return undefined}switch(n.getTemplateType()){case z.ListReport:case z.AnalyticalListPage:o=!e.selectAll?"ClearAll":"Default";break;case z.ObjectPage:o=e.selectAll===false?"ClearAll":"Default";if(n.getManifestWrapper().useIconTabBar()){o=!e.selectAll?"ClearAll":"Default"}break;default:}return o}function Tn(e,t,n){let o=(e===null||e===void 0?void 0:e.type)||"ResponsiveTable";if((o==="AnalyticalTable"||o==="TreeTable")&&!n.getManifestWrapper().isDesktop()){o="ResponsiveTable"}return o}function In(e,t,n){if(e!=="ResponsiveTable"){if(n){return{rowCountMode:"Auto",rowCount:3}}else{return{rowCountMode:t.rowCountMode??"Fixed",rowCount:t.rowCount?t.rowCount:5}}}else{return{}}}function An(e,t){return t.condensedTableLayout!==undefined&&e!=="ResponsiveTable"?t.condensedTableLayout:false}function Pn(e){return e.selectAll===true||e.selectionLimit===0?0:e.selectionLimit||200}function Dn(e){var t,n;return(t=e.creationMode)!==null&&t!==void 0&&t.inlineCreationRowCount?(n=e.creationMode)===null||n===void 0?void 0:n.inlineCreationRowCount:2}function Fn(e,t,n,o){var i;if(n){t.push({annotationPath:o.annotationPath})}return{quickFilters:{showCounts:e===null||e===void 0?void 0:(i=e.quickVariantSelection)===null||i===void 0?void 0:i.showCounts,paths:t}}}function Cn(e,t,n){return e.enableExport!==undefined?e.enableExport:t.getTemplateType()!=="ObjectPage"||n}function Sn(e){return e.frozenColumnCount}function En(e,t,n){var o,i,a;if(!t){return{}}const l=[];const r=n.getAnnotationEntityType(t);let s;let d;e===null||e===void 0?void 0:(o=e.quickVariantSelection)===null||o===void 0?void 0:(i=o.paths)===null||i===void 0?void 0:i.forEach(t=>{s=r.resolvePath(t.annotationPath);d=Fn(e,l,s,t)});let u=false;u=!!((a=e.quickVariantSelection)!==null&&a!==void 0&&a.hideTableTitle);return{filters:d,headerVisible:!(s&&u)}}function On(e,t){const n=de(t.getDataModelObjectPath(),e).navigationProperties;if((n===null||n===void 0?void 0:n.length)>0){const e=[];n.forEach(t=>{e.push(Ut(t)||t.name)});return e}}function xn(e,t,n){var o,i,a,l,r,s,d,u;let v=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const c=n.getManifestWrapper();const f=n.getManifestControlConfiguration(t);const p=f&&f.tableSettings||{};const g=((o=p.creationMode)===null||o===void 0?void 0:o.name)||Q.NewPage;const m=!c.isPhone();const y=p.enablePaste!==undefined?p.enablePaste:n.getTemplateType()==="ObjectPage";const b=n.getTemplateType();const h=b===z.ListReport?"API.dataStateIndicatorFilter":undefined;const T=v&&c.isCondensedLayoutCompliant();const I=En(p,e,n);const A=(i=p.creationMode)===null||i===void 0?void 0:i.customValidationFunction;const P=n.getEntityType();const D=new J(P,n);const F=Tn(p,D,n);const C=In(F,p,b===z.ListReport);const S=An(F,p);const E={createAtEnd:((a=p.creationMode)===null||a===void 0?void 0:a.createAtEnd)!==undefined?(l=p.creationMode)===null||l===void 0?void 0:l.createAtEnd:g!==Q.Inline,creationMode:g,customValidationFunction:A,dataStateIndicatorFilter:h,disableAddRowButtonForEmptyData:!A?!!((r=p.creationMode)!==null&&r!==void 0&&r.disableAddRowButtonForEmptyData):false,enableAutoColumnWidth:m,enableExport:Cn(p,n,y),frozenColumnCount:Sn(p),enableFullScreen:bn(p,n,c.isPhone()),enableMassEdit:p===null||p===void 0?void 0:p.enableMassEdit,enableAddCardToInsights:p===null||p===void 0?void 0:p.enableAddCardToInsights,enablePaste:y,headerVisible:true,multiSelectMode:hn(p,F,n),selectionLimit:Pn(p),inlineCreationRowCount:Dn(p),inlineCreationRowsHiddenInEditMode:(p===null||p===void 0?void 0:(s=p.creationMode)===null||s===void 0?void 0:s.inlineCreationRowsHiddenInEditMode)??false,showRowCount:!(p!==null&&p!==void 0&&(d=p.quickVariantSelection)!==null&&d!==void 0&&d.showCounts)&&!((u=c.getViewConfiguration())!==null&&u!==void 0&&u.showCounts),type:F,useCondensedTableLayout:S&&T,isCompactType:c.isCompactType()};const O={...E,...C,...I};if(F==="TreeTable"){O.hierarchyQualifier=p.hierarchyQualifier}return O}C.getTableManifestConfiguration=xn;function Mn(e,t){var n,o,i,a,l;let r;if(ve(e)){r=ue(e.targetType)?Ce[e.targetType.underlyingType]:Ce[e.type]}if(r===undefined&&t!==undefined){r=Ce[t]}const s={type:(n=r)===null||n===void 0?void 0:n.type,constraints:{},formatOptions:{}};if(ve(e)&&r!==undefined){var d,u,v,c,f,p,g,m,y,b,h,T,I,A,P,D,F;s.constraints={scale:(d=r.constraints)!==null&&d!==void 0&&d.$Scale?e.scale:undefined,precision:(u=r.constraints)!==null&&u!==void 0&&u.$Precision?e.precision:undefined,maxLength:(v=r.constraints)!==null&&v!==void 0&&v.$MaxLength?e.maxLength:undefined,nullable:(c=r.constraints)!==null&&c!==void 0&&c.$Nullable?e.nullable:undefined,minimum:(f=r.constraints)!==null&&f!==void 0&&f["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((p=e.annotations)===null||p===void 0?void 0:(g=p.Validation)===null||g===void 0?void 0:g.Minimum)?`${(m=e.annotations)===null||m===void 0?void 0:(y=m.Validation)===null||y===void 0?void 0:y.Minimum}`:undefined,maximum:(b=r.constraints)!==null&&b!==void 0&&b["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((h=e.annotations)===null||h===void 0?void 0:(T=h.Validation)===null||T===void 0?void 0:T.Maximum)?`${(I=e.annotations)===null||I===void 0?void 0:(A=I.Validation)===null||A===void 0?void 0:A.Maximum}`:undefined,isDigitSequence:s.type==="sap.ui.model.odata.type.String"&&(P=r.constraints)!==null&&P!==void 0&&P[`@${"com.sap.vocabularies.Common.v1.IsDigitSequence"}`]&&(D=e.annotations)!==null&&D!==void 0&&(F=D.Common)!==null&&F!==void 0&&F.IsDigitSequence?true:undefined}}s.formatOptions={parseAsString:(s===null||s===void 0?void 0:(o=s.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Int"))===0||(s===null||s===void 0?void 0:(i=s.type)===null||i===void 0?void 0:i.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(s===null||s===void 0?void 0:(a=s.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Int"))===0||(s===null||s===void 0?void 0:(l=s.type)===null||l===void 0?void 0:l.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:s.type==="sap.ui.model.odata.type.String"?true:undefined};return s}C.getTypeConfig=Mn;return{getTableActions:nt,getTableColumns:ot,getColumnsFromEntityType:Ct,updateLinkedProperties:rt,createTableVisualization:dt,createDefaultTableVisualization:ut,getCapabilityRestriction:Tt,getSelectionMode:It,getRowStatusVisibility:Nt,getImportance:Zt,getP13nMode:ln,getTableAnnotationConfiguration:pn,isFilteringCaseSensitive:zt,splitPath:mn,getSelectionVariantConfiguration:yn,getTableManifestConfiguration:xn,getTypeConfig:Mn,updateTableVisualizationForType:at}},false);
//# sourceMappingURL=Table.js.map