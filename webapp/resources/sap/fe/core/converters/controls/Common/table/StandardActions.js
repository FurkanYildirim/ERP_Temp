/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/TableFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","../../../helpers/BindingHelper","../../../helpers/InsightsHelpers","../../../ManifestSettings"],function(e,t,n,i,a,o,s,r){"use strict";var l={};var d=r.TemplateType;var c=r.CreationMode;var u=s.getInsightsVisibility;var p=o.UI;var v=o.singletonPathVisitor;var f=a.isPathUpdatable;var g=a.isPathInsertable;var b=a.isPathDeletable;var h=a.getTargetObjectPath;var y=i.isNavigationProperty;var T=i.isEntitySet;var C=t.pathInModel;var M=t.or;var m=t.notEqual;var E=t.not;var P=t.length;var D=t.isPathInModelExpression;var A=t.isConstant;var S=t.ifElse;var I=t.greaterThan;var x=t.greaterOrEqual;var O=t.getExpressionFromAnnotation;var R=t.formatResult;var w=t.equal;var H=t.constant;var U=t.compileExpression;var V=t.and;var j;(function(e){e["CreateHidden"]="CreateHidden";e["DeleteHidden"]="DeleteHidden";e["UpdateHidden"]="UpdateHidden"})(j||(j={}));function k(e,t,n,i,a){return{collectionPath:h(e.getDataModelObjectPath()),hiddenAnnotation:{create:F(e,j.CreateHidden),delete:F(e,j.DeleteHidden),update:F(e,j.UpdateHidden)},creationMode:t,isDraftOrStickySupported:L(e),isViewWithMultipleVisualizations:i?e.getManifestWrapper().hasMultipleVisualizations(i):false,newAction:z(e),tableManifestConfiguration:n,restrictions:N(e),isInsightsEnabled:a}}l.generateStandardActionsContext=k;function L(e){var t,i,a;const o=e.getDataModelObjectPath();const s=n.isObjectPathDraftSupported(o);const r=(t=o.startingEntitySet)!==null&&t!==void 0&&(i=t.annotations)!==null&&i!==void 0&&(a=i.Session)!==null&&a!==void 0&&a.StickySessionSupported?true:false;return s||r}l.isDraftOrStickySupported=L;function z(e){var t,n,i,a;const o=e.getEntitySet();const s=T(o)?((t=o.annotations.Common)===null||t===void 0?void 0:(n=t.DraftRoot)===null||n===void 0?void 0:n.NewAction)??((i=o.annotations.Session)===null||i===void 0?void 0:(a=i.StickySessionSupported)===null||a===void 0?void 0:a.NewAction):undefined;const r=s===null||s===void 0?void 0:s.toString();if(r){var l,d,c,u;let t=e===null||e===void 0?void 0:(l=e.getEntityType().actions[r])===null||l===void 0?void 0:(d=l.annotations)===null||d===void 0?void 0:(c=d.Core)===null||c===void 0?void 0:(u=c.OperationAvailable)===null||u===void 0?void 0:u.valueOf();t=t!==undefined?t:true;return{name:r,available:O(t)}}return undefined}l.getNewAction=z;function F(e,t){var n;let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const a=e.getEntitySet();const o=e.getDataModelObjectPath();const s=o.navigationProperties.length>0&&i?[o.navigationProperties[o.navigationProperties.length-1].name]:[];const r=(a===null||a===void 0?void 0:(n=a.annotations.UI)===null||n===void 0?void 0:n[t])||false;return a?O(r,s,undefined,t=>v(t,e.getConvertedTypes(),s)):H(false)}l.isActionAnnotatedHidden=F;function N(e){const t=e.getDataModelObjectPath();const n=[{key:"isInsertable",function:g},{key:"isUpdatable",function:f},{key:"isDeletable",function:b}];const i={};n.forEach(function(n){const a=n["function"];i[n.key]={expression:a.apply(null,[t,{pathVisitor:(t,n)=>v(t,e.getConvertedTypes(),n)}]),navigationExpression:a.apply(null,[t,{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(t,n)=>v(t,e.getConvertedTypes(),n)}])}});return i}l.getRestrictions=N;function W(e,t){return t||e.creationMode===c.External}l.getInsertUpdateActionsTemplating=W;function q(e,t){const n=X(e,t);return{isTemplated:U(K(t,n)),visible:U(n),enabled:U(ne(e,t,n))}}l.getStandardActionCreate=q;function B(e,t){const n=Y(e,t);return{isTemplated:U(Q(n)),visible:U(n),enabled:U(ie(e,t,n))}}l.getStandardActionDelete=B;function _(e,t){const n=X(e,t,true);return{isTemplated:U(K(t,n,true)),visible:U(n),enabled:U(te(e,t,n))}}l.getCreationRow=_;function $(e,t,n){const i=X(e,t);const a=ne(e,t,i);const o=Z(e,t,i,n);return{visible:U(o),enabled:U(ae(o,a))}}l.getStandardActionPaste=$;function G(e,t){const n=ee(e,t);return{isTemplated:U(Q(n)),visible:U(n),enabled:U(oe(e,t,n))}}l.getStandardActionMassEdit=G;function J(e,t,n){const i=(t.isInsightsEnabled??false)&&u("Table",e,n,t);return{isTemplated:U(i),visible:U(i),enabled:U(i)}}l.getStandardActionInsights=J;function K(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return V(M(V(n,e.creationMode===c.CreationRow),V(!n,e.creationMode!==c.CreationRow)),M(E(A(t)),t))}l.getCreateTemplating=K;function Q(e){return M(E(A(e)),e)}l.getDefaultTemplating=Q;function X(e,t){var n,i;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const o=t.restrictions.isInsertable.expression;const s=a?F(e,j.CreateHidden,false):t.hiddenAnnotation.create;const r=t.newAction;return S(t.creationMode===c.External,V(E(s),M(e.getTemplateType()===d.ListReport,p.IsEditable)),S(M(V(A(r===null||r===void 0?void 0:r.available),w(r===null||r===void 0?void 0:r.available,false)),V(A(o),w(o,false),!r),V(A(s),w(s,true)),V(t.creationMode===c.InlineCreationRows,((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.type)==="ResponsiveTable",S((t===null||t===void 0?void 0:(i=t.tableManifestConfiguration)===null||i===void 0?void 0:i.inlineCreationRowsHiddenInEditMode)===false,true,p.IsCreateMode))),false,S(e.getTemplateType()===d.ListReport,M(E(D(s)),E(s)),V(E(s),p.IsEditable))))}l.getCreateVisibility=X;function Y(e,t){const n=t.hiddenAnnotation.delete;const i=t.restrictions.isDeletable.expression;return S(e.getTemplateType()===d.AnalyticalListPage,false,S(V(A(i),w(i,false)),false,S(V(A(n),w(n,H(true))),false,S(e.getTemplateType()!==d.ListReport,V(E(n),p.IsEditable),E(V(D(n),n))))))}l.getDeleteVisibility=Y;function Z(e,t,n,i){return V(m(t.tableManifestConfiguration.enablePaste,false),n,i,[d.ListReport,d.AnalyticalListPage].indexOf(e.getTemplateType())===-1,t.restrictions.isInsertable.expression)}l.getPasteVisibility=Z;function ee(e,t){var n;const i=t.hiddenAnnotation.update,a=t.restrictions.isUpdatable.expression,o=((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.enableMassEdit)||false;const s=e.getTemplateType()===d.ObjectPage?p.IsEditable:e.getTemplateType()===d.ListReport;return V(E(V(A(a),w(a,false))),o,s,E(i))}l.getMassEditVisibility=ee;function te(t,n,i){const a=g(t.getDataModelObjectPath(),{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(e,n)=>{if(e.indexOf("/")===0){e=v(e,t.getConvertedTypes(),n);return e}const i=t.getDataModelObjectPath().navigationProperties;if(i){const t=i[i.length-1];const n=y(t)&&t.partner;if(n){e=`${n}/${e}`}}return e}});const o=a._type==="Unresolvable"?g(t.getDataModelObjectPath(),{pathVisitor:e=>v(e,t.getConvertedTypes(),[])}):a;return V(i,o,M(!n.tableManifestConfiguration.disableAddRowButtonForEmptyData,R([C("creationRowFieldValidity","internal")],e.validateCreationRowFields)))}l.getCreationRowEnablement=te;function ne(e,t,n){let i;if(t.creationMode===c.InlineCreationRows){i=E(t.hiddenAnnotation.create)}else{i=n}const a=t.restrictions.isInsertable.expression;const o=e.resolveAbsolutePath(t.collectionPath).target;return V(i,M(T(o),V(a,M(e.getTemplateType()!==d.ObjectPage,p.IsEditable))))}l.getCreateEnablement=ne;function ie(e,t,n){const i=C("deletableContexts","internal");const a=C("unSavedContexts","internal");const o=C("draftsWithDeletableActive","internal");const s=C("draftsWithNonDeletableActive","internal");return V(n,M(t.restrictions.isDeletable.navigationExpression._type==="Unresolvable",t.restrictions.isDeletable.expression),M(V(m(i,undefined),I(P(i),0)),V(m(o,undefined),I(P(o),0)),V(m(s,undefined),I(P(s),0)),V(m(a,undefined),I(P(a),0))))}l.getDeleteEnablement=ie;function ae(e,t){return V(e,t)}l.getPasteEnablement=ae;function oe(e,t,i){const a=t.restrictions.isUpdatable.expression;const o=!A(a)&&t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable";const s=x(C("numberOfSelectedContexts","internal"),1);const r=x(P(C("updatableContexts","internal")),1);const l=n.isObjectPathDraftSupported(e.getDataModelObjectPath());const d=se(e);const c=S(M(V(d,l),o),V(s,r),V(s));return V(i,S(o,c,V(c,a)))}l.getMassEditEnablement=oe;function se(e,t){const n=e.getTemplateType();if(n===d.ListReport||n===d.AnalyticalListPage||t&&e.getManifestWrapper().hasMultipleVisualizations(t)){return true}return false}l.isInDisplayMode=se;return l},false);
//# sourceMappingURL=StandardActions.js.map