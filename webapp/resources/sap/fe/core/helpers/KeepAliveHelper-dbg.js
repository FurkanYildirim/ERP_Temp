/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/fe/core/helpers/KeepAliveRefreshTypes", "./ModelHelper"], function (Log, KeepAliveRefreshTypes, ModelHelper) {
  "use strict";

  var RefreshStrategyType = KeepAliveRefreshTypes.RefreshStrategyType;
  var PATH_TO_STORE = KeepAliveRefreshTypes.PATH_TO_STORE;
  // Private functions - start
  const _fnSimplifyEntitySetPath = function (metaModel, entitySetPathToUse) {
    const entitySetPath = ModelHelper.getEntitySetPath(entitySetPathToUse);
    const entitySet = entitySetPath.indexOf("$NavigationPropertyBinding") > -1 && metaModel.getObject(entitySetPath);
    return entitySet ? `/${entitySet}` : entitySetPathToUse;
  };
  const _fnIsApplicable = function (primaryPath, key, strategy) {
    return primaryPath === key || strategy === RefreshStrategyType.IncludingDependents && primaryPath.startsWith(key);
  };
  /**
   * Check if given path resides in the context path provided.
   *
   * @param metaModel MetaModel to be used
   * @param contextPath Context path to be used
   * @param path Path to be used
   * @param strategy Strategy, it could be 'self' | 'includingDependents'
   * @returns Returns true if the context path is applicable.
   */
  const _isPathApplicableToContextPath = function (metaModel, contextPath, path, strategy) {
    let contextPathToCheck = contextPath.startsWith("/") ? contextPath : `/${contextPath}`,
      pathToCheck = path.startsWith("/") ? path : `/${path}`;
    if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
      contextPathToCheck = _fnSimplifyEntitySetPath(metaModel, contextPathToCheck);
      if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
        pathToCheck = _fnSimplifyEntitySetPath(metaModel, pathToCheck);
      } else {
        return true;
      }
    }
    return _fnIsApplicable(contextPathToCheck, pathToCheck, strategy);
  };
  // Private functions - end
  /**
   * Get controls to refresh in a view.
   *
   * @param view View of the controls
   * @param controls Context path to be used
   * @returns Returns controls that need to be refreshed.
   */
  const getControlsForRefresh = function (view, controls) {
    const controlsForRefresh = [];
    const metaModel = view.getModel().getMetaModel();
    const internalModel = view.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    if (controls) {
      controls.forEach(function (control) {
        const contextPath = control.data("targetCollectionPath");
        for (const key in refreshStrategy) {
          const strategy = refreshStrategy[key];
          if (controlsForRefresh.indexOf(control) === -1 && _isPathApplicableToContextPath(metaModel, contextPath, key, strategy)) {
            controlsForRefresh.push(control);
          }
        }
      });
    }
    return controlsForRefresh;
  };
  /**
   * Get refresh strategy for the control for a context path.
   *
   * @param control Control from which refresh info is needed
   * @param contextPath ContextPath for properities
   * @returns Returns strategy for control refresh.
   */
  const getControlRefreshStrategyForContextPath = function (control, contextPath) {
    const metaModel = control.getModel().getMetaModel();
    const internalModel = control.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    let strategy;
    if (contextPath) {
      for (const key in refreshStrategy) {
        const strategyToCheck = refreshStrategy[key];
        if (_isPathApplicableToContextPath(metaModel, contextPath, key, strategyToCheck)) {
          strategy = strategyToCheck;
          if (strategy === "includingDependents") {
            break;
          }
        }
      }
    }
    return strategy;
  };
  /**
   * Get refresh info from view.
   *
   * @param view View from which refresh info is needed
   * @returns Returns strategy for view refresh.
   */
  const getViewRefreshInfo = function (view) {
    const viewData = view.getViewData(),
      contextPath = viewData && ((viewData === null || viewData === void 0 ? void 0 : viewData.contextPath) || `/${viewData === null || viewData === void 0 ? void 0 : viewData.entitySet}`);
    return KeepAliveHelper.getControlRefreshStrategyForContextPath(view, contextPath);
  };

  /**
   * Get refresh strategy for an intent.
   *
   * @param refreshStrategies RefreshStrategies to consider
   * @param semanticObject Outbound Semantic Object
   * @param action Outbound Action
   * @returns Returns refresh strategies to use for the intent.
   */
  const getRefreshStrategyForIntent = function (refreshStrategies, semanticObject, action) {
    const soAction = semanticObject && action && `${semanticObject}-${action}`;
    const intents = refreshStrategies.intents;
    const soActionIntentMatch = intents && soAction && intents[soAction];
    const soIntentMatch = !soActionIntentMatch && intents && semanticObject && intents[semanticObject];
    return soActionIntentMatch || soIntentMatch || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies.defaultBehavior) || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies._feDefault);
  };
  /**
   * Store control refresh strategy for hash in the internal model.
   *
   * @param control Control for the refresh strategy
   * @param hash Shell hash object
   */
  const storeControlRefreshStrategyForHash = function (control, hash) {
    if (control && control.getModel("viewData") && control.getModel("internal")) {
      const viewData = control.getModel("viewData");
      const refreshStrategies = viewData.getProperty(PATH_TO_STORE);
      if (refreshStrategies) {
        const internalModel = control.getModel("internal");
        const refreshStrategy = KeepAliveHelper.getRefreshStrategyForIntent(refreshStrategies, hash === null || hash === void 0 ? void 0 : hash.semanticObject, hash === null || hash === void 0 ? void 0 : hash.action);
        internalModel.setProperty(PATH_TO_STORE, refreshStrategy);
      }
    }
  };

  /**
   * Method to refresh and restore the view if neccessary.
   *
   * @param view Control for the refresh strategy
   * @returns A promise after view refresh and restore are triggered
   */
  const restoreView = function (view) {
    const internalModelContext = view.getBindingContext("internal");
    const controller = view.getController();
    const viewState = controller === null || controller === void 0 ? void 0 : controller.viewState;
    let refreshBindings = Promise.resolve();
    if (internalModelContext && internalModelContext.getProperty("restoreStatus") === "pending") {
      if (viewState.refreshViewBindings) {
        refreshBindings = viewState.refreshViewBindings();
        refreshBindings.then(function () {
          Log.info(`FE V4: Refresh was triggered successfull: ${view.getId()}`);
        }).catch(function (err) {
          Log.warning(`FE V4: Refresh was unsuccessfull: ${view.getId()}`, err);
        });
      }
      refreshBindings = refreshBindings.then(function () {
        viewState.onRestore();
        internalModelContext.setProperty("restoreStatus", "done");
      }).catch(function (error) {
        Log.warning(`FE V4: Restore was unsuccessfull: ${view.getId()}`, error);
      });
    }
    return refreshBindings;
  };

  /**
   * helper class for KeepAlive feature in sap.fe.
   */
  const KeepAliveHelper = {
    getControlsForRefresh,
    getControlRefreshStrategyForContextPath,
    getViewRefreshInfo,
    getRefreshStrategyForIntent,
    storeControlRefreshStrategyForHash,
    restoreView
  };
  return KeepAliveHelper;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZm5TaW1wbGlmeUVudGl0eVNldFBhdGgiLCJtZXRhTW9kZWwiLCJlbnRpdHlTZXRQYXRoVG9Vc2UiLCJlbnRpdHlTZXRQYXRoIiwiTW9kZWxIZWxwZXIiLCJnZXRFbnRpdHlTZXRQYXRoIiwiZW50aXR5U2V0IiwiaW5kZXhPZiIsImdldE9iamVjdCIsIl9mbklzQXBwbGljYWJsZSIsInByaW1hcnlQYXRoIiwia2V5Iiwic3RyYXRlZ3kiLCJSZWZyZXNoU3RyYXRlZ3lUeXBlIiwiSW5jbHVkaW5nRGVwZW5kZW50cyIsInN0YXJ0c1dpdGgiLCJfaXNQYXRoQXBwbGljYWJsZVRvQ29udGV4dFBhdGgiLCJjb250ZXh0UGF0aCIsInBhdGgiLCJjb250ZXh0UGF0aFRvQ2hlY2siLCJwYXRoVG9DaGVjayIsImdldENvbnRyb2xzRm9yUmVmcmVzaCIsInZpZXciLCJjb250cm9scyIsImNvbnRyb2xzRm9yUmVmcmVzaCIsImdldE1vZGVsIiwiZ2V0TWV0YU1vZGVsIiwiaW50ZXJuYWxNb2RlbCIsInJlZnJlc2hTdHJhdGVneSIsImdldFByb3BlcnR5IiwiUEFUSF9UT19TVE9SRSIsImZvckVhY2giLCJjb250cm9sIiwiZGF0YSIsInB1c2giLCJnZXRDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9yQ29udGV4dFBhdGgiLCJzdHJhdGVneVRvQ2hlY2siLCJnZXRWaWV3UmVmcmVzaEluZm8iLCJ2aWV3RGF0YSIsImdldFZpZXdEYXRhIiwiS2VlcEFsaXZlSGVscGVyIiwiZ2V0UmVmcmVzaFN0cmF0ZWd5Rm9ySW50ZW50IiwicmVmcmVzaFN0cmF0ZWdpZXMiLCJzZW1hbnRpY09iamVjdCIsImFjdGlvbiIsInNvQWN0aW9uIiwiaW50ZW50cyIsInNvQWN0aW9uSW50ZW50TWF0Y2giLCJzb0ludGVudE1hdGNoIiwiZGVmYXVsdEJlaGF2aW9yIiwiX2ZlRGVmYXVsdCIsInN0b3JlQ29udHJvbFJlZnJlc2hTdHJhdGVneUZvckhhc2giLCJoYXNoIiwic2V0UHJvcGVydHkiLCJyZXN0b3JlVmlldyIsImludGVybmFsTW9kZWxDb250ZXh0IiwiZ2V0QmluZGluZ0NvbnRleHQiLCJjb250cm9sbGVyIiwiZ2V0Q29udHJvbGxlciIsInZpZXdTdGF0ZSIsInJlZnJlc2hCaW5kaW5ncyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVmcmVzaFZpZXdCaW5kaW5ncyIsInRoZW4iLCJMb2ciLCJpbmZvIiwiZ2V0SWQiLCJjYXRjaCIsImVyciIsIndhcm5pbmciLCJvblJlc3RvcmUiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiS2VlcEFsaXZlSGVscGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IHsgRkVWaWV3IH0gZnJvbSBcInNhcC9mZS9jb3JlL0Jhc2VDb250cm9sbGVyXCI7XG5pbXBvcnQgdHlwZSB7IEJhc2VNYW5pZmVzdFNldHRpbmdzIH0gZnJvbSBcInNhcC9mZS9jb3JlL2NvbnZlcnRlcnMvTWFuaWZlc3RTZXR0aW5nc1wiO1xuaW1wb3J0IHR5cGUgeyBSZWZyZXNoU3RyYXRlZ2llcywgU09BY3Rpb24sIFNPUmVmcmVzaFN0cmF0ZWd5IH0gZnJvbSBcInNhcC9mZS9jb3JlL2hlbHBlcnMvS2VlcEFsaXZlUmVmcmVzaFR5cGVzXCI7XG5pbXBvcnQgeyBQQVRIX1RPX1NUT1JFLCBSZWZyZXNoU3RyYXRlZ3lUeXBlIH0gZnJvbSBcInNhcC9mZS9jb3JlL2hlbHBlcnMvS2VlcEFsaXZlUmVmcmVzaFR5cGVzXCI7XG5pbXBvcnQgdHlwZSBDb250cm9sIGZyb20gXCJzYXAvdWkvY29yZS9Db250cm9sXCI7XG5pbXBvcnQgdHlwZSBWaWV3IGZyb20gXCJzYXAvdWkvY29yZS9tdmMvVmlld1wiO1xuaW1wb3J0IHR5cGUgSlNPTk1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvanNvbi9KU09OTW9kZWxcIjtcbmltcG9ydCB0eXBlIE9EYXRhTWV0YU1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvb2RhdGEvdjQvT0RhdGFNZXRhTW9kZWxcIjtcbmltcG9ydCBPRGF0YU1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvb2RhdGEvdjQvT0RhdGFNb2RlbFwiO1xuaW1wb3J0IHR5cGUgeyBJbnRlcm5hbE1vZGVsQ29udGV4dCB9IGZyb20gXCIuL01vZGVsSGVscGVyXCI7XG5pbXBvcnQgTW9kZWxIZWxwZXIgZnJvbSBcIi4vTW9kZWxIZWxwZXJcIjtcblxuLy8gUHJpdmF0ZSBmdW5jdGlvbnMgLSBzdGFydFxuY29uc3QgX2ZuU2ltcGxpZnlFbnRpdHlTZXRQYXRoID0gZnVuY3Rpb24gKG1ldGFNb2RlbDogT0RhdGFNZXRhTW9kZWwsIGVudGl0eVNldFBhdGhUb1VzZTogc3RyaW5nKTogc3RyaW5nIHtcblx0Y29uc3QgZW50aXR5U2V0UGF0aCA9IE1vZGVsSGVscGVyLmdldEVudGl0eVNldFBhdGgoZW50aXR5U2V0UGF0aFRvVXNlKTtcblx0Y29uc3QgZW50aXR5U2V0ID0gZW50aXR5U2V0UGF0aC5pbmRleE9mKFwiJE5hdmlnYXRpb25Qcm9wZXJ0eUJpbmRpbmdcIikgPiAtMSAmJiBtZXRhTW9kZWwuZ2V0T2JqZWN0KGVudGl0eVNldFBhdGgpO1xuXHRyZXR1cm4gZW50aXR5U2V0ID8gYC8ke2VudGl0eVNldH1gIDogZW50aXR5U2V0UGF0aFRvVXNlO1xufTtcbmNvbnN0IF9mbklzQXBwbGljYWJsZSA9IGZ1bmN0aW9uIChwcmltYXJ5UGF0aDogc3RyaW5nLCBrZXk6IHN0cmluZywgc3RyYXRlZ3k6IFJlZnJlc2hTdHJhdGVneVR5cGUpOiBib29sZWFuIHtcblx0cmV0dXJuIHByaW1hcnlQYXRoID09PSBrZXkgfHwgKHN0cmF0ZWd5ID09PSBSZWZyZXNoU3RyYXRlZ3lUeXBlLkluY2x1ZGluZ0RlcGVuZGVudHMgJiYgcHJpbWFyeVBhdGguc3RhcnRzV2l0aChrZXkpKTtcbn07XG4vKipcbiAqIENoZWNrIGlmIGdpdmVuIHBhdGggcmVzaWRlcyBpbiB0aGUgY29udGV4dCBwYXRoIHByb3ZpZGVkLlxuICpcbiAqIEBwYXJhbSBtZXRhTW9kZWwgTWV0YU1vZGVsIHRvIGJlIHVzZWRcbiAqIEBwYXJhbSBjb250ZXh0UGF0aCBDb250ZXh0IHBhdGggdG8gYmUgdXNlZFxuICogQHBhcmFtIHBhdGggUGF0aCB0byBiZSB1c2VkXG4gKiBAcGFyYW0gc3RyYXRlZ3kgU3RyYXRlZ3ksIGl0IGNvdWxkIGJlICdzZWxmJyB8ICdpbmNsdWRpbmdEZXBlbmRlbnRzJ1xuICogQHJldHVybnMgUmV0dXJucyB0cnVlIGlmIHRoZSBjb250ZXh0IHBhdGggaXMgYXBwbGljYWJsZS5cbiAqL1xuY29uc3QgX2lzUGF0aEFwcGxpY2FibGVUb0NvbnRleHRQYXRoID0gZnVuY3Rpb24gKFxuXHRtZXRhTW9kZWw6IE9EYXRhTWV0YU1vZGVsLFxuXHRjb250ZXh0UGF0aDogc3RyaW5nLFxuXHRwYXRoOiBzdHJpbmcsXG5cdHN0cmF0ZWd5OiBSZWZyZXNoU3RyYXRlZ3lUeXBlXG4pOiBib29sZWFuIHtcblx0bGV0IGNvbnRleHRQYXRoVG9DaGVjayA9IGNvbnRleHRQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gY29udGV4dFBhdGggOiBgLyR7Y29udGV4dFBhdGh9YCxcblx0XHRwYXRoVG9DaGVjayA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogYC8ke3BhdGh9YDtcblx0aWYgKCFfZm5Jc0FwcGxpY2FibGUoY29udGV4dFBhdGhUb0NoZWNrLCBwYXRoVG9DaGVjaywgc3RyYXRlZ3kpKSB7XG5cdFx0Y29udGV4dFBhdGhUb0NoZWNrID0gX2ZuU2ltcGxpZnlFbnRpdHlTZXRQYXRoKG1ldGFNb2RlbCwgY29udGV4dFBhdGhUb0NoZWNrKTtcblx0XHRpZiAoIV9mbklzQXBwbGljYWJsZShjb250ZXh0UGF0aFRvQ2hlY2ssIHBhdGhUb0NoZWNrLCBzdHJhdGVneSkpIHtcblx0XHRcdHBhdGhUb0NoZWNrID0gX2ZuU2ltcGxpZnlFbnRpdHlTZXRQYXRoKG1ldGFNb2RlbCwgcGF0aFRvQ2hlY2spO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIF9mbklzQXBwbGljYWJsZShjb250ZXh0UGF0aFRvQ2hlY2ssIHBhdGhUb0NoZWNrLCBzdHJhdGVneSk7XG59O1xuLy8gUHJpdmF0ZSBmdW5jdGlvbnMgLSBlbmRcbi8qKlxuICogR2V0IGNvbnRyb2xzIHRvIHJlZnJlc2ggaW4gYSB2aWV3LlxuICpcbiAqIEBwYXJhbSB2aWV3IFZpZXcgb2YgdGhlIGNvbnRyb2xzXG4gKiBAcGFyYW0gY29udHJvbHMgQ29udGV4dCBwYXRoIHRvIGJlIHVzZWRcbiAqIEByZXR1cm5zIFJldHVybnMgY29udHJvbHMgdGhhdCBuZWVkIHRvIGJlIHJlZnJlc2hlZC5cbiAqL1xuY29uc3QgZ2V0Q29udHJvbHNGb3JSZWZyZXNoID0gZnVuY3Rpb24gKHZpZXc6IEZFVmlldywgY29udHJvbHM6IENvbnRyb2xbXSk6IENvbnRyb2xbXSB7XG5cdGNvbnN0IGNvbnRyb2xzRm9yUmVmcmVzaDogQ29udHJvbFtdID0gW107XG5cdGNvbnN0IG1ldGFNb2RlbCA9IHZpZXcuZ2V0TW9kZWwoKS5nZXRNZXRhTW9kZWwoKTtcblx0Y29uc3QgaW50ZXJuYWxNb2RlbCA9IHZpZXcuZ2V0TW9kZWwoXCJpbnRlcm5hbFwiKTtcblx0Y29uc3QgcmVmcmVzaFN0cmF0ZWd5ID0gaW50ZXJuYWxNb2RlbC5nZXRQcm9wZXJ0eShQQVRIX1RPX1NUT1JFKSB8fCB7fTtcblx0aWYgKGNvbnRyb2xzKSB7XG5cdFx0Y29udHJvbHMuZm9yRWFjaChmdW5jdGlvbiAoY29udHJvbCkge1xuXHRcdFx0Y29uc3QgY29udGV4dFBhdGggPSBjb250cm9sLmRhdGEoXCJ0YXJnZXRDb2xsZWN0aW9uUGF0aFwiKTtcblx0XHRcdGZvciAoY29uc3Qga2V5IGluIHJlZnJlc2hTdHJhdGVneSkge1xuXHRcdFx0XHRjb25zdCBzdHJhdGVneSA9IHJlZnJlc2hTdHJhdGVneVtrZXldO1xuXHRcdFx0XHRpZiAoY29udHJvbHNGb3JSZWZyZXNoLmluZGV4T2YoY29udHJvbCkgPT09IC0xICYmIF9pc1BhdGhBcHBsaWNhYmxlVG9Db250ZXh0UGF0aChtZXRhTW9kZWwsIGNvbnRleHRQYXRoLCBrZXksIHN0cmF0ZWd5KSkge1xuXHRcdFx0XHRcdGNvbnRyb2xzRm9yUmVmcmVzaC5wdXNoKGNvbnRyb2wpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIGNvbnRyb2xzRm9yUmVmcmVzaDtcbn07XG4vKipcbiAqIEdldCByZWZyZXNoIHN0cmF0ZWd5IGZvciB0aGUgY29udHJvbCBmb3IgYSBjb250ZXh0IHBhdGguXG4gKlxuICogQHBhcmFtIGNvbnRyb2wgQ29udHJvbCBmcm9tIHdoaWNoIHJlZnJlc2ggaW5mbyBpcyBuZWVkZWRcbiAqIEBwYXJhbSBjb250ZXh0UGF0aCBDb250ZXh0UGF0aCBmb3IgcHJvcGVyaXRpZXNcbiAqIEByZXR1cm5zIFJldHVybnMgc3RyYXRlZ3kgZm9yIGNvbnRyb2wgcmVmcmVzaC5cbiAqL1xuY29uc3QgZ2V0Q29udHJvbFJlZnJlc2hTdHJhdGVneUZvckNvbnRleHRQYXRoID0gZnVuY3Rpb24gKGNvbnRyb2w6IENvbnRyb2wsIGNvbnRleHRQYXRoOiBzdHJpbmcpOiBSZWZyZXNoU3RyYXRlZ3lUeXBlIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgbWV0YU1vZGVsID0gKGNvbnRyb2wuZ2V0TW9kZWwoKSBhcyBPRGF0YU1vZGVsKS5nZXRNZXRhTW9kZWwoKTtcblx0Y29uc3QgaW50ZXJuYWxNb2RlbCA9IGNvbnRyb2wuZ2V0TW9kZWwoXCJpbnRlcm5hbFwiKSBhcyBKU09OTW9kZWw7XG5cdGNvbnN0IHJlZnJlc2hTdHJhdGVneSA9IGludGVybmFsTW9kZWwuZ2V0UHJvcGVydHkoUEFUSF9UT19TVE9SRSkgfHwge307XG5cdGxldCBzdHJhdGVneTtcblx0aWYgKGNvbnRleHRQYXRoKSB7XG5cdFx0Zm9yIChjb25zdCBrZXkgaW4gcmVmcmVzaFN0cmF0ZWd5KSB7XG5cdFx0XHRjb25zdCBzdHJhdGVneVRvQ2hlY2sgPSByZWZyZXNoU3RyYXRlZ3lba2V5XTtcblx0XHRcdGlmIChfaXNQYXRoQXBwbGljYWJsZVRvQ29udGV4dFBhdGgobWV0YU1vZGVsLCBjb250ZXh0UGF0aCwga2V5LCBzdHJhdGVneVRvQ2hlY2spKSB7XG5cdFx0XHRcdHN0cmF0ZWd5ID0gc3RyYXRlZ3lUb0NoZWNrO1xuXHRcdFx0XHRpZiAoc3RyYXRlZ3kgPT09IFwiaW5jbHVkaW5nRGVwZW5kZW50c1wiKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHN0cmF0ZWd5O1xufTtcbi8qKlxuICogR2V0IHJlZnJlc2ggaW5mbyBmcm9tIHZpZXcuXG4gKlxuICogQHBhcmFtIHZpZXcgVmlldyBmcm9tIHdoaWNoIHJlZnJlc2ggaW5mbyBpcyBuZWVkZWRcbiAqIEByZXR1cm5zIFJldHVybnMgc3RyYXRlZ3kgZm9yIHZpZXcgcmVmcmVzaC5cbiAqL1xuY29uc3QgZ2V0Vmlld1JlZnJlc2hJbmZvID0gZnVuY3Rpb24gKHZpZXc6IFZpZXcpOiBSZWZyZXNoU3RyYXRlZ3lUeXBlIHwgdW5kZWZpbmVkIHtcblx0Y29uc3Qgdmlld0RhdGEgPSB2aWV3LmdldFZpZXdEYXRhKCkgYXMgQmFzZU1hbmlmZXN0U2V0dGluZ3MsXG5cdFx0Y29udGV4dFBhdGggPSB2aWV3RGF0YSAmJiAodmlld0RhdGE/LmNvbnRleHRQYXRoIHx8IGAvJHt2aWV3RGF0YT8uZW50aXR5U2V0fWApO1xuXHRyZXR1cm4gS2VlcEFsaXZlSGVscGVyLmdldENvbnRyb2xSZWZyZXNoU3RyYXRlZ3lGb3JDb250ZXh0UGF0aCh2aWV3LCBjb250ZXh0UGF0aCk7XG59O1xuXG4vKipcbiAqIEdldCByZWZyZXNoIHN0cmF0ZWd5IGZvciBhbiBpbnRlbnQuXG4gKlxuICogQHBhcmFtIHJlZnJlc2hTdHJhdGVnaWVzIFJlZnJlc2hTdHJhdGVnaWVzIHRvIGNvbnNpZGVyXG4gKiBAcGFyYW0gc2VtYW50aWNPYmplY3QgT3V0Ym91bmQgU2VtYW50aWMgT2JqZWN0XG4gKiBAcGFyYW0gYWN0aW9uIE91dGJvdW5kIEFjdGlvblxuICogQHJldHVybnMgUmV0dXJucyByZWZyZXNoIHN0cmF0ZWdpZXMgdG8gdXNlIGZvciB0aGUgaW50ZW50LlxuICovXG5jb25zdCBnZXRSZWZyZXNoU3RyYXRlZ3lGb3JJbnRlbnQgPSBmdW5jdGlvbiAoXG5cdHJlZnJlc2hTdHJhdGVnaWVzOiBSZWZyZXNoU3RyYXRlZ2llcyxcblx0c2VtYW50aWNPYmplY3Q/OiBzdHJpbmcsXG5cdGFjdGlvbj86IHN0cmluZ1xuKTogU09SZWZyZXNoU3RyYXRlZ3kgfCB1bmRlZmluZWQge1xuXHRjb25zdCBzb0FjdGlvbiA9IHNlbWFudGljT2JqZWN0ICYmIGFjdGlvbiAmJiBgJHtzZW1hbnRpY09iamVjdH0tJHthY3Rpb259YDtcblx0Y29uc3QgaW50ZW50cyA9IHJlZnJlc2hTdHJhdGVnaWVzLmludGVudHM7XG5cdGNvbnN0IHNvQWN0aW9uSW50ZW50TWF0Y2ggPSBpbnRlbnRzICYmIHNvQWN0aW9uICYmIGludGVudHNbc29BY3Rpb25dO1xuXHRjb25zdCBzb0ludGVudE1hdGNoID0gIXNvQWN0aW9uSW50ZW50TWF0Y2ggJiYgaW50ZW50cyAmJiBzZW1hbnRpY09iamVjdCAmJiBpbnRlbnRzW3NlbWFudGljT2JqZWN0XTtcblxuXHRyZXR1cm4gc29BY3Rpb25JbnRlbnRNYXRjaCB8fCBzb0ludGVudE1hdGNoIHx8IHJlZnJlc2hTdHJhdGVnaWVzPy5kZWZhdWx0QmVoYXZpb3IgfHwgcmVmcmVzaFN0cmF0ZWdpZXM/Ll9mZURlZmF1bHQ7XG59O1xuLyoqXG4gKiBTdG9yZSBjb250cm9sIHJlZnJlc2ggc3RyYXRlZ3kgZm9yIGhhc2ggaW4gdGhlIGludGVybmFsIG1vZGVsLlxuICpcbiAqIEBwYXJhbSBjb250cm9sIENvbnRyb2wgZm9yIHRoZSByZWZyZXNoIHN0cmF0ZWd5XG4gKiBAcGFyYW0gaGFzaCBTaGVsbCBoYXNoIG9iamVjdFxuICovXG5jb25zdCBzdG9yZUNvbnRyb2xSZWZyZXNoU3RyYXRlZ3lGb3JIYXNoID0gZnVuY3Rpb24gKGNvbnRyb2w6IENvbnRyb2wsIGhhc2g6IFNPQWN0aW9uKTogdm9pZCB7XG5cdGlmIChjb250cm9sICYmIGNvbnRyb2wuZ2V0TW9kZWwoXCJ2aWV3RGF0YVwiKSAmJiBjb250cm9sLmdldE1vZGVsKFwiaW50ZXJuYWxcIikpIHtcblx0XHRjb25zdCB2aWV3RGF0YSA9IGNvbnRyb2wuZ2V0TW9kZWwoXCJ2aWV3RGF0YVwiKSBhcyBKU09OTW9kZWw7XG5cdFx0Y29uc3QgcmVmcmVzaFN0cmF0ZWdpZXM6IFJlZnJlc2hTdHJhdGVnaWVzID0gdmlld0RhdGEuZ2V0UHJvcGVydHkoUEFUSF9UT19TVE9SRSk7XG5cdFx0aWYgKHJlZnJlc2hTdHJhdGVnaWVzKSB7XG5cdFx0XHRjb25zdCBpbnRlcm5hbE1vZGVsID0gY29udHJvbC5nZXRNb2RlbChcImludGVybmFsXCIpO1xuXHRcdFx0Y29uc3QgcmVmcmVzaFN0cmF0ZWd5OiBTT1JlZnJlc2hTdHJhdGVneSB8IHVuZGVmaW5lZCA9IEtlZXBBbGl2ZUhlbHBlci5nZXRSZWZyZXNoU3RyYXRlZ3lGb3JJbnRlbnQoXG5cdFx0XHRcdHJlZnJlc2hTdHJhdGVnaWVzLFxuXHRcdFx0XHRoYXNoPy5zZW1hbnRpY09iamVjdCxcblx0XHRcdFx0aGFzaD8uYWN0aW9uXG5cdFx0XHQpO1xuXHRcdFx0KGludGVybmFsTW9kZWwgYXMgSlNPTk1vZGVsKS5zZXRQcm9wZXJ0eShQQVRIX1RPX1NUT1JFLCByZWZyZXNoU3RyYXRlZ3kpO1xuXHRcdH1cblx0fVxufTtcblxuLyoqXG4gKiBNZXRob2QgdG8gcmVmcmVzaCBhbmQgcmVzdG9yZSB0aGUgdmlldyBpZiBuZWNjZXNzYXJ5LlxuICpcbiAqIEBwYXJhbSB2aWV3IENvbnRyb2wgZm9yIHRoZSByZWZyZXNoIHN0cmF0ZWd5XG4gKiBAcmV0dXJucyBBIHByb21pc2UgYWZ0ZXIgdmlldyByZWZyZXNoIGFuZCByZXN0b3JlIGFyZSB0cmlnZ2VyZWRcbiAqL1xuY29uc3QgcmVzdG9yZVZpZXcgPSBmdW5jdGlvbiAodmlldzogVmlldyk6IFByb21pc2U8YW55PiB7XG5cdGNvbnN0IGludGVybmFsTW9kZWxDb250ZXh0ID0gdmlldy5nZXRCaW5kaW5nQ29udGV4dChcImludGVybmFsXCIpIGFzIEludGVybmFsTW9kZWxDb250ZXh0O1xuXHRjb25zdCBjb250cm9sbGVyID0gdmlldy5nZXRDb250cm9sbGVyKCk7XG5cdGNvbnN0IHZpZXdTdGF0ZSA9IChjb250cm9sbGVyIGFzIGFueSk/LnZpZXdTdGF0ZTtcblx0bGV0IHJlZnJlc2hCaW5kaW5ncyA9IFByb21pc2UucmVzb2x2ZSgpO1xuXHRpZiAoaW50ZXJuYWxNb2RlbENvbnRleHQgJiYgaW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJyZXN0b3JlU3RhdHVzXCIpID09PSBcInBlbmRpbmdcIikge1xuXHRcdGlmICh2aWV3U3RhdGUucmVmcmVzaFZpZXdCaW5kaW5ncykge1xuXHRcdFx0cmVmcmVzaEJpbmRpbmdzID0gdmlld1N0YXRlLnJlZnJlc2hWaWV3QmluZGluZ3MoKTtcblx0XHRcdHJlZnJlc2hCaW5kaW5nc1xuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0TG9nLmluZm8oYEZFIFY0OiBSZWZyZXNoIHdhcyB0cmlnZ2VyZWQgc3VjY2Vzc2Z1bGw6ICR7dmlldy5nZXRJZCgpfWApO1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdExvZy53YXJuaW5nKGBGRSBWNDogUmVmcmVzaCB3YXMgdW5zdWNjZXNzZnVsbDogJHt2aWV3LmdldElkKCl9YCwgZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJlZnJlc2hCaW5kaW5ncyA9IHJlZnJlc2hCaW5kaW5nc1xuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR2aWV3U3RhdGUub25SZXN0b3JlKCk7XG5cdFx0XHRcdGludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwicmVzdG9yZVN0YXR1c1wiLCBcImRvbmVcIik7XG5cdFx0XHR9KVxuXHRcdFx0LmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuXHRcdFx0XHRMb2cud2FybmluZyhgRkUgVjQ6IFJlc3RvcmUgd2FzIHVuc3VjY2Vzc2Z1bGw6ICR7dmlldy5nZXRJZCgpfWAsIGVycm9yKTtcblx0XHRcdH0pO1xuXHR9XG5cdHJldHVybiByZWZyZXNoQmluZGluZ3M7XG59O1xuXG4vKipcbiAqIGhlbHBlciBjbGFzcyBmb3IgS2VlcEFsaXZlIGZlYXR1cmUgaW4gc2FwLmZlLlxuICovXG5jb25zdCBLZWVwQWxpdmVIZWxwZXIgPSB7XG5cdGdldENvbnRyb2xzRm9yUmVmcmVzaCxcblx0Z2V0Q29udHJvbFJlZnJlc2hTdHJhdGVneUZvckNvbnRleHRQYXRoLFxuXHRnZXRWaWV3UmVmcmVzaEluZm8sXG5cdGdldFJlZnJlc2hTdHJhdGVneUZvckludGVudCxcblx0c3RvcmVDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9ySGFzaCxcblx0cmVzdG9yZVZpZXdcbn07XG5leHBvcnQgZGVmYXVsdCBLZWVwQWxpdmVIZWxwZXI7XG4iXSwibWFwcGluZ3MiOiI7QUFBQTtBQUFBO0FBQUE7Ozs7OztFQWFBO0VBQ0EsTUFBTUEsd0JBQXdCLEdBQUcsVUFBVUMsU0FBeUIsRUFBRUMsa0JBQTBCLEVBQVU7SUFDekcsTUFBTUMsYUFBYSxHQUFHQyxXQUFXLENBQUNDLGdCQUFnQixDQUFDSCxrQkFBa0IsQ0FBQztJQUN0RSxNQUFNSSxTQUFTLEdBQUdILGFBQWEsQ0FBQ0ksT0FBTyxDQUFDLDRCQUE0QixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUlOLFNBQVMsQ0FBQ08sU0FBUyxDQUFDTCxhQUFhLENBQUM7SUFDaEgsT0FBT0csU0FBUyxHQUFJLElBQUdBLFNBQVUsRUFBQyxHQUFHSixrQkFBa0I7RUFDeEQsQ0FBQztFQUNELE1BQU1PLGVBQWUsR0FBRyxVQUFVQyxXQUFtQixFQUFFQyxHQUFXLEVBQUVDLFFBQTZCLEVBQVc7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