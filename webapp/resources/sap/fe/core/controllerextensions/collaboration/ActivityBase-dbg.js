/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/base/util/UriParameters", "sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/ui/core/ws/SapPcpWebSocket"], function (Log, UriParameters, CollaborationCommon, SapPcpWebSocket) {
  "use strict";

  var _exports = {};
  var SUPPORTED_PROTOCOLS = SapPcpWebSocket.SUPPORTED_PROTOCOLS;
  var Activity = CollaborationCommon.Activity;
  const COLLABORATION = "/collaboration";
  const CONNECTED = "/collaboration/connected";
  const CONNECTION = "/collaboration/connection";
  const CURRENTDRAFTID = "/collaboration/DraftID";
  function isCollaborationConnected(internalModel) {
    return !!internalModel.getProperty(CONNECTED);
  }
  _exports.isCollaborationConnected = isCollaborationConnected;
  function initializeCollaboration(user, webSocketBaseURL, draftUUID, serviceUrl, internalModel, receiveCallback) {
    let sendUserInfo = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : false;
    if (internalModel.getProperty(CONNECTION)) {
      // A connection is already established
      if (internalModel.getProperty(CURRENTDRAFTID) === draftUUID) {
        // Connection corresponds to the same draft -> nothing to do
        return;
      } else {
        // There was a connection to another draft -> we close it before creating a new one
        // This can happen e.g. when switching between items in FCL
        endCollaboration(internalModel);
      }
    }
    const activeUsers = [user];
    internalModel.setProperty(COLLABORATION, {
      activeUsers: activeUsers,
      activities: {}
    });
    sendUserInfo = sendUserInfo || UriParameters.fromQuery(window.location.search).get("useFLPUser") === "true";
    const webSocket = createWebSocket(user, webSocketBaseURL, draftUUID, serviceUrl, sendUserInfo);
    internalModel.setProperty(CONNECTION, webSocket);
    internalModel.setProperty(CURRENTDRAFTID, draftUUID);
    webSocket.attachMessage(function (event) {
      const message = event.getParameter("pcpFields");
      receiveCallback(message);
    });
    webSocket.attachOpen(function () {
      internalModel.setProperty(CONNECTED, true);
    });
    webSocket.attachError(function () {
      Log.error(`The connection to the websocket channel ${webSocketBaseURL} could not be established`);
      internalModel.setProperty(CONNECTED, false);
    });
    webSocket.attachClose(function () {
      internalModel.setProperty(CONNECTED, false);
    });
  }
  _exports.initializeCollaboration = initializeCollaboration;
  function broadcastCollaborationMessage(action, content, internalModel, triggeredActionName, refreshListBinding, requestedProperties) {
    if (isCollaborationConnected(internalModel)) {
      const webSocket = internalModel.getProperty(CONNECTION);
      webSocket.send("", {
        clientAction: action,
        clientContent: content,
        clientTriggeredActionName: triggeredActionName,
        clientRefreshListBinding: refreshListBinding,
        clientRequestedProperties: requestedProperties
      });
      if (action === Activity.Activate || action === Activity.Discard) {
        endCollaboration(internalModel);
      }
    }
  }
  _exports.broadcastCollaborationMessage = broadcastCollaborationMessage;
  function endCollaboration(internalModel) {
    const webSocket = internalModel.getProperty(CONNECTION);
    webSocket === null || webSocket === void 0 ? void 0 : webSocket.close();
    internalModel.setProperty(COLLABORATION, {});
  }
  _exports.endCollaboration = endCollaboration;
  function createWebSocket(user, socketBaseURL, draftUUID, serviceUrl) {
    let sendUserInfo = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
    const hostLocation = window.location;
    let socketURI;

    // Support useBackendUrl for local testing
    const useBackendUrl = UriParameters.fromQuery(window.location.search).get("useBackendUrl");
    if (useBackendUrl) {
      socketURI = useBackendUrl.replace("https", "wss");
    } else {
      socketURI = hostLocation.protocol === "https:" ? "wss:" : "ws:";
      socketURI += `//${hostLocation.host}`;
    }
    socketURI += `${(socketBaseURL.startsWith("/") ? "" : "/") + socketBaseURL}?draft=${draftUUID}&relatedService=${serviceUrl}`;
    if (sendUserInfo) {
      socketURI += `&userID=${encodeURI(user.id)}&userName=${encodeURI(user.initialName || "")}`;
    }
    return new SapPcpWebSocket(socketURI, [SUPPORTED_PROTOCOLS.v10]);
  }
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDT0xMQUJPUkFUSU9OIiwiQ09OTkVDVEVEIiwiQ09OTkVDVElPTiIsIkNVUlJFTlREUkFGVElEIiwiaXNDb2xsYWJvcmF0aW9uQ29ubmVjdGVkIiwiaW50ZXJuYWxNb2RlbCIsImdldFByb3BlcnR5IiwiaW5pdGlhbGl6ZUNvbGxhYm9yYXRpb24iLCJ1c2VyIiwid2ViU29ja2V0QmFzZVVSTCIsImRyYWZ0VVVJRCIsInNlcnZpY2VVcmwiLCJyZWNlaXZlQ2FsbGJhY2siLCJzZW5kVXNlckluZm8iLCJlbmRDb2xsYWJvcmF0aW9uIiwiYWN0aXZlVXNlcnMiLCJzZXRQcm9wZXJ0eSIsImFjdGl2aXRpZXMiLCJVcmlQYXJhbWV0ZXJzIiwiZnJvbVF1ZXJ5Iiwid2luZG93IiwibG9jYXRpb24iLCJzZWFyY2giLCJnZXQiLCJ3ZWJTb2NrZXQiLCJjcmVhdGVXZWJTb2NrZXQiLCJhdHRhY2hNZXNzYWdlIiwiZXZlbnQiLCJtZXNzYWdlIiwiZ2V0UGFyYW1ldGVyIiwiYXR0YWNoT3BlbiIsImF0dGFjaEVycm9yIiwiTG9nIiwiZXJyb3IiLCJhdHRhY2hDbG9zZSIsImJyb2FkY2FzdENvbGxhYm9yYXRpb25NZXNzYWdlIiwiYWN0aW9uIiwiY29udGVudCIsInRyaWdnZXJlZEFjdGlvbk5hbWUiLCJyZWZyZXNoTGlzdEJpbmRpbmciLCJyZXF1ZXN0ZWRQcm9wZXJ0aWVzIiwic2VuZCIsImNsaWVudEFjdGlvbiIsImNsaWVudENvbnRlbnQiLCJjbGllbnRUcmlnZ2VyZWRBY3Rpb25OYW1lIiwiY2xpZW50UmVmcmVzaExpc3RCaW5kaW5nIiwiY2xpZW50UmVxdWVzdGVkUHJvcGVydGllcyIsIkFjdGl2aXR5IiwiQWN0aXZhdGUiLCJEaXNjYXJkIiwiY2xvc2UiLCJzb2NrZXRCYXNlVVJMIiwiaG9zdExvY2F0aW9uIiwic29ja2V0VVJJIiwidXNlQmFja2VuZFVybCIsInJlcGxhY2UiLCJwcm90b2NvbCIsImhvc3QiLCJzdGFydHNXaXRoIiwiZW5jb2RlVVJJIiwiaWQiLCJpbml0aWFsTmFtZSIsIlNhcFBjcFdlYlNvY2tldCIsIlNVUFBPUlRFRF9QUk9UT0NPTFMiLCJ2MTAiXSwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIkFjdGl2aXR5QmFzZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTG9nIGZyb20gXCJzYXAvYmFzZS9Mb2dcIjtcbmltcG9ydCBVcmlQYXJhbWV0ZXJzIGZyb20gXCJzYXAvYmFzZS91dGlsL1VyaVBhcmFtZXRlcnNcIjtcbmltcG9ydCB0eXBlIHsgTWVzc2FnZSwgVXNlciB9IGZyb20gXCJzYXAvZmUvY29yZS9jb250cm9sbGVyZXh0ZW5zaW9ucy9jb2xsYWJvcmF0aW9uL0NvbGxhYm9yYXRpb25Db21tb25cIjtcbmltcG9ydCB7IEFjdGl2aXR5IH0gZnJvbSBcInNhcC9mZS9jb3JlL2NvbnRyb2xsZXJleHRlbnNpb25zL2NvbGxhYm9yYXRpb24vQ29sbGFib3JhdGlvbkNvbW1vblwiO1xuaW1wb3J0IHR5cGUgRXZlbnQgZnJvbSBcInNhcC91aS9iYXNlL0V2ZW50XCI7XG5pbXBvcnQgU2FwUGNwV2ViU29ja2V0LCB7IFNVUFBPUlRFRF9QUk9UT0NPTFMgfSBmcm9tIFwic2FwL3VpL2NvcmUvd3MvU2FwUGNwV2ViU29ja2V0XCI7XG5pbXBvcnQgdHlwZSBKU09OTW9kZWwgZnJvbSBcInNhcC91aS9tb2RlbC9qc29uL0pTT05Nb2RlbFwiO1xuXG5jb25zdCBDT0xMQUJPUkFUSU9OID0gXCIvY29sbGFib3JhdGlvblwiO1xuY29uc3QgQ09OTkVDVEVEID0gXCIvY29sbGFib3JhdGlvbi9jb25uZWN0ZWRcIjtcbmNvbnN0IENPTk5FQ1RJT04gPSBcIi9jb2xsYWJvcmF0aW9uL2Nvbm5lY3Rpb25cIjtcbmNvbnN0IENVUlJFTlREUkFGVElEID0gXCIvY29sbGFib3JhdGlvbi9EcmFmdElEXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbGxhYm9yYXRpb25Db25uZWN0ZWQoaW50ZXJuYWxNb2RlbDogSlNPTk1vZGVsKTogYm9vbGVhbiB7XG5cdHJldHVybiAhIWludGVybmFsTW9kZWwuZ2V0UHJvcGVydHkoQ09OTkVDVEVEKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVDb2xsYWJvcmF0aW9uKFxuXHR1c2VyOiBVc2VyLFxuXHR3ZWJTb2NrZXRCYXNlVVJMOiBzdHJpbmcsXG5cdGRyYWZ0VVVJRDogc3RyaW5nLFxuXHRzZXJ2aWNlVXJsOiBzdHJpbmcsXG5cdGludGVybmFsTW9kZWw6IEpTT05Nb2RlbCxcblx0cmVjZWl2ZUNhbGxiYWNrOiAoXzogTWVzc2FnZSkgPT4gdm9pZCxcblx0c2VuZFVzZXJJbmZvID0gZmFsc2Vcbikge1xuXHRpZiAoaW50ZXJuYWxNb2RlbC5nZXRQcm9wZXJ0eShDT05ORUNUSU9OKSkge1xuXHRcdC8vIEEgY29ubmVjdGlvbiBpcyBhbHJlYWR5IGVzdGFibGlzaGVkXG5cdFx0aWYgKGludGVybmFsTW9kZWwuZ2V0UHJvcGVydHkoQ1VSUkVOVERSQUZUSUQpID09PSBkcmFmdFVVSUQpIHtcblx0XHRcdC8vIENvbm5lY3Rpb24gY29ycmVzcG9uZHMgdG8gdGhlIHNhbWUgZHJhZnQgLT4gbm90aGluZyB0byBkb1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBUaGVyZSB3YXMgYSBjb25uZWN0aW9uIHRvIGFub3RoZXIgZHJhZnQgLT4gd2UgY2xvc2UgaXQgYmVmb3JlIGNyZWF0aW5nIGEgbmV3IG9uZVxuXHRcdFx0Ly8gVGhpcyBjYW4gaGFwcGVuIGUuZy4gd2hlbiBzd2l0Y2hpbmcgYmV0d2VlbiBpdGVtcyBpbiBGQ0xcblx0XHRcdGVuZENvbGxhYm9yYXRpb24oaW50ZXJuYWxNb2RlbCk7XG5cdFx0fVxuXHR9XG5cblx0Y29uc3QgYWN0aXZlVXNlcnM6IFVzZXJbXSA9IFt1c2VyXTtcblx0aW50ZXJuYWxNb2RlbC5zZXRQcm9wZXJ0eShDT0xMQUJPUkFUSU9OLCB7IGFjdGl2ZVVzZXJzOiBhY3RpdmVVc2VycywgYWN0aXZpdGllczoge30gfSk7XG5cblx0c2VuZFVzZXJJbmZvID0gc2VuZFVzZXJJbmZvIHx8IFVyaVBhcmFtZXRlcnMuZnJvbVF1ZXJ5KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLmdldChcInVzZUZMUFVzZXJcIikgPT09IFwidHJ1ZVwiO1xuXG5cdGNvbnN0IHdlYlNvY2tldCA9IGNyZWF0ZVdlYlNvY2tldCh1c2VyLCB3ZWJTb2NrZXRCYXNlVVJMLCBkcmFmdFVVSUQsIHNlcnZpY2VVcmwsIHNlbmRVc2VySW5mbyk7XG5cblx0aW50ZXJuYWxNb2RlbC5zZXRQcm9wZXJ0eShDT05ORUNUSU9OLCB3ZWJTb2NrZXQpO1xuXHRpbnRlcm5hbE1vZGVsLnNldFByb3BlcnR5KENVUlJFTlREUkFGVElELCBkcmFmdFVVSUQpO1xuXG5cdHdlYlNvY2tldC5hdHRhY2hNZXNzYWdlKGZ1bmN0aW9uIChldmVudDogRXZlbnQpIHtcblx0XHRjb25zdCBtZXNzYWdlOiBNZXNzYWdlID0gZXZlbnQuZ2V0UGFyYW1ldGVyKFwicGNwRmllbGRzXCIpO1xuXHRcdHJlY2VpdmVDYWxsYmFjayhtZXNzYWdlKTtcblx0fSk7XG5cblx0d2ViU29ja2V0LmF0dGFjaE9wZW4oZnVuY3Rpb24gKCkge1xuXHRcdGludGVybmFsTW9kZWwuc2V0UHJvcGVydHkoQ09OTkVDVEVELCB0cnVlKTtcblx0fSk7XG5cblx0d2ViU29ja2V0LmF0dGFjaEVycm9yKGZ1bmN0aW9uICgpIHtcblx0XHRMb2cuZXJyb3IoYFRoZSBjb25uZWN0aW9uIHRvIHRoZSB3ZWJzb2NrZXQgY2hhbm5lbCAke3dlYlNvY2tldEJhc2VVUkx9IGNvdWxkIG5vdCBiZSBlc3RhYmxpc2hlZGApO1xuXHRcdGludGVybmFsTW9kZWwuc2V0UHJvcGVydHkoQ09OTkVDVEVELCBmYWxzZSk7XG5cdH0pO1xuXG5cdHdlYlNvY2tldC5hdHRhY2hDbG9zZShmdW5jdGlvbiAoKSB7XG5cdFx0aW50ZXJuYWxNb2RlbC5zZXRQcm9wZXJ0eShDT05ORUNURUQsIGZhbHNlKTtcblx0fSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBicm9hZGNhc3RDb2xsYWJvcmF0aW9uTWVzc2FnZShcblx0YWN0aW9uOiBBY3Rpdml0eSxcblx0Y29udGVudDogc3RyaW5nIHwgdW5kZWZpbmVkLFxuXHRpbnRlcm5hbE1vZGVsOiBKU09OTW9kZWwsXG5cdHRyaWdnZXJlZEFjdGlvbk5hbWU/OiBzdHJpbmcsXG5cdHJlZnJlc2hMaXN0QmluZGluZz86IGJvb2xlYW4sXG5cdHJlcXVlc3RlZFByb3BlcnRpZXM/OiBzdHJpbmdcbikge1xuXHRpZiAoaXNDb2xsYWJvcmF0aW9uQ29ubmVjdGVkKGludGVybmFsTW9kZWwpKSB7XG5cdFx0Y29uc3Qgd2ViU29ja2V0ID0gaW50ZXJuYWxNb2RlbC5nZXRQcm9wZXJ0eShDT05ORUNUSU9OKSBhcyBTYXBQY3BXZWJTb2NrZXQ7XG5cblx0XHR3ZWJTb2NrZXQuc2VuZChcIlwiLCB7XG5cdFx0XHRjbGllbnRBY3Rpb246IGFjdGlvbixcblx0XHRcdGNsaWVudENvbnRlbnQ6IGNvbnRlbnQsXG5cdFx0XHRjbGllbnRUcmlnZ2VyZWRBY3Rpb25OYW1lOiB0cmlnZ2VyZWRBY3Rpb25OYW1lLFxuXHRcdFx0Y2xpZW50UmVmcmVzaExpc3RCaW5kaW5nOiByZWZyZXNoTGlzdEJpbmRpbmcsXG5cdFx0XHRjbGllbnRSZXF1ZXN0ZWRQcm9wZXJ0aWVzOiByZXF1ZXN0ZWRQcm9wZXJ0aWVzXG5cdFx0fSk7XG5cblx0XHRpZiAoYWN0aW9uID09PSBBY3Rpdml0eS5BY3RpdmF0ZSB8fCBhY3Rpb24gPT09IEFjdGl2aXR5LkRpc2NhcmQpIHtcblx0XHRcdGVuZENvbGxhYm9yYXRpb24oaW50ZXJuYWxNb2RlbCk7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmRDb2xsYWJvcmF0aW9uKGludGVybmFsTW9kZWw6IEpTT05Nb2RlbCkge1xuXHRjb25zdCB3ZWJTb2NrZXQgPSBpbnRlcm5hbE1vZGVsLmdldFByb3BlcnR5KENPTk5FQ1RJT04pIGFzIFNhcFBjcFdlYlNvY2tldDtcblx0d2ViU29ja2V0Py5jbG9zZSgpO1xuXHRpbnRlcm5hbE1vZGVsLnNldFByb3BlcnR5KENPTExBQk9SQVRJT04sIHt9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlV2ViU29ja2V0KHVzZXI6IFVzZXIsIHNvY2tldEJhc2VVUkw6IHN0cmluZywgZHJhZnRVVUlEOiBzdHJpbmcsIHNlcnZpY2VVcmw6IHN0cmluZywgc2VuZFVzZXJJbmZvID0gZmFsc2UpIHtcblx0Y29uc3QgaG9zdExvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uO1xuXHRsZXQgc29ja2V0VVJJO1xuXG5cdC8vIFN1cHBvcnQgdXNlQmFja2VuZFVybCBmb3IgbG9jYWwgdGVzdGluZ1xuXHRjb25zdCB1c2VCYWNrZW5kVXJsID0gVXJpUGFyYW1ldGVycy5mcm9tUXVlcnkod2luZG93LmxvY2F0aW9uLnNlYXJjaCkuZ2V0KFwidXNlQmFja2VuZFVybFwiKTtcblx0aWYgKHVzZUJhY2tlbmRVcmwpIHtcblx0XHRzb2NrZXRVUkkgPSB1c2VCYWNrZW5kVXJsLnJlcGxhY2UoXCJodHRwc1wiLCBcIndzc1wiKTtcblx0fSBlbHNlIHtcblx0XHRzb2NrZXRVUkkgPSBob3N0TG9jYXRpb24ucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIndzczpcIiA6IFwid3M6XCI7XG5cdFx0c29ja2V0VVJJICs9IGAvLyR7aG9zdExvY2F0aW9uLmhvc3R9YDtcblx0fVxuXG5cdHNvY2tldFVSSSArPSBgJHsoc29ja2V0QmFzZVVSTC5zdGFydHNXaXRoKFwiL1wiKSA/IFwiXCIgOiBcIi9cIikgKyBzb2NrZXRCYXNlVVJMfT9kcmFmdD0ke2RyYWZ0VVVJRH0mcmVsYXRlZFNlcnZpY2U9JHtzZXJ2aWNlVXJsfWA7XG5cblx0aWYgKHNlbmRVc2VySW5mbykge1xuXHRcdHNvY2tldFVSSSArPSBgJnVzZXJJRD0ke2VuY29kZVVSSSh1c2VyLmlkKX0mdXNlck5hbWU9JHtlbmNvZGVVUkkodXNlci5pbml0aWFsTmFtZSB8fCBcIlwiKX1gO1xuXHR9XG5cblx0cmV0dXJuIG5ldyBTYXBQY3BXZWJTb2NrZXQoc29j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