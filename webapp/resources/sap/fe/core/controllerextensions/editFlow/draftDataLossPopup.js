/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/helpers/EditState","../../controls/DataLossOrDraftDiscard/DraftDataLossDialog.block"],function(t,e,a,i){"use strict";var o;(function(t){t["BackNavigation"]="BackNavigation";t["ForwardNavigation"]="ForwardNavigation"})(o||(o={}));const n=new i({});function r(t){var e,a;let i=false;const o=t.getAppComponent().getManifest();i=(o===null||o===void 0?void 0:(e=o["sap.fe"])===null||e===void 0?void 0:(a=e.app)===null||a===void 0?void 0:a.silentlyKeepDraftOnForwardNavigation)||false;return i}async function s(t,e,a,i,o){if(t.CreationDateTime!==t.LastChangeDateTime){n.performAfterDiscardorKeepDraft(i,e,a,o)}else{i()}}async function c(e,i,r,s,c,l,f){if(a.isEditStateDirty()){if(e.CreationDateTime===e.LastChangeDateTime&&c===o.BackNavigation){try{await n.discardDraft(r,f);s()}catch(e){t.error("Error while canceling the document",e)}}else if(c===o.ForwardNavigation&&l){s()}else{n.performAfterDiscardorKeepDraft(s,i,r,f)}}else{s()}}async function l(e,a,i,n){if(n===o.BackNavigation){const o={skipDiscardPopover:true};try{await e.editFlow.cancelDocument(a,o);i()}catch(e){t.error("Error while canceling the document",e)}}else{i()}}async function f(t,e,a,i,r,s){if(i===o.ForwardNavigation&&r){a()}else{n.performAfterDiscardorKeepDraft(a,e,t,s)}}async function d(t,i,n,d,g,D){let p=arguments.length>6&&arguments[6]!==undefined?arguments[6]:o.BackNavigation;const v=e.isConnected(g.getView());const u=!v?i:function(){e.disconnect(g.getView());for(var t=arguments.length,a=new Array(t),o=0;o<t;o++){a[o]=arguments[o]}i.apply(null,...a)};const y=r(g);if(t){if(g.getAppComponent().getRootViewController().isFclEnabled()){await s(t,n,g,u,D)}else if(!d.getObject().HasActiveEntity){c(t,n,g,u,p,y,D)}else if(t.CreationDateTime===t.LastChangeDateTime){l(g,d,u,p)}else if(a.isEditStateDirty()){f(g,n,u,p,y,D)}else{u()}}else{i()}}async function g(e,a,i,n,r){let s=arguments.length>5&&arguments[5]!==undefined?arguments[5]:o.BackNavigation;const c=n.getView();const l=i.getModel();const f=l.getMetaModel();const g=c.getViewData().entitySet??"";const D=g&&f.getObject("/"+g+"@com.sap.vocabularies.Common.v1.DraftRoot");const p=c.getModel("ui");const v=p.getProperty("/isEditable");const u=l.bindContext(`${i.getPath()}/DraftAdministrativeData`).getBoundContext();if(i&&i.getObject()&&(!D&&s===o.BackNavigation||!v)){e()}else{try{const t=await u.requestObject();await d(t,e,a,i,n,r,s)}catch(e){t.error("Cannot retrieve draftDataContext information",e)}}}const D={processDataLossOrDraftDiscardConfirmation:g,silentlyKeepDraftOnForwardNavigation:r,NavigationType:o,processFclMode:s,processNoActiveEntityMode:c,processEditingDraftForExistingEntity:l,processEditStateDirty:f};return D},false);
//# sourceMappingURL=draftDataLossPopup.js.map