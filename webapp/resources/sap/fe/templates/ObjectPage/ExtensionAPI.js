/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/ID","sap/fe/core/ExtensionAPI","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/RecommendationHelper","sap/fe/core/helpers/ResourceModelHelper","sap/ui/core/InvisibleMessage","sap/ui/core/library","sap/ui/core/message/Message"],function(e,t,n,s,o,r,i,a,c,g){"use strict";var p,l;var u=c.MessageType;var d=c.InvisibleMessageMode;var f=r.recommendationHelper;var h=o.defineUI5Class;var y=n.getSideContentLayoutID;function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;P(e,t)}function P(e,t){P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return P(e,t)}let E=(p=h("sap.fe.templates.ObjectPage.ExtensionAPI"),p(l=function(n){v(s,n);function s(){return n.apply(this,arguments)||this}var o=s.prototype;o.refresh=function e(n){const s=this._view.getBindingContext();if(!s){return Promise.resolve()}const o=t.getAppComponent(this._view),r=o.getSideEffectsService(),i=s.getModel().getMetaModel(),a={targetProperties:[],targetEntities:[]};let c,g,p,l;if(n===undefined||n===null){a.targetEntities.push({$NavigationPropertyPath:""})}else{c=Array.isArray(n)?n:[n];p=this._controller.getOwnerComponent().getEntitySet();for(let e=0;e<c.length;e++){g=c[e];if(g===""){a.targetProperties.push("*")}else{l=i.getObject(`/${p}/${g}/$kind`);if(l==="NavigationProperty"){a.targetEntities.push({$NavigationPropertyPath:g})}else if(l){a.targetProperties.push(g)}else{return Promise.reject(`${g} is not a valid path to be refreshed`)}}}}return r.requestSideEffects([...a.targetEntities,...a.targetProperties],s)};o.getSelectedContexts=function e(t){let n=this._view.byId(t);if(n&&n.isA("sap.fe.macros.table.TableAPI")){n=n.getContent()}return n&&n.isA("sap.ui.mdc.Table")&&n.getSelectedContexts()||[]};o.showSideContent=function e(t,n){const s=y(t),o=this._view.byId(s),r=n===undefined?!o.getShowSideContent():n;o.setShowSideContent(r,false)};o.getBindingContext=function e(){return this._view.getBindingContext()};o._buildOPMessage=async function e(t){const n=this._view;const s=i.getResourceModel(n);let o=null;switch(t.length){case 0:break;case 1:o=t[0];break;default:const e={Error:{id:2,count:0},Warning:{id:1,count:0},Information:{id:0,count:0}};o=t.reduce((t,n)=>{const s=n.getType();t.setType(e[s].id>e[t.getType()].id?s:t.getType());e[s].count++;return t},new g({type:u.Information}));if(e.Error.count===0&&e.Warning.count===0&&e.Information.count>0){o.setMessage(s.getText("OBJECTPAGESTATE_INFORMATION"))}else if(e.Error.count>0&&e.Warning.count>0||e.Information.count>0){o.setMessage(s.getText("OBJECTPAGESTATE_ISSUE"))}else{const e=o.getType()===u.Error?"OBJECTPAGESTATE_ERROR":"OBJECTPAGESTATE_WARNING";o.setMessage(s.getText(e))}}return o};o.showMessages=async function t(n){const s=this._view;const o=s.getBindingContext("internal");try{const e=await this._buildOPMessage(n);if(e){o===null||o===void 0?void 0:o.setProperty("OPMessageStripVisibility",true);o===null||o===void 0?void 0:o.setProperty("OPMessageStripText",e.getMessage());o===null||o===void 0?void 0:o.setProperty("OPMessageStripType",e.getType());a.getInstance().announce(e.getMessage(),d.Assertive)}else{this.hideMessage()}}catch(t){e.error("Cannot display ObjectPage message")}};o.hideMessage=function e(){const t=this._view;const n=t.getBindingContext("internal");n===null||n===void 0?void 0:n.setProperty("OPMessageStripVisibility",false)};o.setRecommendations=function e(t){f.transformRecommendationsForInternalStorage(t);this._view.getModel("internal").setProperty("/recommendationsData",t)};return s}(s))||l);return E},false);
//# sourceMappingURL=ExtensionAPI.js.map