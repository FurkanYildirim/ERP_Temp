/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/ActionRuntime","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/helpers/DeleteHelper","sap/fe/core/library","sap/fe/macros/field/FieldRuntime","sap/fe/macros/table/TableHelper","sap/fe/macros/table/Utils"],function(e,t,n,o,i,s,a,r,c){"use strict";const l=s.CreationMode;const d={displayTableSettings:function(e){const t=e.getSource().getParent(),o=sap.ui.getCore().byId(`${t.getId()}-settings`);n.fireButtonPress(o)},executeConditionalActionShortcut:function(e,t){const o=t.getParent();if(e!==l.CreationRow){const t=o.getActions().reduce(function(e,t){return e.concat(t.getAction())},[]).find(function(t){return t.getId().endsWith(e)});n.fireButtonPress(t)}else{const e=o.getAggregation("creationRow");if(e&&e.getApplyEnabled()&&e.getVisible()){e.fireApply()}}},setContexts:function(t,n,i,s,a,r,c){o.lock(t);return d.setContextsAsync(t,n,i,s,a,r,c).then(()=>{e.info("Selections updated")}).catch(t=>{e.error(t)}).finally(()=>{o.unlock(t)})},setContextsAsync:async function(e,n,o,s,a,c,l){const d=c?c.split(","):[];const g=JSON.parse(s);const f=a&&a!=="undefined"&&JSON.parse(a);let u=e.getSelectedContexts();const p=[];const b=e.data("displayModePropertyBinding")==="true"&&o!=="undefined";const y=[];const C={};const h={};const x=e.getBindingContext("internal");if(!x){return}u=u.filter(function(e){return!e.isInactive()});const A=Object.assign(x.getObject()||{},{selectedContexts:u,numberOfSelectedContexts:u.length,dynamicActions:C,ibn:h,deleteEnabled:true,deletableContexts:p,unSavedContexts:[],lockedContexts:[],draftsWithNonDeletableActive:[],draftsWithDeletableActive:[],controlId:"",updatableContexts:y,semanticKeyHasDraftIndicator:x.getProperty("semanticKeyHasDraftIndicator")?x.getProperty("semanticKeyHasDraftIndicator"):undefined});for(const e of u){const t=e.getObject();for(const e in t){if(e.indexOf("#")===0){let t=e;t=t.substring(1,t.length);A.dynamicActions[t]={enabled:true};x.setProperty("",A)}}const n=l.length===0||!!e.getProperty(l);const o=!b||t.IsActiveEntity;if(n&&o){y.push(e)}}i.updateDeleteInfoForSelectedContexts(x,u);if(!e.data("enableAnalytics")){r.setIBNEnablement(x,f,u)}if(u.length>1){this.disableAction(d,C)}if(A){A["updatableContexts"]=y;A["controlId"]=e.getId();x.setProperty("",A)}return t.setActionEnablement(x,g,u,"table")},disableAction:function(e,t){e.forEach(function(e){t[e]={bEnabled:false}})},onFieldChangeInCreationRow:function(e,t){const n=a.getFieldStateOnChange(e),o=n.field,i=o.getId();const s=o.getBindingContext("internal"),r=s.getProperty("creationRowFieldValidity"),c=Object.assign({},r);c[i]=n.state;s.setProperty("creationRowFieldValidity",c);if(t){const e=s.getProperty("creationRowCustomValidity"),t=Object.assign({},e);t[o.getBinding("value").getPath()]={fieldId:o.getId()};s.setProperty("creationRowCustomValidity",t);const n=sap.ui.getCore().getMessageManager();const i=`${o.getBindingContext().getPath()}/${o.getBindingPath("value")}`;n.getMessageModel().getData().forEach(function(e){if(e.target===i){n.removeMessages(e)}})}},onTreeTableContextChanged:function(e,t){const n=e.getRowBinding();if(!n.getContext()){return}const o=n.getAggregation()??{};const i=c.getAllFilterInfo(e);o.expandTo=i.search?100:t;n.setAggregation(o)}};return d},false);
//# sourceMappingURL=TableRuntime.js.map