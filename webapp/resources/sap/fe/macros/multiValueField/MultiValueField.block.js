/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/buildingBlocks/BuildingBlockBase","sap/fe/core/buildingBlocks/BuildingBlockSupport","sap/fe/core/buildingBlocks/BuildingBlockTemplateProcessor","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyFormatters","sap/fe/core/templating/UIFormatters","sap/fe/macros/field/FieldHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/valuehelp/ValueHelpTemplating"],function(e,t,i,a,r,n,o,l,s,u,c,d,p,f){"use strict";var m,h,g,v,b,y,P,x,M,F,B,O,V,$,E,I,w;var D={};var j=p.getVisibleExpression;var k=p.getValueBinding;var z=c.getDisplayMode;var S=s.isPathInsertable;var T=s.isPathDeletable;var L=s.getRelativePaths;var C=s.getContextRelativeTargetObjectPath;var G=s.enhanceDataModelPath;var R=l.isPropertyPathExpression;var _=l.isPathAnnotationExpression;var H=l.isMultipleNavigationProperty;var N=n.or;var U=n.not;var q=n.isConstant;var A=n.ifElse;var Q=n.getExpressionFromAnnotation;var J=n.constant;var K=n.compileExpression;var W=n.and;var X=a.UI;var Y=i.xml;var Z=t.defineBuildingBlock;var ee=t.blockAttribute;function te(e,t,i,a){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(a):void 0})}function ie(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function ae(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;re(e,t)}function re(e,t){re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return re(e,t)}function ne(e,t,i,a,r){var n={};Object.keys(a).forEach(function(e){n[e]=a[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,a){return a(e,t,i)||i},n);if(r&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(r):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}function oe(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let le=(m=Z({name:"MultiValueField",namespace:"sap.fe.macros.internal"}),h=ee({type:"string"}),g=ee({type:"string"}),v=ee({type:"sap.ui.model.Context",required:true,expectedTypes:["com.sap.vocabularies.UI.v1.DataField"]}),b=ee({type:"sap.ui.model.Context",required:true,expectedTypes:["EntitySet","NavigationProperty","EntityType","Singleton"]}),y=ee({type:"string"}),P=ee({type:"string"}),x=ee({type:"object",validate:function(e){if(e.displayMode&&!["Value","Description","ValueDescription","DescriptionValue"].includes(e.displayMode)){throw new Error(`Allowed value ${e.displayMode} for displayMode does not match`)}return e}}),m(M=(F=function(e){ae(t,e);t._getMultiInputSettings=function e(i,a){var r;const{collectionPath:n,itemDataModelObjectPath:o}=t._getPathStructure(i);const l=`{path:'${n}', templateShareable: false}`;const s=`{path:'${n}', parameters: {$$ownRequest : true}, templateShareable: false}`;const u=i.targetObject;const c=R(u)?u.$target:u;const d=(r=c.annotations.Common)===null||r===void 0?void 0:r.Text;const p=L(i);const f=d?K(Q(d,p)):k(o,a,true);return{text:f,collectionBindingDisplay:l,collectionBindingEdit:s,key:k(o,a,true)}};t._getPathStructure=function e(t){var i,a;let r="";const n=(i=t.contextLocation)!==null&&i!==void 0&&i.targetEntitySet?t.contextLocation.targetEntitySet:t.startingEntitySet;const o=[];const l=((a=t.contextLocation)===null||a===void 0?void 0:a.navigationProperties)||[];for(const e of t.navigationProperties){if(t.contextLocation===undefined||!t.contextLocation.navigationProperties.some(t=>t.fullyQualifiedName===e.fullyQualifiedName)){o.push(e.name);l.push(e)}if(n.navigationPropertyBinding.hasOwnProperty(e.name)){if(H(e)){break}}}r=`${o.join("/")}`;const s=Object.assign({},t);if(s.contextLocation){s.contextLocation.navigationProperties=l}return{collectionPath:r,itemDataModelObjectPath:s}};t.computeFieldGroupIds=function e(t,i){if(!i){return""}const a=i.getSideEffectsService();const r=a.computeFieldGroupIds(t.targetEntityType.fullyQualifiedName,t.targetObject.fullyQualifiedName);const n=r.join(",");return n===""?undefined:n};function t(i,a,n){var o;o=e.call(this,i)||this;te(o,"idPrefix",B,ie(o));te(o,"vhIdPrefix",O,ie(o));te(o,"metaPath",V,ie(o));te(o,"contextPath",$,ie(o));te(o,"ariaLabelledBy",E,ie(o));te(o,"key",I,ie(o));te(o,"formatOptions",w,ie(o));let l=r.getInvolvedDataModelObjects(o.metaPath,o.contextPath);const s=r.convertMetaModelContext(o.metaPath);let u;if(_(s.Value)){u=s.Value.path}o.visible=j(l,o.formatOptions);if(u&&u.length>0){l=G(l,u)}const c=S(l);const d=T(l,{ignoreTargetCollection:true,authorizeUnresolvable:true});const p=T(l);const f=A(d._type==="Unresolvable",N(U(q(p)),p),p);o.editMode=o.formatOptions.displayOnly==="true"?"Display":K(A(W(c,f,X.IsEditable),J("Editable"),J("Display")));o.displayMode=z(l);const m=t._getMultiInputSettings(l,o.formatOptions);o.text=m.text;o.collection=o.editMode==="Display"?m.collectionBindingDisplay:m.collectionBindingEdit;o.key=m.key;o.fieldGroupIds=t.computeFieldGroupIds(l,n.appComponent);return o}D=t;var i=t.prototype;i.getTemplate=function e(){const t=r.getInvolvedDataModelObjects(this.metaPath,this.contextPath);const i=t.targetObject;const a=G(t,i.Value.path);const n=this.idPrefix?o.generate([this.idPrefix,"MultiValueField"]):undefined;const l=d.valueHelpProperty(this.metaPath);const s=this.metaPath.getModel().createBindingContext(l,this.metaPath);const c=f.generateID(undefined,this.vhIdPrefix,u.getRelativePropertyPath(s,{context:this.contextPath}),C(a)??"");const p=d.computeLabelText(i.Value,{context:this.metaPath});const m=`MVFieldRuntime.handleChange($controller, $event)`;const h=`MVFieldRuntime.onValidateFieldGroup($controller, $event)`;return Y`
		<mdc:MultiValueField
				xmlns:mdc="sap.ui.mdc"
				core:require="{MVFieldRuntime:'sap/fe/macros/multiValueField/MultiValueFieldRuntime'}"
				delegate="{name: 'sap/fe/macros/multiValueField/MultiValueFieldDelegate'}"
				id="${n}"
				items="${this.collection}"
				display="${this.displayMode}"
				width="100%"
				editMode="${this.editMode}"
				fieldHelp="${c}"
				ariaLabelledBy = "${this.ariaLabelledBy}"
				showEmptyIndicator = "${this.formatOptions.showEmptyIndicator}"
				label = "${p}"
				change="${m}"
				fieldGroupIds="${this.fieldGroupIds}"
				validateFieldGroup="${h}"
		>
		<mdcField:MultiValueFieldItem xmlns:mdcField="sap.ui.mdc.field" key="${this.key}" description="${this.text}" />
		</mdc:MultiValueField>`};return t}(e),B=ne(F.prototype,"idPrefix",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),O=ne(F.prototype,"vhIdPrefix",[g],{configurable:true,enumerable:true,writable:true,initializer:function(){return"FieldValueHelp"}}),V=ne(F.prototype,"metaPath",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),$=ne(F.prototype,"contextPath",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),E=ne(F.prototype,"ariaLabelledBy",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),I=ne(F.prototype,"key",[P],{configurable:true,enumerable:true,writable:true,initializer:null}),w=ne(F.prototype,"formatOptions",[x],{configurable:true,enumerable:true,writable:true,initializer:function(){return{}}}),F))||M);D=le;return D},false);
//# sourceMappingURL=MultiValueField.block.js.map