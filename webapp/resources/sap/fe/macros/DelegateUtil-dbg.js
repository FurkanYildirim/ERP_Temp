/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/templating/PropertyFormatters", "sap/fe/macros/field/FieldHelper", "sap/fe/macros/internal/valuehelp/ValueHelpTemplating"], function (Log, CommonUtils, StableIdHelper, PropertyFormatters, FieldHelper, ValueHelpTemplating) {
  "use strict";

  var generateID = ValueHelpTemplating.generateID;
  var getRelativePropertyPath = PropertyFormatters.getRelativePropertyPath;
  var generate = StableIdHelper.generate;
  const NS_MACRODATA = "http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1";
  function _retrieveModel() {
    this.control.detachModelContextChange(_retrieveModel, this);
    const sModelName = this.modelName,
      oModel = this.control.getModel(sModelName);
    if (oModel) {
      this.resolve(oModel);
    } else {
      this.control.attachModelContextChange(_retrieveModel, this);
    }
  }
  async function getCustomDataWithModifier(oControl, sProperty, oModifier) {
    const aCustomData = [];
    const aRetrievedCustomData = await Promise.resolve().then(oModifier.getAggregation.bind(oModifier, oControl, "customData"));
    const oPromise = aRetrievedCustomData.reduce((oPreviousPromise, oCustomData) => {
      return oPreviousPromise.then(oModifier.getProperty.bind(oModifier, oCustomData, "key")).then(function (sKey) {
        if (sKey === sProperty) {
          aCustomData.push(oCustomData);
        }
      });
    }, Promise.resolve());
    await oPromise;
    if (aCustomData.length === 1) {
      return oModifier.getProperty(aCustomData[0], "value");
    } else {
      return undefined;
    }
  }
  const FETCHED_PROPERTIES_DATA_KEY = "sap_fe_ControlDelegate_propertyInfoMap";
  const DelegateUtil = {
    setCachedProperties(control, fetchedProperties) {
      // do not cache during templating, else it becomes part of the cached view
      if (control instanceof window.Element) {
        return;
      }
      const key = FETCHED_PROPERTIES_DATA_KEY;
      DelegateUtil.setCustomData(control, key, fetchedProperties);
    },
    getCachedProperties(control) {
      // properties are not cached during templating
      if (control instanceof window.Element) {
        return null;
      }
      const key = FETCHED_PROPERTIES_DATA_KEY;
      return DelegateUtil.getCustomData(control, key);
    },
    getCustomData(oControl, sProperty, oModifier) {
      // If Modifier is given, the method must execute asynchronously and return a Promise
      if (oModifier) {
        return getCustomDataWithModifier(oControl, sProperty, oModifier);
      } else {
        // Delegate invoked from a non-flex change - FilterBarDelegate._addP13nItem for OP table filtering, FilterBarDelegate.fetchProperties etc.
        if (oControl && sProperty) {
          if (oControl instanceof window.Element) {
            return oControl.getAttributeNS(NS_MACRODATA, sProperty);
          }
          if (oControl.data instanceof Function) {
            return oControl.data(sProperty);
          }
        }
        return undefined;
      }
    },
    setCustomData(oControl, sProperty, vValue) {
      if (oControl && sProperty) {
        if (oControl instanceof window.Element) {
          return oControl.setAttributeNS(NS_MACRODATA, `customData:${sProperty}`, vValue);
        }
        if (oControl.data instanceof Function) {
          return oControl.data(sProperty, vValue);
        }
      }
    },
    fetchPropertiesForEntity(sEntitySet, oMetaModel) {
      return oMetaModel.requestObject(`${sEntitySet}/`);
    },
    fetchAnnotationsForEntity(sEntitySet, oMetaModel) {
      return oMetaModel.requestObject(`${sEntitySet}@`);
    },
    fetchModel(oControl) {
      return new Promise(resolve => {
        const sModelName = oControl.getDelegate().payload && oControl.getDelegate().payload.modelName,
          oContext = {
            modelName: sModelName,
            control: oControl,
            resolve: resolve
          };
        _retrieveModel.call(oContext);
      });
    },
    templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions, oModifier) {
      return CommonUtils.templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions, oModifier);
    },
    doesValueHelpExist(mParameters) {
      const sPropertyName = mParameters.sPropertyName || "";
      const sValueHelpType = mParameters.sValueHelpType || "";
      const oMetaModel = mParameters.oMetaModel;
      const oModifier = mParameters.oModifier;
      const sOriginalProperty = `${mParameters.sBindingPath}/${sPropertyName}`;
      const oPropertyContext = oMetaModel.createBindingContext(sOriginalProperty);
      let sValueHelpProperty = FieldHelper.valueHelpProperty(oPropertyContext);
      const bIsAbsolute = mParameters.sBindingPath && mParameters.sBindingPath.indexOf("/") === 0;

      // unit/currency
      if (sValueHelpProperty.indexOf("$Path") > -1) {
        sValueHelpProperty = oMetaModel.getObject(sValueHelpProperty);
      }
      if (bIsAbsolute && sValueHelpProperty.indexOf("/") !== 0) {
        sValueHelpProperty = `${mParameters.sBindingPath}/${sValueHelpProperty}`;
      }
      const sGeneratedId = generateID(mParameters.flexId, generate([oModifier ? oModifier.getId(mParameters.oControl) : mParameters.oControl.getId(), sValueHelpType]), getRelativePropertyPath(oPropertyContext.getProperty(sOriginalProperty), {
        context: {
          getModel: () => {
            return mParameters.oMetaModel;
          },
          getPath: () => {
            return sOriginalProperty;
          }
        }
      }), getRelativePropertyPath(oPropertyContext.getProperty(sValueHelpProperty), {
        context: {
          getModel: () => {
            return mParameters.oMetaModel;
          },
          getPath: () => {
            return sValueHelpProperty;
          }
        }
      }));
      return Promise.resolve().then(function () {
        if (oModifier) {
          return oModifier.getAggregation(mParameters.oControl, "dependents");
        }
        return mParameters.oControl.getAggregation("dependents");
      }).then(function (aDependents) {
        return Promise.resolve(aDependents && aDependents.some(function (oDependent) {
          return oModifier ? oModifier.getId(oDependent) === sGeneratedId : oDependent.getId() === sGeneratedId;
        }));
      });
    },
    isValueHelpRequired(mParameters, bInFilterField) {
      const sPropertyName = mParameters.sPropertyName || "",
        oMetaModel = mParameters.oMetaModel,
        sProperty = `${mParameters.sBindingPath}/${sPropertyName}`,
        oPropertyContext = oMetaModel.createBindingContext(sProperty),
        sValueHelpProperty = FieldHelper.valueHelpProperty(oPropertyContext, bInFilterField);
      return this.getCustomData(mParameters.oControl, "displayModePropertyBinding", mParameters.oModifier).then(function (bReadOnly) {
        // Check whether the control is read-only. If yes, no need of a value help.
        bReadOnly = typeof bReadOnly === "boolean" ? bReadOnly : bReadOnly === "true";
        if (bReadOnly) {
          return false;
        }
        // Else, check whether Value Help relevant annotation exists for the property.
        // TODO use PropertyFormatter.hasValueHelp () => if doing so, QUnit tests fail due to mocked model implementation
        return Promise.all([oMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListWithFixedValues`), oMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListReferences`), oMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListMapping`), oMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueList`)]);
      }).then(function (aResults) {
        return !!aResults[0] || !!aResults[1] || !!aResults[2] || !!aResults[3];
      }).catch(function (oError) {
        Log.warning("Error while retrieving custom data / value list annotation values", oError);
      });
    },
    isMultiValue(oProperty) {
      let bIsMultiValue = true;
      //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
      switch (oProperty.filterExpression) {
        case "SearchExpression":
        case "SingleRange":
        case "SingleValue":
          bIsMultiValue = false;
          break;
        default:
          break;
      }
      if (oProperty.type && oProperty.type.indexOf("Boolean") > 0) {
        bIsMultiValue = false;
      }
      return bIsMultiValue;
    }
  };
  return DelegateUtil;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOU19NQUNST0RBVEEiLCJfcmV0cmlldmVNb2RlbCIsImNvbnRyb2wiLCJkZXRhY2hNb2RlbENvbnRleHRDaGFuZ2UiLCJzTW9kZWxOYW1lIiwibW9kZWxOYW1lIiwib01vZGVsIiwiZ2V0TW9kZWwiLCJyZXNvbHZlIiwiYXR0YWNoTW9kZWxDb250ZXh0Q2hhbmdlIiwiZ2V0Q3VzdG9tRGF0YVdpdGhNb2RpZmllciIsIm9Db250cm9sIiwic1Byb3BlcnR5Iiwib01vZGlmaWVyIiwiYUN1c3RvbURhdGEiLCJhUmV0cmlldmVkQ3VzdG9tRGF0YSIsIlByb21pc2UiLCJ0aGVuIiwiZ2V0QWdncmVnYXRpb24iLCJiaW5kIiwib1Byb21pc2UiLCJyZWR1Y2UiLCJvUHJldmlvdXNQcm9taXNlIiwib0N1c3RvbURhdGEiLCJnZXRQcm9wZXJ0eSIsInNLZXkiLCJwdXNoIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiRkVUQ0hFRF9QUk9QRVJUSUVTX0RBVEFfS0VZIiwiRGVsZWdhdGVVdGlsIiwic2V0Q2FjaGVkUHJvcGVydGllcyIsImZldGNoZWRQcm9wZXJ0aWVzIiwid2luZG93IiwiRWxlbWVudCIsImtleSIsInNldEN1c3RvbURhdGEiLCJnZXRDYWNoZWRQcm9wZXJ0aWVzIiwiZ2V0Q3VzdG9tRGF0YSIsImdldEF0dHJpYnV0ZU5TIiwiZGF0YSIsIkZ1bmN0aW9uIiwidlZhbHVlIiwic2V0QXR0cmlidXRlTlMiLCJmZXRjaFByb3BlcnRpZXNGb3JFbnRpdHkiLCJzRW50aXR5U2V0Iiwib01ldGFNb2RlbCIsInJlcXVlc3RPYmplY3QiLCJmZXRjaEFubm90YXRpb25zRm9yRW50aXR5IiwiZmV0Y2hNb2RlbCIsImdldERlbGVnYXRlIiwicGF5bG9hZCIsIm9Db250ZXh0IiwiY2FsbCIsInRlbXBsYXRlQ29udHJvbEZyYWdtZW50Iiwic0ZyYWdtZW50TmFtZSIsIm9QcmVwcm9jZXNzb3JTZXR0aW5ncyIsIm9PcHRpb25zIiwiQ29tbW9uVXRpbHMiLCJkb2VzVmFsdWVIZWxwRXhpc3QiLCJtUGFyYW1ldGVycyIsInNQcm9wZXJ0eU5hbWUiLCJzVmFsdWVIZWxwVHlwZSIsInNPcmlnaW5hbFByb3BlcnR5Iiwic0JpbmRpbmdQYXRoIiwib1Byb3BlcnR5Q29udGV4dCIsImNyZWF0ZUJpbmRpbmdDb250ZXh0Iiwic1ZhbHVlSGVscFByb3BlcnR5IiwiRmllbGRIZWxwZXIiLCJ2YWx1ZUhlbHBQcm9wZXJ0eSIsImJJc0Fic29sdXRlIiwiaW5kZXhPZiIsImdldE9iamVjdCIsInNHZW5lcmF0ZWRJZCIsImdlbmVyYXRlSUQiLCJmbGV4SWQiLCJnZW5lcmF0ZSIsImdldElkIiwiZ2V0UmVsYXRpdmVQcm9wZXJ0eVBhdGgiLCJjb250ZXh0IiwiZ2V0UGF0aCIsImFEZXBlbmRlbnRzIiwic29tZSIsIm9EZXBlbmRlbnQiLCJpc1ZhbHVlSGVscFJlcXVpcmVkIiwiYkluRmlsdGVyRmllbGQiLCJiUmVhZE9ubHkiLCJhbGwiLCJhUmVzdWx0cyIsImNhdGNoIiwib0Vycm9yIiwiTG9nIiwid2FybmluZyIsImlzTXVsdGlWYWx1ZSIsIm9Qcm9wZXJ0eSIsImJJc011bHRpVmFsdWUiLCJmaWx0ZXJFeHByZXNzaW9uIiwidHlwZSJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiRGVsZWdhdGVVdGlsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IENvbW1vblV0aWxzIGZyb20gXCJzYXAvZmUvY29yZS9Db21tb25VdGlsc1wiO1xuaW1wb3J0IHtcblx0Y29sdW1uRXhwb3J0U2V0dGluZ3MsXG5cdEN1c3RvbUJhc2VkVGFibGVDb2x1bW4sXG5cdEV4dGVuc2lvbkZvckFuYWx5dGljcyxcblx0UHJvcGVydHlUeXBlQ29uZmlnLFxuXHRWaXN1YWxTZXR0aW5nc1xufSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy9jb250cm9scy9Db21tb24vVGFibGVcIjtcbmltcG9ydCB7IEN1c3RvbUVsZW1lbnQgfSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy9oZWxwZXJzL0NvbmZpZ3VyYWJsZU9iamVjdFwiO1xuaW1wb3J0IHsgZ2VuZXJhdGUgfSBmcm9tIFwic2FwL2ZlL2NvcmUvaGVscGVycy9TdGFibGVJZEhlbHBlclwiO1xuaW1wb3J0IHsgRGlzcGxheU1vZGUgfSBmcm9tIFwic2FwL2ZlL2NvcmUvdGVtcGxhdGluZy9EaXNwbGF5TW9kZUZvcm1hdHRlclwiO1xuaW1wb3J0IHsgZ2V0UmVsYXRpdmVQcm9wZXJ0eVBhdGggfSBmcm9tIFwic2FwL2ZlL2NvcmUvdGVtcGxhdGluZy9Qcm9wZXJ0eUZvcm1hdHRlcnNcIjtcbmltcG9ydCBGaWVsZEhlbHBlciBmcm9tIFwic2FwL2ZlL21hY3Jvcy9maWVsZC9GaWVsZEhlbHBlclwiO1xuaW1wb3J0IHsgZ2VuZXJhdGVJRCB9IGZyb20gXCJzYXAvZmUvbWFjcm9zL2ludGVybmFsL3ZhbHVlaGVscC9WYWx1ZUhlbHBUZW1wbGF0aW5nXCI7XG5pbXBvcnQgTW9kZWwgZnJvbSBcInNhcC91aS9tb2RlbC9Nb2RlbFwiO1xuXG5jb25zdCBOU19NQUNST0RBVEEgPSBcImh0dHA6Ly9zY2hlbWFzLnNhcC5jb20vc2FwdWk1L2V4dGVuc2lvbi9zYXAudWkuY29yZS5DdXN0b21EYXRhLzFcIjtcblxuZXhwb3J0IHR5cGUgdGFibGVEZWxlZ2F0ZU1vZGVsID0ge1xuXHRlbmFibGVBdXRvQ29sdW1uV2lkdGg6IGJvb2xlYW47XG5cdGlzT3B0aW1pemVkRm9yU21hbGxEZXZpY2U6IGJvb2xlYW47XG5cdHJlYWRPbmx5OiBib29sZWFuO1xuXHRjb2x1bW5FZGl0TW9kZTogc3RyaW5nO1xuXHR0YWJsZVR5cGU6IHN0cmluZztcblx0b25DaGFuZ2U6IEZ1bmN0aW9uO1xuXHRpZDogc3RyaW5nO1xuXHRuYXZpZ2F0aW9uUHJvcGVydHlQYXRoOiBzdHJpbmc7XG5cdGNvbHVtbkluZm86IEN1c3RvbUVsZW1lbnQ8Q3VzdG9tQmFzZWRUYWJsZUNvbHVtbj47XG5cdGNvbGxlY3Rpb246IHtcblx0XHRzUGF0aDogc3RyaW5nO1xuXHRcdG9Nb2RlbDogc3RyaW5nO1xuXHR9O1xufTtcblxuZXhwb3J0IHR5cGUgUHJvcGVydHlJbmZvID0ge1xuXHRhZGRpdGlvbmFsTGFiZWxzPzogc3RyaW5nW107XG5cdGNhc2VTZW5zaXRpdmU/OiBib29sZWFuO1xuXHRkZXNjcmlwdGlvbj86IHN0cmluZztcblx0ZGVzY3JpcHRpb25Qcm9wZXJ0eT86IHN0cmluZztcblx0ZXhwb3J0U2V0dGluZ3M/OiBjb2x1bW5FeHBvcnRTZXR0aW5ncyB8IG51bGw7XG5cdGZpbHRlcmFibGU/OiBib29sZWFuO1xuXHRncm91cD86IHN0cmluZztcblx0Z3JvdXBhYmxlPzogYm9vbGVhbjtcblx0Z3JvdXBMYWJlbD86IHN0cmluZztcblx0a2V5PzogYm9vbGVhbjtcblx0bGFiZWw/OiBzdHJpbmc7XG5cdG1heENvbmRpdGlvbnM/OiBudW1iZXI7XG5cdG1ldGFkYXRhUGF0aD86IHN0cmluZztcblx0bW9kZT86IERpc3BsYXlNb2RlO1xuXHRuYW1lOiBzdHJpbmc7XG5cdHBhdGg/OiBzdHJpbmc7XG5cdHByb3BlcnR5SW5mb3M/OiBzdHJpbmdbXTtcblx0cmVsYXRpdmVQYXRoPzogc3RyaW5nO1xuXHRzb3J0YWJsZT86IGJvb2xlYW47XG5cdHNvcnREaXJlY3Rpb24/OiBzdHJpbmc7XG5cdHRleHQ/OiBzdHJpbmc7XG5cdHRvb2x0aXA/OiBzdHJpbmc7XG5cdHR5cGVDb25maWc/OiBQcm9wZXJ0eVR5cGVDb25maWc7XG5cdHR5cGU/OiBzdHJpbmc7XG5cdHVuaXQ/OiBzdHJpbmc7XG5cdHZhbHVlUHJvcGVydHk/OiBzdHJpbmc7XG5cdHZpc2libGU6IGJvb2xlYW47XG5cdHZpc3VhbFNldHRpbmdzPzogVmlzdWFsU2V0dGluZ3M7XG5cdGV4cG9ydERhdGFQb2ludFRhcmdldFZhbHVlPzogc3RyaW5nO1xuXHRpc1BhcmFtZXRlcj86IGJvb2xlYW47XG5cdGFnZ3JlZ2F0YWJsZT86IGJvb2xlYW47XG5cdGV4dGVuc2lvbj86IEV4dGVuc2lvbkZvckFuYWx5dGljcztcbn07XG5cbmZ1bmN0aW9uIF9yZXRyaWV2ZU1vZGVsKHRoaXM6IHsgbW9kZWxOYW1lOiBzdHJpbmc7IGNvbnRyb2w6IGFueTsgcmVzb2x2ZTogRnVuY3Rpb24gfSkge1xuXHR0aGlzLmNvbnRyb2wuZGV0YWNoTW9kZWxDb250ZXh0Q2hhbmdlKF9yZXRyaWV2ZU1vZGVsLCB0aGlzKTtcblx0Y29uc3Qgc01vZGVsTmFtZSA9IHRoaXMubW9kZWxOYW1lLFxuXHRcdG9Nb2RlbCA9IHRoaXMuY29udHJvbC5nZXRNb2RlbChzTW9kZWxOYW1lKTtcblxuXHRpZiAob01vZGVsKSB7XG5cdFx0dGhpcy5yZXNvbHZlKG9Nb2RlbCk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5jb250cm9sLmF0dGFjaE1vZGVsQ29udGV4dENoYW5nZShfcmV0cmlldmVNb2RlbCwgdGhpcyk7XG5cdH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGdldEN1c3RvbURhdGFXaXRoTW9kaWZpZXIob0NvbnRyb2w6IGFueSwgc1Byb3BlcnR5OiBhbnksIG9Nb2RpZmllcjogYW55KSB7XG5cdGNvbnN0IGFDdXN0b21EYXRhOiBhbnlbXSA9IFtdO1xuXG5cdGNvbnN0IGFSZXRyaWV2ZWRDdXN0b21EYXRhID0gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihcblx0XHRvTW9kaWZpZXIuZ2V0QWdncmVnYXRpb24uYmluZChvTW9kaWZpZXIsIG9Db250cm9sLCBcImN1c3RvbURhdGFcIikgYXMgKCkgPT4gYW55W11cblx0KTtcblxuXHRjb25zdCBvUHJvbWlzZSA9IGFSZXRyaWV2ZWRDdXN0b21EYXRhLnJlZHVjZSgob1ByZXZpb3VzUHJvbWlzZTogUHJvbWlzZTx2b2lkPiwgb0N1c3RvbURhdGEpID0+IHtcblx0XHRyZXR1cm4gb1ByZXZpb3VzUHJvbWlzZS50aGVuKG9Nb2RpZmllci5nZXRQcm9wZXJ0eS5iaW5kKG9Nb2RpZmllciwgb0N1c3RvbURhdGEsIFwia2V5XCIpKS50aGVuKGZ1bmN0aW9uIChzS2V5OiBhbnkpIHtcblx0XHRcdGlmIChzS2V5ID09PSBzUHJvcGVydHkpIHtcblx0XHRcdFx0YUN1c3RvbURhdGEucHVzaChvQ3VzdG9tRGF0YSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sIFByb21pc2UucmVzb2x2ZSgpKTtcblx0YXdhaXQgb1Byb21pc2U7XG5cblx0aWYgKGFDdXN0b21EYXRhLmxlbmd0aCA9PT0gMSkge1xuXHRcdHJldHVybiBvTW9kaWZpZXIuZ2V0UHJvcGVydHkoYUN1c3RvbURhdGFbMF0sIFwidmFsdWVcIik7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0fVxufVxuY29uc3QgRkVUQ0hFRF9QUk9QRVJUSUVTX0RBVEFfS0VZID0gXCJzYXBfZmVfQ29udHJvbERlbGVnYXRlX3Byb3BlcnR5SW5mb01hcFwiO1xuXG5jb25zdCBEZWxlZ2F0ZVV0aWwgPSB7XG5cdHNldENhY2hlZFByb3BlcnRpZXMoY29udHJvbDogYW55LCBmZXRjaGVkUHJvcGVydGllczogUHJvcGVydHlJbmZvW10pIHtcblx0XHQvLyBkbyBub3QgY2FjaGUgZHVyaW5nIHRlbXBsYXRpbmcsIGVsc2UgaXQgYmVjb21lcyBwYXJ0IG9mIHRoZSBjYWNoZWQgdmlld1xuXHRcdGlmIChjb250cm9sIGluc3RhbmNlb2Ygd2luZG93LkVsZW1lbnQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Y29uc3Qga2V5ID0gRkVUQ0hFRF9QUk9QRVJUSUVTX0RBVEFfS0VZO1xuXHRcdERlbGVnYXRlVXRpbC5zZXRDdXN0b21EYXRhKGNvbnRyb2wsIGtleSwgZmV0Y2hlZFByb3BlcnRpZXMpO1xuXHR9LFxuXHRnZXRDYWNoZWRQcm9wZXJ0aWVzKGNvbnRyb2w6IGFueSk6IFByb3BlcnR5SW5mb1tdIHwgbnVsbCB7XG5cdFx0Ly8gcHJvcGVydGllcyBhcmUgbm90IGNhY2hlZCBkdXJpbmcgdGVtcGxhdGluZ1xuXHRcdGlmIChjb250cm9sIGluc3RhbmNlb2Ygd2luZG93LkVsZW1lbnQpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRjb25zdCBrZXkgPSBGRVRDSEVEX1BST1BFUlRJRVNfREFUQV9LRVk7XG5cdFx0cmV0dXJuIERlbGVnYXRlVXRpbC5nZXRDdXN0b21EYXRhKGNvbnRyb2wsIGtleSk7XG5cdH0sXG5cblx0Z2V0Q3VzdG9tRGF0YShvQ29udHJvbDogYW55LCBzUHJvcGVydHk6IGFueSwgb01vZGlmaWVyPzogYW55KSB7XG5cdFx0Ly8gSWYgTW9kaWZpZXIgaXMgZ2l2ZW4sIHRoZSBtZXRob2QgbXVzdCBleGVjdXRlIGFzeW5jaHJvbm91c2x5IGFuZCByZXR1cm4gYSBQcm9taXNlXG5cdFx0aWYgKG9Nb2RpZmllcikge1xuXHRcdFx0cmV0dXJuIGdldEN1c3RvbURhdGFXaXRoTW9kaWZpZXIob0NvbnRyb2wsIHNQcm9wZXJ0eSwgb01vZGlmaWVyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRGVsZWdhdGUgaW52b2tlZCBmcm9tIGEgbm9uLWZsZXggY2hhbmdlIC0gRmlsdGVyQmFyRGVsZWdhdGUuX2FkZFAxM25JdGVtIGZvciBPUCB0YWJsZSBmaWx0ZXJpbmcsIEZpbHRlckJhckRlbGVnYXRlLmZldGNoUHJvcGVydGllcyBldGMuXG5cdFx0XHRpZiAob0NvbnRyb2wgJiYgc1Byb3BlcnR5KSB7XG5cdFx0XHRcdGlmIChvQ29udHJvbCBpbnN0YW5jZW9mIHdpbmRvdy5FbGVtZW50KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9Db250cm9sLmdldEF0dHJpYnV0ZU5TKE5TX01BQ1JPREFUQSwgc1Byb3BlcnR5KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAob0NvbnRyb2wuZGF0YSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9Db250cm9sLmRhdGEoc1Byb3BlcnR5KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0XHR9XG5cdH0sXG5cdHNldEN1c3RvbURhdGEob0NvbnRyb2w6IGFueSwgc1Byb3BlcnR5OiBhbnksIHZWYWx1ZTogYW55KSB7XG5cdFx0aWYgKG9Db250cm9sICYmIHNQcm9wZXJ0eSkge1xuXHRcdFx0aWYgKG9Db250cm9sIGluc3RhbmNlb2Ygd2luZG93LkVsZW1lbnQpIHtcblx0XHRcdFx0cmV0dXJuIG9Db250cm9sLnNldEF0dHJpYnV0ZU5TKE5TX01BQ1JPREFUQSwgYGN1c3RvbURhdGE6JHtzUHJvcGVydHl9YCwgdlZhbHVlKTtcblx0XHRcdH1cblx0XHRcdGlmIChvQ29udHJvbC5kYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcblx0XHRcdFx0cmV0dXJuIG9Db250cm9sLmRhdGEoc1Byb3BlcnR5LCB2VmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0ZmV0Y2hQcm9wZXJ0aWVzRm9yRW50aXR5KHNFbnRpdHlTZXQ6IGFueSwgb01ldGFNb2RlbDogYW55KSB7XG5cdFx0cmV0dXJuIG9NZXRhTW9kZWwucmVxdWVzdE9iamVjdChgJHtzRW50aXR5U2V0fS9gKTtcblx0fSxcblx0ZmV0Y2hBbm5vdGF0aW9uc0ZvckVudGl0eShzRW50aXR5U2V0OiBhbnksIG9NZXRhTW9kZWw6IGFueSkge1xuXHRcdHJldHVybiBvTWV0YU1vZGVsLnJlcXVlc3RPYmplY3QoYCR7c0VudGl0eVNldH1AYCk7XG5cdH0sXG5cdGZldGNoTW9kZWwob0NvbnRyb2w6IGFueSk6IFByb21pc2U8TW9kZWw+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdGNvbnN0IHNNb2RlbE5hbWUgPSBvQ29udHJvbC5nZXREZWxlZ2F0ZSgpLnBheWxvYWQgJiYgb0NvbnRyb2wuZ2V0RGVsZWdhdGUoKS5wYXlsb2FkLm1vZGVsTmFtZSxcblx0XHRcdFx0b0NvbnRleHQgPSB7IG1vZGVsTmFtZTogc01vZGVsTmFtZSwgY29udHJvbDogb0NvbnRyb2wsIHJlc29sdmU6IHJlc29sdmUgfTtcblx0XHRcdF9yZXRyaWV2ZU1vZGVsLmNhbGwob0NvbnRleHQpO1xuXHRcdH0pO1xuXHR9LFxuXHR0ZW1wbGF0ZUNvbnRyb2xGcmFnbWVudChzRnJhZ21lbnROYW1lOiBhbnksIG9QcmVwcm9jZXNzb3JTZXR0aW5nczogYW55LCBvT3B0aW9uczogYW55LCBvTW9kaWZpZXI/OiBhbnkpIHtcblx0XHRyZXR1cm4gQ29tbW9uVXRpbHMudGVtcGxhdGVDb250cm9sRnJhZ21lbnQoc0ZyYWdtZW50TmFtZSwgb1ByZXByb2Nlc3NvclNldHRpbmdzLCBvT3B0aW9ucywgb01vZGlmaWVyKTtcblx0fSxcblx0ZG9lc1ZhbHVlSGVscEV4aXN0KG1QYXJhbWV0ZXJzOiBhbnkpIHtcblx0XHRjb25zdCBzUHJvcGVydHlOYW1lID0gbVBhcmFtZXRlcnMuc1Byb3BlcnR5TmFtZSB8fCBcIlwiO1xuXHRcdGNvbnN0IHNWYWx1ZUhlbHBUeXBlID0gbVBhcmFtZXRlcnMuc1ZhbHVlSGVscFR5cGUgfHwgXCJcIjtcblx0XHRjb25zdCBvTWV0YU1vZGVsID0gbVBhcmFtZXRlcnMub01ldGFNb2RlbDtcblx0XHRjb25zdCBvTW9kaWZpZXIgPSBtUGFyYW1ldGVycy5vTW9kaWZpZXI7XG5cdFx0Y29uc3Qgc09yaWdpbmFsUHJvcGVydHkgPSBgJHttUGFyYW1ldGVycy5zQmluZGluZ1BhdGh9LyR7c1Byb3BlcnR5TmFtZX1gO1xuXHRcdGNvbnN0IG9Qcm9wZXJ0eUNvbnRleHQgPSBvTWV0YU1vZGVsLmNyZWF0ZUJpbmRpbmdDb250ZXh0KHNPcmlnaW5hbFByb3BlcnR5KTtcblx0XHRsZXQgc1ZhbHVlSGVscFByb3BlcnR5ID0gRmllbGRIZWxwZXIudmFsdWVIZWxwUHJvcGVydHkob1Byb3BlcnR5Q29udGV4dCk7XG5cdFx0Y29uc3QgYklzQWJzb2x1dGUgPSBtUGFyYW1ldGVycy5zQmluZGluZ1BhdGggJiYgbVBhcmFtZXRlcnMuc0JpbmRpbmdQYXRoLmluZGV4T2YoXCIvXCIpID09PSAwO1xuXG5cdFx0Ly8gdW5pdC9jdXJyZW5jeVxuXHRcdGlmIChzVmFsdWVIZWxwUHJvcGVydHkuaW5kZXhPZihcIiRQYXRoXCIpID4gLTEpIHtcblx0XHRcdHNWYWx1ZUhlbHBQcm9wZXJ0eSA9IG9NZXRhTW9kZWwuZ2V0T2JqZWN0KHNWYWx1ZUhlbHBQcm9wZXJ0eSk7XG5cdFx0fVxuXHRcdGlmIChiSXNBYnNvbHV0ZSAmJiBzVmFsdWVIZWxwUHJvcGVydHkuaW5kZXhPZihcIi9cIikgIT09IDApIHtcblx0XHRcdHNWYWx1ZUhlbHBQcm9wZXJ0eSA9IGAke21QYXJhbWV0ZXJzLnNCaW5kaW5nUGF0aH0vJHtzVmFsdWVIZWxwUHJvcGVydHl9YDtcblx0XHR9XG5cblx0XHRjb25zdCBzR2VuZXJhdGVkSWQgPSBnZW5lcmF0ZUlEKFxuXHRcdFx0bVBhcmFtZXRlcnMuZmxleElkLFxuXHRcdFx0Z2VuZXJhdGUoW29Nb2RpZmllciA/IG9Nb2RpZmllci5nZXRJZChtUGFyYW1ldGVycy5vQ29udHJvbCkgOiBtUGFyYW1ldGVycy5vQ29udHJvbC5nZXRJZCgpLCBzVmFsdWVIZWxwVHlwZV0pLFxuXHRcdFx0Z2V0UmVsYXRpdmVQcm9wZXJ0eVBhdGgob1Byb3BlcnR5Q29udGV4dC5nZXRQcm9wZXJ0eShzT3JpZ2luYWxQcm9wZXJ0eSksIHtcblx0XHRcdFx0Y29udGV4dDoge1xuXHRcdFx0XHRcdGdldE1vZGVsOiAoKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbVBhcmFtZXRlcnMub01ldGFNb2RlbDtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldFBhdGg6ICgpID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiBzT3JpZ2luYWxQcm9wZXJ0eTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gYXMgYW55XG5cdFx0XHR9KSxcblx0XHRcdGdldFJlbGF0aXZlUHJvcGVydHlQYXRoKG9Qcm9wZXJ0eUNvbnRleHQuZ2V0UHJvcGVydHkoc1ZhbHVlSGVscFByb3BlcnR5KSwge1xuXHRcdFx0XHRjb250ZXh0OiB7XG5cdFx0XHRcdFx0Z2V0TW9kZWw6ICgpID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiBtUGFyYW1ldGVycy5vTWV0YU1vZGVsO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0UGF0aDogKCkgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHNWYWx1ZUhlbHBQcm9wZXJ0eTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gYXMgYW55XG5cdFx0XHR9KVxuXHRcdCk7XG5cblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcblx0XHRcdC50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0aWYgKG9Nb2RpZmllcikge1xuXHRcdFx0XHRcdHJldHVybiBvTW9kaWZpZXIuZ2V0QWdncmVnYXRpb24obVBhcmFtZXRlcnMub0NvbnRyb2wsIFwiZGVwZW5kZW50c1wiKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbVBhcmFtZXRlcnMub0NvbnRyb2wuZ2V0QWdncmVnYXRpb24oXCJkZXBlbmRlbnRzXCIpO1xuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChhRGVwZW5kZW50czogYW55KSB7XG5cdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoXG5cdFx0XHRcdFx0YURlcGVuZGVudHMgJiZcblx0XHRcdFx0XHRcdGFEZXBlbmRlbnRzLnNvbWUoZnVuY3Rpb24gKG9EZXBlbmRlbnQ6IGFueSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gb01vZGlmaWVyID8gb01vZGlmaWVyLmdldElkKG9EZXBlbmRlbnQpID09PSBzR2VuZXJhdGVkSWQgOiBvRGVwZW5kZW50LmdldElkKCkgPT09IHNHZW5lcmF0ZWRJZDtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblx0fSxcblx0aXNWYWx1ZUhlbHBSZXF1aXJlZChtUGFyYW1ldGVyczogYW55LCBiSW5GaWx0ZXJGaWVsZD86IGJvb2xlYW4pIHtcblx0XHRjb25zdCBzUHJvcGVydHlOYW1lID0gbVBhcmFtZXRlcnMuc1Byb3BlcnR5TmFtZSB8fCBcIlwiLFxuXHRcdFx0b01ldGFNb2RlbCA9IG1QYXJhbWV0ZXJzLm9NZXRhTW9kZWwsXG5cdFx0XHRzUHJvcGVydHkgPSBgJHttUGFyYW1ldGVycy5zQmluZGluZ1BhdGh9LyR7c1Byb3BlcnR5TmFtZX1gLFxuXHRcdFx0b1Byb3BlcnR5Q29udGV4dCA9IG9NZXRhTW9kZWwuY3JlYXRlQmluZGluZ0NvbnRleHQoc1Byb3BlcnR5KSxcblx0XHRcdHNWYWx1ZUhlbHBQcm9wZXJ0eSA9IEZpZWxkSGVscGVyLnZhbHVlSGVscFByb3BlcnR5KG9Qcm9wZXJ0eUNvbnRleHQsIGJJbkZpbHRlckZpZWxkKTtcblxuXHRcdHJldHVybiB0aGlzLmdldEN1c3RvbURhdGEobVBhcmFtZXRlcnMub0NvbnRyb2wsIFwiZGlzcGxheU1vZGVQcm9wZXJ0eUJpbmRpbmdcIiwgbVBhcmFtZXRlcnMub01vZGlmaWVyKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKGJSZWFkT25seTogYW55KSB7XG5cdFx0XHRcdC8vIENoZWNrIHdoZXRoZXIgdGhlIGNvbnRyb2wgaXMgcmVhZC1vbmx5LiBJZiB5ZXMsIG5vIG5lZWQgb2YgYSB2YWx1ZSBoZWxwLlxuXHRcdFx0XHRiUmVhZE9ubHkgPSB0eXBlb2YgYlJlYWRPbmx5ID09PSBcImJvb2xlYW5cIiA/IGJSZWFkT25seSA6IGJSZWFkT25seSA9PT0gXCJ0cnVlXCI7XG5cdFx0XHRcdGlmIChiUmVhZE9ubHkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gRWxzZSwgY2hlY2sgd2hldGhlciBWYWx1ZSBIZWxwIHJlbGV2YW50IGFubm90YXRpb24gZXhpc3RzIGZvciB0aGUgcHJvcGVydHkuXG5cdFx0XHRcdC8vIFRPRE8gdXNlIFByb3BlcnR5Rm9ybWF0dGVyLmhhc1ZhbHVlSGVscCAoKSA9PiBpZiBkb2luZyBzbywgUVVuaXQgdGVzdHMgZmFpbCBkdWUgdG8gbW9ja2VkIG1vZGVsIGltcGxlbWVudGF0aW9uXG5cdFx0XHRcdHJldHVybiBQcm9taXNlLmFsbChbXG5cdFx0XHRcdFx0b01ldGFNb2RlbC5yZXF1ZXN0T2JqZWN0KGAke3NWYWx1ZUhlbHBQcm9wZXJ0eX1AY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlZhbHVlTGlzdFdpdGhGaXhlZFZhbHVlc2ApLFxuXHRcdFx0XHRcdG9NZXRhTW9kZWwucmVxdWVzdE9iamVjdChgJHtzVmFsdWVIZWxwUHJvcGVydHl9QGNvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5WYWx1ZUxpc3RSZWZlcmVuY2VzYCksXG5cdFx0XHRcdFx0b01ldGFNb2RlbC5yZXF1ZXN0T2JqZWN0KGAke3NWYWx1ZUhlbHBQcm9wZXJ0eX1AY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlZhbHVlTGlzdE1hcHBpbmdgKSxcblx0XHRcdFx0XHRvTWV0YU1vZGVsLnJlcXVlc3RPYmplY3QoYCR7c1ZhbHVlSGVscFByb3BlcnR5fUBjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVmFsdWVMaXN0YClcblx0XHRcdFx0XSk7XG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKGFSZXN1bHRzOiBhbnlbXSkge1xuXHRcdFx0XHRyZXR1cm4gISFhUmVzdWx0c1swXSB8fCAhIWFSZXN1bHRzWzFdIHx8ICEhYVJlc3VsdHNbMl0gfHwgISFhUmVzdWx0c1szXTtcblx0XHRcdH0pXG5cdFx0XHQuY2F0Y2goZnVuY3Rpb24gKG9FcnJvcjogYW55KSB7XG5cdFx0XHRcdExvZy53YXJuaW5nKFwiRXJyb3Igd2hpbGUgcmV0cmlldmluZyBjdXN0b20gZGF0YSAvIHZhbHVlIGxpc3QgYW5ub3RhdGlvbiB2YWx1ZXNcIiwgb0Vycm9yKTtcblx0XHRcdH0pO1xuXHR9LFxuXHRpc011bHRpVmFsdWUob1Byb3BlcnR5OiBhbnkpIHtcblx0XHRsZXQgYklzTXVsdGlWYWx1ZSA9IHRydWU7XG5cdFx0Ly9TaW5nbGVWYWx1ZSB8IE11bHRpVmFsdWUgfCBTaW5nbGVSYW5nZSB8IE11bHRpUmFuZ2UgfCBTZWFyY2hFeHByZXNzaW9uIHwgTXVsdGlSYW5nZU9yU2VhcmNoRXhwcmVzc2lvblxuXHRcdHN3aXRjaCAob1Byb3BlcnR5LmZpbHRlckV4cHJlc3Npb24pIHtcblx0XHRcdGNhc2UgXCJTZWFyY2hFeHByZXNzaW9uXCI6XG5cdFx0XHRjYXNlIFwiU2luZ2xlUmFuZ2VcIjpcblx0XHRcdGNhc2UgXCJTaW5nbGVWYWx1ZVwiOlxuXHRcdFx0XHRiSXNNdWx0aVZhbHVlID0gZmFsc2U7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdGlmIChvUHJvcGVydHkudHlwZSAmJiBvUHJvcGVydHkudHlwZS5pbmRleE9mKFwiQm9vbGVhblwiKSA+IDApIHtcblx0XHRcdGJJc011bHRpVmFsdWUgPSBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIGJJc011bHRpVmFsdWU7XG5cdH1cbn07XG5leHBvcnQgZGVmYXVsdCBEZWxlZ2F0ZVV0aWw7XG4iXSwibWFwcGluZ3MiOiI7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7RUFpQkEsTUFBTUEsWUFBWSxHQUFHLGtFQUFrRTtFQXFEdkYsU0FBU0MsY0FBYyxHQUErRDtJQUNyRixJQUFJLENBQUNDLE9BQU8sQ0FBQ0Msd0JBQXdCLENBQUNGLGNBQWMsRUFBRSxJQUFJLENBQUM7SUFDM0QsTUFBTUcsVUFBVSxHQUFHLElBQUksQ0FBQ0MsU0FBUztNQUNoQ0MsTUFBTSxHQUFHLElBQUksQ0FBQ0osT0FBTyxDQUFDSyxRQUFRLENBQUNILFVBQVUsQ0FBQztJQUUzQyxJQUFJRSxNQUFNLEVBQUU7TUFDWCxJQUFJLENBQUNFLE9BQU8sQ0FBQ0YsTUFBTSxDQUFDO0lBQ3JCLENBQUMsTUFBTTtNQUNOLElBQUksQ0FBQ0osT0FBTyxDQUFDTyx3QkFBd0IsQ0FBQ1IsY0FBYyxFQUFFLElBQUksQ0FBQztJQUM1RDtFQUNEO0VBQ0EsZUFBZVMseUJBQXlCLENBQUNDLFFBQWEsRUFBRUMsU0FBYyxFQUFFQyxTQUFjLEVBQUU7SUFDdkYsTUFBTUMsV0FBa0IsR0FBRyxFQUFFO0lBRTdCLE1BQU1DLG9CQUFvQixHQUFHLE1BQU1DLE9BQU8sQ0FBQ1IsT0FBTyxFQUFFLENB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