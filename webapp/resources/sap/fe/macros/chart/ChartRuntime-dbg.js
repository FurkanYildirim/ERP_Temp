/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/ActionRuntime", "sap/fe/macros/chart/ChartUtils", "sap/fe/macros/DelegateUtil"], function (ActionRuntime, ChartUtils, DelegateUtil) {
  "use strict";

  /**
   * Static class used by MDC_Chart during runtime
   *
   * @private
   * @experimental This module is only for internal/experimental use!
   */
  const ChartRuntime = {
    /**
     * Updates the chart after selection or deselection of data points.
     *
     * @function
     * @static
     * @name sap.fe.macros.chart.ChartRuntime.fnUpdateChart
     * @memberof sap.fe.macros.chart.ChartRuntime
     * @param oEvent Chart event
     * @ui5-restricted
     */
    fnUpdateChart: function (oEvent) {
      const oInnerChart = oEvent.getSource();
      const oMdcChart = oInnerChart.getParent();
      let sActionsMultiselectDisabled,
        oActionOperationAvailableMap = {},
        aActionsMultiselectDisabled = [];
      // changing drill stack changes order of custom data, looping through all
      oMdcChart.getCustomData().forEach(function (oCustomData) {
        if (oCustomData.getKey() === "operationAvailableMap") {
          oActionOperationAvailableMap = DelegateUtil.getCustomData(oMdcChart, "operationAvailableMap") && DelegateUtil.getCustomData(oMdcChart, "operationAvailableMap").customData;
        } else if (oCustomData.getKey() === "multiSelectDisabledActions") {
          sActionsMultiselectDisabled = oCustomData.getValue();
          aActionsMultiselectDisabled = sActionsMultiselectDisabled ? sActionsMultiselectDisabled.split(",") : [];
        }
      });
      const oInternalModelContext = oMdcChart.getBindingContext("internal");
      const aSelectedContexts = [];
      let oModelObject;
      const aSelectedDataPoints = ChartUtils.getChartSelectedData(oInnerChart);
      for (let i = 0; i < aSelectedDataPoints.length; i++) {
        aSelectedContexts.push(aSelectedDataPoints[i].context);
      }
      oInternalModelContext.setProperty("selectedContexts", aSelectedContexts);
      oInternalModelContext.getModel().setProperty(`${oInternalModelContext.getPath()}/numberOfSelectedContexts`, oInnerChart.getSelectedDataPoints().count);
      for (let j = 0; j < aSelectedContexts.length; j++) {
        const oSelectedContext = aSelectedContexts[j];
        const oContextData = oSelectedContext.getObject();
        for (const key in oContextData) {
          if (key.indexOf("#") === 0) {
            let sActionPath = key;
            sActionPath = sActionPath.substring(1, sActionPath.length);
            oModelObject = oInternalModelContext.getObject();
            oModelObject[sActionPath] = true;
            oInternalModelContext.setProperty("", oModelObject);
          }
        }
        oModelObject = oInternalModelContext.getObject();
      }
      ActionRuntime.setActionEnablement(oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, "chart");
      if (aSelectedContexts.length > 1) {
        aActionsMultiselectDisabled.forEach(function (sAction) {
          oInternalModelContext.setProperty(sAction, false);
        });
      }
    }
  };
  return ChartRuntime;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDaGFydFJ1bnRpbWUiLCJmblVwZGF0ZUNoYXJ0Iiwib0V2ZW50Iiwib0lubmVyQ2hhcnQiLCJnZXRTb3VyY2UiLCJvTWRjQ2hhcnQiLCJnZXRQYXJlbnQiLCJzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQiLCJvQWN0aW9uT3BlcmF0aW9uQXZhaWxhYmxlTWFwIiwiYUFjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkIiwiZ2V0Q3VzdG9tRGF0YSIsImZvckVhY2giLCJvQ3VzdG9tRGF0YSIsImdldEtleSIsIkRlbGVnYXRlVXRpbCIsImN1c3RvbURhdGEiLCJnZXRWYWx1ZSIsInNwbGl0Iiwib0ludGVybmFsTW9kZWxDb250ZXh0IiwiZ2V0QmluZGluZ0NvbnRleHQiLCJhU2VsZWN0ZWRDb250ZXh0cyIsIm9Nb2RlbE9iamVjdCIsImFTZWxlY3RlZERhdGFQb2ludHMiLCJDaGFydFV0aWxzIiwiZ2V0Q2hhcnRTZWxlY3RlZERhdGEiLCJpIiwibGVuZ3RoIiwicHVzaCIsImNvbnRleHQiLCJzZXRQcm9wZXJ0eSIsImdldE1vZGVsIiwiZ2V0UGF0aCIsImdldFNlbGVjdGVkRGF0YVBvaW50cyIsImNvdW50IiwiaiIsIm9TZWxlY3RlZENvbnRleHQiLCJvQ29udGV4dERhdGEiLCJnZXRPYmplY3QiLCJrZXkiLCJpbmRleE9mIiwic0FjdGlvblBhdGgiLCJzdWJzdHJpbmciLCJBY3Rpb25SdW50aW1lIiwic2V0QWN0aW9uRW5hYmxlbWVudCIsInNBY3Rpb24iXSwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIkNoYXJ0UnVudGltZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2hhcnQgZnJvbSBcInNhcC9jaGFydC9DaGFydFwiO1xuaW1wb3J0IEFjdGlvblJ1bnRpbWUgZnJvbSBcInNhcC9mZS9jb3JlL0FjdGlvblJ1bnRpbWVcIjtcbmltcG9ydCB7IEludGVybmFsTW9kZWxDb250ZXh0IH0gZnJvbSBcInNhcC9mZS9jb3JlL2hlbHBlcnMvTW9kZWxIZWxwZXJcIjtcbmltcG9ydCBDaGFydFV0aWxzIGZyb20gXCJzYXAvZmUvbWFjcm9zL2NoYXJ0L0NoYXJ0VXRpbHNcIjtcbmltcG9ydCBEZWxlZ2F0ZVV0aWwgZnJvbSBcInNhcC9mZS9tYWNyb3MvRGVsZWdhdGVVdGlsXCI7XG5pbXBvcnQgVUk1RXZlbnQgZnJvbSBcInNhcC91aS9iYXNlL0V2ZW50XCI7XG5pbXBvcnQgQ29udHJvbCBmcm9tIFwic2FwL3VpL21kYy9Db250cm9sXCI7XG5cbnR5cGUgSW5uZXJDaGFydCA9IENvbnRyb2wgJiBDaGFydCAmIHsgZ2V0UGFyZW50OiBGdW5jdGlvbjsgZ2V0Q3VzdG9tRGF0YTogRnVuY3Rpb24gfTtcbnR5cGUgTURDQ2hhcnQgPSBDb250cm9sO1xudHlwZSBPYmplY3RXaXRoQ291bnQgPSBvYmplY3QgJiB7IGNvdW50OiBudW1iZXIgfTtcbmludGVyZmFjZSBCb29sZWFuTWFwIHtcblx0W2tleTogc3RyaW5nXTogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBTdGF0aWMgY2xhc3MgdXNlZCBieSBNRENfQ2hhcnQgZHVyaW5nIHJ1bnRpbWVcbiAqXG4gKiBAcHJpdmF0ZVxuICogQGV4cGVyaW1lbnRhbCBUaGlzIG1vZHVsZSBpcyBvbmx5IGZvciBpbnRlcm5hbC9leHBlcmltZW50YWwgdXNlIVxuICovXG5jb25zdCBDaGFydFJ1bnRpbWUgPSB7XG5cdC8qKlxuXHQgKiBVcGRhdGVzIHRoZSBjaGFydCBhZnRlciBzZWxlY3Rpb24gb3IgZGVzZWxlY3Rpb24gb2YgZGF0YSBwb2ludHMuXG5cdCAqXG5cdCAqIEBmdW5jdGlvblxuXHQgKiBAc3RhdGljXG5cdCAqIEBuYW1lIHNhcC5mZS5tYWNyb3MuY2hhcnQuQ2hhcnRSdW50aW1lLmZuVXBkYXRlQ2hhcnRcblx0ICogQG1lbWJlcm9mIHNhcC5mZS5tYWNyb3MuY2hhcnQuQ2hhcnRSdW50aW1lXG5cdCAqIEBwYXJhbSBvRXZlbnQgQ2hhcnQgZXZlbnRcblx0ICogQHVpNS1yZXN0cmljdGVkXG5cdCAqL1xuXHRmblVwZGF0ZUNoYXJ0OiBmdW5jdGlvbiAob0V2ZW50OiBVSTVFdmVudCkge1xuXHRcdGNvbnN0IG9Jbm5lckNoYXJ0ID0gb0V2ZW50LmdldFNvdXJjZSgpIGFzIElubmVyQ2hhcnQ7XG5cdFx0Y29uc3Qgb01kY0NoYXJ0ID0gb0lubmVyQ2hhcnQuZ2V0UGFyZW50KCkgYXMgTURDQ2hhcnQ7XG5cdFx0bGV0IHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCxcblx0XHRcdG9BY3Rpb25PcGVyYXRpb25BdmFpbGFibGVNYXAgPSB7fSxcblx0XHRcdGFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZDogT2JqZWN0W10gPSBbXTtcblx0XHQvLyBjaGFuZ2luZyBkcmlsbCBzdGFjayBjaGFuZ2VzIG9yZGVyIG9mIGN1c3RvbSBkYXRhLCBsb29waW5nIHRocm91Z2ggYWxsXG5cdFx0b01kY0NoYXJ0LmdldEN1c3RvbURhdGEoKS5mb3JFYWNoKGZ1bmN0aW9uIChvQ3VzdG9tRGF0YTogYW55KSB7XG5cdFx0XHRpZiAob0N1c3RvbURhdGEuZ2V0S2V5KCkgPT09IFwib3BlcmF0aW9uQXZhaWxhYmxlTWFwXCIpIHtcblx0XHRcdFx0b0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCA9XG5cdFx0XHRcdFx0RGVsZWdhdGVVdGlsLmdldEN1c3RvbURhdGEob01kY0NoYXJ0LCBcIm9wZXJhdGlvbkF2YWlsYWJsZU1hcFwiKSAmJlxuXHRcdFx0XHRcdERlbGVnYXRlVXRpbC5nZXRDdXN0b21EYXRhKG9NZGNDaGFydCwgXCJvcGVyYXRpb25BdmFpbGFibGVNYXBcIikuY3VzdG9tRGF0YTtcblx0XHRcdH0gZWxzZSBpZiAob0N1c3RvbURhdGEuZ2V0S2V5KCkgPT09IFwibXVsdGlTZWxlY3REaXNhYmxlZEFjdGlvbnNcIikge1xuXHRcdFx0XHRzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQgPSBvQ3VzdG9tRGF0YS5nZXRWYWx1ZSgpO1xuXHRcdFx0XHRhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQgPSBzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQgPyBzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQuc3BsaXQoXCIsXCIpIDogW107XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Y29uc3Qgb0ludGVybmFsTW9kZWxDb250ZXh0ID0gb01kY0NoYXJ0LmdldEJpbmRpbmdDb250ZXh0KFwiaW50ZXJuYWxcIikgYXMgSW50ZXJuYWxNb2RlbENvbnRleHQ7XG5cblx0XHRjb25zdCBhU2VsZWN0ZWRDb250ZXh0cyA9IFtdO1xuXHRcdGxldCBvTW9kZWxPYmplY3Q6IEJvb2xlYW5NYXAgfCB1bmRlZmluZWQ7XG5cdFx0Y29uc3QgYVNlbGVjdGVkRGF0YVBvaW50cyA9IENoYXJ0VXRpbHMuZ2V0Q2hhcnRTZWxlY3RlZERhdGEob0lubmVyQ2hhcnQpO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYVNlbGVjdGVkRGF0YVBvaW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0YVNlbGVjdGVkQ29udGV4dHMucHVzaChhU2VsZWN0ZWREYXRhUG9pbnRzW2ldLmNvbnRleHQpO1xuXHRcdH1cblx0XHRvSW50ZXJuYWxNb2RlbENvbnRleHQuc2V0UHJvcGVydHkoXCJzZWxlY3RlZENvbnRleHRzXCIsIGFTZWxlY3RlZENvbnRleHRzKTtcblx0XHRvSW50ZXJuYWxNb2RlbENvbnRleHRcblx0XHRcdC5nZXRNb2RlbCgpXG5cdFx0XHQuc2V0UHJvcGVydHkoXG5cdFx0XHRcdGAke29JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRQYXRoKCl9L251bWJlck9mU2VsZWN0ZWRDb250ZXh0c2AsXG5cdFx0XHRcdChvSW5uZXJDaGFydC5nZXRTZWxlY3RlZERhdGFQb2ludHMoKSBhcyBPYmplY3RXaXRoQ291bnQpLmNvdW50XG5cdFx0XHQpO1xuXHRcdGZvciAobGV0IGogPSAwOyBqIDwgYVNlbGVjdGVkQ29udGV4dHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGNvbnN0IG9TZWxlY3RlZENvbnRleHQgPSBhU2VsZWN0ZWRDb250ZXh0c1tqXTtcblx0XHRcdGNvbnN0IG9Db250ZXh0RGF0YSA9IG9TZWxlY3RlZENvbnRleHQuZ2V0T2JqZWN0KCk7XG5cdFx0XHRmb3IgKGNvbnN0IGtleSBpbiBvQ29udGV4dERhdGEpIHtcblx0XHRcdFx0aWYgKGtleS5pbmRleE9mKFwiI1wiKSA9PT0gMCkge1xuXHRcdFx0XHRcdGxldCBzQWN0aW9uUGF0aCA9IGtleTtcblx0XHRcdFx0XHRzQWN0aW9uUGF0aCA9IHNBY3Rpb25QYXRoLnN1YnN0cmluZygxLCBzQWN0aW9uUGF0aC5sZW5ndGgpO1xuXHRcdFx0XHRcdG9Nb2RlbE9iamVjdCA9IG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRPYmplY3QoKSBhcyBCb29sZWFuTWFwO1xuXHRcdFx0XHRcdG9Nb2RlbE9iamVjdFtzQWN0aW9uUGF0aF0gPSB0cnVlO1xuXHRcdFx0XHRcdG9JbnRlcm5hbE1vZGVsQ29udGV4dC5zZXRQcm9wZXJ0eShcIlwiLCBvTW9kZWxPYmplY3QpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRvTW9kZWxPYmplY3QgPSBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0T2JqZWN0KCkgYXMgQm9vbGVhbk1hcDtcblx0XHR9XG5cblx0XHRBY3Rpb25SdW50aW1lLnNldEFjdGlvbkVuYWJsZW1lbnQob0ludGVybmFsTW9kZWxDb250ZXh0LCBvQWN0aW9uT3BlcmF0aW9uQXZhaWxhYmxlTWFwLCBhU2VsZWN0ZWRDb250ZXh0cywgXCJjaGFydFwiKTtcblxuXHRcdGlmIChhU2VsZWN0ZWRDb250ZXh0cy5sZW5ndGggPiAxKSB7XG5cdFx0XHRhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQuZm9yRWFjaChmdW5jdGlvbiAoc0FjdGlvbjogYW55KSB7XG5cdFx0XHRcdG9JbnRlcm5hbE1vZGVsQ29udGV4dC5zZXRQcm9wZXJ0eShzQWN0aW9uLCBmYWxzZSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IENoYXJ0UnVudGltZTtcbiJdLCJtYXBwaW5ncyI6IjtB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