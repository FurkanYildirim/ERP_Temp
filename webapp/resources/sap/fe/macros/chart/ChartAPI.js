/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/merge","sap/fe/core/helpers/ClassSupport","sap/fe/macros/chart/ChartRuntime","sap/fe/macros/chart/ChartUtils","sap/fe/macros/filter/FilterUtils","sap/fe/macros/MacroAPI","../insights/CommonInsightsHelper","../insights/InsightsCardHelper"],function(e,t,r,n,i,a,o,l,s){"use strict";var u,c,p,g,f,d,h,b,y,v,m,C,w,P,S,z,D,I,O,A,x,E,j,M,k,R,T,V,q,B,F,N,U,_;var H=s.showInsightsCardPreview;var $=s.IntegrationCardType;var L=s.genericErrorMessageForInsightsCard;var G=l.createInsightsParams;var J=r.xmlEventHandler;var K=r.property;var Q=r.event;var W=r.defineUI5Class;var X=r.aggregation;function Y(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function Z(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function ee(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;te(e,t)}function te(e,t){te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return te(e,t)}function re(e,t,r,n,i){var a={};Object.keys(n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(i&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(i):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,t,a);a=null}return a}function ne(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let ie=(u=W("sap.fe.macros.chart.ChartAPI",{returnTypes:["sap.fe.macros.MacroAPI"]}),c=K({type:"string"}),p=K({type:"string",required:true,expectedTypes:["EntitySet","EntityType","Singleton","NavigationProperty"],expectedAnnotations:["com.sap.vocabularies.UI.v1.Chart"]}),g=K({type:"string",required:true,expectedTypes:["EntitySet","EntityType","Singleton","NavigationProperty"],expectedAnnotations:[]}),f=K({type:"string"}),d=K({type:"boolean",defaultValue:true}),h=K({type:"string",defaultValue:"Multiple",allowedValues:["None","Single","Multiple"]}),b=K({type:"string"}),y=K({type:"string",allowedValues:["Control"]}),v=K({type:"boolean | string",defaultValue:true}),m=K({type:"string[]",defaultValue:[]}),C=X({type:"sap.fe.macros.chart.Action",multiple:true}),w=Q(),P=Q(),S=Q(),z=J(),D=J(),I=J(),u(O=(A=function(r){ee(o,r);function o(){var e;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++){n[i]=arguments[i]}e=r.call(this,...n)||this;Y(e,"id",x,Z(e));Y(e,"metaPath",E,Z(e));Y(e,"contextPath",j,Z(e));Y(e,"header",M,Z(e));Y(e,"headerVisible",k,Z(e));Y(e,"selectionMode",R,Z(e));Y(e,"filterBar",T,Z(e));Y(e,"variantManagement",V,Z(e));Y(e,"personalization",q,Z(e));Y(e,"prevDrillStack",B,Z(e));Y(e,"actions",F,Z(e));Y(e,"selectionChange",N,Z(e));Y(e,"stateChange",U,Z(e));Y(e,"internalDataRequested",_,Z(e));return e}var l=o.prototype;l.getSelectedContexts=function e(){var t,r;return((t=this.content)===null||t===void 0?void 0:(r=t.getBindingContext("internal"))===null||r===void 0?void 0:r.getProperty("selectedContexts"))||[]};l.onAfterRendering=function e(){const t=this.getController().getView();const r=t.getBindingContext("internal");const n=this.getContent();const i={};const a=n.data("entitySet"),o=`${a}Chart`,l=t.getBindingContext();i[o]=n.data("draftSupported")==="true"&&!!l&&!l.getObject("IsActiveEntity");r.setProperty("controls/showMessageStrip",i)};l.refreshNotApplicableFields=function e(t){const r=this.getContent();return a.getNotApplicableFilters(t,r)};l.handleSelectionChange=function e(r){const i=r.getParameter("data");const a=r.getParameter("name")==="selectData";n.fnUpdateChart(r);this.fireSelectionChange(t({},{data:i,selected:a}))};l.onInternalDataRequested=function e(){this.fireEvent("internalDataRequested")};l.hasSelections=function t(){const r=this.content;if(r){try{const e=r.getControlDelegate().getInnerChart(r);if(e){const t=i.getDimensionsFromDrillStack(e);const n=t.length>this.prevDrillStack.length;const a=t.length<this.prevDrillStack.length;const o=t.toString()===this.prevDrillStack.toString();let l;if(a&&t.length===1){l=i.getChartSelections(r,true)}else{l=i.getChartSelections(r)}if(n||a){this.prevDrillStack=t;return l.length>0}else if(o){return l.length>0}}}catch(t){e.error(`Error while checking for selections in Chart: ${t}`)}}return false};l.onAddCardToInsightsPressed=async function t(){try{const e=await G(this,$.analytical);if(e){H(e);return}}catch(t){L(this.content);e.error(t)}};return o}(o),x=re(A.prototype,"id",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),E=re(A.prototype,"metaPath",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),j=re(A.prototype,"contextPath",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),M=re(A.prototype,"header",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),k=re(A.prototype,"headerVisible",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),R=re(A.prototype,"selectionMode",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),T=re(A.prototype,"filterBar",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),V=re(A.prototype,"variantManagement",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),q=re(A.prototype,"personalization",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),B=re(A.prototype,"prevDrillStack",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),F=re(A.prototype,"actions",[C],{configurable:true,enumerable:true,writable:true,initializer:null}),N=re(A.prototype,"selectionChange",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),U=re(A.prototype,"stateChange",[P],{configurable:true,enumerable:true,writable:true,initializer:null}),_=re(A.prototype,"internalDataRequested",[S],{configurable:true,enumerable:true,writable:true,initializer:null}),re(A.prototype,"handleSelectionChange",[z],Object.getOwnPropertyDescriptor(A.prototype,"handleSelectionChange"),A.prototype),re(A.prototype,"onInternalDataRequested",[D],Object.getOwnPropertyDescriptor(A.prototype,"onInternalDataRequested"),A.prototype),re(A.prototype,"onAddCardToInsightsPressed",[I],Object.getOwnPropertyDescriptor(A.prototype,"onAddCardToInsightsPressed"),A.prototype),A))||O);return ie},false);
//# sourceMappingURL=ChartAPI.js.map