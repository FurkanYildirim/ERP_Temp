//@ui5-bundle sap/suite/ui/commons/library-preload.js
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/AriaProperties", ["./library","sap/ui/core/Element"],function(e,a){"use strict";var l=a.extend("sap.suite.ui.commons.AriaProperties",{metadata:{library:"sap.suite.ui.commons",properties:{label:{type:"string",defaultValue:null},labelledBy:{type:"string",defaultValue:null},describedBy:{type:"string",defaultValue:null},role:{type:"string",defaultValue:null},hasPopup:{type:"string",defaultValue:null}}}});l.writeAriaProperties=function(e,a,l){var t=l&&l.getLabel()||a.label;if(t){e.attr("aria-label",t)}var r=l&&l.getLabelledBy()||a.labelledBy;if(r){e.attr("aria-labelledby",r)}var i=l&&l.getDescribedBy()||a.describedBy;if(i){e.attr("aria-describedby",i)}var u=l&&l.getRole()||a.role;if(u){e.attr("role",u)}var s=l&&l.getHasPopup()||a.hasPopup;if(s){e.attr("aria-haspopup",s)}};return l});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilder", ["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","./CalculationBuilderItem","./CalculationBuilderExpression","./CalculationBuilderInput","./CalculationBuilderFunction","sap/m/OverflowToolbar","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarButton","sap/m/ToolbarSpacer","sap/m/Title","sap/m/MessageBox","sap/base/Log","sap/base/util/uid","sap/ui/core/library","sap/m/library","sap/suite/ui/commons/util/FullScreenUtil"],function(jQuery,t,e,i,o,r,n,s,a,l,u,p,c,d,_,h,f,g){"use strict";var y=f.ButtonType;var E=h.TitleLevel;var T=Object.freeze({SHOW_EXPRESSION:"sap-icon://notification-2",EXPAND_VARIABLE:"sap-icon://disconnected",FULL_SCREEN:"sap-icon://full-screen",EXIT_FULL_SCREEN:"sap-icon://exit-full-screen"});var b=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var I=t.CalculationBuilderOperatorType,m=t.CalculationBuilderLogicalOperatorType,x=t.CalculationBuilderComparisonOperatorType,B=t.CalculationBuilderItemType,C=t.CalculationBuilderFunctionType,S=t.CalculationBuilderLayoutType,L=t.CalculationBuilderValidationMode;var A=new RegExp(String.fromCharCode(160),"g");var O={abs:{key:"ABS",title:"ABS - Absolute Value",allowed:true},round:{key:"Round",title:"Round",template:["",",",""],allowed:true},roundup:{key:"RoundUp",title:"Round Up",template:["",",",""],allowed:true},rounddown:{key:"RoundDown",title:"Round Down",template:["",",",""],allowed:true},sqrt:{key:"SQRT",title:"SQRT",allowed:true},case:{key:"Case",title:"Case",description:'CASE ( "When" Expression "Then" Expression "Else" Expression )',template:["",",","",",",""]},ndiv0:{key:"NDIV0",title:"NDIV0"},nodim:{key:"NODIM",title:"NODIM",description:"NODIM ( Variable )"},sumct:{key:"SUMCT",title:"SUMCT",description:"SUMGT ( Variable )"},sumgt:{key:"SUMGT",title:"SUMGT",description:"SUMGT ( Variable )"},sumrt:{key:"SUMRT",title:"SUMRT",description:"SUMRT ( Variable )"}};var w=e.extend("sap.suite.ui.commons.CalculationBuilder",{metadata:{library:"sap.suite.ui.commons",properties:{expression:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},showToolbar:{type:"boolean",group:"Misc",defaultValue:true},wrapItemsInExpression:{type:"boolean",group:"Misc",defaultValue:true},layoutType:{type:"string",group:"Misc",defaultValue:"Default"},showInputToolbar:{type:"boolean",group:"Misc",defaultValue:false},readOnly:{type:"boolean",group:"Misc",defaultValue:false},allowComparisonOperators:{type:"boolean",group:"Misc",defaultValue:true},allowLogicalOperators:{type:"boolean",group:"Misc",defaultValue:true},allowSuggestions:{type:"boolean",group:"Misc",defaultValue:true},allowStringConstants:{type:"boolean",group:"Misc",defaultValue:false},allowStringLiterals:{type:"boolean",group:"Misc",defaultValue:false},validationMode:{type:"sap.suite.ui.commons.CalculationBuilderValidationMode",group:"Misc",defaultValue:L.LiveChange},disabledDefaultTokens:{type:"string",group:"Misc",defaultValue:""}},defaultAggregation:"items",aggregations:{items:{type:"sap.suite.ui.commons.CalculationBuilderItem",multiple:true,singularName:"item",bindable:"bindable",forwarding:{idSuffix:"-expression",aggregation:"items",forwardBinding:true}},variables:{type:"sap.suite.ui.commons.CalculationBuilderVariable",multiple:true,singularName:"Variable",forwarding:{idSuffix:"-expression",aggregation:"variables",forwardBinding:true}},functions:{type:"sap.suite.ui.commons.CalculationBuilderFunction",multiple:true,singularName:"Function",forwarding:{idSuffix:"-expression",aggregation:"functions",forwardBinding:true}},operators:{type:"sap.ui.core.Item",multiple:true,singularName:"Operator",forwarding:{idSuffix:"-expression",aggregation:"operators",forwardBinding:true}},groups:{type:"sap.suite.ui.commons.CalculationBuilderGroup",multiple:true,singularName:"Group",forwarding:{idSuffix:"-expression",aggregation:"groups",forwardBinding:true}}},events:{validateFunction:{parameters:{definition:"object",customFunction:"object",result:"sap.suite.ui.commons.CalculationBuilderValidationResult"}},change:{},afterValidation:{}}},renderer:{apiVersion:2,render:function(t,e){var i=e.getWrapItemsInExpression()?"sapCalculationBuilderWrapItems":"",o=e.getLayoutType()===S.TextualOnly,r=e._bShowInput||o,n=e._isExpressionVisible(),s=e._isInputVisible(),a=e.getReadOnly();t.openStart("div",e);t.class("sapCalculationBuilder");if(e.getReadOnly()){t.class("sapCalculationBuilderReadOnly")}t.class("oCalculationBuilder");t.openEnd();if(e.getShowToolbar()&&!o){t.renderControl(e.getToolbar())}if(n){e._oExpressionBuilder._bReadOnly=a;t.openStart("div");t.class("sapCalculationBuilderInsideWrapper").class(i);t.openEnd();t.renderControl(e._oExpressionBuilder);t.close("div")}if(n&&s){t.openStart("div");t.class("sapCalculationBuilderDelimiterLine");t.openEnd();t.close("div")}if(s){e._oInput._bReadOnly=a||e.getLayoutType()===S.VisualTextualReadOnly;t.openStart("div");t.class("sapCalculationBuilderInputOuterWrapper");if(e._oInput._bReadOnly){t.class("sapCalculationBuilderReadOnly")}if(e.getLayoutType()===S.Default||e.getLayoutType()===S.VisualTextualReadOnly){t.class("sapCalculationBuilderInputOuterWrapperMargin")}if(!r){t.class("sapCalculationBuilderDisplayNone")}t.openEnd();t.renderControl(e._oInput);t.close("div")}t.close("div")}}});w.prototype.init=function(){this._mDisabledTokens={};this._bShowInput=true;this._oFullScreenContainer=null;this._bIsFullScreen=false;this._oExpressionBuilder=new o(this.getId()+"-expression",{change:function(){this._expressionChanged();this.fireChange()}.bind(this)});this.addDependent(this._oExpressionBuilder);this._oInput=new r(this.getId()+"-input",{change:function(t){var e=t.getParameter("value"),i=this._oInput._stringToItems(e),o=t.getParameter("position");this._oExpressionBuilder._smartRender(i);this._setExpression(this._oInput._convertEmptyHashes(e));if(this.getValidationMode()!==L.FocusOut){this._validateInput(e,o)}else{this._oInput._recreateText({text:e,position:o,errors:this._oExpressionBuilder._aErrors})}this._enableOrDisableExpandAllButton();this.fireChange()}.bind(this)});this.addDependent(this._oInput)};w.prototype._expressionChanged=function(){var t="";this._oExpressionBuilder._aErrors=this._oExpressionBuilder._validateSyntax();t=this._oInput._itemsToString({items:this._oExpressionBuilder.getItems(),errors:this._oExpressionBuilder._aErrors});this._setExpression(t);this.fireAfterValidation();this._oInput._displayError(this._oExpressionBuilder._aErrors.length!==0);this._oExpressionBuilder._printErrors();this._enableOrDisableExpandAllButton()};w.prototype.clone=function(t){var i=e.prototype.clone.apply(this,[t,undefined,{cloneChildren:false,cloneBindings:true}]);return i};w.prototype.onBeforeRendering=function(){this._resetItems();this._createToolbar();this._oExpressionBuilder._createVariablesMap();this._oInput._aVariables=this.getVariables();if(this._bExpressionSet){this._oExpressionBuilder._setItems(this._oInput._stringToItems(this._sExpressionDirectValue))}this._bExpressionSet=false;this._sExpressionDirectValue="";if(!this._isExpressionVisible()){this._oExpressionBuilder._aErrors=this._oExpressionBuilder._validateSyntax()}this._bRendered=false};w.prototype.onAfterRendering=function(){this._setExpression(this._oInput._itemsToString({items:this._oExpressionBuilder.getItems(),errors:this._oExpressionBuilder._aErrors}));this._bRendered=true;this._oInput._displayError(this._oExpressionBuilder._aErrors.length>0)};w.prototype.exit=function(){if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this)}};w.prototype.getToolbar=function(){return this._oToolbar};w.prototype.getInputToolbar=function(){return this._oInput&&this._oInput._oInputToolbar};w.prototype.validateParts=function(t){t=t||{};return this._oExpressionBuilder._validateSyntax({items:t.items,from:t.from,to:t.to})};w.prototype.appendError=function(t){this._oExpressionBuilder._aErrors.push(t)};w.prototype.getErrors=function(){return this._oExpressionBuilder._aErrors};w.prototype.validate=function(){this._resetItems();this._oExpressionBuilder._aErrors=this._oExpressionBuilder._validateSyntax();this.updateErrorsDisplay()};w.prototype.updateErrorsDisplay=function(){var t=this._oExpressionBuilder._aErrors;if(this._isInputVisible()){this._oInput._recreateText({errors:t});this._oInput._displayError(t.length>0)}if(this._isExpressionVisible()){this._oExpressionBuilder._printErrors()}};w.prototype.allowFunction=function(t,e){if(!t){return}var i=O[t.toLowerCase()];if(i){i.allowed=e}};w.prototype.updateOrCreateItem=function(t){this._oExpressionBuilder._updateOrCreateItem({key:t})};w.prototype.getErrors=function(){return this._oExpressionBuilder&&this._oExpressionBuilder._aErrors};w.prototype.getAllowStringConstants=function(){d.warning("This function is deprecated, please use getAllowStringLiterals instead");return this.getAllowStringLiterals()};w.prototype.setAllowStringConstants=function(t){d.warning("This function is deprecated, please use setAllowStringLiterals instead");return this.setAllowStringLiterals(t)};w.prototype._resetItems=function(){this.getItems().forEach(function(t){t._reset()})};w.prototype._validateInput=function(t,e){this._oExpressionBuilder._aErrors=this._oExpressionBuilder._validateSyntax();this.fireAfterValidation();this._oInput._recreateText({text:t,position:e,errors:this._oExpressionBuilder._aErrors});this._oExpressionBuilder._printErrors();this._oInput._displayError(this._oExpressionBuilder._aErrors.length>0)};w.prototype._findInArray=function(t,e,i){return e.some(function(e){var o=i?e["get"+i]():e;return o.toLowerCase()===t})};w.prototype._findInItems=function(t,e){t=(t||"").toLowerCase();return e.some(function(e){return e.getKey().toLowerCase()===t})};w.prototype._createErrorText=function(t,e){t=t||this.getErrors();var i="",o=0,r=5;for(var n=0;n<t.length&&o<r;n++){if(t[n].index<0||!jQuery.isNumeric(t[n].index)||!e){o++;i+=t[n].title+"\n"}}return i};w.prototype._getFunctionMap=function(){return O};w.prototype._getFunctionDefinition=function(t){t=(t||"").toLowerCase();return O[t]||jQuery.grep(this.getFunctions(),function(e){return e.getKey().toLowerCase()===t})[0]};w.prototype._getFunctionDescription=function(t){var e;if(t.description){return t.description}e=b.getText("CALCULATION_BUILDER_EXPRESSION_TITLE");if(t.template){var i=(t.key||"")+" ( ";t.template.forEach(function(t){i+=(t?t:e)+" "});return i+")"}return(t.key||"")+" ( "+e+" )"};w.prototype._getFunctionTemplateItems=function(t){if(!t){return[]}var e=t instanceof n?B.CustomFunction:B.Function;return e===B.Function?t.template||[]:this._convertToTemplate(t.getItems())};w.prototype._getFunctionAllowParametersCount=function(t){var e=this._getFunctionTemplateItems(this._getFunctionDefinition(t)),i=e.join("");return(i.match(/,/g)||[]).length+1};w.prototype._convertToTemplate=function(t){return t.map(function(t){return t.getKey()})};w.prototype._isOperator=function(t,e){e=e!==false;t=(t||"").toLowerCase();if(!this._isTokenAllowed(t)){return false}return this._findInArray(t,Object.keys(I))||e&&this.getAllowLogicalOperators()&&this._findInArray(t,Object.keys(m))||this.getAllowComparisonOperators()&&this._findInArray(t,Object.keys(x))};w.prototype._isFunction=function(t){return this._isTokenAllowed(t)&&this._findInArray(t,Object.keys(C))};w.prototype._isCustomOperator=function(t){return this._findInItems(t,this.getOperators())};w.prototype._isStringLiteral=function(t){return t&&t.length>=2&&t[0]==='"'&&t[t.length-1]==='"'};w.prototype._getType=function(t){t=(t||"").toLowerCase();if(!t){return B.Empty}if(this._isOperator(t)){return B.Operator}if(this._isCustomOperator(t)){return B.CustomOperator}if(this._findInArray(t,this.getVariables(),"Key")){return B.Variable}if(this._isFunction(t)){return B.Function}if(this._findInArray(t,this.getFunctions(),"Key")){return B.CustomFunction}if(this.getAllowStringLiterals()&&this._isStringLiteral(t)){return B.Literal}if(!isNaN(t)){return B.Literal}return B.Error};w.prototype._createToolbar=function(){if(this._oToolbar){this._oShowInputButton&&this._oShowInputButton.setVisible(this._isInputVisible());this._oToolbarTitle.setText(this.getTitle());this._oToolbarTitle.setVisible(!!this.getTitle());return}this._oToolbarTitle=new p({titleStyle:E.H4,text:this.getTitle(),visible:!!this.getTitle()});this._oToolbar=new s(this.getId()+"-toolbar",{content:[this._oToolbarTitle,new u]}).addStyleClass("sapCalculationBuilderToolbar");this._oShowInputButton=new a({type:y.Transparent,icon:T.SHOW_EXPRESSION,tooltip:b.getText("CALCULATION_BUILDER_TOGGLE_EXPRESSION_BUTTON"),pressed:true,press:function(){this.$().find(".sapCalculationBuilderInputOuterWrapper").toggle();this._bShowInput=!this._bShowInput}.bind(this)});this._oToolbar.addContent(this._oShowInputButton);this._oToolbar.addContent(this._getExpandAllVariablesButton());this._oToolbar.addContent(new a({type:y.Transparent,icon:T.FULL_SCREEN,tooltip:b.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),press:function(t){var e=t.getSource();this._toggleFullScreen();e.setAggregation("tooltip",this._bIsFullScreen?b.getText("CALCULATION_BUILDER_EXIT_FULL_SCREEN_BUTTON"):b.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),true);e.setProperty("icon",this._bIsFullScreen?T.EXIT_FULL_SCREEN:T.FULL_SCREEN,true);e.focus()}.bind(this)}));this.addDependent(this._oToolbar)};w.prototype._getExpandAllVariablesButton=function(){if(!this._oExpandAllVariablesButton){this._oExpandAllVariablesButton=new l({type:y.Transparent,icon:T.EXPAND_VARIABLE,tooltip:b.getText("CALCULATION_BUILDER_EXPAND_ALL_BUTTON"),press:function(t){c.show(b.getText("CALCULATION_BUILDER_EXPAND_ALL_MESSAGE_TEXT"),{icon:c.Icon.WARNING,title:b.getText("CALCULATION_BUILDER_EXPAND_ALL_MESSAGE_TITLE"),actions:[c.Action.OK,c.Action.CANCEL],onClose:function(t){if(t===c.Action.OK){this._oExpressionBuilder._expandAllVariables()}}.bind(this)})}.bind(this)})}return this._oExpandAllVariablesButton};w.prototype._enableOrDisableExpandAllButton=function(){var t=this.getReadOnly()||this.getLayoutType()===S.VisualTextualReadOnly,e=this._getExpandAllVariablesButton().$();if(e[0]){this._getExpandAllVariablesButton().setEnabled(!t&&this.getItems().some(function(t){return t._isVariable()&&t.isExpandable()}))}};w.prototype.setExpression=function(t){this.setProperty("expression",t);this._sExpressionDirectValue=t;if(this._bRendered||this._sExpressionDirectValue){this._bExpressionSet=true}this._oInput._setupAriaLabel();return this};w.prototype.getExpression=function(){if(this._bExpressionSet){return this._sExpressionDirectValue}return this._oInput._itemsToString({createInputText:false,items:this.getItems()})};w.prototype._setExpression=function(t){if(t){t=t.replace(A," ")}this.setProperty("expression",t,true);this._oInput._setupAriaLabel()};w.prototype._toggleFullScreen=function(t){this._oFullScreenButton=t;this._bIsFullScreen=!this._bIsFullScreen;if(!this._oFullScreenUtil){this._oFullScreenUtil=g}this._oFullScreenUtil.toggleFullScreen(this,this._bIsFullScreen,this._oFullScreenButton,this._toggleFullScreen)};w.prototype._getGroupMap=function(){return this._oExpressionBuilder._mGroups};w.prototype._isExpressionVisible=function(){return this.getLayoutType()!==S.TextualOnly};w.prototype._isInputVisible=function(){return this.getLayoutType()!==S.VisualOnly};w.prototype._createFunctionObject=function(t){if(!t){return null}return t instanceof n?{key:t.getKey(),title:t._getLabel(),description:this._getFunctionDescription({key:t.getKey(),description:t.getDescription(),template:this._convertToTemplate(t.getItems())}),type:B.CustomFunction,functionObject:t}:{key:t.key,title:t.title,description:this._getFunctionDescription(t),type:B.Function,functionObject:t}};w.prototype._getAllFunctions=function(){var t=[];Object.keys(O).forEach(function(e){if(O[e].allowed&&this._isTokenAllowed(e)){t.push(this._createFunctionObject(O[e]))}}.bind(this));this.getFunctions().forEach(function(e){t.push(this._createFunctionObject(e))}.bind(this));return t.sort(function(t,e){if(t.title<e.title){return-1}else{return 1}})};w.prototype._isTokenAllowed=function(t){return!this._mDisabledTokens[(t||"").toLowerCase()]};w.prototype.setDisabledDefaultTokens=function(t){this._mDisabledTokens={};this.setProperty("disabledDefaultTokens",t);if(t){var e=t.split(";");e.forEach(function(t){if(t){this._mDisabledTokens[t.toLowerCase()]=1}}.bind(this))}return this};return w});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderExpression", ["sap/ui/thirdparty/jquery","./library","./CalculationBuilderItem","sap/ui/core/Control","sap/ui/core/Popup","sap/ui/core/delegate/ItemNavigation","sap/m/MessageBox","sap/m/OverflowToolbar","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarButton","sap/m/ToolbarSpacer","sap/m/Title","sap/m/Button","sap/m/FlexBox","sap/m/HBox","sap/m/VBox","sap/m/library","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/StepInput","sap/m/Input","sap/m/Page","sap/m/List","sap/m/StandardListItem","sap/m/NavContainer","sap/m/SearchField","sap/m/Label","sap/m/Panel","sap/m/ResponsivePopover","sap/m/Toolbar","sap/m/MessageStrip","./CalculationBuilderValidationResult","sap/suite/ui/commons/ControlProxy","sap/ui/core/Icon","sap/ui/core/library","sap/ui/thirdparty/jqueryui/jquery-ui-core","sap/ui/thirdparty/jqueryui/jquery-ui-widget","sap/ui/thirdparty/jqueryui/jquery-ui-mouse","sap/ui/thirdparty/jqueryui/jquery-ui-draggable","sap/ui/thirdparty/jqueryui/jquery-ui-droppable","sap/ui/thirdparty/jqueryui/jquery-ui-selectable"],function(jQuery,e,t,i,r,n,a,s,o,l,u,p,c,d,_,h,g,f,I,m,C,E,T,A,L,v,y,B,R,b,O,S,N,x,P){"use strict";var U=g.PlacementType;var D=g.ListType;var w=g.ListMode;var F=g.FlexRendertype;var V=P.TextAlign;var K=P.ValueState;var G=e.CalculationBuilderItemType,M=e.CalculationBuilderOperatorType,k=e.CalculationBuilderComparisonOperatorType,j=e.CalculationBuilderLogicalOperatorType,Y=e.CalculationBuilderLayoutType,$=g.FlexDirection;var X=Object.freeze({PAGE_MAIN:"-pagemain",PAGE_OPERATORS:"-pageoperators",PAGE_VARIABLE:"-pagevariable",PAGE_FUNCTIONS:"-pagefunctions",LABEL_LITERALS:"-literalInput-label",INPUT_LITERALS:"-literalInput-field"});var q=Object.freeze({OPERATORS_CATEGORY:"sap-icon://attachment-html",LITERALS_CATEGORY:"sap-icon://grid",VARIABLES_CATEGORY:"sap-icon://notes",FUNCTIONS_CATEGORY:"sap-icon://chalkboard",DELETE:"sap-icon://delete"});var H=Object.freeze({KEY_PREVIOUS:"previous",KEY_NEXT:"next",MOUSE:"mouse"});var z="##DEFAULT##";var W=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var Q=i.extend("sap.suite.ui.commons.CalculationBuilderExpression",{metadata:{library:"sap.suite.ui.commons",defaultAggregation:"items",aggregations:{items:{type:"sap.suite.ui.commons.CalculationBuilderItem",multiple:true,singularName:"item",bindable:"bindable"},variables:{type:"sap.suite.ui.commons.CalculationBuilderVariable",multiple:true,singularName:"Variable"},functions:{type:"sap.suite.ui.commons.CalculationBuilderFunction",multiple:true,singularName:"Function"},operators:{type:"sap.ui.core.Item",multiple:true,singularName:"operator"},groups:{type:"sap.suite.ui.commons.CalculationBuilderGroup",multiple:true,singularName:"Group"}},events:{change:{}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapCalculationBuilderInner");e.openEnd();t._renderDelimiter(e,0);t.getItems().forEach(function(i,r){i._iIndex=r;i._bReadOnly=t._bReadOnly;e.renderControl(i);t._renderDelimiter(e,r+1)},this);if(!t._bReadOnly){e.renderControl(t._getNewItem())}e.openStart("div");e.class("sapCalculationBuilderSelected");e.openEnd();e.close("div");e.close("div");e.openStart("div",t.getId()+"-erroricon");e.class("sapCalculationBuilderExpressionErrorIcon");e.openEnd();e.renderControl(t._getErrorIcon());e.close("div")}}});Q.prototype.init=function(){this._aErrors=[];this._bAreSelectedItemsDeleting=false;this._bDragging=false;this._bIsCalculationBuilderRendering=false};Q.prototype._renderDelimiter=function(e,t){e.openStart("div");e.attr("index",t);e.class("sapCalculationBuilderDelimiter").class("sapCalculationBuilderDroppable");e.openEnd();e.openStart("div");e.class("sapCalculationBuilderDroppableLine");e.openEnd();e.close("div");e.openStart("div");e.class("sapCalculationBuilderDroppableCircle");e.openEnd();e.close("div");e.openStart("div");e.class("sapCalculationBuilderDelimiterNewButton");e.openEnd();e.openStart("span");e.attr("role","presentation");e.attr("aria-hidden","true");e.attr("data-sap-ui-icon-content","");e.class("sapUiIcon").class("sapUiIconMirrorInRTL").class("sapCalculationBuilderDelimiterNewButtonIcon").class("sapCalculationBuilderExpressionSAPFont");e.openEnd();e.close("span");e.close("div");e.close("div")};Q.prototype.onBeforeRendering=function(){if(!this.getParent()._oInput._aVariables.length){this._createVariablesMap();this.getParent()._oInput._aVariables=this.getParent().getVariables()}this._reset();this._createPopup();this.getParent()._enableOrDisableExpandAllButton();this._aErrors=this._validateSyntax();this._fireAfterValidation();this._bIsCalculationBuilderRendering=true;this._bRendered=false};Q.prototype.onAfterRendering=function(){this._bIsCalculationBuilderRendering=false;if(!this._bReadOnly){this._setupDroppable();this._setupSelectable();this._setupNewButtonEvents()}this._setupKeyboard();this._bRendered=true;var e=this.getParent();if(e._bRendered){e._setExpression(e._oInput._itemsToString({items:this.getItems(),errors:this._aErrors}));e._oInput._displayError(this._aErrors.length!==0)}};Q.prototype.onsapfocusleave=function(){if(!this._bAreSelectedItemsDeleting){this._deselect()}};Q.prototype.onsapenter=function(e){this._handleEnter(e)};Q.prototype.onsapspace=function(e){if(jQuery(e.target).hasClass("sapCalculationBuilderItem")){this._handleSpace(e)}};Q.prototype.onsappreviousmodifiers=function(e){if(e.ctrlKey){this._handleCtrlPrevious(e)}};Q.prototype.onsapnextmodifiers=function(e){if(e.ctrlKey){this._handleCtrlNext(e)}};Q.prototype.onsapdelete=function(e){this._handleDelete(e)};Q.prototype.exit=function(){if(this._oPopover){this._oPopover.destroy()}if(this._oItemNavigation){this.removeDelegate(this._oItemNavigation);this._oItemNavigation.destroy()}if(this._oErrorIcon){this._oErrorIcon.destroy();this._oErrorIcon=null}};Q.prototype._getErrorIcon=function(){if(!this._oErrorIcon){this._oErrorIcon=new x({src:"sap-icon://message-error",useIconTooltip:false,size:"20px"})}return this._oErrorIcon};Q.prototype._createPopup=function(){var e={footerButtons:[]};this._createPopoverLayout(e);this._createPopoverFunctionsItems(e);this._createPopoverOperatorsItems(e);this._createPopoverNavContainer(e);this._createPopover(e)};Q.prototype._reset=function(){this.getItems().forEach(function(e){e._reset()});if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};Q.prototype._createPopoverLayout=function(e){var t=function(e){return new c({text:e,press:this._updateOrCreateItem.bind(this,{type:G.Operator,key:e})}).addStyleClass("sapUiTinyMarginEnd")}.bind(this);var i=new _({renderType:F.Div,width:"100%"});i.addStyleClass("sapCalculationBuilderItemPopupOperators");i.addStyleClass("sapCalculationBuilderItemPopupOptionItem");Object.keys(M).forEach(function(e){if(this.getParent()._isTokenAllowed(e)){var r=t(M[e]);if(e===M[","]){this._attachAriaLabelToButton(r,W.getText("CALCULATION_BUILDER_COMMA_ARIA_LABEL"))}else if(e===M["-"]){this._attachAriaLabelToButton(r,W.getText("CALCULATION_BUILDER_MINUS_ARIA_LABEL"))}i.addItem(r)}}.bind(this));var r=this._createPopoverLiteralLabelAndInput(e);var n=new h({items:[i,r],alignItems:"Start"});n.addStyleClass("sapCalculationBuilderItemPopupOperatorsAndInputWrapper");e.layout=n.getItems().length>0?n:null};Q.prototype._createPopoverLiteralLabelAndInput=function(e){var t=new y({id:this.getId()+X.LABEL_LITERALS,text:W.getText("CALCULATION_BUILDER_LITERAL_INPUT_LABEL")});var i;if(this.getParent().getAllowStringLiterals()){i=new C({id:this.getId()+X.INPUT_LITERALS,width:"100%",placeholder:W.getText("CALCULATION_BUILDER_ADD_LITERAL_FIELD_PLACEHOLDER_ANY_STRING"),valueStateText:W.getText("CALCULATION_BUILDER_ADD_LITERAL_FIELD_PLACEHOLDER_ERROR"),liveChange:function(t){var i=t.getSource(),r=t.getParameter("value"),n=r.indexOf('"')===-1;i.setValueState(n?K.None:K.Error);e.footerButtons.okButton.setEnabled(n)},submit:function(e){this._submitLiteralInput(i)}.bind(this)})}else{i=new m({width:"100%",placeholder:W.getText("CALCULATION_BUILDER_ADD_LITERAL_FIELD_PLACEHOLDER"),textAlign:V.Right,valueStateText:W.getText("CALCULATION_BUILDER_ADD_LITERAL_FIELD_ERROR_TEXT"),displayValuePrecision:3,change:function(){e.footerButtons.okButton.setEnabled(true)}});if(i._getInput){var r=i._getInput();if(r){r.attachSubmit(function(e){this._submitLiteralInput(i)},this)}}}i.addAriaLabelledBy(t);e.literalInput=i;var n=new h({renderType:F.Div,items:[t,i],width:"100%"});n.addStyleClass("sapCalculationBuilderItemPopupOptionItem");n.addStyleClass("sapCalculationBuilderItemPopupLiteralLabelAndInput");return n};Q.prototype._createPopoverVariablesItems=function(e){if(!e){return[]}var t=[];e.forEach(function(e){var i=new A({title:e._getLabel()});i._calculationBuilderKey=e.getKey();t.push(i)},this);t=t.sort(function(e,t){return e.getTitle().localeCompare(t.getTitle())});var i=new T({mode:w.SingleSelectMaster,selectionChange:function(e){this._updateOrCreateItem({type:G.Variable,key:e.getParameter("listItem")._calculationBuilderKey})}.bind(this),items:t});this._oSearchField=new v({placeholder:W.getText("CALCULATION_BUILDER_SEARCH_VARIABLE"),liveChange:function(e){var r=e.getSource().getValue();if(r||r===""){i.removeAllItems();t.forEach(function(e){if(e.getTitle().toLowerCase().indexOf(r.toLowerCase())!==-1){i.addItem(e)}})}}});this._aVariableLists.push(i);return[this._oSearchField,i]};Q.prototype._createPopoverFunctionsItems=function(e){var t=this,i=this.getParent();var r=function(e){return new A({title:e.title,description:e.description,type:D.Active,customData:[{key:"functionKey",value:e.key}],press:e.press})};e.functionList=new T({mode:w.SingleSelectMaster,itemPress:function(){this.getSelectedItem().firePress()}});i._getAllFunctions().forEach(function(i){e.functionList.addItem(r({key:i.key,title:i.title,description:i.description,press:t._updateOrCreateItem.bind(t,{key:i.key,type:i.type,functionObject:i.functionObject})}))})};Q.prototype._createPopoverOperatorsItems=function(e){var t=this.getParent();var i=function(e,i){var r=[];Object.keys(e).forEach(function(n){var a,s,o=e[n];if(t._isTokenAllowed(n)){if(typeof o==="object"){s=o.getText();a=o.getKey()}else{a=s=o}var l=new c({text:s,press:this._updateOrCreateItem.bind(this,{type:i,key:a})}).addStyleClass("sapCalculationBuilderPopoverOperatorsButton").addStyleClass("sapUiTinyMarginEnd");if(n===k["!="]){this._attachAriaLabelToButton(l,W.getText("CALCULATION_BUILDER_NOT_EQUAL_ARIA_LABEL"))}r.push(l)}}.bind(this));return r}.bind(this);var r=function(e,t,r){var n=i(t,r);if(n.length>0){return new B({content:[new y({width:"100%",text:e}).addStyleClass("sapUiTinyMarginBottom"),n]})}return null};e.operatorsItems=[];if(this.getParent().getAllowComparisonOperators()){var n=r(W.getText("CALCULATION_BUILDER_COMPARISON_TITLE_SELECT"),k,G.Operator);n&&e.operatorsItems.push(n)}if(this.getParent().getAllowLogicalOperators()){var a=r(W.getText("CALCULATION_BUILDER_LOGICAL_TITLE_SELECT"),j,G.Operator);a&&e.operatorsItems.push(a)}var s=this.getParent().getOperators();if(s.length>0){e.operatorsItems.push(r(W.getText("CALCULATION_BUILDER_OPERATORS_TITLE"),s,G.CustomOperator))}};Q.prototype._createPopoverNavContainer=function(e){var t=function(e){var t=o.getPage(e);o.to(t)};var i=function(){var e=new O({type:"Error",showIcon:true}).addStyleClass("sapUiTinyMarginBegin sapUiTinyMarginEnd sapUiTinyMarginTop");this._aStrips.push(e);return e}.bind(this);this._aStrips=[];var r=[];var n=this._createPopoverVariablesItems(this._mGroups[z]);if(n.length>0){r.push(new A({title:W.getText("CALCULATION_BUILDER_VARIABLES_TITLE"),description:W.getText("CALCULATION_BUILDER_VARIABLES_CATEGORY_DESCRIPTION"),wrapping:true,icon:q.VARIABLES_CATEGORY,press:t.bind(this,this.getId()+X.PAGE_VARIABLE),type:D.Active}))}var a=e.functionList.getItems();if(a.length>0){r.push(new A({title:W.getText("CALCULATION_BUILDER_FUNCTIONS_TITLE"),type:D.Active,description:W.getText("CALCULATION_BUILDER_FUNCTIONS_CATEGORY_DESCRIPTION"),wrapping:true,icon:q.FUNCTIONS_CATEGORY,press:t.bind(this,this.getId()+X.PAGE_FUNCTIONS)}))}if(e.operatorsItems.length>0){r.unshift(new A({title:W.getText("CALCULATION_BUILDER_OPERATORS_TITLE"),type:D.Active,description:W.getText("CALCULATION_BUILDER_OPERATORS_CATEGORY_DESCRIPTION"),wrapping:true,icon:q.OPERATORS_CATEGORY,press:t.bind(this,this.getId()+X.PAGE_OPERATORS)}))}this.getGroups().forEach(function(e){r.push(new A({title:e._getTitle(),type:D.Active,description:e.getDescription(),icon:e.getIcon(),press:t.bind(this,this.getId()+e.getKey())}))}.bind(this));var s=new E({id:this.getId()+X.PAGE_MAIN,title:W.getText("CALCULATION_BUILDER_DIALOG_TITLE"),content:[i(),e.layout,new d({direction:$.Column,items:[new T({items:r})]}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiTinyMarginTop").addStyleClass("sapCalculationBuilderNavMainPage")]});s.setFooter(this._getPageFooter(s.getId(),e));var o=new L({defaultTransitionName:"show",navigate:function(t){var i=t.getParameters().to;i.setFooter(this._getPageFooter(i.getId(),e))}.bind(this),pages:[s]});if(e.operatorsItems.length>0){o.addPage(new E({id:this.getId()+X.PAGE_OPERATORS,content:[i(),new d({direction:$.Column,items:[e.operatorsItems]}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiTinyMarginTop")],showNavButton:true,title:W.getText("CALCULATION_BUILDER_OPERATORS_PAGE_TITLE"),navButtonPress:t.bind(this,this.getId()+X.PAGE_MAIN)}))}if(n.length>0){o.addPage(new E({id:this.getId()+X.PAGE_VARIABLE,content:[i(),new d({direction:$.Column,items:n}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiTinyMarginTop")],showNavButton:true,title:W.getText("CALCULATION_BUILDER_VARIABLES_PAGE_TITLE"),navButtonPress:t.bind(this,this.getId()+X.PAGE_MAIN)}))}if(a.length>0){o.addPage(new E({id:this.getId()+X.PAGE_FUNCTIONS,content:[i(),new d({direction:$.Column,items:[e.functionList]}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiTinyMarginTop")],showNavButton:true,title:W.getText("CALCULATION_BUILDER_FUNCTIONS_PAGE_TITLE"),navButtonPress:t.bind(this,this.getId()+X.PAGE_MAIN)}))}this.getGroups().forEach(function(e){var r=new E({id:this.getId()+e.getKey(),showNavButton:true,title:e._getTitle(),navButtonPress:t.bind(this,this.getId()+X.PAGE_MAIN),content:i()});var n=e.getCustomView();if(n){var a=new N;a.setAssociation("control",n);r.addContent(a)}else{r.addContent(new d({direction:$.Column,items:this._createPopoverVariablesItems(this._mGroups[e.getKey()])}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiTinyMarginTop"))}o.addPage(r)}.bind(this));e.navContainer=o};Q.prototype._callFunctionFireSelection=function(e){this.getGroups().forEach(function(t){if(t.getCustomView()){t.fireSetSelection({key:e})}})};Q.prototype._clearVariableLists=function(){this._aVariableLists.forEach(function(e){var t=e.getSelectedItem();if(t){e.setSelectedItem(t,false)}});this._callFunctionFireSelection()};Q.prototype._setVariableListSelection=function(e){for(var t=0;t<this._aVariableLists.length;t++){var i=this._aVariableLists[t],r=this._aVariableLists[t].getItems();for(var n=0;n<r.length;n++){if(r[n]._calculationBuilderKey===e){i.setSelectedItem(r[n],true);return}}}this._callFunctionFireSelection(e)};Q.prototype._sanitizeStringLiteral=function(e){if(this.getParent()._isStringLiteral(e)){e=e.substring(1,e.length-1)}return e};Q.prototype._clearSearchField=function(){if(this._oSearchField){this._oSearchField.setValue("");this._oSearchField.fireLiveChange()}};Q.prototype._createPopover=function(e){var t=function(){var t=this._oCurrentItem,i=e.navContainer.getCurrentPage().getId(),r=e.functionList.getSelectedItem(),n,a,s;var o=this.getParent().getAllowStringLiterals()?"":0;e.literalInput.setValue(o);this._clearVariableLists();this._clearSearchField();if(r){e.functionList.setSelectedItem(r,false)}if(!t){n=this.getId()+X.PAGE_MAIN}else{if(t._isFunction()){s=t.getKey();n=this.getId()+X.PAGE_FUNCTIONS;a=e.functionList.getItems();for(var l=0;l<a.length;l++){var u=a[l].data("functionKey");if((u&&u.toLowerCase())===s.toLowerCase()){e.functionList.setSelectedItem(a[l],true);break}}}else if(t._isLiteral()){var p=this._sanitizeStringLiteral(t.getKey());e.literalInput.setValue(p);e.literalInput.setValueState(K.None);n=this.getId()+X.PAGE_MAIN}else if(t._isVariable()){this._setVariableListSelection(t.getKey());var c=t._oVariable||t.getVariable(),d=c&&c.getGroup()||X.PAGE_VARIABLE;n=this.getId()+d}else if(t._isSecondaryOperator()){n=this.getId()+X.PAGE_OPERATORS}else{n=this.getId()+X.PAGE_MAIN}}if(n!==i){if(n!==this.getId()+X.PAGE_MAIN){e.navContainer.backToPage(this.getId()+X.PAGE_MAIN)}e.navContainer.to(e.navContainer.getPage(n),"show")}else{e.navContainer.getCurrentPage().setFooter(this._getPageFooter(i,e))}var _=this._oCurrentItem&&this._oCurrentItem._getItemError(),h=_&&" "+_.title;this._aStrips.forEach(function(e){e.setVisible(!!_);e.setText(h?W.getText("CALCULATION_BUILDER_INCORRECT_SYNTAX")+h:"")})}.bind(this);this._oPopover=new R({showHeader:false,resizable:true,placement:U.PreferredBottomOrFlip,contentWidth:"400px",contentHeight:"450px",content:[e.navContainer],beforeOpen:t,afterClose:function(){this._bDragging=false;this._clearNewButtonPositions()}.bind(this)})};Q.prototype._submitLiteralInput=function(e){var t=e.getValue();if(this.getParent()&&this.getParent().getAllowStringLiterals()&&!jQuery.isNumeric(t)){t='"'+t+'"'}this._updateOrCreateItem({type:G.Literal,key:t});e.setValueState(K.None)};Q.prototype._getPageFooter=function(e,t){var i=false,r=false,n=false;if(this._oCurrentItem&&!this._oCurrentItem._bIsNew){r=true;n=this._oCurrentItem._isLiteral()}i=t.literalInput.getValueState()===K.None&&e===this.getId()+X.PAGE_MAIN&&n;t.footerButtons.okButton=new c({enabled:i,text:W.getText("CALCULATION_BUILDER_CONFIRM_BUTTON"),press:function(e){this._submitLiteralInput(t.literalInput)}.bind(this)});t.footerButtons.deleteButton=new c({enabled:r,text:W.getText("CALCULATION_BUILDER_DELETE_BUTTON"),press:this._deleteItem.bind(this)});t.footerButtons.closeButton=new c({text:W.getText("CALCULATION_BUILDER_CLOSE_BUTTON"),press:this._instantClose.bind(this)});return new b({content:[new u,t.footerButtons.okButton,t.footerButtons.deleteButton,t.footerButtons.closeButton]})};Q.prototype._insertFunctionItems=function(e,t){var i=function(t){e.push(t)};if(t&&t.length>0){t.forEach(function(e){i(e)})}else{i("")}i(")")};Q.prototype._updateOrCreateItem=function(e){var t=!this._oCurrentItem||this._oCurrentItem._bIsNew,i=this._oCurrentItem&&!this._oCurrentItem.getKey(),r=this.getParent(),n=e.functionObject,a=this.getItems();var s=function(){var t=e.type===G.Function?n.template:r._convertToTemplate(n.getItems());this._insertFunctionItems(u,t)}.bind(this);var o=function(){var e=isNaN(this._iCurrentIndex)?this.getItems().length:this._iCurrentIndex,t=this._getKeys();this._smartRender(t.slice(0,e).concat(u,t.slice(e)))}.bind(this);var l=function(){for(var e=0;e<a.length;e++){if(a[e]===this._oCurrentItem){return e+1}}return null}.bind(this);if(t){var u=[e.key];if(n){s()}o()}else{this._oCurrentItem.setKey(e.key);if(e.type){this._oCurrentItem._sType=e.type}if(i&&n){var u=[];this._iCurrentIndex=l();s();o()}}this._instantClose();this._fireChange()};Q.prototype._expandAllVariables=function(){this.getItems().forEach(function(e){if(e.isExpandable()){e._expandVariable(false)}});this._fireChange()};Q.prototype._handleDelete=function(e){if(this._isEmptySelected()){return}this._bAreSelectedItemsDeleting=true;a.show(W.getText("CALCULATION_BUILDER_DELETE_MESSAGE_TEXT"),{icon:a.Icon.WARNING,title:W.getText("CALCULATION_BUILDER_DELETE_MESSAGE_TITLE"),actions:[a.Action.YES,a.Action.CANCEL],onClose:function(e){if(e===a.Action.YES){var t=this.$().find(".sapCalculationBuilderSelected .sapCalculationBuilderItem"),i=t.length,r=t.first(),n=sap.ui.getCore().byId(r.attr("id"));if(n){var s=this._getKeys();s.splice(n._iIndex,i);this._smartRender(s);this._fireChange()}}this._bAreSelectedItemsDeleting=false}.bind(this)})};Q.prototype._handleEnter=function(e){var t=jQuery(e.target),i;if(this._oItemNavigation&&!this._bReadOnly){if(t.hasClass("sapCalculationBuilderNewItem")){i=this._getNewItem();if(i){i._buttonPress(e)}}else if(t.hasClass("sapCalculationBuilderItem")){i=this._getItemById(t[0].id);if(i){i._buttonPress(e)}}else if(t.hasClass("sapCalculationBuilderItemExpandButton")){i=this._getItemById(t.closest(".sapCalculationBuilderItem")[0].id);if(i){i._expandButtonPress(e)}}}};Q.prototype._createVariablesMap=function(){this._mGroups={};this._aVariableLists=[];this.getVariables().forEach(function(e){var t=e.getGroup()||z;if(!this._mGroups[t]){this._mGroups[t]=[]}this._mGroups[t].push(e)}.bind(this))};Q.prototype._handleSpace=function(e){this._selectItem(e.target)};Q.prototype._handleCtrlNext=function(e){this._moveItems(H.KEY_NEXT)};Q.prototype._handleCtrlPrevious=function(e){this._moveItems(H.KEY_PREVIOUS)};Q.prototype._getVariableByKey=function(e){var t=this.getVariables();if(!e){return null}e=e.toLowerCase();for(var i=0;i<t.length;i++){if(t[i].getKey().toLowerCase()===e){return t[i]}}return null};Q.prototype.setTitle=function(e){var t=this._oToolbarTitle;if(t){t.setText(e);t.setVisible(!!e)}this.setProperty("title",e)};Q.prototype._getKeys=function(){return this.getItems().map(function(e){return e.getKey()})};Q.prototype._deleteItem=function(){var e=this._getKeys();e.splice(this._oCurrentItem._iIndex,1);this._smartRender(e);this._instantClose();this._fireChange()};Q.prototype._openDialog=function(e){this._oCurrentItem=e.currentItem;this._iCurrentIndex=e.index;this._oPopover.openBy(e.opener)};Q.prototype._setupDroppable=function(e){var t=this;e=e||this.$().find(".sapCalculationBuilderDroppable");e.droppable({scope:t.getId()+"-scope",tolerance:"pointer",activeClass:"sapCalculationBuilderDroppableActive",hoverClass:"sapCalculationBuilderDroppableActive",drop:function(e,i){if(!i.draggable.hasClass("sapCalculationBuilderSelected")){t._selectItem(i.draggable[0])}t._moveItems(H.MOUSE,parseInt(jQuery(this).attr("index"),10));t._bDragging=false},over:function(e,i){t._bDragging=true}})};Q.prototype._clearNewButtonPositions=function(){var e=this.$();e.find(".sapCalculationBuilderDelimiterNewButton").hide(200);e.find(".sapCalculationBuilderItem").animate({left:0},300)};Q.prototype._setupNewButtonEvents=function(){var e=13,t=300;var i=this.$().find(".sapCalculationBuilderDelimiter[data-events!='bound']"),r=this.$().find(".sapCalculationBuilderDelimiterNewButton[data-events!='bound']"),n=this,a,s;var o=function(e,i){e.prev().animate({left:-i},t);e.next().animate({left:i},t)};r.on("click",function(e){var t=jQuery(this),i=parseInt(t.parent().attr("index"),10);t.css("opacity",1);n._oCurrentItem=null;n._iCurrentIndex=i;n._openDialog({opener:this,index:i})});r.attr("data-events","bound");i.on("mouseover",function(t){var i=jQuery(this);if(!n._bDragging&&!n._oPopover.isOpen()){a=true;s=setTimeout(function(){if(a){a=false;o(i,e);i.find(".sapCalculationBuilderDelimiterNewButton").show(200)}},400)}});i.on("mouseout",function(e){var t=jQuery(this).find(".sapCalculationBuilderDelimiterNewButton"),i=jQuery(this);if(e.target===t[0]&&e.relatedTarget===i[0]){return}a=false;clearTimeout(s);if(n._bDragging||n._oPopover.isOpen()){return}if(!t.is(":hover")){o(i,0);t.hide(200)}});i.attr("data-events","bound")};Q.prototype._setupSelectable=function(){this.$().selectable({cancel:".sapCalculationBuilderCancelSelectable",distance:5,start:function(){this._deselect();this._instantClose()}.bind(this),stop:function(){this._selectItems(this.$().find(".sapCalculationBuilderItem.ui-selected"))}.bind(this)})};Q.prototype._selectItemsTo=function(e){var t=jQuery(e.next(".sapCalculationBuilderDelimiter")[0]),i=t.attr("index")-1,r=this.$(),n,a,s,o,l;if(e.parent().hasClass("sapCalculationBuilderSelected")||this._isEmptySelected()){this._selectItem(e);return}if(i>this._iLastSelectedIndex){n=this._iFirstSelectedIndex;a=i+1}else{n=i;a=this._iLastSelectedIndex+1}this._deselect();o=r.find('.sapCalculationBuilderDelimiter[index="'+n+'"]');l=r.find('.sapCalculationBuilderDelimiter[index="'+a+'"]');s=o.nextUntil(l,".sapCalculationBuilderItem");this._selectItems(s)};Q.prototype._selectItems=function(e){for(var t=0;t<e.length;t++){this._selectItem(e[t])}};Q.prototype._selectItem=function(e){var t=this.$().find(".sapCalculationBuilderSelected"),i=jQuery(e),r=jQuery(i.next(".sapCalculationBuilderDelimiter")[0]),n=t[0].children.length,a=r.attr("index")-1,s=true;if(!this._oItemNavigation||!this._getItemById(i[0].id)||this._bReadOnly){return}if(n===0){this._iFirstSelectedIndex=a;this._iLastSelectedIndex=a}else{if(i.parent().hasClass("sapCalculationBuilderSelected")){if(this._iFirstSelectedIndex===a){this._iFirstSelectedIndex++;this._deselectItem(i,false)}else if(this._iLastSelectedIndex===a){this._iLastSelectedIndex--;this._deselectItem(i,true)}else{this._deselect()}this._setCorrectFocus();return}if(this._iFirstSelectedIndex-a===1){this._iFirstSelectedIndex=a;s=false}else if(a-this._iLastSelectedIndex===1){this._iLastSelectedIndex=a;s=true}else{this._iFirstSelectedIndex=a;this._iLastSelectedIndex=a;this._deselect()}}var o=this.$();if(this._isEmptySelected()){t.detach().insertBefore(i);t.draggable({revert:"invalid",cursor:"move",axis:"x",scope:this.getId()+"-scope",helper:function(e){var i=t.clone();i.removeClass("sapCalculationBuilderSelected");i.addClass("sapCalculationBuilderDraggingSelectedClone");return i},start:function(){t.addClass("sapCalculationBuilderDragging");o.find(".sapCalculationBuilderItemContent").css("cursor","move")},stop:function(){t.removeClass("sapCalculationBuilderDragging");o.find(".sapCalculationBuilderItemContent").css("cursor","pointer")}})}if(s){i.detach().appendTo(t);r.detach().appendTo(t)}else{r.detach().prependTo(t);i.detach().prependTo(t)}if(i.hasClass("sapCalculationBuilderItem")){i.draggable("disable");i.addClass("ui-selected")}this._setCorrectFocus()};Q.prototype._isEmptySelected=function(){var e=this.$().find(".sapCalculationBuilderSelected");if(e){return e.is(":empty")}return true};Q.prototype._deselectItem=function(e,t){var i=this.$().find(".sapCalculationBuilderSelected"),r=jQuery(e.next(".sapCalculationBuilderDelimiter")[0]);if(!e.hasClass("ui-selected")){return}if(t){r.detach().insertAfter(i);e.detach().insertAfter(i)}else{e.detach().insertBefore(i);r.detach().insertBefore(i)}e.draggable("enable");e.removeClass("ui-selected")};Q.prototype._deselect=function(){var e=this.$().find(".sapCalculationBuilderSelected");if(this._isEmptySelected()){return}this.$().find(".sapCalculationBuilderSelected .ui-selected").removeClass("ui-selected");e.children().each(function(){var t=jQuery(this);if(t.hasClass("sapCalculationBuilderItem")){t.draggable("enable")}t.detach().insertBefore(e)})};Q.prototype._setupKeyboard=function(){var e=this.getDomRef(),t=[];this.getItems().forEach(function(e){t.push(e.getFocusDomRef());if(e.isExpandable()){t.push(e.$("expandbutton"))}});t.push(this._getNewItem().getFocusDomRef());if(!this._oItemNavigation){this._oItemNavigation=new n;this.addDelegate(this._oItemNavigation)}this._oItemNavigation.setRootDomRef(e);this._oItemNavigation.setItemDomRefs(t);this._oItemNavigation.setCycling(true);this._oItemNavigation.setPageSize(250)};Q.prototype._setCorrectFocus=function(){jQuery(this._oItemNavigation.getFocusedDomRef()).focus()};Q.prototype._getItemById=function(e){return this.getItems().filter(function(t){return t.getId()===e})[0]};Q.prototype._getNewItem=function(){if(!this._oNewItem){this._oNewItem=new t;this._oNewItem._bIsNew=true;this._oNewItem.setParent(this,null,true)}return this._oNewItem};Q.prototype._instantClose=function(){var e=this._oPopover.getAggregation("_popup");if(e&&e.oPopup&&e.oPopup.close){e.oPopup.close(0);this._setCorrectFocus()}};Q.prototype._attachAriaLabelToButton=function(e,t){e.addEventDelegate({onAfterRendering:function(e){e.srcControl.$("content").attr("aria-label",t)}})};Q.prototype._printErrors=function(){this.getItems().forEach(function(e){var t=e._getItemError(),i=e.$(),r=!!t?"addClass":"removeClass";i[r]("sapCalculationBuilderItemErrorSyntax")});if(this.getParent().getLayoutType()===Y.VisualOnly){this._showErrorIcon()}};Q.prototype._validateSyntax=function(e){var t=function(){var e=this.getItems()[f],t=e.getKey();return!e._isOperator()||t==="("||t==="+"||t==="-"||t.toLowerCase()==="not"}.bind(this);var i=function(){var e=this.getItems(),t=e[I-1];return!t._isOperator()||t.getKey()===")"}.bind(this);var r=function(e){var t=e.getKey().toLowerCase();if(e._isOperator()){return t==="not"||t==="("||t===")"?t:"#op#"}return e._isFunction()?"#fun#":"#col#"};var n=function(e){return{index:T,item:e,items:[],text:e.getKey()+(e._isFunction()?"(":"")}};var a=function(e){var t=1,i=T;T++;for(;T<p.length;T++){var r=p[T],s=r.getKey(),o=n(r);e.items.push(o);switch(s){case")":t--;break;case"(":t++;break;case",":t=1;break}if(r._isFunction()){a(o);e.text+=o.text}else{e.text+=s}if(t===0){return e}}E.push({index:i,title:W.getText("CALCULATION_BUILDER_CLOSING_BRACKET_ERROR_TEXT")});return e};var s=function(e){var t=this.getParent()._getFunctionAllowParametersCount(e.item.getKey()),i=[],r=[];e.items.forEach(function(e){if(e.item._isComma()){i.push(r);r=[]}else{r.push(e)}});if(r.length>0&&r[r.length-1].text===")"){r.pop()}i.push(r);if(i.length!==t){E.push({index:e.index,title:W.getText(i.length<t?"CALCULATION_BUILDER_TOO_LITTLE_PARAMETERS":"CALCULATION_BUILDER_TOO_MANY_PARAMETERS")})}if(i.length>0){i.forEach(function(t){if(t.length>0){jQuery.merge(E,this._validateSyntax({from:t[0].index,to:t[t.length-1].index+1}))}else{E.push({index:e.index,title:W.getText("CALCULATION_BUILDER_EMPTY_PARAMETER")})}}.bind(this))}}.bind(this);var o=0;var l=function(){var e=_.getKey()==="+"||_.getKey()==="-";if(e){o++;if(o>2){E.push({index:T,title:W.getText("CALCULATION_BUILDER_SYNTAX_ERROR_TEXT")})}}else{o=0}};var u={"#op#":["(","#col#","#fun#","not","+","-"],"(":["(","+","-","#col#","#fun#","not"],")":["#op#",")"],"#col#":["#op#",")"],"#fun#":["(","+","-","#col#","#fun#"],not:["#col#","#fun#","not","("]};e=e||{};var p=e.items||this.getItems(),c,d,_,h,g,f=e.from||0,I=e.to||p.length,m=f===0&&I===p.length,C=[],E=[];if(p.length>0){if(!t()){E.push({index:f,title:W.getText("CALCULATION_BUILDER_FIRST_CHAR_ERROR_TEXT")})}if(!i()){E.push({index:I-1,title:W.getText("CALCULATION_BUILDER_LAST_CHAR_ERROR_TEXT")})}}for(var T=f;T<I;T++){_=p[T];if(_._getType()===G.Error){E.push({index:T,title:W.getText("CALCULATION_BUILDER_SYNTAX_ERROR_TEXT")});continue}l();if(!e.skipCustomValidation&&_._isFunction()){var A=_._getCustomFunction(),L=a(n(_));if(A&&!A.getUseDefaultValidation()){var v=new S;this.getParent().fireValidateFunction({definition:L,customFunction:A,result:v});jQuery.merge(E,v.getErrors())}else{s(L)}}if(T<I-1){h=p[T+1];c=r(p[T]);d=r(h);g=h?h.getKey().toLowerCase():"";var y=h._isCustomOperator()||_._isCustomOperator();if(u[c].indexOf(d)===-1&&u[c].indexOf(g)===-1&&!y){var B={index:T+1};if(_._isOperator()&&h._isOperator()){B.title=W.getText("CALCULATION_BUILDER_BEFORE_OPERATOR_ERROR_TEXT",h.getKey())}else if(!_._isOperator()&&!h._isOperator()){B.title=W.getText("CALCULATION_BUILDER_BETWEEN_NOT_OPERATORS_ERROR_TEXT",[_.getKey(),h.getKey()])}else if(_.getKey()===")"&&!h._isOperator()){B.title=W.getText("CALCULATION_BUILDER_AFTER_CLOSING_BRACKET_ERROR_TEXT")}else if(!_._isOperator()&&h.getKey()==="("){B.title=W.getText("CALCULATION_BUILDER_BEFORE_OPENING_BRACKET_ERROR_TEXT")}else{B.title=W.getText("CALCULATION_BUILDER_CHAR_ERROR_TEXT")}E.push(B)}}if(_._isFunction()){continue}if(m&&_.getKey()===","){E.push({index:T,title:W.getText("CALCULATION_BUILDER_WRONG_PARAMETER_MARK")})}if(_._isOperator()&&_.getKey()==="("||_._isFunction()){C.push(T)}if(_._isOperator()&&_.getKey()===")"){if(C.length===0){E.push({index:T,title:W.getText("CALCULATION_BUILDER_OPENING_BRACKET_ERROR_TEXT")})}else{C.pop()}}}for(T=0;T<C.length;T++){E.push({index:C[T],title:W.getText("CALCULATION_BUILDER_CLOSING_BRACKET_ERROR_TEXT")})}return E};Q.prototype._getType=function(e){return this.getParent()&&this.getParent()._getType(e)};Q.prototype._moveItems=function(e,t){var i=[],r=this.$(),n=this.getItems(),a=r.find(".sapCalculationBuilderSelected"),s,o,l,u;if(this._isEmptySelected()){return}u=a.length>1?jQuery(a[0]).children():a.children();if(e===H.KEY_PREVIOUS){o=this._iFirstSelectedIndex-1}else if(e===H.KEY_NEXT){o=this._iLastSelectedIndex+2}else if(e===H.MOUSE){o=t}if(o<0||o===n.length+1){return}s=this.$().find('.sapCalculationBuilderDelimiter[index="'+o+'"]');for(var p=0;p<n.length+1;p++){l=n[p];if(o===p){u.each(function(){var e=jQuery(this),t;if(e.hasClass("sapCalculationBuilderItem")){t=sap.ui.getCore().byId(jQuery(this)[0].id);i.push(t);t._bMovingItem=true;e.draggable("enable")}e.css("left",0+"px");e.detach().insertAfter(s).removeClass("");s=e})}if(l&&!l.$().parent().hasClass("sapCalculationBuilderSelected")&&!l._bMovingItem){i.push(l)}}a.css("left","");r.find(".sapCalculationBuilderDelimiter").each(function(e){jQuery(this).attr("index",e)});this.removeAllAggregation("items",true);i.forEach(function(e,t){e._bMovingItem=false;e._iIndex=t;this.addAggregation("items",e,true)}.bind(this));this._setupKeyboard();this._selectItems(u.filter(function(e,t){return jQuery(t).hasClass("sapCalculationBuilderItem")}));this._fireChange()};Q.prototype._fireAfterValidation=function(){this.getParent().fireAfterValidation()};Q.prototype._setItems=function(e){this.removeAllAggregation("items",true);(e||[]).forEach(function(e){this.addAggregation("items",this._convertFromNewItem(e),true)}.bind(this))};Q.prototype._getKeyFromCreatedItem=function(e){return typeof e==="object"?e.getKey():e};Q.prototype._convertFromNewItem=function(e){return typeof e==="object"?e:new t({key:e})};Q.prototype._showErrorIcon=function(){var e=this.$("erroricon"),t=this.getParent(),i=t._createErrorText(null,true);if(i){e.show();e.attr("title",t._createErrorText(null,true))}else{e.hide()}};Q.prototype._smartRender=function(e){var t,i=this.$(),r=[],n=this.getItems(),a=n.length,s=sap.ui.getCore().createRenderManager();var o=function(e){e=this._convertFromNewItem(e);this.addAggregation("items",e,true);e._iIndex=t;if(i[0]){e._render(s);this._renderDelimiter(s,t+1)}e.bOutput=true;r.push(e)}.bind(this);if(!this.getParent()._isExpressionVisible()){this._setItems(e);return}this._bRendered=false;this._bIsCalculationBuilderRendering=true;this._deselect();for(var t=0;t<e.length;t++){var l=n[t],u=e[t],p=typeof u==="object"&&u.getKey?u.getKey():u,c=u._sType?u._sType:"";if(!l){o(e[t])}else if(l.getKey()!==p||l._sType!==c){l.setKey(p,true);l._sType=c;var d=l.$();l._innerRender(s,d[0]);d.attr("class",l._getClass(null,s,true));d.attr("title",l._getTooltip());l._setEvents()}}if(e.length<a){for(var t=e.length;t<n.length;t++){var d=n[t].$();d.next().remove();d.remove();this.removeAggregation("items",n[t],true)}}if(i[0]&&r.length>0){s.flush(i[0],false,i.children().index(i.find(".sapCalculationBuilderDelimiter").last()[0])+1);r.forEach(function(e){e._afterRendering()});this._setupDroppable(i.find(".sapCalculationBuilderDroppable").filter(function(){return parseInt(jQuery(this).attr("index"),10)>a}))}this._bRendered=true;this._setupKeyboard();this._setupNewButtonEvents();this._bIsCalculationBuilderRendering=false};Q.prototype._fireChange=function(){this.fireEvent("change")};return Q});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderFunction", ["./library","sap/ui/core/Control"],function(e,t){"use strict";var u=t.extend("sap.suite.ui.commons.CalculationBuilderFunction",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},useDefaultValidation:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{items:{type:"sap.suite.ui.commons.CalculationBuilderItem",multiple:true,singularName:"item"}}},renderer:null});u.prototype._getLabel=function(){return this.getLabel()||this.getKey()};return u});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderGroup", ["./library","sap/ui/core/Control"],function(e,t){"use strict";var i=t.extend("sap.suite.ui.commons.CalculationBuilderGroup",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},icon:{type:"string",group:"Misc",defaultValue:null}},events:{setSelection:{parameters:{key:"string"}}},aggregations:{customView:{type:"sap.ui.core.Control",multiple:false}}}});i.prototype._getTitle=function(){return this.getTitle()||this.getKey()};return i});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderInput", ["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","./CalculationBuilderItem","sap/m/List","sap/m/StandardListItem","sap/m/Popover","sap/m/Button","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem","sap/m/OverflowToolbar","sap/m/ToolbarSeparator","sap/m/ToolbarSpacer","sap/m/Title","sap/m/OverflowToolbarToggleButton","sap/ui/core/CustomData","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/dom/containsOrEquals","sap/m/library"],function(jQuery,t,e,i,n,o,r,s,a,u,p,l,h,g,f,c,d,_,C,S,y,T){"use strict";var m=T.ButtonType;var I=T.PlacementType;var v=T.ListMode;var b="&nbsp;&nbsp;";var L="┘┘";var x=t.CalculationBuilderItemType,E=t.CalculationBuilderValidationMode;var w=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var O=function(t){if(typeof t.which==="undefined"){return true}else if(typeof t.which==="number"&&t.which>0){return!t.ctrlKey&&!t.metaKey&&!t.altKey&&t.which!==8}return false};var P=function(t,e){var i,n="",o=0;if(t instanceof jQuery){t=t[0]}var r=t.nodeType;if(!r){while(i=t[o++]){n+=P(i,e)}}else if(r===1||r===9||r===11){for(t=t.firstChild;t;t=t.nextSibling){n+=P(t,e)}}else if(r===3||r===4){n+=e&&jQuery(t).parent().hasClass("sapCalculationBuilderItemTextEmpty")&&t.nodeValue==="  "?"┘┘":t.nodeValue}return n};var A=e.extend("sap.suite.ui.commons.CalculationBuilderInput",{metadata:{library:"sap.suite.ui.commons",events:{change:{parameters:{value:"String",position:"integer",validate:"boolean"}}}},renderer:{apiVersion:2,render:function(t,e){if(e.getParent().getShowInputToolbar()&&!e._bReadOnly){t.openStart("div");t.class("sapCalculationBuilderInputToolbarWrapper");t.openEnd();t.renderControl(e._oInputToolbar);t.close("div")}t.openStart("div",e);t.class("sapCalculationBuilderInputWrapper");t.attr("aria-label","");t.openEnd();t.openStart("div");t.attr("aria-label","");t.attr("aria-describedby",e.getId()+"-error");t.attr("spellcheck","false");if(!e._bReadOnly){t.attr("contenteditable","true")}t.attr("id",e.getId()+"-input");t.class("sapCalculationBuilderInput");t.openEnd();t.close("div");t.openStart("div");t.attr("id",e.getId()+"-error");t.class("sapCalculationBuilderInputErrorArea");t.openEnd();t.close("div");t.close("div")}}});A.prototype.init=function(){this._setupSuggestionList();this._iCarretPosition=0;this._sSuggestionText="";this._aVariables=[];this._oInputToolbar=new l(this.getId()+"-toolbar").addStyleClass("sapCalculationBuilderInputToolbar");this.addDependent(this._oInputToolbar)};A.prototype.exit=function(){if(this._oPopup){this._oPopup.destroy()}if(this._oInputToolbar){this._oInputToolbar.destroy()}};A.prototype.onAfterRendering=function(){this._setupKeyPress();this._setupEvents();this._setupAriaLabel()};A.prototype.onBeforeRendering=function(){this._aFunctions=this.getParent()._getAllFunctions();this._fillInputToolbar()};A.prototype.getFocusDomRef=function(){return this.getDomRef("input")};A.prototype._setupEvents=function(){var t=this.$("input");t.blur(function(){this._lastRangeSelection=this._getSelectionRange()}.bind(this));t.on("mouseup",function(t){this._iCarretPosition=this._getCaretPosition()}.bind(this))};A.prototype._validate=function(t){var e=this.getParent();if(e&&e.getValidationMode()===E.FocusOut){this.getParent()._validateInput(P(this.$("input")),t?this._iCarretPosition:0)}};A.prototype._setupKeyPress=function(){var t=this,e=this.getParent(),i=e&&e.getAllowSuggestions()&&S.system.desktop,n="paste input";this.$("input").on("focus",function(){var t=jQuery(this);t.data("before",P(t[0]))}).on(n,function(e){var n=jQuery(this),o=n.data("before"),r=e.key,s=P(n[0]);if(t._oPopup.isOpen()&&r==="Enter"){return}if(o!==s){var a=t._iCarretPosition=t._getCaretPosition();t._storeCurrent();t.fireChange({position:Math.max(0,a),value:P(n[0],true)});if(i){t._checkSuggestions(a,s,O(e));if(t._sSuggestionText.length>0){t._filterSuggestionList(t._sSuggestionText);if(t._oSuggestionList.getItems().length===0){t._oPopup.close()}else{t._findCurrentSpan();if(!t._oPopup.isOpen()){var u=sap.ui.getCore().getConfiguration().getRTL(),p=jQuery(t._oCurrentSpan),l=u?-(n.width()-p.position().left-p.width()):p.position().left;var h=parseInt(l,10),g=t.$("input").outerHeight()-(parseInt(jQuery(t._oCurrentSpan).position().top,10)+jQuery(t._oCurrentSpan).height())-10;t._iSuggestionSelectedIndex=-1;t._oPopup.setOffsetX(h);t._oPopup.setOffsetY(-g);t._oPopup.openBy(t.getDomRef("input"))}}}}}})};A.prototype._createItemSpan=function(t,e){var i=function(){if(!t){return"sapCalculationBuilderItemTextEmpty"}if(e){return"sapCalculationBuilderItemTextError"}if(this._isOperator(t)){return"sapCalculationBuilderItemTextOperator"}return"sapCalculationBuilderItemTextDefault"}.bind(this);var n=t?"text":"html";var o=jQuery("<span></span>",{title:e?e.title:"",class:i()})[n](t||b);return o};A.prototype._findCurrentSpan=function(){var t;if(window.getSelection&&window.getSelection().getRangeAt){t=window.getSelection();this._oCurrentSpan=t.anchorNode.parentNode;if(!jQuery(this._oCurrentSpan).is("span")){this._oCurrentSpan=this.$("input").children().first()[0]}}return this._oCurrentSpan};A.prototype._setupSuggestionList=function(){var t=new _({path:"grouptitle",descending:false,group:function(t){return t.getProperty("grouptitle")}});var e=function(t){var e=this._createItemSpan(t);jQuery(this._oCurrentSpan).after(e);return e}.bind(this);var i=function(t){var e=t.innerText,i=this._sSuggestionText.toLowerCase(),n=i.length,o=e.toLowerCase(),r="",s=(" "+o).indexOf(" "+i),a;if(s>-1){r+=e.substring(0,s);a=e.substring(s,s+n);r+='<span class="sapMInputHighlight">'+a+"</span>";r+=e.substring(s+n)}else{r=e}return r}.bind(this);this._oSuggestionList=new n({mode:v.SingleSelectMaster,showNoData:false,enableBusyIndicator:false,rememberSelections:false,items:{path:"/data",factory:function(t,e){var i=e.getProperty(e.oModel.sPath),n=new o({title:i.title,customData:[new d({key:"key",value:i.key})]});n.addStyleClass("sapCalculationBuilderSuggestionItem");return n},sorter:t},selectionChange:function(t){var i=t.getParameter("listItem"),n,o,r,s,a;if(i){s=i.getCustomData()[0].getValue();r=this._getFunction(s);jQuery(this._oCurrentSpan).text(r?s+"(":s+"");jQuery(this._oCurrentSpan).removeClass("sapCalculationBuilderItemTextError").addClass("sapCalculationBuilderItemTextDefault");this._iCarretPosition+=(s||"").length+1;if(r){a=this._getFunctionTemplateItems(r);n=a.length;if(n>0){a.forEach(function(t,i){this._oCurrentSpan=e(t)[0];if(!t&&!o){o=this._oCurrentSpan}if(!o&&t){this._iCarretPosition+=t.length}if(t&&i!==n-1){this._oCurrentSpan=e(" ")}}.bind(this))}else{o=this._oCurrentSpan=e("")[0]}var u=e(")");if(!o){this._oCurrentSpan=u[0]}}this._storeCurrent();var p=o||this._oCurrentSpan,l=p&&p.textContent&&p.textContent.length||0;this.fireChange({position:this._getCaretPosition(p,r?1:l),value:P(this.$("input")[0],true)})}this._oPopup.close()}.bind(this)});this._oSuggestionList.addEventDelegate({onAfterRendering:function(){this._oSuggestionList.$().find(".sapMDLILabel, .sapMSLITitleOnly, .sapMDLIValue").each(function(){this.innerHTML=i(this)});this._oSuggestionList.$().find(".sapMGHLI").addClass("sapCalculationBuilderSuggestionListHeader")}.bind(this)});this._oPopup=new r(this.getId()+"-popup",{contentWidth:"300px",showArrow:false,showHeader:false,placement:I.Vertical,horizontalScrolling:true,content:this._oSuggestionList,initialFocus:this}).attachAfterClose(function(t){this._clearSuggestion()}.bind(this))};A.prototype._checkSuggestions=function(t,e,i){var n=e[Math.max(t-1,0)];var o=function(t){return this._isOperator(t)||this._isEmptySpace(t)}.bind(this);if(!n||o(n)){this._clearSuggestion();return}var r=i?n:"",s=i?2:1;t=Math.max(t,0);for(var a=t-s;a>=0;a--){if(o(e[a])){break}r=e[a]+r}for(a=t;a<e.length;a++){if(o(e[a])){break}r=r+e[a]}if(!r){this._clearSuggestion()}this._sSuggestionText=r||""};A.prototype._clearSuggestion=function(){this._sSuggestionText="";this._oCurrentSpan={};this._oPopup.close()};A.prototype._filterSuggestionList=function(t){var e=[];var i=function(i,n,o,r){var s=(n||i).toLowerCase(),a=t.toLowerCase();if((" "+s).indexOf(" "+a)!==-1){e.push({title:n||i,key:i,type:o,grouptitle:r})}};var n=this.getParent();n.getOperators().forEach(function(t){i(t.getKey(),t.getText(),x.CustomOperator,w.getText("CALCULATION_BUILDER_OPERATORS_TITLE"))});this._aVariables.forEach(function(t){var e=t.getGroup(),o,r=w.getText("CALCULATION_BUILDER_VARIABLES_TITLE");if(e){o=n.getGroups().filter(function(t){return t.getKey()===e})[0];r=o?o.getTitle():r}i(t.getKey(),t.getLabel(),x.Variable,r)});this._aFunctions.forEach(function(t){i(t.key,t.title,x.Function,w.getText("CALCULATION_BUILDER_FUNCTIONS_TITLE"))});e.sort(function(t,e){return t.title.toUpperCase()<e.title.toUpperCase()?-1:1});this._oSuggestionList.setModel(new C({data:e}))};A.prototype._getCaretPosition=function(t,e){var i,n,o,r=0;var s=function(e){return t&&e===t||!t&&(e===n.anchorNode||e===n.anchorNode.parentNode)};var a=function(t){var e;if(s(t)){return false}if(t.nodeType===3){r+=t.textContent.length}else{for(var i=0;i<t.childNodes.length;i++){e=t.childNodes[i];if(s(e)){return false}r+=e.textContent.length}}return true};try{if(window.getSelection&&window.getSelection().getRangeAt){i=window.getSelection().getRangeAt(0);n=window.getSelection();o=this.$("input")[0].childNodes;for(var u=0;u<o.length;u++){if(!a(o[u])){break}}return(e||i.startOffset)+r}}catch(t){return this._iCarretPosition}return 0};A.prototype._getSelectionRange=function(){var t,e=0,i=this.$("input")[0];if(typeof window.getSelection!=="undefined"){try{var n=window.getSelection().getRangeAt(0),o=n.cloneRange();if(!y(i,n.startContainer)){return this._lastRangeSelection}o.selectNodeContents(i);o.setEnd(n.startContainer,n.startOffset);t=o.toString().length;e=t+n.toString().length}catch(i){e=t=this._iCarretPosition||0}}return{start:t,length:e-t}};A.prototype._setCaretPosition=function(t){var e=window.getSelection(),i=this.$("input"),n,o,r,s,a;var u=function(t){var e=i.children(),n,o,r=0;for(var s=0;s<e.length;s++){n=e[s];o=n.innerText||"";if(r+o.length>t){return{spanIndex:s,position:r+o.length-t}}r+=o.length}return{spanIndex:Math.max(s-1,0),position:100}};if(typeof t==="number"){t=u(t)}r=t&&t.span;if(t){n=i[0];if(!r){r=n&&n.children&&n.children.length>t.spanIndex?n.childNodes[t.spanIndex]:null}if(r){o=document.createRange();s=r.firstChild?r.firstChild:r;a=Math.min(s.length,t.position);o.setStart(s,a);o.collapse(true);e.removeAllRanges();e.addRange(o)}}};A.prototype._recreateText=function(t){var e=function(e){var i;if(e){if(!this._isEmptySpace(e)){i=jQuery.grep(t.errors,function(t){return t.index===s})[0]}if(e==="┘"){e=""}o+=this._createItemSpan(e,i)[0].outerHTML;if(!this._isEmptySpace(e)){s++}p++}}.bind(this);var i=function(){for(;f<r.length;f++){n();if(!this._isEmptySpace(r[f])&&r[f]!=="("){f--;break}h+=r[f];if(r[f]==="("){break}}e(h);h=""}.bind(this);var n=function(e){if(!l&&t.position===f){l={spanIndex:p-(e||0),position:e||h.length}}};var o="",r,s=0,a=this.getParent().getAllowStringLiterals(),u=false,p=0,l=null,h="",g;r=t.text||P(this.$("input")[0],true);for(var f=0;f<r.length;f++){g=r[f];n();if(g==='"'&&a){u=!u}if(u){h+=g;continue}if(g==="┘"||this._isEmptySpace(g)||this._isOperator(g)){if(this._isFunction(h)){i()}else{e(h);e(g);h=""}if(g==="┘"){f++;n(1)}}else{h+=g}}e(h);var c=this.$("input");c.html(o);if(c.is(":focus")){this._showErrorText(true,t.errors)}if(t.position>0){this._setCaretPosition(l||{spanIndex:p-1,position:Number.MAX_SAFE_INTEGER})}};A.prototype._setupAriaLabel=function(){var t,e,i;t=this.getParent();e=t._oExpressionBuilder._aErrors;i=w.getText("CALCULATION_BUILDER_EXPRESSION_TITLE")+": "+t.getExpression();if(e.length>0){i+=". "+w.getText("CALCULATION_BUILDER_ERROR_TITLE")+": ";e.forEach(function(t){i+=t.title+" "})}this.$().attr("aria-label",i)};A.prototype._showErrorText=function(t,e){var i=this.$("error"),n=this.getParent();e=e||n.getErrors();if(e&&e.length>0&&t){i.show();i.text(n._createErrorText())}else{i.hide()}};A.prototype._stringToItems=function(t){var e=[],n="",o="",r=0,s=false;var a=function(){var n,s="";if(o){n=this._getFunction(o);if(n){if(t[r]!=="("){s=x.Error;for(;r<t.length;r++){if(t[r]==="("){s="";break}if(!this._isEmptySpace(t[r])){r--;break}}}}var a=new i({key:o});a._sType=s;e.push(a)}o="";return!!n||!!s}.bind(this);if(typeof t==="undefined"){var u=this.$("input")[0];t=u?P(this.$("input")[0],true):""}for(;r<t.length;r++){n=t[r];if(n==='"'&&this.getParent().getAllowStringLiterals()){o+='"';if(s){e.push(new i({key:o}));o=""}s=!s;continue}if(s){o+=n;continue}if(n==="┘"){e.push(new i);r++;continue}if(this._isEmptySpace(n)){if(o){a()}continue}var p=t[r+1];if(p&&this._isOperator(n+p,false)){n+=p;r++}var l=this._isOperator(n,false);if(l){if(a()){continue}e.push(new i({key:n}))}else{o+=n}}a();return e};A.prototype._itemsToString=function(t){var e=t.items,i="",n="",o=t.createInputText!==false,r,s;for(var a=0;a<e.length;a++){var u=e[a],p=u.getKey(),l=this._isFunction(p);if(o){r=jQuery.grep(t.errors,function(t){return t.index===a})[0]}var h=p!==","&&p!==")"&&s!=="("&&s;if(o){h?n+=this._createItemSpan(" ",r)[0].outerHTML:"";n+=this._createItemSpan(p+(l?"(":""),r)[0].outerHTML}i+=(h?" ":"")+p+(l?"(":"");s=l?"(":p}if(o){this.$("input").html(n)}return i};A.prototype.onfocusin=function(t){if(this._bSetCaretOnFocus){this._setCaretPosition(this._iCarretPosition)}this._bSetCaretOnFocus=false;this._showErrorText(true)};A.prototype.onsapfocusleave=function(t){if(t.relatedControlId&&y(this._oPopup.getDomRef(),sap.ui.getCore().byId(t.relatedControlId).getFocusDomRef())){if(sap.ui.getCore().isMobile()||S.browser.safari){this._bSetCaretOnFocus=true}this.focus()}else{this._showErrorText(false);this._validate(false)}};A.prototype.onsappageup=function(t){this._suggestionListKeyHandling({event:t,add:true,toEnd:true});if(!this._oPopup.isOpen()){this._iCarretPosition=P(this.$("input")).length-1}};A.prototype.onsapnext=function(t){if(this._iCarretPosition<P(this.$("input")).length-1){this._iCarretPosition++}};A.prototype.onsapprev=function(t){if(this._iCarretPosition>0){this._iCarretPosition--}};A.prototype.onsappagedown=function(t){this._suggestionListKeyHandling({event:t,add:false,toEnd:true});if(!this._oPopup.isOpen()){this._iCarretPosition=0}};A.prototype.onsapdown=function(t){this._suggestionListKeyHandling({event:t,add:true})};A.prototype.onsapescape=function(t){if(this._oPopup.isOpen()){this._oPopup.close()}};A.prototype.onsapup=function(t){this._suggestionListKeyHandling({event:t,add:false})};A.prototype.onsapenter=function(t){if(this._oPopup.isOpen()){this._oSuggestionList.fireSelectionChange({listItem:this._oSuggestionList.getSelectedItem()})}else{this._validate(true)}t.preventDefault();t.stopPropagation()};A.prototype._suggestionListKeyHandling=function(t){var e=t.event,i=t.add,n=t.toEnd,o,r;if(!this._oPopup.isOpen()||!e){return}i?this._iSuggestionSelectedIndex++:this._iSuggestionSelectedIndex--;o=this._oSuggestionList.$().find(".sapCalculationBuilderSuggestionItem");r=o.length;if(this._iSuggestionSelectedIndex<0||!i&&n){this._iSuggestionSelectedIndex=r-1}else if(this._iSuggestionSelectedIndex>=r||i&&n){this._iSuggestionSelectedIndex=0}this._oSuggestionList.removeSelections(true);sap.ui.getCore().byId(o[this._iSuggestionSelectedIndex].id).setSelected(true).focus();e.preventDefault();e.stopPropagation()};A.prototype._displayError=function(t){this.$("input")[t?"addClass":"removeClass"]("sapCalculationBuilderInputError")};A.prototype._insertItemFromToolbar=function(t){var e=this.$("input"),i,n,o;var r=" "+t+" ",s=this._getFunction(t),a=r.length,u;var p=function(){return{start:e.text().length,length:0}};o=this._getSelectionRange()||p();e.focus();this._lastRangeSelection={};i=P(e[0],true);if(i[o.start]==="┘"&&i[o.start-1]==="┘"&&o.length===0){o.start--;o.length+=2}if(s){r=" "+t+"(";u=this._getFunctionTemplateItems(s);if(u.length>0){u.forEach(function(t){r+=t?t:L})}else{r+=L}r+=") ";a=r.indexOf(L)+1}n=[i.slice(0,o.start),r,i.slice(o.start+o.length)].join("");this.fireChange({value:n,position:o.start+a});this._storeCurrent()};A.prototype._convertEmptyHashes=function(t){return t?t.replace(new RegExp(L,"g"),"  "):""};A.prototype._fillInputToolbar=function(){var e=function(t,e){return new s({type:m.Transparent,text:t,press:this._insertItemFromToolbar.bind(this,t)}).addStyleClass("sapCalculationBuilderInputToolbarButtons "+e)}.bind(this);var i=function(t){if(t){return t.map(function(t){return new p({key:t.getKey(),text:t._getLabel()})}).sort(function(t,e){return t.getText().localeCompare(e.getText())})}return[]};var n=function(t){return t.map(function(t){return new p({key:t.getKey(),text:t.getText()?t.getText():t.getKey()})}).sort(function(t,e){return t.getText().localeCompare(e.getText())})};var o=function(t){return t.map(function(t){return new p({key:t,text:t})})};var r=function(){var t=this.getParent(),e=t.getAllowComparisonOperators(),i=t.getAllowLogicalOperators(),r=t.getOperators(),s=r.length>0,a,u,l,h=[];if(e){a=o(Object.keys(d));h.push(new p({text:w.getText("CALCULATION_BUILDER_COMPARISON_TITLE"),items:a}))}if(i){u=o(Object.keys(_));h.push(new p({text:w.getText("CALCULATION_BUILDER_LOGICAL_TITLE"),items:o(Object.keys(_))}))}if(s){l=n(r);h.push(new p({text:w.getText("CALCULATION_BUILDER_ADDITIONAL_OPERATOR"),items:l}))}if(h.length>1){return h}if(e){return a}if(i){return u}if(s){return l}return[]}.bind(this);var l=function(t){return new u({text:t,menu:new a({itemSelected:function(t){this._insertItemFromToolbar(t.getParameters().item.getKey())}.bind(this)})}).addStyleClass("sapCalculationBuilderInputToolbarFunctionMenu").addStyleClass("sapCalculationBuilderInputToolbarMenuButtons")}.bind(this);var c=t.CalculationBuilderOperatorType,d=t.CalculationBuilderComparisonOperatorType,_=t.CalculationBuilderLogicalOperatorType,C=r(),S=this.getParent(),y=!!S.getTitle()&&S.getLayoutType()===t.CalculationBuilderLayoutType.TextualOnly,T;this._oInputToolbar.removeAllContent();this._oInputToolbar.addContent(new f({text:S.getTitle(),visible:y}));this._oInputToolbar.addContent(new g);Object.keys(c).forEach(function(t){this._oInputToolbar.addContent(e(c[t],""))}.bind(this));this._oInputToolbar.addContent((new h).addStyleClass("sapUiSmallMarginBeginEnd"));if(C.length>0){this._oInputToolbar.addContent(new u({text:w.getText("CALCULATION_BUILDER_OPERATORS_TITLE"),menu:new a({itemSelected:function(t){this._insertItemFromToolbar(t.getParameters().item.getKey())}.bind(this),items:C})}).addStyleClass("sapCalculationBuilderInputToolbarMenuButtons"))}T=this._aFunctions.map(function(t){return new p({key:t.key,text:t.title})});var I=l(w.getText("CALCULATION_BUILDER_FUNCTIONS_AND_VARIABLES_TITLE"));if(T.length>0){I.getMenu().addItem(new p({text:w.getText("CALCULATION_BUILDER_FUNCTIONS_TITLE"),items:[T]}))}var v=S._getGroupMap(),b=S.getGroups(),L=v["##DEFAULT##"];if(L&&L.length>0){I.getMenu().addItem(new p({text:w.getText("CALCULATION_BUILDER_VARIABLES_TITLE"),items:i(L)}))}b.forEach(function(t){var e=v[t.getKey()];if(e&&e.length>0){I.getMenu().addItem(new p({text:t._getTitle(),items:i(e)}))}});this._oInputToolbar.addContent(I)};A.prototype._isOperator=function(t,e){return this.getParent()&&this.getParent()._isOperator(t,e)};A.prototype._getFunctionTemplateItems=function(t){return this.getParent()._getFunctionTemplateItems(t)};A.prototype._isEmptySpace=function(t){return t===String.fromCharCode(160)||t===" "};A.prototype._isEmptyItem=function(t){return t===b};A.prototype._getText=function(){return this.$("input").text()};A.prototype._isFunction=function(t){return!!this._getFunction(t)};A.prototype._getFunction=function(t){var e=this.getParent();return e&&e._isTokenAllowed(t)&&e._getFunctionDefinition(t)};A.prototype._storeCurrent=function(t){var e=this.$("input");e.data("before",e.text())};return A});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderItem", ["sap/ui/thirdparty/jquery","./library","sap/ui/base/Object","sap/ui/core/Control","sap/m/MessageBox","sap/base/security/encodeXML","./Utils","sap/ui/thirdparty/jqueryui/jquery-ui-core","sap/ui/thirdparty/jqueryui/jquery-ui-widget","sap/ui/thirdparty/jqueryui/jquery-ui-mouse","sap/ui/thirdparty/jqueryui/jquery-ui-draggable"],function(jQuery,t,e,i,r,n,a){"use strict";var s=t.CalculationBuilderItemType,o=t.CalculationBuilderOperatorType,u=t.CalculationBuilderLogicalOperatorType;var l=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var p=i.extend("sap.suite.ui.commons.CalculationBuilderItem",{constructor:function(t,e){if(typeof t!=="string"&&t!==undefined){e=t}if(e&&e.key){e.key=this._sanitizeKey(e.key)}i.apply(this,arguments)},metadata:{library:"sap/suite/ui/commons",properties:{key:{type:"string",group:"Misc",defaultValue:null}}},renderer:{apiVersion:2,render:function(t,e){e._render(t)}}});p.prototype._innerRender=function(t,e){var i=this._bReadOnly?"sapMBtnDisabled":"",r=this._getLabel(),a={"!=":"NOT_EQUAL","-":"MINUS",",":"COMMA"};var s=function(t){t.openStart("div");t.class("sapCalculationBuilderItemFocusWrapper");t.openEnd();t.openStart("div");t.class("sapCalculationBuilderItemFocus");t.openEnd();t.close("div");t.close("div")};var o=function(t){t.openStart("div");t.class("sapCalculationBuilderItemExpandButtonWrapper");t.attr("title",l.getText("CALCULATION_BUILDER_EXPAND_BUTTON_TITLE"));t.openEnd();t.openStart("div");t.attr("id",this.getId()+"-expandbutton");t.class("sapCalculationBuilderItemExpandButton").class(i);t.attr("tabindex","-1");t.openEnd();if(!this._bReadOnly){t.openStart("div");t.class("sapCalculationBuilderItemExpandButtonFocus");t.openEnd();t.close("div")}u(t,"");t.close("div");t.close("div")}.bind(this);var u=function(t,e){t.openStart("span");t.attr("aria-hidden","true");t.attr("data-sap-ui-icon-content",e);t.class("sapCalculationBuilderEmptyItemIcon").class("sapUiIcon").class("sapUiIconMirrorInRTL").class("sapCalculationBuilderExpressionSAPFont");t.openEnd();t.close("span")};var p=function(t,e){t.attr("aria-label",l.getText(e))};t.openStart("div");t.class("sapCalculationBuilderItemContentWrapper");t.openEnd();t.openStart("div");t.attr("id",this.getId()+"-content");t.class("sapCalculationBuilderItemContent");if(this._bIsNew||this._isEmpty()){t.attr("title",l.getText("CALCULATION_BUILDER_NEW_ITEM_TITLE"))}else if(a[r]){p(t,"CALCULATION_BUILDER_"+a[r]+"_ARIA_LABEL")}t.attr("aria-haspopup","dialog");t.openEnd();s(t);if(this._isEmpty()){u(t,"");t.close("div")}else if(this._bIsNew){u(t,"");t.close("div")}else if(this._isFunction()){var c=this._getFunction();t.openStart("span");t.class("sapCalculationBuilderItemLabel").class("sapCalculationBuilderItemFunctionLabel");t.openEnd();t.unsafeHtml(n(c.title||this.getKey()));t.close("span");t.openStart("span");t.class("sapCalculationBuilderItemLabel").class("sapCalculationBuilderItemFunctionBracket");t.openEnd();t.unsafeHtml("(");t.close("span");t.close("div")}else{t.openStart("span");t.class("sapCalculationBuilderItemLabel");t.openEnd();t.unsafeHtml(n(r));t.close("span");t.close("div")}t.close("div");if(this._isVariable()&&this.isExpandable()){o(t)}if(e){t.flush(e)}};p.prototype._getClass=function(t,e,i){var r="",n=this._isEmpty();r+=this._bIsNew?"sapCalculationBuilderNewItem  sapCalculationBuilderCancelSelectable":"sapCalculationBuilderItem";if(n){r+=" sapCalculationBuilderNewItem "}if(this._isBracket()){r+=" sapCalculationBuilderItemBracket "}else if(this._isOperator()){r+=" sapCalculationBuilderItemOperator sapCalculationBuilderItemOperatorLength-"+this._getLabel().length+" ";if(this._isLogicalOperator()){r+=" sapCalculationBuilderItemLogicalOperator "}}else if(this._isCustomOperator()){r+=" sapCalculationBuilderItemOperator sapCalculationBuilderItemCustomOperator "}else if(this._isFunction()){r+=" sapCalculationBuilderItemFunction "}else if(this._isLiteral()){r+=" sapCalculationBuilderItemLiteral "}else if(this._isVariable()){r+=" sapCalculationBuilderItemVariable ";if(this.isExpandable()){r+=" sapCalculationBuilderItemVariableSeparator "}}else{r+=" sapCalculationBuilderUnknownItem "}if(t){r+=" sapCalculationBuilderItemErrorSyntax "}if(i){return r}var a=r.split(" "),s;for(s=0;s<a.length;s++){e.class(a[s])}};p.prototype._render=function(t){if(!this.getParent()){return}var e=this._hasCorrectParent(),i=this._getItemError(),r=this._getTooltip(),n=r?'"'+r+'"':"",a=this._bIsNew?"button":"",s=e?"-1":"0";t.openStart("div");this._getClass(!!i,t);t.attr("id",this.getId());t.attr("tabindex",s);t.attr("title",n);t.attr("role",a);t.openEnd();this._innerRender(t);t.close("div")};p.prototype.init=function(){this._bIsNew=false};p.prototype.onBeforeRendering=function(){this._oVariable=this.getVariable()};p.prototype.onAfterRendering=function(){this._afterRendering()};p.prototype._afterRendering=function(){var t=this.getParent();if(!t){return}this._setEvents();if(!this._bIsNew&&!this._bReadOnly){this._setupDraggable()}if(this._hasCorrectParent(t)){if(!t._bIsCalculationBuilderRendering){t._setupKeyboard();t.getParent()._enableOrDisableExpandAllButton()}}};p.prototype._setEvents=function(){if(this.isExpandable()){this.$("expandbutton").on("click",this._expandButtonPress.bind(this));this.$("expandbutton").on("mousedown",function(t){t.stopPropagation()})}if(!this._bReadOnly){this.$("content").on("click",this._buttonPress.bind(this))}if(this._isBracket()||this._isFunction()){this._setBracketHover()}};p.prototype._buttonPress=function(t){var e=this.getParent();if(this._hasCorrectParent(e)&&!e._bDragging){if(t.ctrlKey){e._selectItem(this.$())}else if(t.shiftKey){e._selectItemsTo(this.$())}else{e._deselect();e._openDialog({opener:this,currentItem:this})}}};p.prototype._expandButtonPress=function(t){if(!this._bReadOnly){this._openExpandConfirmMessageBox()}};p.prototype.isExpandable=function(){var t=this._oVariable?this._oVariable:this.getVariable();return t&&t.getItems().length>0};p.prototype.getVariable=function(){var t=this.getParent();return this._hasCorrectParent(t)&&t._getVariableByKey(this.getKey())};p.prototype.getType=function(){return this._getType()};p.prototype._setupDraggable=function(){var t=this.getParent(),e=t.$(),i=this.$();i.draggable({revert:"invalid",axis:"x",delay:100,cursor:"move",helper:function(t){var e=i.clone();e.addClass("sapCalculationBuilderDragging");e.css("pointer-events","none");return e},scope:t.getId()+"-scope",start:function(){e.find(".sapCalculationBuilderBracket").removeClass("sapCalculationBuilderBracket");e.find(".sapCalculationBuilderItemContent").css("cursor","move");jQuery(this).addClass("sapCalculationBuilderDragging");t._bDragging=true;if(!jQuery(this).hasClass("ui-selected")){t._deselect()}},stop:function(){jQuery(this).removeClass("sapCalculationBuilderDragging");e.find(".sapCalculationBuilderItemContent").css("cursor","pointer");t._bDragging=false}});a._setupMobileDraggable(i)};p.prototype._setBracketHover=function(){var t=this.$("content"),e=this._isFunction()?o["("]:this.getKey(),i=e===o[")"],r=i?o["("]:o[")"],n;t.mouseenter(function(t){var a,s,o=0,u=this._hasCorrectParent()&&this.getParent().getItems()||[],l=i?u.length:0;for(;i?l>=0:l<u.length;i?l--:l++){a=u[l];if(a===this){s=true}if(s){if(a.getKey()===r||a._isFunction()&&i){o--;if(o===0){n=a;break}}else if(a.getKey()===e||a._isFunction()&&!i){o++}}}if(n){this.$().addClass("sapCalculationBuilderBracket");n.$().addClass("sapCalculationBuilderBracket")}}.bind(this));t.on("mouseleave",function(t){this.$().removeClass("sapCalculationBuilderBracket");if(n){n.$().removeClass("sapCalculationBuilderBracket")}}.bind(this))};p.prototype._expandVariable=function(t){var e=this.getParent(),i,r;if(e){i=e.getItems().indexOf(this);r=e._getVariableByKey(this.getKey());e.insertItem(new p({key:"("}),i++);r.getItems().forEach(function(t){e.insertItem(t._cloneItem(),i++)});e.insertItem(new p({key:")"}),i++);e.removeItem(this);if(t){e._aErrors=e._validateSyntax();e._fireChange()}}};p.prototype._cloneItem=function(){return new p({key:this.getKey()})};p.prototype._openExpandConfirmMessageBox=function(){r.show(l.getText("CALCULATION_BUILDER_EXPAND_MESSAGE_TEXT",this._getLabel()),{icon:r.Icon.WARNING,title:l.getText("CALCULATION_BUILDER_EXPAND_MESSAGE_TITLE"),actions:[r.Action.OK,r.Action.CANCEL],onClose:function(t){var e;if(t===r.Action.OK){this._expandVariable(true)}else{e=this.getParent();if(e){e._setCorrectFocus()}}}.bind(this)})};p.prototype._getItemError=function(){var t=this.getParent(),e;if(this._hasCorrectParent(t)){e=jQuery.grep(t._aErrors,function(t){return t.index===this._iIndex}.bind(this))[0]}return e};p.prototype._getLabel=function(){var t=function(){var t=this._getItem();if(!t){return this.getKey()}if(t.title){return t.title}if(t._getLabel){return t._getLabel()}return t.getText()||t.getKey()}.bind(this);if(!this._sLabel){this._sLabel=t();if(this._isFunction()){this._sLabel+=" ("}}return this._sLabel};p.prototype._sanitizeKey=function(t){if(!t||typeof t!=="string"){return t}t=t.replace(/{/g,"&#125;");t=t.replace(/}/g,"&#123;");return t};p.prototype._reset=function(){this._sType="";this._sLabel="";this._oVariable=""};p.prototype.setKey=function(t,e){this._reset();this.setProperty("key",this._sanitizeKey(t),e);var i=this.getParent();if(i&&i._bRendered){i.getParent()&&i.getParent()._expressionChanged()}return this};p.prototype.getKey=function(){var t=this.getProperty("key");t=t.replace(/&#125;/g,"{");t=t.replace(/&#123;/g,"}");return t};p.prototype._getType=function(){var t=this.getParent();if(!this._sType&&t){this._sType=t._getType(this.getKey())}return this._sType};p.prototype._isEmpty=function(){return!this._bIsNew&&!this.getKey()};p.prototype._isOperator=function(){return this._getType()===s.Operator};p.prototype._isSecondaryOperator=function(){var t=this._getType();if(this._getType()===s.Operator){return["+","-","/","*","(",")",","].indexOf(this.getKey())===-1}return t===s.CustomOperator};p.prototype._isCustomOperator=function(){return this._getType()===s.CustomOperator};p.prototype._isVariable=function(){return this._getType()===s.Variable};p.prototype._isLiteral=function(){return this._getType()===s.Literal};p.prototype._isFunction=function(){var t=this._getType();return t===s.Function||t===s.CustomFunction};p.prototype._getFunction=function(){var t=this._getType();if(t===s.Function||t===s.CustomFunction){var e=this.getParent().getParent();return e._createFunctionObject(e._getFunctionDefinition(this.getKey()))}return null};p.prototype._getItemInstance=function(t,e){if(this._getType()===t){var i=this.getKey(),r=this.getParent()[e]();return jQuery.grep(r,function(t){return t.getKey().toLowerCase()===i.toLowerCase()})[0]}return null};p.prototype._getItem=function(){var t=this._getType();switch(t){case s.Variable:return this._getVariable();case s.CustomFunction:return this._getCustomFunction();case s.CustomOperator:return this._getCustomOperator()}return null};p.prototype._getTooltip=function(){var t=this._getItem();return t&&t.getTooltip_AsString?t.getTooltip_AsString():""};p.prototype._getVariable=function(){return this._getItemInstance(s.Variable,"getVariables")};p.prototype._getCustomFunction=function(){return this._getItemInstance(s.CustomFunction,"getFunctions")};p.prototype._getCustomOperator=function(){return this._getItemInstance(s.CustomOperator,"getOperators")};p.prototype._isBracket=function(){return this._isOperator()&&(this.getKey()==="("||this.getKey()===")")};p.prototype._isAddition=function(){return this._isOperator()&&this.getKey()==="+"};p.prototype._isSubtraction=function(){return this._isOperator()&&this.getKey()==="-"};p.prototype._isDivision=function(){return this._isOperator()&&this.getKey()==="/"};p.prototype._isMultiplication=function(){return this._isOperator()&&this.getKey()==="*"};p.prototype._isComma=function(){return this._isOperator()&&this.getKey()===","};p.prototype._isLogicalOperator=function(){return this._isOperator()&&!!u[this.getKey()]};p.prototype._hasCorrectParent=function(t){t=t||this.getParent();return e.isA(t,"sap.suite.ui.commons.CalculationBuilderExpression")};return p});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderValidationResult", ["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject"],function(jQuery,r){"use strict";var t=r.extend("sap.suite.ui.commons.CalculationBuilderValidationResult",{constructor:function(){r.prototype.constructor.apply(this,arguments);this._aErrors=[]}});t.prototype.addError=function(r){this._aErrors.push(r)};t.prototype.addErrors=function(r){jQuery.merge(this._aErrors,r)};t.prototype.getErrors=function(){return this._aErrors};return t});
sap.ui.predefine("sap/suite/ui/commons/CalculationBuilderVariable", ["./library","sap/ui/core/Control"],function(e,t){"use strict";var i=t.extend("sap.suite.ui.commons.CalculationBuilderVariable",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},group:{type:"string",group:"Misc"}},aggregations:{items:{type:"sap.suite.ui.commons.CalculationBuilderItem",multiple:true,singularName:"Item"}}},renderer:null});i.prototype._getLabel=function(){return this.getLabel()||this.getKey()};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainer", ["sap/ui/thirdparty/jquery","./library","sap/m/library","sap/viz/library","sap/ui/base/ManagedObject","sap/m/Button","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/SegmentedButton","sap/m/Title","sap/m/ToolbarSpacer","sap/ui/Device","sap/ui/core/Control","sap/ui/core/CustomData","sap/ui/core/ResizeHandler","sap/ui/core/delegate/ScrollEnablement","sap/m/ToggleButton","sap/m/OverflowToolbarToggleButton","sap/base/util/uid","sap/base/Log","./ChartContainerRenderer","sap/suite/ui/commons/util/FullScreenUtil"],function(jQuery,t,e,o,i,n,s,r,a,l,h,u,g,c,d,p,_,f,m,S,C,b){"use strict";var y=e.ButtonType;var B=g.extend("sap.suite.ui.commons.ChartContainer",{metadata:{library:"sap.suite.ui.commons",properties:{showPersonalization:{type:"boolean",group:"Misc",defaultValue:false},showFullScreen:{type:"boolean",group:"Misc",defaultValue:false},fullScreen:{type:"boolean",group:"Misc",defaultValue:false},showLegend:{type:"boolean",group:"Misc",defaultValue:true},title:{type:"string",group:"Misc",defaultValue:""},selectorGroupLabel:{type:"string",group:"Misc",defaultValue:null,deprecated:true},autoAdjustHeight:{type:"boolean",group:"Misc",defaultValue:false},showZoom:{type:"boolean",group:"Misc",defaultValue:true},showLegendButton:{type:"boolean",group:"Misc",defaultValue:true},showSelectionDetails:{type:"boolean",group:"Behavior",defaultValue:false},wrapLabels:{type:"boolean",group:"Misc",defaultValue:false},enableScroll:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"}},defaultAggregation:"content",aggregations:{dimensionSelectors:{type:"sap.ui.core.Control",multiple:true,singularName:"dimensionSelector"},content:{type:"sap.suite.ui.commons.ChartContainerContent",multiple:true,singularName:"content"},toolbar:{type:"sap.m.OverflowToolbar",multiple:false},customIcons:{type:"sap.ui.core.Icon",multiple:true,singularName:"customIcon"}},events:{personalizationPress:{},contentChange:{parameters:{selectedItemId:{type:"string"}}},customZoomInPress:{},customZoomOutPress:{}}}});B.prototype.init=function(){this._aUsedContentIcons=[];this._aCustomIcons=[];this._oToolBar=null;this._aDimensionSelectors=[];this._bChartContentHasChanged=false;this._bControlNotRendered=true;this._bSegmentedButtonSaveSelectState=false;this._mOriginalVizFrameHeights={};this._oActiveChartButton=null;this._oSelectedContent=null;this._sResizeListenerId=null;this._bHasApplicationToolbar=false;this._iPlaceholderPosition=0;this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");this._oFullScreenButton=new f({icon:"sap-icon://full-screen",type:y.Transparent,text:this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN"),tooltip:this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN"),press:this._onFullScreenButtonPress.bind(this)});this._oShowLegendButton=new _({icon:"sap-icon://legend",type:y.Transparent,tooltip:this._oResBundle.getText("CHARTCONTAINER_LEGEND"),press:this._onShowLegendButtonPress.bind(this)});this._oPersonalizationButton=new r({icon:"sap-icon://action-settings",type:y.Transparent,text:this._oResBundle.getText("CHARTCONTAINER_PERSONALIZE"),tooltip:this._oResBundle.getText("CHARTCONTAINER_PERSONALIZE"),press:this._onPersonalizationButtonPress.bind(this)});this._oZoomInButton=new r({icon:"sap-icon://zoom-in",type:y.Transparent,text:this._oResBundle.getText("CHARTCONTAINER_ZOOMIN"),tooltip:this._oResBundle.getText("CHARTCONTAINER_ZOOMIN"),press:this._zoom.bind(this,true)});this._oZoomOutButton=new r({icon:"sap-icon://zoom-out",type:y.Transparent,text:this._oResBundle.getText("CHARTCONTAINER_ZOOMOUT"),tooltip:this._oResBundle.getText("CHARTCONTAINER_ZOOMOUT"),press:this._zoom.bind(this,false)});this._oChartSegmentedButton=new a({select:this._onChartSegmentButtonSelect.bind(this),width:"auto"});this._oChartTitle=new l};B.prototype.onAfterRendering=function(){this._sResizeListenerId=d.register(this,this._performHeightChanges.bind(this));if(!u.system.desktop){u.resize.attachHandler(this._performHeightChanges,this)}if(this.getAutoAdjustHeight()||this.getFullScreen()){setTimeout(function(){var t=this._performHeightChanges.bind(this);if(typeof t==="string"||t instanceof String){t=this[t]}t.apply(this,[])}.bind(this),500)}var t=this.getSelectedContent(),e=false,o;if(t){o=t.getContent();e=o&&o.getMetadata().getName()==="sap.viz.ui5.controls.VizFrame"}if(this.getEnableScroll()){this._oScrollEnablement=new p(this,this.getId()+"-wrapper",{horizontal:!e,vertical:!e})}this._bControlNotRendered=false;if(this.getTitle()&&(this.getToolbar().getContent().length===2&&this.getToolbar().getContent()[0]instanceof sap.m.Title)){this.getToolbar().setActive(true)}};B.prototype.onBeforeRendering=function(){if(this._sResizeListenerId){d.deregister(this._sResizeListenerId);this._sResizeListenerId=null}if(!u.system.desktop){u.resize.detachHandler(this._performHeightChanges,this)}if(this._bChartContentHasChanged||this._bControlNotRendered){this._chartChange()}var t=this._aCustomIcons;this._aCustomIcons=[];var e=this.getAggregation("customIcons");if(e&&e.length>0){for(var o=0;o<e.length;o++){this._addButtonToCustomIcons(e[o])}}if(this._bControlNotRendered){if(!this.getToolbar()){this.setAggregation("toolbar",new s({design:"Transparent"}))}}this._adjustDisplay();this._destroyButtons(t);var i=this.getSelectedContent();if(i){var n=i.getContent();if(n&&n.attachRenderComplete){n.detachRenderComplete(this._checkZoomIcons,this);n.attachRenderComplete(this._checkZoomIcons,this)}}this._oShowLegendButton.setPressed(this.getShowLegend())};B.prototype.exit=function(){if(this._oFullScreenButton){this._oFullScreenButton.destroy();this._oFullScreenButton=undefined}if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this)}if(this._oShowLegendButton){this._oShowLegendButton.destroy();this._oShowLegendButton=undefined}if(this._oPersonalizationButton){this._oPersonalizationButton.destroy();this._oPersonalizationButton=undefined}if(this._oActiveChartButton){this._oActiveChartButton.destroy();this._oActiveChartButton=undefined}if(this._oChartSegmentedButton){this._oChartSegmentedButton.destroy();this._oChartSegmentedButton=undefined}if(this._oSelectedContent){this._oSelectedContent.destroy();this._oSelectedContent=undefined}if(this._oToolBar){this._oToolBar.destroy();this._oToolBar=undefined}if(this._oToolbarSpacer){this._oToolbarSpacer.destroy();this._oToolbarSpacer=undefined}if(this._aDimensionSelectors){for(var t=0;t<this._aDimensionSelectors.length;t++){if(this._aDimensionSelectors[t]){this._aDimensionSelectors[t].destroy()}}this._aDimensionSelectors=undefined}if(this._oScrollEnablement){this._oScrollEnablement.destroy();this._oScrollEnablement=undefined}if(this._sResizeListenerId){d.deregister(this._sResizeListenerId);this._sResizeListenerId=null}if(!u.system.desktop){u.resize.detachHandler(this._performHeightChanges,this)}if(this._oZoomInButton){this._oZoomInButton.destroy();this._oZoomInButton=undefined}if(this._oZoomOutButton){this._oZoomOutButton.destroy();this._oZoomOutButton=undefined}};B.prototype._onButtonIconPress=function(t){var e=t.getSource().getCustomData()[0].getValue();this._switchChart(e)};B.prototype._onFullScreenButtonPress=function(t){if(t.getParameter("pressed")===true){this._oFullScreenButton.setTooltip(this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN_CLOSE"));this._oFullScreenButton.setText(this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN_CLOSE"));this._oFullScreenButton.setIcon("sap-icon://exit-full-screen")}else{this._oFullScreenButton.setTooltip(this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN"));this._oFullScreenButton.setText(this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN"));this._oFullScreenButton.setIcon("sap-icon://full-screen")}this._bSegmentedButtonSaveSelectState=true;this._toggleFullScreen();this._oFullScreenButton.focus()};B.prototype._onShowLegendButtonPress=function(t){this._bSegmentedButtonSaveSelectState=true;this._onLegendButtonPress()};B.prototype._onChartSegmentButtonSelect=function(t){var e=t.getParameter("button").getCustomData()[0].getValue();this._bSegmentedButtonSaveSelectState=true;this._switchChart(e)};B.prototype._onOverflowToolbarButtonPress=function(t,e){e.icon.firePress({controlReference:t.getSource()})};B.prototype._onLegendButtonPress=function(){var t=this.getSelectedContent();if(t){var e=t.getContent();if(jQuery.isFunction(e.getLegendVisible)){var o=e.getLegendVisible();e.setLegendVisible(!o);this.setShowLegend(!o)}else{this.setShowLegend(!this.getShowLegend())}}else{this.setShowLegend(!this.getShowLegend())}};B.prototype._checkZoomIcons=function(t){if(t.getSource()._getZoomInfo){var e=t.getSource()._getZoomInfo();if(e){this._manageZoomIcons(e.currentZoomLevel)}}};B.prototype._onPersonalizationButtonPress=function(){this.firePersonalizationPress()};B.prototype._setSelectedContent=function(t){var e;if(this.getSelectedContent()===t){return this}if(t===null){this._oShowLegendButton.setVisible(false);return this}var o=t.getContent();this._toggleShowLegendButtons(o);e=o&&o.getMetadata&&o.getMetadata().getName()==="sap.viz.ui5.controls.VizFrame";var i=e||jQuery.isFunction(o.setLegendVisible);if(this.getShowLegendButton()){this._oShowLegendButton.setVisible(i)}var n=this.getShowZoom()&&u.system.desktop&&e;this._oZoomInButton.setVisible(n);this._oZoomOutButton.setVisible(n);this._oSelectedContent=t;return this};B.prototype._getSelectionDetails=function(){var t=this.getSelectedContent();return t&&t._getSelectionDetails()};B.prototype._toggleShowLegendButtons=function(t){var e=t.getId();var o=null;for(var i=0;!o&&i<this._aUsedContentIcons.length;i++){if(this._aUsedContentIcons[i].getCustomData()[0].getValue()===e&&t.getVisible()===true){o=this._aUsedContentIcons[i];this._oChartSegmentedButton.setSelectedButton(o);break}}};B.prototype._setDefaultOnSegmentedButton=function(){if(!this._bSegmentedButtonSaveSelectState){this._oChartSegmentedButton.setSelectedButton(null)}this._bSegmentedButtonSaveSelectState=false};B.prototype._toggleFullScreen=function(){var t=this.getProperty("fullScreen");var e=function(t,e,o){this._oFullScreenButton.setIcon(t);this._oFullScreenButton.setText(e);this._oFullScreenButton.setTooltip(e);this._oFullScreenButton.setPressed(o)}.bind(this);var o;var i=this.getAggregation("content");if(t){this.setProperty("fullScreen",false,true);e("sap-icon://full-screen",this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN"),false);for(var n=0;n<i.length;n++){o=i[n].getContent();o.setWidth("100%");if(typeof o.getHeight!=="undefined"&&o.getHeight()!==""){o.setHeight(this._sChartOriginalHeight)}}this.invalidate()}else{this.setProperty("fullScreen",true,true);e("sap-icon://exit-full-screen",this._oResBundle.getText("CHARTCONTAINER_FULLSCREEN_CLOSE"),true);for(var n=0;n<i.length;n++){o=i[n].getContent();o.setWidth("100%");if(typeof o.getHeight!=="undefined"&&o.getHeight()!==""){this._sChartOriginalHeight=o.getHeight()}}}t=!t;if(!this._oFullScreenUtil){this._oFullScreenUtil=b}this._oFullScreenUtil.toggleFullScreen(this,t,this._oFullScreenButton,this._toggleFullScreen)};B.prototype._performHeightChanges=function(){var t,e;if(this.getAutoAdjustHeight()||this.getFullScreen()){var o=this.$(),i,n,s;t=o.find(".sapSuiteUiCommonsChartContainerToolBarArea :first");e=o.find(".sapSuiteUiCommonsChartContainerChartArea :first");i=this.getSelectedContent();if(t[0]&&e[0]&&i){var r=o.height();var a=t.height();var l=Math.round(parseFloat(t.css("borderBottomWidth")));var h=r-a-l;var u=e.height();n=i.getContent();if(n){s=n.getMetadata().getName();if(s==="sap.viz.ui5.controls.VizFrame"||s==="sap.chart.Chart"){if(h>0&&h!==u){this._rememberOriginalHeight(n);n.setHeight(h+"px")}}else if(this.$("chartArea").innerWidth()&&n.$().innerWidth()!==this.$("chartArea").innerWidth()){this.rerender()}}}}};B.prototype._rememberOriginalHeight=function(t){var e;if(jQuery.isFunction(t.getHeight)){e=t.getHeight()}else{e=0}this._mOriginalVizFrameHeights[t.getId()]=e};B.prototype._switchChart=function(t){var e=this._findChartById(t);this._setSelectedContent(e);this.fireContentChange({selectedItemId:t});this.rerender()};B.prototype._chartChange=function(){var t=this.getContent();this._destroyButtons(this._aUsedContentIcons);this._aUsedContentIcons=[];if(this.getContent().length===0){this._oChartSegmentedButton.removeAllButtons();this._setDefaultOnSegmentedButton();this.switchChart(null)}if(t){var e=this.getShowLegend();var o;var i;for(var s=0;s<t.length;s++){if(!t[s].getVisible()){continue}o=t[s].getContent();if(jQuery.isFunction(o.setVizProperties)){o.setVizProperties({legend:{visible:e},sizeLegend:{visible:e}})}if(jQuery.isFunction(o.setWidth)){o.setWidth("100%")}if(jQuery.isFunction(o.setHeight)&&this._mOriginalVizFrameHeights[o.getId()]){o.setHeight(this._mOriginalVizFrameHeights[o.getId()])}i=new n({icon:t[s].getIcon(),type:y.Transparent,tooltip:t[s].getTitle(),customData:[new c({key:"chartId",value:o.getId()})],press:this._onButtonIconPress.bind(this)});this._aUsedContentIcons.push(i);if(s===0){this._setSelectedContent(t[s]);this._oActiveChartButton=i}}}this._bChartContentHasChanged=false};B.prototype._findChartById=function(t){var e=this.getAggregation("content");if(e){for(var o=0;o<e.length;o++){if(e[o].getContent().getId()===t){return e[o]}}}return null};B.prototype._getToolbarPlaceHolderPosition=function(t){var e;for(var o=0;o<t.getContent().length;o++){e=t.getContent()[o];if(e.getMetadata&&e.getMetadata().getName()==="sap.suite.ui.commons.ChartContainerToolbarPlaceholder"){return o}}return-1};B.prototype._addContentToolbar=function(t,e){if(!this._bHasApplicationToolbar){if(!e){this._oToolBar.addContent(t)}else{this._oToolBar.insertContent(t,e)}}else{if(t instanceof h){this._iPlaceholderPosition=this._getToolbarPlaceHolderPosition(this._oToolBar);return}if(e){this._iPlaceholderPosition=this._iPlaceholderPosition+e}this._oToolBar.insertContent(t,this._iPlaceholderPosition);this._iPlaceholderPosition=this._iPlaceholderPosition+1}};B.prototype._rearrangeToolbar=function(){var t=this._aToolbarContent.length;for(var e=0;e<t;e++){this._oToolBar.insertContent(this._aToolbarContent[e],e)}};B.prototype._adjustIconsDisplay=function(){if(this.getShowSelectionDetails()){this._addContentToolbar(this._getSelectionDetails())}if(this.getShowLegendButton()){this._addContentToolbar(this._oShowLegendButton)}if(this.getShowZoom()&&u.system.desktop){this._addContentToolbar(this._oZoomInButton);this._addContentToolbar(this._oZoomOutButton)}if(this.getShowPersonalization()){this._addContentToolbar(this._oPersonalizationButton)}if(this.getShowFullScreen()){this._addContentToolbar(this._oFullScreenButton)}var t=0;for(t;t<this._aCustomIcons.length;t++){this._addContentToolbar(this._aCustomIcons[t])}if(!this._bControlNotRendered){this._oChartSegmentedButton.removeAllButtons()}var e=this._aUsedContentIcons.length;if(e>1){for(t=0;t<e;t++){this._oChartSegmentedButton.addButton(this._aUsedContentIcons[t])}this._addContentToolbar(this._oChartSegmentedButton)}};B.prototype._adjustSelectorDisplay=function(){if(this._aDimensionSelectors.length===0){this._oChartTitle.setVisible(true);this._addContentToolbar(this._oChartTitle);return}for(var t=0;t<this._aDimensionSelectors.length;t++){if(jQuery.isFunction(this._aDimensionSelectors[t].setAutoAdjustWidth)){this._aDimensionSelectors[t].setAutoAdjustWidth(true)}this._addContentToolbar(this._aDimensionSelectors[t])}};B.prototype._adjustDisplay=function(){this._oToolBar=this.getToolbar();if(this._oToolbarSpacer){this._oToolBar.removeContent(this._oToolbarSpacer);this._oToolbarSpacer.destroy()}this._oToolBar.removeAllContent();this._oToolBar.setProperty("height","3rem",true);if(this._bHasApplicationToolbar){this._rearrangeToolbar();this._iPlaceholderPosition=0}this._adjustSelectorDisplay();this._oToolbarSpacer=new h;this._addContentToolbar(this._oToolbarSpacer);this._adjustIconsDisplay()};B.prototype._addButtonToCustomIcons=function(t){var e=t;var o=e.getTooltip();var i=new r({icon:e.getSrc(),text:o,tooltip:o,type:y.Transparent,visible:e.getVisible(),press:[{icon:e},this._onOverflowToolbarButtonPress.bind(this)]});this._aCustomIcons.push(i)};B.prototype._zoom=function(t){var e=this.getSelectedContent().getContent();if(e.getMetadata().getName()==="sap.viz.ui5.controls.VizFrame"){if(t){e.zoom({direction:"in"})}else{e.zoom({direction:"out"})}}if(t){this.fireCustomZoomInPress()}else{this.fireCustomZoomOutPress()}this._manageZoomIcons(e._getZoomInfo().currentZoomLevel)};B.prototype._manageZoomIcons=function(t){if(t===undefined){return}else if(t===null){this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(false)}else if(t===0){this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(true)}else if(t===1){this._oZoomInButton.setEnabled(false);this._oZoomOutButton.setEnabled(true)}else{if(this._oZoomOutButton.getEnabled()==false){this._oZoomOutButton.setEnabled(true)}if(this._oZoomInButton.getEnabled()==false){this._oZoomInButton.setEnabled(true)}}};B.prototype._destroyButtons=function(t){for(var e=0;e<t.length;e++){t[e].destroy()}};B.prototype._setShowLegendForAllCharts=function(t){var e=this.getContent();var o;for(var i=0;i<e.length;i++){o=e[i].getContent();if(jQuery.isFunction(o.setLegendVisible)){o.setLegendVisible(t)}else{S.info("ChartContainer: chart with id "+o.getId()+" is missing the setVizProperties property")}}};B.prototype.setFullScreen=function(t){if(this._bControlNotRendered){return this}if(this.getFullScreen()===t){return this}if(this.getProperty("fullScreen")!==t){this._toggleFullScreen()}return this};B.prototype.setTitle=function(t){if(this.getTitle()===t){return this}this._oChartTitle.setText(t);this.setProperty("title",t,true);return this};B.prototype.setShowLegendButton=function(t){if(this.getShowLegendButton()===t){return this}this.setProperty("showLegendButton",t,true);if(!this.getShowLegendButton()){this.setShowLegend(false)}return this};B.prototype.setSelectorGroupLabel=function(t){if(this.getSelectorGroupLabel()===t){return this}this.setProperty("selectorGroupLabel",t,true);return this};B.prototype.setShowLegend=function(t){if(this.getShowLegend()===t){return this}this.setProperty("showLegend",t,true);this._setShowLegendForAllCharts(t);return this};B.prototype.setWrapLabels=function(t){var e;if(this.getWrapLabels()!==t){this.setProperty("wrapLabels",t);e=this._getSelectionDetails();if(e){e.setWrapLabels(t)}}return this};B.prototype.setToolbar=function(t){if(!t||this._getToolbarPlaceHolderPosition(t)===-1){S.info("A placeholder of type 'sap.suite.ui.commons.ChartContainerToolbarPlaceholder' needs to be provided. Otherwise, the toolbar will be ignored");return this}if(this.getToolbar()!==t){this.setAggregation("toolbar",t)}if(this.getToolbar()){this._aToolbarContent=this.getToolbar().getContent();this._bHasApplicationToolbar=true}else{this._aToolbarContent=null;this._bHasApplicationToolbar=false}this.invalidate();return this};B.prototype.getDimensionSelectors=function(){return this._aDimensionSelectors};B.prototype.indexOfDimensionSelector=function(t){for(var e=0;e<this._aDimensionSelectors.length;e++){if(this._aDimensionSelectors[e]===t){return e}}return-1};B.prototype.addDimensionSelector=function(t){this._aDimensionSelectors.push(t);return this};B.prototype.insertDimensionSelector=function(t,e){if(!t){return this}var o;if(e<0){o=0}else if(e>this._aDimensionSelectors.length){o=this._aDimensionSelectors.length}else{o=e}if(o!==e){S.warning("ManagedObject.insertAggregation: index '"+e+"' out of range [0,"+this._aDimensionSelectors.length+"], forced to "+o)}this._aDimensionSelectors.splice(o,0,t);return this};B.prototype.destroyDimensionSelectors=function(){if(this._oToolBar){for(var t=0;t<this._aDimensionSelectors.length;t++){if(this._aDimensionSelectors[t]){this._oToolBar.removeContent(this._aDimensionSelectors[t]);this._aDimensionSelectors[t].destroy()}}}this._aDimensionSelectors=[];return this};B.prototype.removeDimensionSelector=function(t){if(!t){return null}if(this._oToolBar){this._oToolBar.removeContent(t)}var e=this.indexOfDimensionSelector(t);if(e===-1){return null}else{return this._aDimensionSelectors.splice(e,1)[0]}};B.prototype.removeAllDimensionSelectors=function(){var t=this._aDimensionSelectors.slice();if(this._oToolBar){for(var e=0;e<this._aDimensionSelectors.length;e++){if(this._aDimensionSelectors[e]){this._oToolBar.removeContent(this._aDimensionSelectors[e])}}}this._aDimensionSelectors=[];return t};B.prototype.addContent=function(t){this.addAggregation("content",t);this._bChartContentHasChanged=true;return this};B.prototype.insertContent=function(t,e){this.insertAggregation("content",t,e);this._bChartContentHasChanged=true;return this};B.prototype.updateContent=function(){this.updateAggregation("content");this._bChartContentHasChanged=true};B.prototype.addAggregation=function(t,e,o){if(t==="dimensionSelectors"){return this.addDimensionSelector(e)}else{return i.prototype.addAggregation.apply(this,arguments)}};B.prototype.getAggregation=function(t,e){if(t==="dimensionSelectors"){return this.getDimensionSelectors()}else{return i.prototype.getAggregation.apply(this,arguments)}};B.prototype.indexOfAggregation=function(t,e){if(t==="dimensionSelectors"){return this.indexOfDimensionSelector(e)}else{return i.prototype.indexOfAggregation.apply(this,arguments)}};B.prototype.insertAggregation=function(t,e,o,n){if(t==="dimensionSelectors"){return this.insertDimensionSelector(e,o)}else{return i.prototype.insertAggregation.apply(this,arguments)}};B.prototype.destroyAggregation=function(t,e){if(t==="dimensionSelectors"){return this.destroyDimensionSelectors()}else{return i.prototype.destroyAggregation.apply(this,arguments)}};B.prototype.removeAggregation=function(t,e,o){if(t==="dimensionSelectors"){return this.removeDimensionSelector(e)}else{return i.prototype.removeAggregation.apply(this,arguments)}};B.prototype.removeAllAggregation=function(t,e){if(t==="dimensionSelectors"){return this.removeAllDimensionSelectors()}else{return i.prototype.removeAllAggregation.apply(this,arguments)}};B.prototype.getSelectedContent=function(){return this._oSelectedContent};B.prototype.getScrollDelegate=function(){return this._oScrollEnablement};B.prototype.switchChart=function(t){this._setSelectedContent(t);this.rerender()};B.prototype.updateChartContainer=function(){this._bChartContentHasChanged=true;this.rerender();return this};B.prototype.setWidth=function(t){this.setProperty("width",t,true);this.$().css("width",this.getWidth());return this};return B});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainerContent", ["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/ui/base/Event","sap/m/SelectionDetails","sap/m/SelectionDetailsItem","sap/m/SelectionDetailsItemLine","sap/suite/ui/commons/ChartContainer","./ChartContainerContentRenderer"],function(jQuery,e,t,i,a,n,o,s){"use strict";var r=e.extend("sap.suite.ui.commons.ChartContainerContent",{metadata:{library:"sap.suite.ui.commons",properties:{icon:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false}}}});r.prototype.init=function(){this._oSelectionDetails=new i;this._oSelectionDetails.registerSelectionDetailsItemFactory(r._selectionDetailsItemFactory)};r.prototype.onBeforeRendering=function(){var e=this.getParent(),t;this._oSelectionDetails.detachSelectionHandler("_selectionDetails");t=this.getContent();if(t&&t.getMetadata().getName()==="sap.viz.ui5.controls.VizFrame"){this._oSelectionDetails.attachSelectionHandler("_selectionDetails",t)}if(e instanceof o){this._oSelectionDetails.setWrapLabels(e.getWrapLabels())}};r.prototype.exit=function(){if(this._oSelectionDetails){this._oSelectionDetails.destroy();this._oSelectionDetails=null}};r.prototype.getSelectionDetails=function(){r._addEventMapping(this._oSelectionDetails);return this._oSelectionDetails.getFacade()};r.prototype._getSelectionDetails=function(){var e=this.getContent();if(e&&e.getMetadata().getName()==="sap.viz.ui5.controls.VizFrame"){return this._oSelectionDetails}};r._selectionDetailsItemFactory=function(e,t,i,o,s){s=s||"";var r=[],l,c=typeof s==="string";for(var u=0;u<e.length;u++){l=new n({label:e[u].label,value:e[u].value,unit:e[u].unit});if(!c){l.setLineMarker(s[e[u].id])}else if(u===0){l.setLineMarker(s)}r.push(l)}return new a({lines:r})};r._aProxyEvent=["beforeOpen","beforeClose","navigate","actionPress"];r._addEventMapping=function(e){var i=e.attachEvent;e.attachEvent=function(a,n,o,s){if(r._aProxyEvent.indexOf(a)===-1){i.apply(this,arguments);return}else if(jQuery.type(n)==="function"){s=o;o=n;n=null}i.apply(e,[a,n,l,s||e.getFacade()]);function l(i){var r=new t(a,i.oSource,i.mParameters);r.getSource=e.getFacade;if(a==="actionPress"){i.getParameters().items=c(i)}else if(a==="navigate"){i.getParameters().item=i.getParameter("item").getFacade()}o.call(s||e.getFacade(),r,n)}function c(e){var t=e.getParameter("items"),i=[];for(var a=0;a<t.length;a++){i.push(t[a].getFacade())}return i}}};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainerContentRenderer", function(){"use strict";var e={apiVersion:2};e.render=function(e,n){e.renderControl(n.getContent())};return e},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainerRenderer", function(){"use strict";var e={apiVersion:2};e.render=function(e,t){var n=t.getSelectedContent();e.openStart("div",t);e.class("sapSuiteUiCommonsChartContainer");e.style("width",t.getWidth());e.openEnd();e.openStart("div",t.getId()+"-wrapper");e.class("sapSuiteUiCommonsChartContainerWrapper");e.openEnd();e.openStart("div");e.class("sapSuiteUiCommonsChartContainerToolBarArea");e.openEnd();e.renderControl(t.getToolbar());e.close("div");e.openStart("div",t.getId()+"-chartArea");e.class("sapSuiteUiCommonsChartContainerChartArea");e.openEnd();if(n!==null){e.renderControl(n)}else if(t.getContent().length>0){n=t.getContent()[0];e.renderControl(n)}e.close("div");e.close("div");e.close("div")};return e},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainerToolbarPlaceholder", ["sap/ui/core/Control","./ChartContainerToolbarPlaceholderRenderer"],function(e,r){"use strict";var a=e.extend("sap.suite.ui.commons.ChartContainerToolbarPlaceholder",{metadata:{library:"sap.suite.ui.commons"}});return a});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ChartContainerToolbarPlaceholderRenderer", function(){"use strict";var e={apiVersion:2};e.render=function(e,n){};return e},true);
sap.ui.predefine("sap/suite/ui/commons/CloudFileInfo", ["sap/ui/base/ManagedObject"],function(e){"use strict";var t=e.extend("sap.suite.ui.commons.CloudFileInfo",{metadata:{library:"sap.suite.ui.commons",properties:{fileShareId:{type:"string",group:"Data"},fileShareItemId:{type:"string",group:"Data"},isFolder:{type:"boolean",group:"Data"},parentFileShareItemId:{type:"string",group:"Data"},fileShareItemName:{type:"string",group:"Data"},createdByUser:{type:"string",group:"Data"},creationDateTime:{type:"string",group:"Data"},lastChangedByUser:{type:"string",group:"Data"},lastChangeDateTime:{type:"string",group:"Data"},fileShareItemContent:{type:"string",group:"Data"},fileShareItemContentType:{type:"string",group:"Data"},fileShareItemContentSize:{type:"string",group:"Data"},fileShareItemContentLink:{type:"string",group:"Data"},isDocumentCreationAllowed:{type:"boolean",group:"Data"}}}});return t});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/CloudFilePicker", ["sap/m/Button","sap/m/Dialog","sap/m/DialogRenderer","sap/m/HBox","sap/m/Table","sap/m/ColumnListItem","sap/m/Column","sap/ui/model/odata/v4/ODataModel","sap/m/Select","sap/m/Label","sap/m/Input","sap/ui/layout/form/SimpleForm","sap/ui/core/IconPool","sap/ui/core/Icon","sap/m/Page","sap/m/Breadcrumbs","sap/m/Link","sap/m/Text","./CloudFileInfo","./library","sap/m/library","sap/ui/core/library","sap/ui/layout/FixFlex","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/Title","sap/m/ColumnPopoverSelectListItem","sap/m/ColumnHeaderPopover","sap/ui/core/CustomData","sap/ui/model/Sorter","sap/m/SearchField","sap/m/OverflowToolbarLayoutData","sap/ui/Device","sap/base/Log","sap/ui/model/odata/type/DateTimeOffset","sap/ui/core/Item","sap/m/IllustratedMessage","sap/m/IllustratedMessageType","sap/m/IllustratedMessageSize","sap/ui/core/format/FileSizeFormat"],function(e,t,i,n,o,a,s,r,l,h,d,u,c,m,g,p,f,C,F,b,S,y,I,T,v,w,_,N,L,B,x,D,k,E,P,O,M,V,A,R){"use strict";var K=S.DialogType;var U=S.ButtonType;var z=y.SortOrder;var j=y.ValueState;var H=b.FilePickerModes;var $=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var W=t.extend("sap.suite.ui.commons.CloudFilePicker",{metadata:{library:"sap.suite.ui.commons",properties:{serviceUrl:{type:"sap.ui.core.URI",group:"Data",defaultValue:""},sharedModel:{type:"object",group:"Misc",defaultValue:null},confirmButtonText:{type:"string",group:"Data",defaultValue:$.getText("CFP_BUTTON_SELECT")},filePickerMode:{type:"sap.suite.ui.commons.FilePickerModes",group:"Data",defaultValue:"All"},title:{type:"string",group:"Data",defaultValue:$.getText("CFP_TITLE")},enableDuplicateCheck:{type:"boolean",group:"Data",defaultValue:false},duplicateMessage:{type:"string",group:"Data"},suggestedFileName:{type:"string",group:"Data"},fileNameMandatory:{type:"boolean",group:"Data",defaultValue:false}},events:{select:{parameters:{replaceExistingFile:"boolean",selectedFileName:"string",selectedFiles:{type:"sap.suite.ui.commons.CloudFileInfo[]"},selectedFolder:{type:"sap.suite.ui.commons.CloudFileInfo"}}},cancel:{}}},constructor:function(){t.prototype.constructor.apply(this,arguments);this.oTableControl=null;this.oSelectControl=null;this.oBreadcrumbLinkControl=null;this.oFileNameControl=null;this.aVisibleLinks=null;this.oNavigationMap=null;this.oConfirmationButton=null;this.oNewFolderButton=null;this.oNewFolderColumnListItem=null;this.oCurrentParentData=null;this.setResizable(true);this.setDraggable(true);this._createDialogContent();this._createButton();if(k.system.phone){this.setStretch(true)}else{this.setStretch(false);this.setContentWidth("780px");this.setContentHeight("48.75rem")}this.setHorizontalScrolling(false);this.setVerticalScrolling(false);this.setTitle(this.getTitle());this.setBusyIndicatorDelay(0);this.setBusy(true)},renderer:i});W.prototype._createDialogContent=function(){var e=this.getServiceUrl(),t=this.getSharedModel();if(!e&&!t){E.error("Invalid Configuration")}if(!t&&e){t=new r({serviceUrl:e,synchronizationMode:"None",earlyRequests:true})}if(t){t.setSizeLimit(200)}this.setModel(t);var i=this._createCloudDropdownAndFileNameField();this.oBreadcrumbLinkControl=this._createBreadcrumbLinks();var n=this._createTableContent();var o=new I({fixContent:[i,this.oBreadcrumbLinkControl],flexContent:n});this.addContent(o)};W.prototype._createCloudDropdownAndFileNameField=function(){var t=new h({text:$.getText("CFP_LOCATION"),showColon:true,labelFor:this.getId()+"-cloudSpaceSelect"}).addStyleClass(k.system.desktop?"sapUiTinyMarginTop":"");this.oSelectControl=new l({id:this.getId()+"-cloudSpaceSelect",forceSelection:false,change:function(e){this.oTableControl.setBusyIndicatorDelay(0);this.oTableControl.setNoDataText(" ");this.oFileNameControl.setValue(this.getSuggestedFileName());this.oBreadcrumbLinkControl.destroyLinks();this._initializeVisibleLinks();var t=e.getParameters().selectedItem;this._loadFileShareRootFolder(t.getKey())}.bind(this)}).bindItems({path:"/FileShares",events:{dataReceived:function(t){var i=t.getParameters();if(i.error||!Object.keys(i.data).length&&!t.getSource().getCurrentContexts().length){this.setBusy(false);var n=new M({illustrationType:V.ErrorScreen,illustrationSize:A.Spot,enableVerticalResponsiveness:true,title:$.getText("CFP_NO_FILESHARE_FOUND"),description:$.getText("CFP_NO_FILESHARE_FOUND_RELOAD"),additionalContent:[new e({text:$.getText("CFP_BUTTON_RELOAD"),press:function(){this.oSelectControl.getBinding("items").refresh()}})]});this.oTableControl.setNoData(n)}else{if(t.getSource()&&t.getSource().getContexts()&&t.getSource().getContexts().length){var o=t.getSource().getContexts()[0].sPath;var a=o.split(/[']/)[1];this.oSelectControl.setSelectedKey(a);setTimeout(function(){this._initializeVisibleLinks()}.bind(this));this._loadFileShareRootFolder(this.oSelectControl.getSelectedKey())}}}.bind(this)},template:new O({key:"{FileShare}",text:{parts:["FileShare","FileShareDescription"],formatter:function(e,t){return t?t:e}}})});var i=new u({layout:"ResponsiveGridLayout",singleContainerFullSize:false});i.addContent(t);i.addContent(this.oSelectControl);var n=new h({text:$.getText("CFP_FILENAME"),showColon:true,labelFor:this.getId()+"-fileName"}).addStyleClass(k.system.desktop?"sapUiTinyMarginTop":"");this.oFileNameControl=new d({id:this.getId()+"-fileName",liveChange:function(e){this.oTableControl.removeSelections();var t=this.oNavigationMap.get(this.aVisibleLinks[this.aVisibleLinks.length-1].fileShareItemId);this._setConfirmationButtonEnabled(null,t,true)}.bind(this)});i.addContent(n);i.addContent(this.oFileNameControl);if(this.getFilePickerMode()===H.FileOnly){this.oFileNameControl.setVisible(false)}else{this.oFileNameControl.setValue(this.getSuggestedFileName())}return i};W.prototype._createBreadcrumbLinks=function(){this.oBreadcrumbLinkControl=new p(this.getId()+"-breadcrumbs").addStyleClass("sapUiSmallMarginBegin sapUiSmallMarginEnd");this.oNavigationMap=new Map;this._initializeVisibleLinks();return this.oBreadcrumbLinkControl};W.prototype._initializeVisibleLinks=function(){var e=this.oSelectControl.getSelectedItem()?this.oSelectControl.getSelectedItem().getText():"";var t={fileShareItemId:"Root",title:e};this.aVisibleLinks=[t];this.oBreadcrumbLinkControl.setCurrentLocationText(e);this.oNavigationMap.clear()};W.prototype._createTableContent=function(){this.oNewFolderButton=new e({text:$.getText("CFP_TITLE_NEWFOLDER"),type:U.Transparent,enabled:false,press:function(){this._createNewFolderInline()}.bind(this)});this.oTableControl=new o({headerToolbar:new T({content:[new w({text:$.getText("CFP_LIST_HEADER")}),new v,new x({layoutData:new D({minWidth:"200px",maxWidth:"300px",shrinkable:true,moveToOverflow:false}),visible:false}),this.oNewFolderButton],design:"Transparent"}),columns:[new s({header:new C({text:$.getText("CFP_NAME")}),customData:[new L({key:"bindingProperty",value:"FileShareItemName"})],width:"auto",importance:"High"}),new s({hAlign:"Left",header:new C({text:$.getText("CFP_TYPE"),wrapping:false}),customData:[new L({key:"bindingProperty",value:"FileShareItemContentType"})],width:"17%",importance:"High"}),new s({header:new C({text:$.getText("CFP_OWNER"),wrapping:false}),customData:[new L({key:"bindingProperty",value:"CreatedByUser"})],width:"17%",importance:"Low",visible:k.system.phone?false:true}),new s({hAlign:"End",header:new C({text:$.getText("CFP_TITLE_LAST_CHANGED_ON"),wrapping:false}),customData:[new L({key:"bindingProperty",value:"LastChangeDateTime"})],width:"17%",importance:"Low",visible:k.system.phone?false:true}),new s({hAlign:"End",header:new C({text:$.getText("CFP_FILESIZE"),wrapping:false}),customData:[new L({key:"bindingProperty",value:"FileShareItemContentSize"})],width:"10%",importance:"Low",visible:k.system.phone?false:true})],autoPopinMode:true,sticky:["HeaderToolbar","ColumnHeaders"],headerDesign:"Plain",noDataText:" ",mode:"SingleSelectMaster",itemPress:function(e){this.oTableControl.setBusyIndicatorDelay(0);this.oTableControl.setNoDataText(" ");var t=e.getParameters().listItem;var i=t.getBindingContext();var n=i.getObject("FileShareItemKind")==="folder";if(n){var o=this._createSelectionParameter(t);var a=o.getFileShareItemId();o.path=i.getCanonicalPath();this.oCurrentParentData=o;this.oNavigationMap.set(a,o);var s=i.getModel().createBindingContext(o.path);this.aVisibleLinks.push({fileShareItemId:a,title:t.getCells()[0].getItems()[1].getText()});this._updateBreadcrumbLinks();this.oTableControl.setBindingContext(s)}else{var r=i.getProperty("FileShareItemName");this.oFileNameControl.setValue(r)}}.bind(this),items:{path:"_Children",parameters:{$$operationMode:"Server"},sorter:[new B({path:"FileShareItemKind",descending:true}),new B({path:"FileShareItemName",descending:false})],events:{dataReceived:function(){this.oTableControl.setNoData(null);this.oTableControl.setNoDataText($.getText("CFP_NO_DATA_FILESHARE"));this.setBusy(false)}.bind(this)},template:new a({cells:[new n({items:[new m({src:{parts:["FileShareItemKind","FileShareItemContentType","isDocumentCreationAllowed"],formatter:function(e,t,i){if(e==="folder"){if(i==="No"){return"sap-icon://locked"}else{return"sap-icon://folder-full"}}else{return c.getIconForMimeType(t)}}},tooltip:{parts:["FileShareItemKind","isDocumentCreationAllowed"],formatter:function(e,t){if(e==="folder"&&t==="No"){return $.getText("CFP_LOCKED_FOLDER_INFO")}else{return""}}}}).addStyleClass("sapUiTinyMarginEnd"),new C({text:"{FileShareItemName}"})]}),new C({text:"{FileShareItemHumanContentType}"}),new C({text:"{= ${FileShareItemKind} === 'folder' ? '' : ${CreatedByUser}}"}),new C({text:{parts:["FileShareItemKind","LastChangeDateTime"],formatter:function(e,t){if(e==="folder"){return""}else{var i=new P({style:"short"});return i.formatValue(new Date(t),"string")}}}}),new C({text:{parts:["FileShareItemKind","FileShareItemContentSize"],formatter:function(e,t){if(e!=="folder"){var i=R.getInstance({binaryFilesize:false,maxFractionDigits:1,maxIntegerDigits:3}).format(t.split(",").join(""));return i}else{return""}}}})],type:"{= ${FileShareItemKind} === 'folder' ? 'Navigation' : 'Active'}"})},updateFinished:function(e){if(!this.oTableControl.getBusy()){if(this.oCurrentParentData&&Object.keys(this.oCurrentParentData).length!==0){this._setConfirmationButtonEnabled(this.oCurrentParentData.getProperty("isDocumentCreationAllowed"));this._enableDisableNewFolderBtn()}}}.bind(this)});this.oTableControl.bActiveHeaders=true;this.oTableControl.attachEvent("columnPress",function(e){var t=e.getParameter("column"),i=t.getCustomData()[0].getValue();if(i==="CreatedByUser"||i==="FileShareItemContentSize"||i==="FileShareItemContentType"){return}var n=[new _({icon:"sap-icon://sort-ascending",action:function(){this._fHandleSorting(t,true)}.bind(this)}),new _({icon:"sap-icon://sort-descending",action:function(){this._fHandleSorting(t,false)}.bind(this)})];var o=new N({items:[n]});o.openBy(t)}.bind(this));var t=new g({showHeader:false,content:[this.oTableControl],enableScrolling:true});return t};W.prototype._createNewFolderInline=function(){var e=new d({placeholder:"Enter Folder Name",width:"100%",visible:true,value:$.getText("CFP_TITLE_NEWFOLDER")});e.attachBrowserEvent("click",function(){e.setValue("")});e.attachBrowserEvent("focusout",function(t){if(e&&e.getValue()!==""){this.setBusy(true);var i=this.oSelectControl.getSelectedKey();var n=t.target.value;var o="folder";this._checkForDuplicateFileAndFolder(n,i,o).then(function(i){this.setBusy(false);if(i.value.length){e.setValueState(j.Error);e.setValueStateText($.getText("CFP_FOLDER_EXIST"))}else{e.setValueState(j.None);e.setValueStateText("");this._makeNewFolderEntry(t.target.value)}}.bind(this))}}.bind(this));this.oNewFolderColumnListItem=new a({cells:[new n({items:[e]}),new C({text:"{= ${FileShareItemKind} === 'folder' ? '' : ${FileShareItemContentType}}"}),new C({text:"{= ${FileShareItemKind} === 'folder' ? '' : ${CreatedByUser}}"}),new C({text:{parts:["FileShareItemKind","LastChangeDateTime"],formatter:function(e,t){if(e==="folder"){return""}else{if(t){var i=new P({style:"short"});return i.formatValue(new Date(t),"string")}}}}}),new C({text:"{= ${FileShareItemKind} === 'folder' ? '' : ${FileShareItemContentSize}}"})]});this._setConfirmationButtonEnabled(false);this.oNewFolderButton.setEnabled(false);this.oTableControl.insertItem(this.oNewFolderColumnListItem);setTimeout(function(){e.focus()})};W.prototype._checkForDuplicateFileAndFolder=function(e,t,i){var n=this.aVisibleLinks[this.aVisibleLinks.length-1].fileShareItemId;var o="/FileShareItems(FileShare='"+t+"',FileShareItem='"+n+"')/_Query";var a=this.getModel().bindContext(o,"",{$filter:"FileShareItemName eq '"+e+"'and FileShareItemKind eq '"+i+"'"});return a.requestObject()};W.prototype._enableDisableNewFolderBtn=function(){if(this.oNavigationMap.size&&this.oCurrentParentData.getProperty("isDocumentCreationAllowed")){this.oNewFolderButton.setEnabled(true)}else{this.oNewFolderButton.setEnabled(false)}};W.prototype._makeNewFolderEntry=function(e){this.setBusy(true);var t=this.oTableControl.getBinding("items"),i,n=new Promise(function(e){i=e});this.oTableControl.removeItem(this.oNewFolderColumnListItem);this.oNewFolderColumnListItem.destroy();var o=t.create({FileShareItemName:e,FileShareItemKind:"folder"},true,false,false);var a=function(e){var n=e.getParameter("context"),s=e.getParameter("success");if(n===o){t.detachCreateCompleted(a,this);i(s)}};t.attachCreateCompleted(a,this);var s=function(){o.created().then(undefined,function(e){E.trace("transient creation context deleted")}).catch(function(e){E.trace("transient creation context deletion error",e)})};n.then(function(e){if(!e){s();t.resetChanges();this.setBusy(false)}else{o.created();this.oTableControl.setSelectedItem(this.oTableControl.getItems().length>0?this.oTableControl.getItems()[0]:null);this.setBusy(false)}}.bind(this))};W.prototype._warningMessageDialog=function(i){var n=new t({type:K.Message,title:$.getText("CFP_TITLE_WARNING"),state:j.Warning,content:new C({text:i}),beginButton:new e({type:U.Emphasized,text:$.getText("CFP_BUTTON_OK"),press:function(){n.close()}})});n.open()};W.prototype._fHandleSorting=function(e,t){var i=t?z.Ascending:z.Descending;if(i===e.getSortIndicator()){i=z.None}this.oTableControl.getColumns().forEach(function(e){e.setSortIndicator("None")});e.setSortIndicator(i);var n=e.data("bindingProperty");var o=this.oTableControl.getBinding("items");o.sort([new B("FileShareItemKind",true),new B(n,!t)])};W.prototype._resetAndApplyDefaultSorting=function(){this.oTableControl.getColumns().forEach(function(e){e.setSortIndicator("None")});var e=this.oTableControl.getBinding("items");e.sort([new B("FileShareItemKind",true),new B("FileShareItemName",false)])};W.prototype._updateBreadcrumbLinks=function(){if(this.aVisibleLinks&&this.aVisibleLinks.length>1){var e=this.aVisibleLinks.slice().reverse();var t=[];e.forEach(function(e,i,n){if(i==0){this.oBreadcrumbLinkControl.setCurrentLocationText(e.title)}else{var o=new f({text:e.title,press:function(e){if(this.oNewFolderColumnListItem&&this.oTableControl.indexOfItem(this.oNewFolderColumnListItem)>-1){this.oTableControl.removeItem(this.oNewFolderColumnListItem);this.oNewFolderColumnListItem.destroy()}var t=this.oBreadcrumbLinkControl.indexOfLink(e.getSource());var i=this.aVisibleLinks.splice(t+1);var n,o;this._updateBreadcrumbLinks();if(this.aVisibleLinks.length>1){n=this.oNavigationMap.get(this.aVisibleLinks[this.aVisibleLinks.length-1].fileShareItemId);this.oCurrentParentData=n;for(var a in i){this.oNavigationMap.delete(i[a].fileShareItemId)}this._setConfirmationButtonEnabled(null,n);o=this.getModel().createBindingContext(n.path);this.oTableControl.setBindingContext(o)}else{n=this.oNavigationMap.get(this.aVisibleLinks[this.aVisibleLinks.length-1].fileShareItemId);this.oCurrentParentData=n;this._setConfirmationButtonEnabled(null,n);this._loadFileShareRootFolder(this.oSelectControl.getSelectedKey())}}.bind(this)});t.push(o)}}.bind(this));t.reverse();if(this.oBreadcrumbLinkControl.getLinks()){this.oBreadcrumbLinkControl.removeAllLinks()}for(var i=0;i<t.length;i++){this.oBreadcrumbLinkControl.addLink(t[i])}}else{this.oBreadcrumbLinkControl.destroyLinks();this._initializeVisibleLinks();this._enableDisableNewFolderBtn()}this._setConfirmationButtonEnabled(false)};W.prototype._loadFileShareRootFolder=function(e){this.oNavigationMap.clear();var t="/FileShares("+"'"+e+"'"+")/_Root";var i=this.getModel().bindContext(t);i.requestObject().then(function(e){var t=this._createSelectionParameter(e,i.getBoundContext(e));this._setConfirmationButtonEnabled(null,t)}.bind(this));var n=this.getModel().createBindingContext(t);this.oTableControl.setBindingContext(n)};W.prototype._createButton=function(){this.oConfirmationButton=new e({text:this.getConfirmButtonText(),type:U.Emphasized,enabled:false,press:function(){this.setBusy(true);var e=this.oFileNameControl.getValue();if(this.getFilePickerMode()===H.FileOnly||e){if(this.getEnableDuplicateCheck()){var t="document";this._checkForDuplicateFileAndFolder(e,this.oSelectControl.getSelectedKey(),t).then(function(t){this.setBusy(false);if(t.value.length){this._showOverwriteMessage(e)}else{this._closeDialog()}}.bind(this))}else{this._closeDialog()}}}.bind(this)});this.addButton(this.oConfirmationButton);this.addButton(new e({text:$.getText("CFP_BUTTON_CANCEL"),press:function(){this.fireCancel();this.close();setTimeout(function(){this.destroy()}.bind(this))}.bind(this)}));this._setConfirmationButtonEnabled(false)};W.prototype._setConfirmationButtonEnabled=function(e,t,i){var n=false;if(this.oFileNameControl&&this.oFileNameControl.getValue()){n=this.oFileNameControl.getValue()!==""}if(this.getFilePickerMode()===H.FileOnly){this.oConfirmationButton.setEnabled(e)}else if(t&&t.getIsDocumentCreationAllowed()){if(this.getFileNameMandatory()){n||e?this.oConfirmationButton.setEnabled(true):this.oConfirmationButton.setEnabled(false)}else{this.oConfirmationButton.setEnabled(true)}}else if(i){if(this.getFileNameMandatory()){this.oConfirmationButton.setEnabled(t&&t.getIsDocumentCreationAllowed()?n:false)}}else{this.oConfirmationButton.setEnabled(e?e:false)}};W.prototype._showOverwriteMessage=function(i){var n=this.getDuplicateMessage();if(!n){n=$.getText("CFP_MESSAGE_DUPLICATE",i)}var o=new t({type:K.Message,title:$.getText("CFP_TITLE_WARNING"),state:j.Warning,content:new C({text:n}),beginButton:new e({type:U.Emphasized,text:$.getText("CFP_BUTTON_YES"),press:function(){o.close();this._closeDialog(true)}.bind(this)}),endButton:new e({text:$.getText("CFP_BUTTON_NO"),press:function(){o.close()}})});o.open()};W.prototype._closeDialog=function(e){var t={};if(this.aVisibleLinks.length>1){t.selectedFolder=this.oNavigationMap.get(this.aVisibleLinks[this.aVisibleLinks.length-1].fileShareItemId)}else{t.selectedFolder=new F;t.selectedFolder.setFileShareId(this.oSelectControl.getSelectedKey())}t.selectedFileName=this.oFileNameControl.getValue();t.replaceExistingFile=!!e;t.selectedFiles=[];var i=this.oTableControl.getSelectedItem();if(i){t.selectedFiles.push(this._createSelectionParameter(i))}this.fireEvent("select",t);this.close();setTimeout(function(){this.destroy()}.bind(this))};W.prototype._createSelectionParameter=function(e,t){var i=new F;var n;if(!t){n=e.getBindingContext()}else{n=t}i.setFileShareId(n.getObject("FileShare"));i.setFileShareItemId(n.getObject("FileShareItem"));i.setParentFileShareItemId(n.getObject("ParentFileShareItem"));i.setIsFolder(n.getObject("FileShareItemKind")==="folder");i.setFileShareItemName(n.getObject("FileShareItemName"));i.setCreatedByUser(n.getObject("CreatedByUser"));i.setCreationDateTime(n.getObject("CreationDateTime"));i.setLastChangedByUser(n.getObject("LastChangedByUser"));i.setLastChangeDateTime(n.getObject("LastChangeDateTime"));i.setFileShareItemContent(n.getObject("FileShareItemContent"));i.setFileShareItemContentType(n.getObject("FileShareItemContentType"));i.setFileShareItemContentSize(n.getObject("FileShareItemContentSize"));i.setFileShareItemContentLink(n.getObject("FileShareItemContentLink"));i.setIsDocumentCreationAllowed(n.getObject("isDocumentCreationAllowed"));return i};return W});
sap.ui.predefine("sap/suite/ui/commons/ControlProxy", ["./library","sap/ui/core/Control"],function(t,o){"use strict";var s=o.extend("sap.suite.ui.commons.ControlProxy",{metadata:{library:"sap.suite.ui.commons",association:{control:{type:"sap.ui.core.Control",multiple:false}}},renderer:function(t,o){var s=o.getAssociation("control"),a=sap.ui.getCore().byId(s);t.renderControl(a)}});s.prototype.setAssociation=function(t,s){o.prototype.setAssociation.apply(this,arguments);var a=this.getAssociation("control"),e=sap.ui.getCore().byId(a);if(e&&Array.isArray(this.aCustomStyleClasses)){this.aCustomStyleClasses.forEach(function(t){e.addStyleClass(t)})}};s.prototype.addStyleClass=function(t){o.prototype.addStyleClass.apply(this,arguments);var s=this.getAssociation("control"),a=sap.ui.getCore().byId(s);if(a){a.addStyleClass(t)}};return s});
sap.ui.predefine("sap/suite/ui/commons/MicroProcessFlow", ["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/base/ManagedObject","sap/ui/core/delegate/ItemNavigation","sap/ui/core/ResizeHandler"],function(jQuery,t,e,i,s,o,r){"use strict";var n=t.MicroProcessFlowRenderType;var l=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var a=function(t){return t[t.length-1]};var c=e.extend("sap.suite.ui.commons.MicroProcessFlow",{metadata:{library:"sap.suite.ui.commons",interfaces:["sap.ui.core.IFormContent"],properties:{ariaLabel:{type:"string",defaultValue:null},renderType:{type:"sap.suite.ui.commons.MicroProcessFlowRenderType",defaultValue:sap.suite.ui.commons.MicroProcessFlowRenderType.Wrap},width:{type:"sap.ui.core.CSSSize",defaultValue:""}},aggregations:{content:{type:"sap.suite.ui.commons.MicroProcessFlowItem",multiple:true,singularName:"content"}}},renderer:{apiVersion:2,render:function(t,e){var i=e.getContent(),s=e.getWidth(),o=i.length,r=e.getAriaLabel();if(!e._bThemeApplied){return}t.openStart("div",e);t.attr("role","listbox");t.attr("aria-roledescription",l.getText("ACC_CTR_TYPE_MICRO_PROCESS_FLOW"));t.attr("aria-label",r);if(s){t.style("width",s)}t.class("sapSuiteUiCommonsMicroProcessFlow");t.openEnd();if(e._hasScrolling()){t.openStart("div");t.attr("tabindex","0");t.attr("id",e.getId()+"-leftscroller");t.class("sapSuiteUiCommonsMicroProcessFlowScroller").class("sapSuiteUiCommonsMicroProcessFlowLeftScroller");t.openEnd();t.renderControl(e._getLeftScroller());t.openStart("span");t.attr("id",e.getId()+"-leftlabel");t.class("sapSuiteUiCommonsMicroProcessFlowLeftLabel");t.openEnd();t.close("span");t.close("div")}t.openStart("div");t.attr("id",e.getId()+"-content");t.class("sapSuiteUiCommonsMicroProcessFlowContent");t.openEnd();t.openStart("div");t.attr("id",e.getId()+"-scrolling");t.class("sapSuiteUiCommonsMicroProcessFlowScrolling").class("sapSuiteUiCommonsMicroProcessFlowScrollingTransition");if(e.getRenderType()===n.Wrap){t.style("flex-wrap","wrap")}t.openEnd();i.forEach(function(e,i){e._setAccessibilityData(i+1,o);t.renderControl(e)});t.close("div");t.close("div");if(e._hasScrolling()){t.openStart("div");t.attr("id",e.getId()+"-rightscroller");t.attr("tabindex","0");t.class("sapSuiteUiCommonsMicroProcessFlowScroller").class("sapSuiteUiCommonsMicroProcessFlowRightScroller");t.openEnd();t.openStart("span");t.attr("id",e.getId()+"-rightlabel");t.class("sapSuiteUiCommonsMicroProcessFlowRightLabel");t.openEnd();t.close("span");t.renderControl(e._getRightScroller());t.close("div")}t.close("div")}}});c.prototype.exit=function(){if(this._oLeftScroller){this._oLeftScroller.destroy()}if(this._oRightScroller){this._oRightScroller.destroy()}};c.prototype.init=function(){sap.ui.getCore().attachThemeChanged(function(){this._bThemeApplied=true;this.invalidate()},this);this._bThemeApplied=sap.ui.getCore().isThemeApplied();this._iScrollingIndex=0;this._iLastVisibleIndex=0;this._aEdges=[];this._aWidths=[];this._aSeperatorWidth=[]};c.prototype.onAfterRendering=function(){this._correctSeparatorWidth();this._setupKeyboard();if(this._hasScrolling()){this._setupScrolling();this._collectEdgesAndWidths();this._updateScrollingElements();if(this.getRenderType()===n.ScrollingWithResizer){this._oResizer=r.register(this,jQuery.proxy(this._performResizeChanges,this))}}};c.prototype._performResizeChanges=function(){this._collectEdgesAndWidths();this._updateScrollingElements()};c.prototype._isLastItem=function(t){return t===this.getContent()[this.getContent().length-1]};c.prototype._getMaxHeight=function(t){return Math.max.apply(null,this.$().find(".sapSuiteUiCommonsMicroProcessFlowItemWrapper").map(function(){return jQuery(this).height()}).get())};c.prototype._correctSeparatorWidth=function(){var t=this._getMaxHeight();if(t){this.getContent().forEach(function(e){var i=e.getStepWidth(),s;if(i.indexOf("%")!==-1){s=parseInt(i,10);if(!isNaN(s)){e.$("separator").width(t/s*100)}}},this)}};c.prototype._firePress=function(){if(this._oItemNavigation){var t=this._oItemNavigation.getFocusedIndex(),e=this.getContent()[t];if(e){e._firePress()}}};c.prototype._setupKeyboard=function(){var t=this.getDomRef(),e=this.getContent(),i=[];e.forEach(function(t,e){var s=t._getAccessibleItem();i.push(s[0])});if(!this._oItemNavigation){this._oItemNavigation=new o;this.addDelegate(this._oItemNavigation)}this._oItemNavigation.setRootDomRef(t);this._oItemNavigation.setItemDomRefs(i);this._oItemNavigation.setCycling(false);this._oItemNavigation.attachEvent(o.Events.AfterFocus,function(t){if(this._bKeyBoard===true){this._findEdgeItems(t.getParameter("index"));this._updateScrollingElements()}this._bKeyBoard=false}.bind(this))};c.prototype._hasScrolling=function(){var t=this.getRenderType();return t===n.Scrolling||t===n.ScrollingWithResizer};c.prototype._setupScrolling=function(){var t=this.$("leftscroller"),e=this.$("rightscroller");this._iScrollingIndex=0;this._iLastVisibleIndex=0;t.on("click",this._scroll.bind(this,-1));e.on("click",this._scroll.bind(this,1));this._iScrollingIndex<=0?t.hide():t.show()};c.prototype._updateScrollingElements=function(t){var e=this.getContent(),i=this.$("leftscroller"),s=this.$("rightscroller");i[this._iScrollingIndex<=0?"hide":"show"]();this._iLastVisibleIndex=this._findLastVisibleItemIndex(t);s[this._iLastVisibleIndex>=e.length-1?"hide":"show"]();this.$("leftlabel").text(this._iScrollingIndex);this.$("rightlabel").text(e.length-1-this._iLastVisibleIndex)};c.prototype._scroll=function(t,e){e.stopPropagation();var i=this.$("rightscroller"),s=this.$("leftscroller"),o=sap.ui.getCore().getConfiguration().getRTL(),r,n,l;var c=function(){if(t>0){var e=this.$("content").width()-(s.is(":visible")?0:s.width()),o=a(this._aEdges)+a(this._aWidths);if(r+e>o){r-=r+e-o+i.width();for(var n=0;n<this._aEdges;n++){if(this._aEdges[n]+this._aWidths[n]>r){this._iScrollingIndex=n;break}}}}}.bind(this);var h=function(){if(!o&&d[0].scrollLeft!=0){this._clearScroll(d)}if(o){l=d.scrollRightRTL();if(l){this._clearScroll(d)}}}.bind(this);var p=this.$("scrolling"),d=p.parent();this._bKeyBoard=false;if(t<0&&this._iScrollingIndex<=0){return}h();t<0?i.show():s.show();this._iScrollingIndex+=t;r=this._aEdges[this._iScrollingIndex];c();n="translateX("+(o?1:-1)*r+"px)";this.$("scrolling").css("transform",n);if(!p.hasClass("sapSuiteUiCommonsMicroProcessFlowScrollingTransition")){setTimeout(function(){p.addClass("sapSuiteUiCommonsMicroProcessFlowScrollingTransition")},0)}this._updateScrollingElements(t);h()};c.prototype._clearScroll=function(t){var e=sap.ui.getCore().getConfiguration().getRTL();if(t&&t[0]){e?t.scrollLeftRTL(t[0].scrollWidth-t[0].clientWidth):t[0].scrollLeft=0}};c.prototype._findLastVisibleItemIndex=function(t){var e=this._aEdges[this._iScrollingIndex],i=this.$("content").width(),s=i+this.$("rightscroller").width(),o,r=0,n;for(var l=0;l<this._aEdges.length;l++){o=this._aEdges[l];if(o+this._aWidths[l]-this._aSeperatorWidth[l]<e+i){r=l}else{if(o+this._aWidths[l]<e+s){n=true}else{n=false;break}}}return n&&t!==-1?this.getContent().length-1:r};c.prototype._collectEdgesAndWidths=function(){var t=0;this._aEdges=[];this._aWidths=[];this._aSeperatorWidth=[];this.getContent().forEach(function(e,i){var s=e.$().width(),o=e.$().find(".sapSuiteUiCommonsMicroProcessFlowItemSeparatorWrapper").width();this._aEdges.push(t);this._aWidths.push(s);this._aSeperatorWidth.push(o?o:0);t+=s},this)};c.prototype._getLeftScroller=function(){if(!this._oLeftScroller){this._oLeftScroller=new i(this.getId()+"leftscroller",{src:"sap-icon://nav-back"});this._oLeftScroller.addStyleClass("sapSuiteUiCommonsMicroProcessFlowArrow")}return this._oLeftScroller};c.prototype._getRightScroller=function(){if(!this._oRightScroller){this._oRightScroller=new i(this.getId()+"rightscroller",{src:"sap-icon://navigation-right-arrow"});this._oRightScroller.addStyleClass("sapSuiteUiCommonsMicroProcessFlowArrow")}return this._oRightScroller};c.prototype._findEdgeItems=function(t){var e=this.$("scrolling"),i=e.parent(),s=this.getContent(),o=Math.abs(e.position().left),r,n,l=-1,a=-1;if(o<10||t===0){l=0;this._clearScroll(i)}if(t===s.length-1){a=s.length-1}r=e.width();for(var c=0;c<this._aEdges.length;c++){n=this._aEdges[c];if(l===-1&&n>=o){l=c}if(a===-1&&n+this._aWidths[c]>o+r+5){a=c-1;break}}this._iScrollingIndex=l;this._iLastVisibleIndex=a!==-1?a:s.length-2};c.prototype._processKeyPress=function(){if(this._hasScrolling()){var t=this.$("scrolling");this._bKeyBoard=true;t.removeClass("sapSuiteUiCommonsMicroProcessFlowScrollingTransition");t.css("transform","")}};c.prototype.onsapspace=function(){this._firePress()};c.prototype.onsapenter=function(){this._firePress()};c.prototype.onsapnext=function(t){this._processKeyPress()};c.prototype.onsapprevious=function(){this._processKeyPress()};c.prototype.onsaphome=function(t){this._processKeyPress()};c.prototype.onsapend=function(){this._processKeyPress()};c.prototype.getAccessibilityInfo=function(){var t="";this.getAggregation("content").forEach(function(e){t=t.concat(e._getAriaText())});return{type:l.getText("ACC_CTR_TYPE_MICRO_PROCESS_FLOW"),description:t}};c.prototype.getFormDoNotAdjustWidth=function(){return true};return c});
sap.ui.predefine("sap/suite/ui/commons/MicroProcessFlowItem", ["sap/ui/thirdparty/jquery","./library","sap/ui/core/library","sap/ui/core/Control","sap/suite/ui/commons/MicroProcessFlow"],function(jQuery,e,t,s,o){"use strict";var i=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons"),r={Error:"sap-icon://message-error",None:null,Success:"sap-icon://message-success",Warning:"sap-icon://message-warning",Information:"sap-icon://message-information"},a=t.ValueState;var n=s.extend("sap.suite.ui.commons.MicroProcessFlowItem",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},icon:{type:"string",group:"Appearance",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},state:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:a.Standard},showIntermediary:{type:"boolean",group:"Appearance",defaultValue:false},stepWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null},showSeparator:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{customControl:{type:"sap.ui.core.Control",multiple:false,singularName:"customControl"},intermediary:{type:"sap.ui.core.Control",multiple:false,singularName:"intermediary"}},events:{press:{allowPreventDefault:true,parameters:{item:"object"}}}},onAfterRendering:function(){this._setupEvents();this._setAccessibility()},renderer:{apiVersion:2,render:function(e,t){var s=function(){e.openStart("div");e.attr("id",t.getId()+"-separator");e.class("sapSuiteUiCommonsMicroProcessFlowItemSeparatorWrapper");e.style("width",t._getStepWidth());e.openEnd();e.openStart("div");e.class("sapSuiteUiCommonsMicroProcessFlowItemSeparator");if(!t.getShowSeparator()||r){e.class("sapSuiteUiCommonsMicroProcessFlowItemHiddenSeparator")}e.openEnd();e.close("div");if(n){o()}e.close("div")};var o=function(){var s=t.getIntermediary();e.openStart("div");e.class("sapSuiteUiCommonsMicroProcessFlowItemIntermediary");e.openEnd();if(s){e.renderControl(s)}else{e.openStart("div");e.class("sapSuiteUiCommonsMicroProcessFlowItemOnHoldElement");e.openEnd();e.close("div")}e.close("div")};var i=t.getIcon()||t._getIconByState(),r=t.getParent()._isLastItem(t),a=t.getId(),n=t.getShowIntermediary(),c=t.getCustomControl(),p=t.getTitle();e.openStart("div",t);e.class("sapSuiteUiCommonsMicroProcessFlowItemWrapper");e.openEnd();e.openStart("div");e.attr("id",a+"-item");if(p){e.attr("title",p)}e.class("sapSuiteUiCommonsMicroProcessFlowItemContent");e.openEnd();if(c){e.renderControl(c)}else{e.openStart("div");e.attr("id",a+"-itemContent");e.attr("tabindex","0");e.class("sapSuiteUiCommonsMicroProcessFlowItem").class("sapSuiteUiCommonsMicroProcessFlowItem"+t.getState());e.attr("aria-label",t._getAriaText());e.attr("role","option");e.attr("aria-selected","false");e.openEnd();if(i){e.renderControl(new sap.ui.core.Icon({tooltip:t.getTitle(),src:i}).addStyleClass("sapSuiteUiCommonsMicroProcessFlowItemIcon"))}e.close("div")}e.close("div");if(!r||n){s()}e.close("div")}}});n.prototype.getFocusDomRef=function(){var e=this.getCustomControl();return e?e.getFocusDomRef():this.getDomRef("itemContent")};n.prototype._setAccessibility=function(){var e=this._getAccessibleItem(),t=this._getAriaText();if(e.attr("tabindex")!=="0"){e.attr("tabindex",0)}e.attr("aria-label",t);e.attr("role","option");e.attr("aria-posinset",this._iIndex);e.attr("aria-setsize",this._iItemsCount)};n.prototype._getAccessibleItem=function(){var e=jQuery(this.getFocusDomRef());return e.attr("tabindex")==="0"?e:this.$("item")};n.prototype._setupEvents=function(){var e=this.$("item"),t=this.hasListeners("press");e.on("touchstart click",this._click.bind(this));if(t){e.on("mousedown",function(e){jQuery(this).addClass("sapSuiteUiCommonsMicroProcessFlowItemPressed")});e.on("mouseup",function(e){jQuery(this).removeClass("sapSuiteUiCommonsMicroProcessFlowItemPressed")})}if(t){e.css("cursor","pointer");e.attr("role","button");e.attr("aria-hidden","true")}};n.prototype._getAriaText=function(){var e=i.getText("MICRO_PROCESS_FLOW_ITEM");switch(this.getState()){case a.Error:e+=" - "+i.getText("MICRO_PROCESS_FLOW_ERROR");break;case a.Warning:e+=" - "+i.getText("MICRO_PROCESS_FLOW_WARNING");break;case a.Success:e+=" - "+i.getText("MICRO_PROCESS_FLOW_SUCCESS");break;case a.Information:e+=" - "+i.getText("MICRO_PROCESS_FLOW_INFORMATION");break}if(this.getTitle()){e+=" - "+this.getTitle()}return e};n.prototype._isCompact=function(){return jQuery("body").hasClass("sapUiSizeCompact")||this.$().is(".sapUiSizeCompact")||this.$().closest(".sapUiSizeCompact").length>0};n.prototype._getStepWidth=function(){var e=this.getStepWidth();if(!e){e=this._isCompact()?"1rem":"1.5rem"}return e};n.prototype._setAccessibilityData=function(e,t){this._iIndex=e;this._iItemsCount=t};n.prototype._click=function(e){var t=this.getParent();if(t){t._bKeyBoard=false}this._firePress(e)};n.prototype._firePress=function(e){if(this.hasListeners("press")){this.firePress({item:this.getFocusDomRef()});if(e.preventDefault){e.preventDefault()}if(e.stopPropagation){e.stopPropagation()}}var t=document.getElementsByClassName("sapSuiteMicroProcessFlowItemSelected")[0];var s=this._getAccessibleItem()[0];if(t){t.setAttribute("aria-selected",false);t.classList.remove("sapSuiteMicroProcessFlowItemSelected")}if(s.tabIndex=="0"){s.setAttribute("aria-selected",true);s.classList.add("sapSuiteMicroProcessFlowItemSelected")}};n.prototype._getIconByState=function(){return r[this.getState()]};return n});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlow", ["sap/ui/thirdparty/jquery","./library","sap/m/library","sap/m/ImageHelper","sap/ui/core/Control","sap/suite/ui/commons/ProcessFlowConnection","sap/suite/ui/commons/ProcessFlowLaneHeader","sap/ui/Device","sap/ui/core/ResizeHandler","sap/base/Log","sap/ui/events/KeyCodes","./ProcessFlowRenderer","sap/ui/core/date/UI5Date"],function(jQuery,e,t,i,o,s,a,n,r,l,c,h,u){"use strict";var g=o.extend("sap.suite.ui.commons.ProcessFlow",{metadata:{library:"sap.suite.ui.commons",properties:{foldedCorners:{type:"boolean",group:"Misc",defaultValue:false},scrollable:{type:"boolean",group:"Misc",defaultValue:true},wheelZoomable:{type:"boolean",group:"Behavior",defaultValue:true},showLabels:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"lanes",aggregations:{_connections:{type:"sap.suite.ui.commons.ProcessFlowConnection",multiple:true,singularName:"_connection",visibility:"hidden"},nodes:{type:"sap.suite.ui.commons.ProcessFlowNode",multiple:true,singularName:"node"},lanes:{type:"sap.suite.ui.commons.ProcessFlowLaneHeader",multiple:true,singularName:"lane"},ariaProperties:{type:"sap.suite.ui.commons.AriaProperties",multiple:false,group:"Misc"}},events:{nodeTitlePress:{deprecated:true,parameters:{oEvent:{type:"object"}}},nodePress:{parameters:{oEvent:{type:"object"}}},labelPress:{parameters:{oEvent:{type:"object"}}},headerPress:{parameters:{oEvent:{type:"object"}}},onError:{parameters:{oEvent:{type:"object"}}}},dnd:{draggable:false,droppable:true}}});g.prototype._resBundle=null;g._cellEdgeConstants={LU:"tl",LD:"lb",DU:"tb",LR:"rl",DR:"rt",UR:"rb"};g._constants={scrollContainer:"scrollContainer",counterLeft:"counterLeft",counterRight:"counterRight",arrowScrollRight:"arrowScrollRight",arrowScrollRightMinus:"-arrowScrollRight",arrowScrollLeft:"arrowScrollLeft",arrowScrollLeftMinus:"-arrowScrollLeft",top:"top",px:"px",parents:"parents",left:"left",right:"right"};g._mouseEvents={mouseMove:"mousemove",mouseDown:"mousedown",mouseUp:"mouseup",mouseLeave:"mouseleave",mouseEnter:"mouseenter",touchStart:"touchstart",sapTouchStart:"saptouchstart",touchEnd:"touchend",sapTouchCancel:"saptouchcancel"};g._enumMoveDirection={LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down"};g.prototype._zoomLevel=e.ProcessFlowZoomLevel.Two;g.prototype._wheelTimeout=null;g.prototype._isFocusChanged=false;g.prototype._wheelTimestamp=null;g.prototype._wheelCalled=false;g.prototype._internalCalcMatrix=false;g.prototype._internalConnectionMap=null;g.prototype._internalLanes=false;g.prototype._jumpOverElements=5;g.prototype._lastNavigationFocusElement=null;g.prototype._bHighlightedMode=false;g.prototype._isLayoutOptimized=false;g.prototype._defaultCursorClass="sapSuiteUiDefaultCursorPF";if(n.browser.edge){g.prototype._grabCursorClass="sapSuiteUiGrabCursorIEPF";g.prototype._grabbingCursorClass="sapSuiteUiGrabbingCursorIEPF"}else{g.prototype._grabCursorClass="sapSuiteUiGrabCursorPF";g.prototype._grabbingCursorClass="sapSuiteUiGrabbingCursorPF"}g.prototype._mousePreventEvents="contextmenu dblclick";g.prototype._mouseEvents="contextmenu mousemove mouseleave mousedown mouseup mouseenter";g.prototype._mouseWheelEvent=n.browser.mozilla?"DOMMouseScroll MozMousePixelScroll":"mousewheel wheel";g.prototype._headerHasFocus=false;g.prototype._isInitialZoomLevelNeeded=true;g.prototype._bDoScroll=!n.system.desktop||n.os.windows&&n.os.version>=8;g.prototype._scrollStep=192;g.prototype._bPreviousScrollForward=false;g.prototype._bPreviousScrollBack=false;g.prototype._iInitialArrowTop=undefined;g.prototype._iInitialCounterTop=undefined;g.prototype._bRtl=false;g.prototype._arrowScrollable=null;g.prototype._iTouchStartScrollTop=undefined;g.prototype._iTouchStartScrollLeft=undefined;g.prototype._bSetFocusOnce=true;g.prototype.init=function(){this._bRtl=sap.ui.getCore().getConfiguration().getRTL();if(!this._resBundle){this._resBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}this._internalLanes=[];if(this._getScrollContainer()){this._getScrollContainer().on("keydown",jQuery.proxy(this.onkeydown,this))}};g.prototype.exit=function(){var e=this.getNodes(),t;if(e){for(t=0;t<e.length;t++){if(e[t]){e[t].destroy()}}e=null}if(this._internalLanes){for(t=0;t<this._internalLanes.length;t++){this._internalLanes[t].destroy()}this._internalLanes=null}var i=this.getAggregation("_connections");if(i){for(t=0;t<i.length;t++){i[t].destroy()}i=null}if(this._oArrowLeft){this._oArrowLeft.destroy()}if(this._oArrowRight){this._oArrowRight.destroy()}if(this._resizeRegId){r.deregister(this._resizeRegId)}if(this._internalCalcMatrix){delete this._internalCalcMatrix;this._internalCalcMatrix=null}if(this._getScrollContainer()){this._getScrollContainer().off(this._mousePreventEvents,this._handlePrevent);this._getScrollContainer().off(this._mouseEvents,jQuery.proxy(this._registerMouseEvents,this));this._getScrollContainer().off(this._mouseWheelEvent,jQuery.proxy(this._registerMouseWheel,this));this._getScrollContainer().off("keydown",jQuery.proxy(this.onkeydown,this));this._getScrollContainer().off("scroll",jQuery.proxy(this._onScroll,this))}};g.prototype.onBeforeRendering=function(){if(this._getScrollContainer()){this._getScrollContainer().off(this._mousePreventEvents,this._handlePrevent);this._getScrollContainer().off(this._mouseEvents,jQuery.proxy(this._registerMouseEvents,this));this._getScrollContainer().off(this._mouseWheelEvent,jQuery.proxy(this._registerMouseWheel,this));this._getScrollContainer().off("keydown",jQuery.proxy(this.onkeydown,this));this._getScrollContainer().off("scroll",jQuery.proxy(this._onScroll,this))}};g.prototype.onAfterRendering=function(){var e=false,t=this.$("scroll-content"),i,o,s,a;this._checkOverflow(this._getScrollContainer().get(0),this.$());this.iCursorPositionX=0;this.iCursorPositionY=0;if(t&&t.length){this._getScrollContainer().find(".sapSuiteUiCommonsProcessFlowNode .sapUiIcon").css("cursor","inherit");if(this.getScrollable()){i=parseInt(this._getScrollContainer().css("height").slice(0,-2),10);o=parseInt(this._getScrollContainer().css("width").slice(0,-2),10);a=t[0].scrollHeight;s=t[0].scrollWidth;if(a<=i&&s<=o){this._clearHandlers(this._getScrollContainer());this._switchCursors(this._getScrollContainer(),this._grabCursorClass,this._defaultCursorClass)}else{this._switchCursors(this._getScrollContainer(),this._defaultCursorClass,this._grabCursorClass);e=true}}else{this._clearHandlers(this._getScrollContainer());this._switchCursors(this._getScrollContainer(),this._grabCursorClass,this._defaultCursorClass);t.css("position","static")}if(e){if(!this._iInitialArrowTop||!this._iInitialCounterTop){this._iInitialArrowTop=parseInt(this.$(g._constants.arrowScrollRight).css(g._constants.top),10);this._iInitialCounterTop=parseInt(this.$(g._constants.counterRight).css(g._constants.top),10)}if(n.os.windows&&n.system.combi&&n.browser.chrome){this._getScrollContainer().bind(this._mouseEvents,jQuery.proxy(this._registerMouseEvents,this));this._getScrollContainer().css("overflow","auto")}else if(n.os.windows&&n.browser.edge){this._getScrollContainer().bind(this._mouseEvents,jQuery.proxy(this._registerMouseEvents,this));this._getScrollContainer().css("overflow","auto");this._getScrollContainer().css("-ms-overflow-style","none")}else if(!n.support.touch){this._getScrollContainer().bind(this._mouseEvents,jQuery.proxy(this._registerMouseEvents,this))}else{this._clearHandlers(this._getScrollContainer());this._getScrollContainer().css("overflow","auto")}}else if(this._bDoScroll){this._getScrollContainer().css("overflow","auto")}else{this._getScrollContainer().css("overflow","hidden")}if(n.browser.mozilla){this._getScrollContainer().css("scrollbar-width","none")}if(this.getWheelZoomable()&&n.system.desktop&&!this._isHeaderMode()){this._getScrollContainer().bind(this._mouseWheelEvent,jQuery.proxy(this._registerMouseWheel,this))}if(this._bDoScroll){this._getScrollContainer().on("scroll",jQuery.proxy(this._onScroll,this))}this._resizeRegId=r.register(this,jQuery.proxy(g.prototype._onResize,this));if(this._isInitialZoomLevelNeeded){this._initZoomLevel()}if(this._headerHasFocus){var l=this.$("scroll-content").children().children().children(1).children("td[tabindex='0']").first().children();if(l[0]){var c=sap.ui.getCore().byId(l[0].id);this._changeNavigationFocus(null,c);this._headerHasFocus=false}}}};g.prototype.ontouchend=function(e){if(e.target&&e.target.id.indexOf("arrowScroll")!==-1){this._onArrowClick(e)}else{if(!n.support.touch){this.onAfterRendering()}else{this._adjustAndShowArrow()}if(e===null||e.oSource===undefined){return}e.preventDefault();if(this._isHeaderMode()){this._internalLanes=[];this.fireHeaderPress(this)}}};g.prototype._handlePrevent=function(e){if(e&&!e.isDefaultPrevented()){e.preventDefault()}if(e&&!e.isPropagationStopped()){e.stopPropagation()}if(e&&!e.isImmediatePropagationStopped()){e.stopImmediatePropagation()}};g.prototype._onResize=function(){var e=Date.now();if(!this._iLastResizeEventTime||e-this._iLastResizeEventTime<50){if(!this._iLastResizeHandlingTime||e-this._iLastResizeHandlingTime>500){this.onAfterRendering();this._iLastResizeHandlingTime=e}}else{this._iLastResizeHandlingTime=null}this._iLastResizeEventTime=e};g.prototype._registerMouseEvents=function(e){if(e&&!e.isDefaultPrevented()){e.preventDefault()}switch(e.type){case g._mouseEvents.mouseMove:if(this._getScrollContainer().hasClass(this._grabbingCursorClass)){if(sap.ui.getCore().getConfiguration().getRTL()){this._getScrollContainer().scrollLeftRTL(this.iCursorPositionX-e.pageX)}else{this._getScrollContainer().scrollLeft(this.iCursorPositionX-e.pageX)}this._getScrollContainer().scrollTop(this.iCursorPositionY-e.pageY);this._adjustAndShowArrow()}break;case g._mouseEvents.mouseDown:this._switchCursors(this._getScrollContainer(),this._defaultCursorClass,this._grabbingCursorClass);if(sap.ui.getCore().getConfiguration().getRTL()){this.iCursorPositionX=this._getScrollContainer().scrollLeftRTL()+e.pageX}else{this.iCursorPositionX=this._getScrollContainer().scrollLeft()+e.pageX}this.iCursorPositionY=this._getScrollContainer().scrollTop()+e.pageY;if(n.system.combi){this._iTouchStartScrollLeft=this._getScrollContainer().scrollLeft();if(this.getScrollable()){this._iTouchStartScrollTop=this._getScrollContainer().scrollTop()}}break;case g._mouseEvents.mouseUp:this._switchCursors(this._getScrollContainer(),this._grabbingCursorClass,this._grabCursorClass);break;case g._mouseEvents.mouseLeave:this._getScrollContainer().removeClass(this._grabbingCursorClass);this._getScrollContainer().removeClass(this._grabCursorClass);this._getScrollContainer().addClass(this._defaultCursorClass);break;case g._mouseEvents.mouseEnter:this._getScrollContainer().removeClass(this._defaultCursorClass);if(e.buttons===null){if(e.which===1){this._getScrollContainer().addClass(this._grabbingCursorClass)}else{this._getScrollContainer().addClass(this._grabCursorClass)}}else if(e.buttons===0){this._getScrollContainer().addClass(this._grabCursorClass)}else if(e.buttons===1){this._getScrollContainer().addClass(this._grabbingCursorClass)}break;default:}if(e.target&&e.target.parentElement&&e.target.parentElement.parentElement&&e.target.parentElement.parentElement.getMetadata&&e.target.parentElement.parentElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){if(e&&!e.isPropagationStopped()){e.stopPropagation()}if(e&&!e.isImmediatePropagationStopped()){e.stopImmediatePropagation()}}};g.prototype.onfocusin=function(e){var t;if(e&&e.target&&e.target.id){t=sap.ui.getCore().byId(e.target.id)}if(this._isHeaderMode()||this._checkNodesVisibility()){this._setFocusOnHeader(true)}else if(this._bSetFocusOnce&&!(t&&e.target.id.indexOf("arrowScroll"))){this._bSetFocusOnce=false;if(t&&t.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){this._changeNavigationFocus(null,t)}else if(!this._lastNavigationFocusElement){var i=this.$("scroll-content").children().children().children(1).children("td[tabindex='0']").first().children();var o=sap.ui.getCore().byId(i[0].id);this._changeNavigationFocus(null,o)}else if(this._lastNavigationFocusElement){this._changeNavigationFocus(null,this._lastNavigationFocusElement)}}};g.prototype._checkNodesVisibility=function(){var e=true;this.getNodes().forEach(function(t){if(t.getVisible()){e=false}});return e};g.prototype.onfocusout=function(){this._bSetFocusOnce=true;if(this._lastNavigationFocusElement&&this._lastNavigationFocusElement._getNavigationFocus()){this._lastNavigationFocusElement._setNavigationFocus(false);if(this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){this._lastNavigationFocusElement.rerender()}}};g.prototype.onsapplus=function(){this._isFocusChanged=true;this.zoomIn()};g.prototype.onsapminus=function(){this._isFocusChanged=true;this.zoomOut()};g.prototype.onsaptabnext=function(e){var t=true;var i=e.target;var o=sap.ui.getCore().byId(i.id);if(!o&&i&&i.childElementCount>0){i=i.childNodes[0];o=sap.ui.getCore().byId(i.id)}if(!o||o.getMetadata().getName()!=="sap.suite.ui.commons.ProcessFlowNode"&&o.getMetadata().getName()!=="sap.suite.ui.commons.ProcessFlowConnectionLabel"){if(!this._isHeaderMode()&&!this._lastNavigationFocusElement&&!this._checkNodesVisibility()){var s=this.$("scroll-content").children().children().children(1).children("td[tabindex='0']").first().children();var a=sap.ui.getCore().byId(s[0].id);this._changeNavigationFocus(null,a);t=false}else if(this._lastNavigationFocusElement){this._changeNavigationFocus(null,this._lastNavigationFocusElement);t=false}}if((this._isHeaderMode()||this._checkNodesVisibility())&&t){if(!this._headerHasFocus){this._setFocusOnHeader(true)}else{this._setFocusOnHeader(false)}}else if(this._lastNavigationFocusElement&&this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){this._lastNavigationFocusElement.rerender()}var n;if(t){n=this.$().nextAll(":focusable").first();if(n.length===0){n=this.$().nextAll().find(":focusable").first();if(n.length===0){r.apply(this)}}n.focus();l.debug("saptabnext: Keyboard focus has been changed to element:  id='"+n.id+"' outerHTML='"+n.outerHTML+"'");n=null}e.preventDefault();function r(){var e=this.$().parent();do{n=e.next(":focusable");if(n.length===0){n=e.nextAll().find(":focusable").first()}e=e.parent()}while(e.length!==0&&n.length===0);if(n.length===0){n=jQuery(":focusable")[0]}}};g.prototype.onsaptabprevious=function(e){var t=null;var i=e.target;if((!this._lastNavigationFocusElement||!this._lastNavigationFocusElement._getNavigationFocus())&&e.target&&e.target.childElementCount>0){i=e.target.childNodes[0]}var o=sap.ui.getCore().byId(i.id);if(o&&(o.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"||o.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode")){if(!this._isHeaderMode()&&!this._lastNavigationFocusElement){var s=this.$("scroll-content").children().children().children(1).children("td[tabindex='0']").first().children();var a=sap.ui.getCore().byId(s[0].id);this._changeNavigationFocus(null,a)}else if(this._lastNavigationFocusElement){this._changeNavigationFocus(null,this._lastNavigationFocusElement);e.preventDefault();return}}if(this._isHeaderMode()){if(!this._headerHasFocus){this._setFocusOnHeader(true)}else{this._setFocusOnHeader(false);t=this.$().prevAll().find(":focusable").last()}}else{t=this.$().prev(":focusable");if(t.length===0){t=this.$().prevAll().find(":focusable").last()}if(this._lastNavigationFocusElement){this._lastNavigationFocusElement._setNavigationFocus(false)}if(this._lastNavigationFocusElement&&this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){this._lastNavigationFocusElement.rerender()}}if(t){if(t.length===0){n.apply(this)}else if(t.first().length!==0){t=jQuery(t.first())}t.focus();l.debug("saptabnext: Keyboard focus has been set on element:  id='"+t.id+"' outerHTML='"+t.outerHTML+"'");t=null}e.preventDefault();function n(){var e=this.$();do{t=e.prev(":focusable");if(t.length===0){t=e.prevAll().find(":focusable").last()}e=e.parent()}while(e.length!==0&&t.length===0)}};g.prototype._handleKeySelect=function(e){if(this._isHeaderMode()){this._internalLanes=[];this.fireHeaderPress(this);var t=this.$("scroll-content").children().children().children(1).children("td[tabindex='0']").first().children();var i=sap.ui.getCore().byId(t[0].id);this._changeNavigationFocus(null,i)}else if(this._lastNavigationFocusElement&&this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&this._lastNavigationFocusElement._getNavigationFocus()){var o=this._lastNavigationFocusElement;o._handleEvents(e)}};g.prototype.onkeyup=function(e){var t=e.keyCode?e.keyCode:e.which;switch(t){case c.ENTER:case c.SPACE:var i=this._lastNavigationFocusElement;if(i){this.fireNodePress(this._lastNavigationFocusElement);i._handleEvents(e)}break;default:break}};g.prototype.onkeydown=function(e){var t=e.keyCode?e.keyCode:e.which;l.debug("ProcessFlow::keyboard input has been catched and action going to start: keycode="+t);var i=false;var o=e.ctrlKey;var s=e.altKey;var a=this._lastNavigationFocusElement;switch(t){case c.ARROW_RIGHT:i=this._moveToNextElement(g._enumMoveDirection.RIGHT);break;case c.ARROW_LEFT:i=this._moveToNextElement(g._enumMoveDirection.LEFT);break;case c.ARROW_DOWN:i=this._moveToNextElement(g._enumMoveDirection.DOWN);break;case c.ARROW_UP:i=this._moveToNextElement(g._enumMoveDirection.UP);break;case c.PAGE_UP:i=this._moveOnePage(g._enumMoveDirection.UP,s);break;case c.PAGE_DOWN:i=this._moveOnePage(g._enumMoveDirection.DOWN,s);break;case c.HOME:i=this._moveHomeEnd(g._enumMoveDirection.LEFT,o);break;case c.END:i=this._moveHomeEnd(g._enumMoveDirection.RIGHT,o);break;case c.NUMPAD_0:case c.DIGIT_0:this._initZoomLevel();break;case c.ENTER:case c.SPACE:this._handleKeySelect(e);e.preventDefault();return;default:return}e.preventDefault();if(i){this._changeNavigationFocus(a,this._lastNavigationFocusElement)}};g.prototype._onArrowClick=function(e){var t=e.target.id;if(t){var i=this.getId();e.preventDefault();if(t===i+g._constants.arrowScrollLeftMinus&&n.system.desktop){this._scroll(-this._scrollStep,500)}else if(t===i+g._constants.arrowScrollRightMinus&&n.system.desktop){this._scroll(this._scrollStep,500)}}};g.prototype._onScroll=function(){var e=this._getScrollContainer().scrollLeft();var t=Math.abs(e-this._iTouchStartScrollLeft);if(t>this._scrollStep/4&&!this._isFocusChanged){this._adjustAndShowArrow();this._iTouchStartScrollLeft=e}else if(this.getScrollable()){var i=this._getScrollContainer().scrollTop();var o=Math.abs(i-this._iTouchStartScrollTop);if(o>10){this._moveArrowAndCounterVertical();this._iTouchStartScrollTop=i}}};g.prototype.ontouchstart=function(){this._iTouchStartScrollLeft=this._getScrollContainer().scrollLeft();if(this.getScrollable()){this._iTouchStartScrollTop=this._getScrollContainer().scrollTop()}};g.prototype.ontouchmove=function(e){e.setMarked()};g.prototype._handleLabelClick=function(e){if(e){var t=e.getSource();if(t&&t.getMetadata().getName()==="sap.ui.core.Icon"){t=t.getParent()}if(t&&t.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){var i=this._getConnectionMapEntries(t);var o=this._createLabelPressEventArgs(t,i);this.fireLabelPress(o)}}};g.prototype._onFocusChanged=function(){var e=this._lastNavigationFocusElement,t=e?e.$():null,i,o,s,a,n,r,c,h,u,g,d,_,f,p,m,v,C=500;if(e&&this.getScrollable()){l.debug("The actually focused element is "+e.getId());if(e.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){h=t.parent().parent().parent().outerWidth();u=t.parent().parent().parent().outerHeight();g=t.parent().parent().parent().position()}else{h=t.outerWidth();u=t.outerHeight();g=t.position()}l.debug("Element outer width x height ["+h+" x "+u+"]");l.debug("Position of element in the content is ["+g.left+", "+g.top+"]");n=this.$("scroll-content");i=this._getScrollContainer().innerWidth();o=this._getScrollContainer().innerHeight();l.debug("Scroll container inner width x height ["+i+" x "+o+"]");s=this._getScrollContainer().scrollLeft();a=this._getScrollContainer().scrollTop();l.debug("Current scroll offset is ["+s+", "+a+"]");r=n.innerWidth();c=n.innerHeight();l.debug("Scroll content inner width x height ["+r+" x "+c+"]");d=-s+g.left;f=d+h;_=-a+g.top;p=_+u;if(f>i||d<0||p>o||_<0){m=Math.round((i-h)/2);m=Math.max(i-r+g.left,m);m=Math.min(g.left,m);v=Math.round((o-u)/2);v=Math.max(o-c+g.top,v);v=Math.min(g.top,v);l.debug("Element lies outside the scroll container, scrolling from ["+d+","+_+"] to ["+m+","+v+"]");this._isFocusChanged=true;this._getScrollContainer().animate({scrollTop:g.top-v,scrollLeft:g.left-m},C,"swing",jQuery.proxy(this._adjustAndShowArrow,this))}else{l.debug("Element lies inside the scroll container, no scrolling happens.");this._setFocusToNode(e)}}else{this._setFocusToNode(e);this._adjustAndShowArrow()}};g.prototype._setScrollWidth=function(){switch(this.getZoomLevel()){case e.ProcessFlowZoomLevel.One:this._scrollStep=240;break;case e.ProcessFlowZoomLevel.Two:this._scrollStep=192;break;case e.ProcessFlowZoomLevel.Three:this._scrollStep=168;break;case e.ProcessFlowZoomLevel.Four:this._scrollStep=128;break;default:this._scrollStep=192}};g.prototype._getLastNavigationFocusElement=function(){return this._lastNavigationFocusElement};g.prototype._getNode=function(e,t){for(var i=0;i<t.length;i++){if(t[i].getNodeId()===e.toString()){return t[i]}}};g.prototype._getLane=function(e){for(var t=0;t<this._internalLanes.length;t++){if(this._internalLanes[t].getLaneId()===e){return this._internalLanes[t]}}};g.prototype.destroyLanes=function(){this.removeAllAggregation("lanes");for(var e=0;e<this._internalLanes.length;e++){this._internalLanes[e].destroy()}this._internalLanes=[];return this};g._getChildIdByElement=function(e){if(typeof e==="object"){return e.nodeId}else{return e}};g.prototype._isHeaderMode=function(){var e=this.getNodes();return!e||e.length===0};g.prototype._getScrollContainer=function(){return this.$(g._constants.scrollContainer)};g.prototype._handleException=function(e){var t=this._resBundle.getText("PF_ERROR_INPUT_DATA");this.fireOnError({text:t});l.error("Error loading data for the process flow with id : "+this.getId());if(e instanceof Array){for(var i=0;i<e.length;i++){l.error("Detailed description ("+i+") :"+e[i])}}else{l.error("Detailed description  :"+e)}};g.prototype._getAriaText=function(){return this._resBundle.getText("PF_ARIA_PROCESS_FLOW")};g.prototype._updateLanesFromNodes=function(){g.NodeElement._createNodeElementsFromProcessFlowNodes(this.getNodes(),this.getLanes());var e=this._arrangeNodesByParentChildRelation(this.getNodes());this._internalLanes=g.NodeElement._updateLanesFromNodes(this.getLanes(),e).lanes};g.prototype._getOrCreateLaneMap=function(){if(!this._internalLanes||this._internalLanes.length<=0){this._updateLanesFromNodes()}return g.NodeElement._createMapFromLanes(this._internalLanes,jQuery.proxy(this.ontouchend,this),this._isHeaderMode()).positionMap};g.prototype._arrangeNodesByParentChildRelation=function(e){var t=e?e.length:0;var i=[];var o,s;if(t>0){this._setParentForNodes(e);for(o=0;o<t;o++){i=e[o].getChildren();if(i){var a=i.length;for(s=0;s<a;s++){i[s]=g._getChildIdByElement(i[s]).toString()}}for(s=0;s<o;s++){if(i&&Array.prototype.indexOf.call(i,e[s].getNodeId())>-1&&e[s].getLaneId()===e[o].getLaneId()){e.splice(s,0,e[o]);e.splice(o+1,1);e=this._arrangeNodesByParentChildRelation(e);break}}}}return e};g.prototype._getOrCreateProcessFlow=function(){if(!this._internalLanes||this._internalLanes.length<=0){this._updateLanesFromNodes()}else if(this._isLanesUpdated()){this._resetLanesFromModel();this._updateLanesFromNodes()}this.applyNodeDisplayState();var e=this.getNodes();var t=g.NodeElement._createNodeElementsFromProcessFlowNodes(e,this._internalLanes);var i=t.elementById;var o=t.elementsByLane;var s=this._calculateMatrix(i);s=this._addFirstAndLastColumn(s);g.NodeElement._calculateLaneStatePieChart(o,this._internalLanes,e,this);for(var a=0;a<s.length;a++){for(var n=0;n<s[a].length;n++){if(s[a][n]instanceof g.NodeElement){s[a][n]=i[s[a][n].nodeId].oNode}}}this._internalCalcMatrix=s;return s};g.prototype._isLanesUpdated=function(){var e=this.getLanes();if(e.length!=this._internalLanes.length){return true}var t;for(var i=0;i<e.length;i++){var o=e[i];t=false;for(var s=0;s<this._internalLanes.length;s++){var a=this._internalLanes[s];if(a.getLaneId()===o.getLaneId()){t=true;break}}if(!t){return true}}return false};g.prototype._resetLanesFromModel=function(){var e=this.getNodes();e.forEach(function(e){e._mergedLaneId=false});var t=this.getLanes();t.forEach(function(e){e._mergedLanePosition=false});this._internalLanes=[];if(this._isHeaderMode()){var i=this.getBindingInfo("lanes");if(i&&i.model){this.getModel(i.model).refresh()}}else{var o=this.getBindingInfo("nodes");if(o&&o.model){this.getModel(o.model).refresh()}}};g.prototype._addFirstAndLastColumn=function(e){if(!e||e.length<=0){return[]}var t=e.length;for(var i=0;i<t;i++){e[i].unshift(null);e[i].push(null)}return e};g.prototype._calculateMatrix=function(e){var t,i,o,s,a;if(!e||e.length===0){return[]}t=new g.InternalMatrixCalculation(this);t.checkInputNodeConsistency(e);i=t._retrieveInfoFromInputArray(e);t._resetPositions();o=i.highestLanePosition+1;s=Math.max(Object.keys(e).length,2);a=t._createMatrix(s,o);for(var n=0;n<i.rootElements.length;n++){t.iPositionY=i.rootElements[n].lane;a=t.processCurrentElement(i.rootElements[n],e,a)}if(this._isLayoutOptimized){t._optimizeMatrix(a,e)}a=t._doubleColumnsInMatrix(a);a=t._calculatePathInMatrix(a);a=t._removeEmptyLines(a);return a};g.NodeElement=function(e,t,i,o){this.nodeId=e;this.lane=t;this.state=i.getState();this.displayState=i._getDisplayState();this.isProcessed=false;if(Array.isArray(o)){this.aParent=o}else{this.oParent=o}this.oNode=i};g.NodeElement._initNodeElement=function(e,t,i,o){return new g.NodeElement(e,t,i,o)};g.NodeElement.prototype={toString:function(){return this.nodeId},containsChildren:function(e){if(!e){return false}if(!(e instanceof g.NodeElement)){return false}if(this.oNode.getChildren()&&e.oNode.getChildren()&&this.oNode.getChildren().length&&e.oNode.getChildren().length){for(var t=0;t<this.oNode.getChildren().length;t++){if(e.oNode.getChildren().indexOf(this.oNode.getChildren()[t])>=0){return true}}}return false}};g.NodeElement._calculateLaneStatePieChart=function(t,i,o,s){if(!t||!i||!o){return}var a;for(a=0;a<o.length;a++){s._bHighlightedMode=o[a].getHighlighted();if(s._bHighlightedMode){break}}var n,r,l,c,h;for(a=0;a<i.length;a++){var u=i[a];var g=t[u.getLaneId()];if(!g){continue}n=0;r=0;l=0;c=0;h=0;for(var d=0;d<g.length;d++){if(!s._bHighlightedMode||(g[d].oNode._getDisplayState()===e.ProcessFlowDisplayState.Highlighted||g[d].oNode._getDisplayState()===e.ProcessFlowDisplayState.HighlightedFocused||g[d].oNode._getDisplayState()===e.ProcessFlowDisplayState.SelectedHighlighted||g[d].oNode._getDisplayState()===e.ProcessFlowDisplayState.SelectedHighlightedFocused)){switch(g[d].oNode.getState()){case e.ProcessFlowNodeState.Positive:n++;break;case e.ProcessFlowNodeState.Negative:case e.ProcessFlowNodeState.PlannedNegative:r++;break;case e.ProcessFlowNodeState.Planned:c++;break;case e.ProcessFlowNodeState.Critical:h++;break;case e.ProcessFlowNodeState.Neutral:default:l++}}}var _=[{state:e.ProcessFlowNodeState.Positive,value:n},{state:e.ProcessFlowNodeState.Negative,value:r},{state:e.ProcessFlowNodeState.Neutral,value:l},{state:e.ProcessFlowNodeState.Planned,value:c},{state:e.ProcessFlowNodeState.Critical,value:h}];u.setState(_)}};g.NodeElement._updateLanesFromNodes=function(e,t){var i=g.NodeElement._createMapFromLanes(e,null,false);var o=i.positionMap;var s=i.idMap;var a={};var n=e.slice();var r;var l={};var c=0;var h;for(h=0;h<t.length;h++){a[t[h].getNodeId()]=t[h]}for(h=0;h<t.length;h++){var u=t[h];var d=u.getChildren()||[];var _=1;var f=null;var p=null;for(var m=0;m<d.length;m++){var v=g._getChildIdByElement(d[m]);var C=a[v];if(C){if(u.getLaneId()===C.getLaneId()){f=C.getLaneId()+_;p=s[f];if(!p){var N=s[u.getLaneId()];p=g.NodeElement._createNewProcessFlowElement(N,f,N.getPosition()+_);s[p.getLaneId()]=p;n.splice(p.getPosition(),0,p)}C._setMergedLaneId(p.getLaneId())}g.NodeElement._changeLaneOfChildren(u.getLaneId(),C,a)}}if(p){l={};r=false;for(var M in o){if(p.getLaneId()===o[M].getLaneId()){r=true;break}if(parseInt(M,10)>=p.getPosition()){var F=o[M];l[F.getPosition()+_]=F}}if(!r){for(var b in l){c=parseInt(b,10);l[c]._setMergedPosition(c)}l[p.getPosition()]=p;for(var w=0;w<p.getPosition();w++){l[w]=o[w]}o=l}}}return{lanes:n,nodes:t}};g.NodeElement._changeLaneOfChildren=function(e,t,i){var o=t.getChildren();if(o){for(var s=0;s<o.length;s++){var a=g._getChildIdByElement(o[s]);var n=i[a];if(n&&n.getLaneId()===e){n._setMergedLaneId(t.getLaneId());g.NodeElement._changeLaneOfChildren(e,n,i)}}}};g.NodeElement._createNewProcessFlowElement=function(e,t,i){return new a({laneId:t,iconSrc:e.getIconSrc(),text:e.getText(),state:e.getState(),position:i,zoomLevel:e.getZoomLevel()})};g.NodeElement._createMapFromLanes=function(e,t,i){var o,s={},a={},n=e?e.length:0,r=0;if(!n){return{}}else{while(r<n){o=e[r];if(o&&o.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowLaneHeader"){s[o.getPosition()]=o;a[o.getLaneId()]=o;if(t){o.attachPress(t)}o._setHeaderMode(i)}r++}return{positionMap:s,idMap:a}}};g.NodeElement._createNodeElementsFromProcessFlowNodes=function(e,t){var i={},o={},s={},a,n=e?e.length:0,r,l,c=t?t.length:0,h,u=[],d,_,f,p,m,v,C={};if(n===0){return{elementById:{},elementsByLane:{}}}if(c===0){throw["No lane definition although there is a node definition."]}m=0;while(m<c){l=t[m];h=l.getLaneId();d=l.getPosition();if(i[h]){throw["The lane with id: "+h+" is defined at least twice. (Lane error)"]}i[h]=d;if(u&&Array.prototype.indexOf.call(u,d)>-1){throw["The position "+d+" is defined at least twice. (Lane error)."]}else{u.push(d)}o[h]=[];m++}m=0;while(m<n){a=e[m];if(a&&a.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){r=a.getNodeId();h=a.getLaneId();_=a.getChildren()||[];p=_.length;v=0;while(v<p){f=g._getChildIdByElement(_[v]);s[f]=s[f]||[];s[f].push(r);v++}}m++}m=0;while(m<n){a=e[m];if(a&&a.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){r=a.getNodeId();if(!r){throw["There is a node which has no node id defined. (Title="+a.getTitle()+") and array position: "+m]}h=a.getLaneId();d=i[h];if(jQuery.type(d)!=="number"){throw["For the node "+r+" position (lane) is not defined."]}if(!C[r]){C[r]=g.NodeElement._initNodeElement(r,d,a,s[r]);o[h].push(C[r])}else{throw["The node id "+r+" is used second time."]}}m++}return{elementById:C,elementsByLane:o}};g.InternalMatrixCalculation=function(){this.iPositionX=0;this.iPositionY=0;this.nodePositions={};this.mapChildToNode={}};g.InternalMatrixCalculation.prototype._optimizeMatrix=function(e,t){var i;do{i=false;for(var o=0;o<e[0].length;o++){for(var s=0;s<e.length-1;s++){if(!e[s][o]){var a=false;for(var n=s+1;n<e.length;n++){if(e[n][o]){a=true;break}}if(!a){break}if(this._optimizeLane(e,s,o,t)){i=true}}}}}while(i)};g.InternalMatrixCalculation.prototype._optimizeLane=function(e,t,i,o){for(var s=t+1;s<e.length;s++){if(e[s][i]){var a=e[s][i];if(this._verifyOptimizeLane(e,t,s,i,o)){e[t][i]=a;this.nodePositions[a.nodeId].x=t;e[s][i]=null;return true}else{return false}}}return false};g.InternalMatrixCalculation.prototype._verifyOptimizeLane=function(e,t,i,o,s){var a=e[i][o].oNode;var n,r,l,c;if(a&&a.getChildren()){l=e[i][o].oNode.getChildren();for(n=0;n<l.length;n++){c=g._getChildIdByElement(l[n]);var h=s[c].lane;for(r=o+1;r<h;r++){if(e[t][r]){return false}}}}var u=e[i][o].nodeId;var d=this.nodePositions[u];var _=e[i][o].aParent;if(_){for(n=0;n<_.length;n++){c=g._getChildIdByElement(_[n]);if(o-1!==s[c].lane){return false}var f=this.nodePositions[c];if(f.x>=d.x){return false}}}for(n=0;n<o;n++){for(r=0;r<e.length;r++){if(e[r][n]&&e[r][n].oNode){c=e[r][n].nodeId;var p=this.nodePositions[c];l=e[r][n].oNode.getChildren();if(l){for(var m=0;m<l.length;m++){var v=g._getChildIdByElement(l[m]);var C=this.nodePositions[v];if(s[v].lane>o&&!(p.x<t&&C.x<t||p.x>t&&C.x>t)){return false}}}}}}if(a._hasChildren()){for(n=0;n<t;n++){if(e[n][o]){l=e[n][o].oNode.getChildren();if(l){for(r=0;r<l.length;r++){c=g._getChildIdByElement(l[r]);var N=s[c];var M=this.nodePositions[c];if(N.lane>o&&M.x>=t&&!a._hasChildrenWithNodeId(c)){return false}}}}}}return true};g.InternalMatrixCalculation.prototype._resetPositions=function(){this.iPositionX=0;this.iPositionY=0;delete this.nodePositions;delete this.mapChildToNode;this.nodePositions={};this.mapChildToNode={}};g.InternalMatrixCalculation.prototype._createMatrix=function(e){e=parseInt(e,10);var t=new Array(e||0);var i=e;if(arguments.length>1){var o=Array.prototype.slice.call(arguments,1);while(i--){t[e-1-i]=this._createMatrix.apply(this,o)}}return t};g.InternalMatrixCalculation.prototype._retrieveInfoFromInputArray=function(e){var t=0,i=[],o;Object.keys(e).forEach(function(s){o=e[s];if(!o.oParent&&!o.aParent){i.push(o)}if(t<o.lane){t=o.lane}});return{highestLanePosition:t,rootElements:i}};g.InternalMatrixCalculation.prototype._doubleColumnsInMatrix=function(e){var t=0,i;for(i=0;i<e.length;i++){t=t>e[i].length?t:e[i].length}var o=new Array(e.length||0);for(i=0;i<o.length;i++){o[i]=new Array(t*2-1);for(var s=0;s<t;s++){if(e[i][s]){o[i][2*s]=e[i][s]}}}return o};g.InternalMatrixCalculation.prototype._removeEmptyLines=function(e){var t=0,i,o;for(i=0;i<e.length;i++){for(o=0;o<e[i].length;o++){if(e[i][o]){t++;break}}}var s=this._createMatrix(t,e[0].length);for(i=0;i<t;i++){for(o=0;o<e[i].length;o++){s[i][o]=null;if(e[i][o]){s[i][o]=e[i][o]}}}return s};g.InternalMatrixCalculation.prototype._sortBasedOnChildren=function(e,t){var i={},o,s=null,a,n,r,l=[],c,h,u;if(e){e.forEach(function(e){var s=g._getChildIdByElement(e);o=i[t[s].lane];if(!o){i[t[s].lane]=o=[]}o.push(t[s])})}else{return[]}var d=function(e,t){n=(e.oNode.getChildren()||[]).length;r=(t.oNode.getChildren()||[]).length;return r-n};a=[];for(s in i){a.push(s);i[s].sort(d)}a=a.sort(function(e,t){return t-e});var _=function(e){if(u.containsChildren(e)){h.push(e)}};a.forEach(function(e){c=i[e];if(c.length>1){h=[];u=c.shift();while(u){if(h.indexOf(u)<0){h.push(u)}c.forEach(_);u=c.shift()}l=l.concat(h)}else{l=l.concat(c)}});return l};g.InternalMatrixCalculation.prototype._calculatePathInMatrix=function(e){var t=null;for(var i in this.nodePositions){if(this.nodePositions.hasOwnProperty(i)){t=this.nodePositions[i];var o=t.c.oNode.getChildren();for(var s=0;o&&s<o.length;s++){var a=g._getChildIdByElement(o[s]);var n=this.nodePositions[a];e=this._calculateSingleNodeConnection(t,n,t.x,t.y,n.x,n.y,e)}}}return e};g.InternalMatrixCalculation.prototype._calculateSingleNodeConnection=function(e,t,i,o,s,a,n){var r=a-o;var l=s-i;if(r<0){throw["Problem with negative horizontal movement","Parent node is "+e.c.toString(),"Children node is "+t.c.toString(),"Coordinates : '"+i+"','"+o+"','"+s+"','"+a+"'"]}else if(l<=-1){var c=this._checkIfHorizontalLinePossible(n,s,o+2,a);var h=a-1;if(c){h=o+1}var u=i;if(c){u=s}n[i][h]=this._createConnectionElement(n[i][h],g._cellEdgeConstants.LU,e,t,false);n=this._writeVerticalLine(n,i,s,h,e,t);n[s][h]=this._createConnectionElement(n[s][h],g._cellEdgeConstants.UR,e,t,h===a-1);var d=o+2;var _=a;if(!c){d=o+1;_=h+1}n=this._writeHorizontalLine(n,u,d,_,e,t)}else if(l===0){n=this._writeHorizontalLine(n,i,o+1,a,e,t)}else if(l===1){n[i][o+1]=this._createConnectionElement(n[i][o+1],g._cellEdgeConstants.LD,e,t,false);n[s][o+1]=this._createConnectionElement(n[s][o+1],g._cellEdgeConstants.DR,e,t,o+1===a-1);n=this._writeHorizontalLine(n,s,o+2,a,e,t)}else{n[i][o+1]=this._createConnectionElement(n[i][o+1],g._cellEdgeConstants.LD,e,t,false);n=this._writeVerticalLine(n,s,i,o+1,e,t);n[s][o+1]=this._createConnectionElement(n[s][o+1],g._cellEdgeConstants.DR,e,t,o+1===a-1);n=this._writeHorizontalLine(n,s,o+2,a,e,t)}return n};g.InternalMatrixCalculation.prototype._writeVerticalLine=function(e,t,i,o,s,a){for(var n=t-1;n>i;n--){e[n][o]=this._createConnectionElement(e[n][o],g._cellEdgeConstants.DU,s,a,false)}return e};g.InternalMatrixCalculation.prototype._checkIfHorizontalLinePossible=function(e,t,i,o){var s=true;for(var a=i;a<o;a++){if(e[t][a]instanceof g.NodeElement){s=false;break}}return s};g.InternalMatrixCalculation.prototype._writeHorizontalLine=function(e,t,i,o,s,a){var n=t===a.x;if(!n){o--}for(var r=i;r<o;r++){e[t][r]=this._createConnectionElement(e[t][r],g._cellEdgeConstants.LR,s,a,r===o-1&&n)}return e};g.InternalMatrixCalculation.prototype._createConnectionElement=function(e,t,i,o,a){var n=e;if(!n){n=new s}if(n.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){var r=this._calculateConnectionDisplayStateBySourceAndTargetNode(i.c.oNode,o.c.oNode);var l={flowLine:t,targetNodeState:o.c.state,displayState:r,hasArrow:a};n.addConnectionData(l)}return n};g.InternalMatrixCalculation.prototype._calculateConnectionDisplayStateBySourceAndTargetNode=function(t,i){var o=t.getHighlighted();var s=t.getSelected();var a=t._getDimmed();var n=i.getHighlighted();var r=i.getSelected();var l=i._getDimmed();var c=e.ProcessFlowDisplayState.Regular;if(s&&r){c=e.ProcessFlowDisplayState.Selected}else if(o&&n){c=e.ProcessFlowDisplayState.Highlighted}else if(a||l||o&&r||s&&n){c=e.ProcessFlowDisplayState.Dimmed}return c};g.prototype.addNode=function(e){return this.addAggregation("nodes",e,false)};g.prototype._switchCursors=function(e,t,i){if(e.hasClass(t)){e.removeClass(t)}if(!e.hasClass(i)){e.addClass(i)}};g.prototype._clearHandlers=function(e){e.bind(this._mousePreventEvents,jQuery.proxy(this._handlePrevent,this))};g.prototype._initZoomLevel=function(){if(this.$()){var i=this.$().width();if(i){if(i<t.ScreenSizes.tablet){this.setZoomLevel(e.ProcessFlowZoomLevel.Four)}else if(i<t.ScreenSizes.desktop){this.setZoomLevel(e.ProcessFlowZoomLevel.Three)}else{this.setZoomLevel(e.ProcessFlowZoomLevel.Two)}}}};g.prototype._registerMouseWheel=function(e){var t=e.originalEvent.wheelDelta||-e.originalEvent.detail;if(t===0){t=-e.originalEvent.deltaY}if(e&&!e.isDefaultPrevented()){e.preventDefault();e.originalEvent.returnValue=false}var i=300;var o=function(){var e=Date.now()-this._wheelTimestamp;if(e<i){this._wheelTimeout=setTimeout(function(){var e=o.bind(this);if(typeof e==="string"||e instanceof String){e=this[e]}e.apply(this,[])}.bind(this),i-e)}else{this._wheelTimeout=null;this._wheelCalled=false}};if(!this._wheelCalled){this._wheelCalled=true;if(t<0){this._isFocusChanged=true;this.zoomOut()}else{this._isFocusChanged=true;this.zoomIn()}}if(!this._wheelTimeout){this._wheelTimestamp=Date.now();this._wheelTimeout=setTimeout(function(){var e=o.bind(this);if(typeof e==="string"||e instanceof String){e=this[e]}e.apply(this,[])}.bind(this),i)}if(e&&!e.isPropagationStopped()){e.stopPropagation()}if(e&&!e.isImmediatePropagationStopped()){e.stopImmediatePropagation()}};g.prototype._setFocusToNode=function(e){if(e){if(e.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){jQuery(document.getElementById(e.sId)).parent().focus();e._setNavigationFocus(true);e.rerender()}else if(e.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){e.$().focus();e._setNavigationFocus(true)}}else if(this._lastNavigationFocusElement){if(this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){jQuery(document.getElementById(this._lastNavigationFocusElement.sId)).parent().focus();this._lastNavigationFocusElement._setNavigationFocus(true);this._lastNavigationFocusElement.rerender()}else if(this._lastNavigationFocusElement.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){this._lastNavigationFocusElement.$().focus();this._lastNavigationFocusElement._setNavigationFocus(true)}}};g.prototype._changeNavigationFocus=function(e,t){if(e&&t&&e.getId()!==t.getId()){l.debug("Rerendering PREVIOUS node with id '"+e.getId()+"' navigation focus : "+e._getNavigationFocus());e._setNavigationFocus(false);if(e.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){e.invalidate()}}if(t){l.debug("Rerendering CURRENT node with id '"+t.getId()+"' navigation focus : "+t._getNavigationFocus());t._setNavigationFocus(true);if(t.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){t.rerender()}this._lastNavigationFocusElement=t;this._onFocusChanged()}};g.prototype._moveOnePage=function(e,t){e=e||g._enumMoveDirection.UP;t=t||false;var i=0,o=0;var s=0,a=0;var n=0;var r=false,l,c,h;for(l=0;l<this._internalCalcMatrix.length;l++){for(c=0;c<this._internalCalcMatrix[l].length;c++){if(this._internalCalcMatrix[l][c]&&this._internalCalcMatrix[l][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&this._internalCalcMatrix[l][c]._getNavigationFocus()){i=l;o=c;break}else if(this._internalCalcMatrix[l][c]&&this._internalCalcMatrix[l][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[l][c]._getVisibleLabel();if(h&&h._getNavigationFocus()){i=l;o=c;break}}}}if(t){if(e===g._enumMoveDirection.UP){for(c=o-1;c>=0&&n<this._jumpOverElements;c--){if(this._internalCalcMatrix[i][c]&&this._internalCalcMatrix[i][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[i][c].getHighlighted())){n++;s=i;a=c;r=true}else if(this._internalCalcMatrix[i][c]&&this._internalCalcMatrix[i][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[i][c]._getVisibleLabel();if(this._labelCanGetFocus(h)){n++;s=i;a=c;r=true}}}}else if(e===g._enumMoveDirection.DOWN){for(c=o+1;c<this._internalCalcMatrix[i].length&&n<this._jumpOverElements;c++){if(this._internalCalcMatrix[i][c]&&this._internalCalcMatrix[i][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[i][c].getHighlighted())){n++;s=i;a=c;r=true}else if(this._internalCalcMatrix[i][c]&&this._internalCalcMatrix[i][c].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[i][c]._getVisibleLabel();if(this._labelCanGetFocus(h)){n++;s=i;a=c;r=true}}}}}else if(e===g._enumMoveDirection.UP){for(l=i-1;l>=0&&n<this._jumpOverElements;l--){if(this._internalCalcMatrix[l][o]&&this._internalCalcMatrix[l][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[l][o].getHighlighted())){n++;s=l;a=o;r=true}else if(this._internalCalcMatrix[l][o]&&this._internalCalcMatrix[l][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[l][o]._getVisibleLabel();if(this._labelCanGetFocus(h)){n++;s=l;a=o;r=true}}}}else if(e===g._enumMoveDirection.DOWN){for(l=i+1;l<this._internalCalcMatrix.length&&n<this._jumpOverElements;l++){if(this._internalCalcMatrix[l][o]&&this._internalCalcMatrix[l][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[l][o].getHighlighted())){n++;s=l;a=o;r=true}else if(this._internalCalcMatrix[l][o]&&this._internalCalcMatrix[l][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[l][o]._getVisibleLabel();if(this._labelCanGetFocus(h)){n++;s=l;a=o;r=true}}}}if(r){if(this._internalCalcMatrix[i][o]&&this._internalCalcMatrix[i][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){this._internalCalcMatrix[i][o]._getVisibleLabel()._setNavigationFocus(false)}else{this._internalCalcMatrix[i][o]._setNavigationFocus(false)}if(this._internalCalcMatrix[s][a]&&this._internalCalcMatrix[s][a].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){h=this._internalCalcMatrix[s][a]._getVisibleLabel();h._setNavigationFocus(true);this._lastNavigationFocusElement=h}else{this._internalCalcMatrix[s][a]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[s][a]}}return r};g.prototype._moveHomeEnd=function(e,t){e=e||g._enumMoveDirection.RIGHT;t=t||false;var i=0,o=0;var s=0,a=0;var n=false,r,l,c;for(r=0;r<this._internalCalcMatrix.length;r++){for(l=0;l<this._internalCalcMatrix[r].length;l++){if(this._internalCalcMatrix[r][l]&&this._internalCalcMatrix[r][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&this._internalCalcMatrix[r][l]._getNavigationFocus()){i=r;o=l;break}else if(this._internalCalcMatrix[r][l]&&this._internalCalcMatrix[r][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[r][l]._getVisibleLabel();if(c&&c._getNavigationFocus()){i=r;o=l;break}}}}if(t){if(e===g._enumMoveDirection.LEFT){for(r=0;r<i;r++){if(this._internalCalcMatrix[r][o]&&this._internalCalcMatrix[r][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[r][o].getHighlighted())){s=r;a=o;n=true;break}else if(this._internalCalcMatrix[r][o]&&this._internalCalcMatrix[r][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[r][o]._getVisibleLabel();if(this._labelCanGetFocus(c)){s=r;a=o;n=true;break}}}}else if(e===g._enumMoveDirection.RIGHT){for(r=this._internalCalcMatrix.length-1;r>i;r--){if(this._internalCalcMatrix[r][o]&&this._internalCalcMatrix[r][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[r][o].getHighlighted())){s=r;a=o;n=true;break}else if(this._internalCalcMatrix[r][o]&&this._internalCalcMatrix[r][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[r][o]._getVisibleLabel();if(this._labelCanGetFocus(c)){s=r;a=o;n=true;break}}}}}else if(e===g._enumMoveDirection.LEFT){for(l=0;l<o;l++){if(this._internalCalcMatrix[i][l]&&this._internalCalcMatrix[i][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[i][l].getHighlighted())){s=i;a=l;n=true;break}else if(this._internalCalcMatrix[i][l]&&this._internalCalcMatrix[i][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[i][l]._getVisibleLabel();if(this._labelCanGetFocus(c)){s=i;a=l;n=true;break}}}}else if(e===g._enumMoveDirection.RIGHT){for(l=this._internalCalcMatrix[i].length-1;l>o;l--){if(this._internalCalcMatrix[i][l]&&this._internalCalcMatrix[i][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&(!this._bHighlightedMode||this._internalCalcMatrix[i][l].getHighlighted())){s=i;a=l;n=true;break}else if(this._internalCalcMatrix[i][l]&&this._internalCalcMatrix[i][l].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[i][l]._getVisibleLabel();if(this._labelCanGetFocus(c)){s=i;a=l;n=true;break}}}}if(n){if(this._internalCalcMatrix[i][o]&&this._internalCalcMatrix[i][o].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){this._internalCalcMatrix[i][o]._getVisibleLabel()._setNavigationFocus(false)}else{this._internalCalcMatrix[i][o]._setNavigationFocus(false)}if(this._internalCalcMatrix[s][a]&&this._internalCalcMatrix[s][a].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){c=this._internalCalcMatrix[s][a]._getVisibleLabel();c._setNavigationFocus(true);this._lastNavigationFocusElement=c}else{this._internalCalcMatrix[s][a]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[s][a]}}return n};g.prototype._moveToNextElement=function(e,t){e=e||g._enumMoveDirection.RIGHT;if(sap.ui.getCore().getConfiguration().getRTL()){if(e===g._enumMoveDirection.RIGHT){e=g._enumMoveDirection.LEFT}else if(e===g._enumMoveDirection.LEFT){e=g._enumMoveDirection.RIGHT}}t=t||1;var i=false;var o=false;var s=0,a=1,n,r,l;if(!this._internalCalcMatrix){return false}var c=0,h=0;for(n=0;n<this._internalCalcMatrix.length;n++){for(r=0;r<this._internalCalcMatrix[n].length;r++){if(this._internalCalcMatrix[n][r]){if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&this._internalCalcMatrix[n][r]._getNavigationFocus()){s=c=n;a=h=r;i=true;break}else if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][r]._getVisibleLabel();if(l&&l._getNavigationFocus()&&l.getEnabled()){s=c=n;a=h=r;i=true;break}}}}if(i){break}}if(e===g._enumMoveDirection.RIGHT){for(n=c;n<this._internalCalcMatrix.length;n++){for(r=h+1;r<this._internalCalcMatrix[n].length;r++){if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][r].getHighlighted())){this._internalCalcMatrix[n][r]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][r];o=true;break}}else if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][r]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}}h=0;if(o){break}}}if(e===g._enumMoveDirection.LEFT){for(n=c;n>=0;n--){for(r=h-1;r>=0;r--){if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][r].getHighlighted())){this._lastNavigationFocusElement=this._internalCalcMatrix[n][r]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][r];o=true;break}}else if(this._internalCalcMatrix[n][r]&&this._internalCalcMatrix[n][r].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][r]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}}if(n>0){h=this._internalCalcMatrix[n-1].length}if(o){break}}}var u,d,_;if(e===g._enumMoveDirection.UP){for(n=c-1;n>=0;n--){u=0;while(!o){d=h-u;_=h+u;if(d>=0&&this._internalCalcMatrix[n][d]&&this._internalCalcMatrix[n][d].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][d].getHighlighted())){this._internalCalcMatrix[n][d]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][d];o=true;break}}else if(d>=0&&this._internalCalcMatrix[n][d]&&this._internalCalcMatrix[n][d].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][d]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}if(_<this._internalCalcMatrix[n].length&&this._internalCalcMatrix[n][_]&&this._internalCalcMatrix[n][_].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][_].getHighlighted())){this._internalCalcMatrix[n][_]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][_];o=true;break}}else if(_>=0&&this._internalCalcMatrix[n][_]&&this._internalCalcMatrix[n][_].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][_]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}if(d<0&&_>this._internalCalcMatrix[n].length){break}u++}}}if(e===g._enumMoveDirection.DOWN){for(n=c+1;n<this._internalCalcMatrix.length;n++){u=0;while(!o){d=h-u;_=h+u;if(d>=0&&this._internalCalcMatrix[n][d]&&this._internalCalcMatrix[n][d].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][d].getHighlighted())){this._lastNavigationFocusElement=this._internalCalcMatrix[n][d]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][d];o=true;break}}else if(d>=0&&this._internalCalcMatrix[n][d]&&this._internalCalcMatrix[n][d].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][d]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}if(_<this._internalCalcMatrix[n].length&&this._internalCalcMatrix[n][_]&&this._internalCalcMatrix[n][_].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){if(i&&(!this._bHighlightedMode||this._internalCalcMatrix[n][_].getHighlighted())){this._lastNavigationFocusElement=this._internalCalcMatrix[n][_]._setNavigationFocus(true);this._lastNavigationFocusElement=this._internalCalcMatrix[n][_];o=true;break}}else if(_>=0&&this._internalCalcMatrix[n][_]&&this._internalCalcMatrix[n][_].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnection"){l=this._internalCalcMatrix[n][_]._getVisibleLabel();if(i&&this._labelCanGetFocus(l)){l._setNavigationFocus(true);this._lastNavigationFocusElement=l;o=true;break}}if(d<0&&_>this._internalCalcMatrix[n].length){break}u++}}}if(o){if(this._internalCalcMatrix[s][a]&&this._internalCalcMatrix[s][a].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){this._internalCalcMatrix[s][a]._setNavigationFocus(false)}else{this._internalCalcMatrix[s][a]._getVisibleLabel()._setNavigationFocus(false)}}return o};g.prototype._getScrollContainerOnZoomChanged=function(e,t){e.scrollLeft=Math.round(t.get()[0].scrollWidth/e.scrollWidth*e.scrollLeft);e.scrollTop=Math.round(t.get()[0].scrollHeight/e.scrollHeight*e.scrollTop);e.scrollWidth=t.get()[0].scrollWidth;e.scrollHeight=t.get()[0].scrollHeight;return e};g.prototype._mergeLaneIdNodeStates=function(t){var i=0;var o=0;var s=0;var a=0;var n=0;for(var r=0;r<5;r++){for(var l=0;l<t.length;l++){switch(t[l][r].state){case e.ProcessFlowNodeState.Positive:i=i+t[l][r].value;break;case e.ProcessFlowNodeState.Negative:o=o+t[l][r].value;break;case e.ProcessFlowNodeState.Neutral:s=s+t[l][r].value;break;case e.ProcessFlowNodeState.Planned:a=a+t[l][r].value;break;case e.ProcessFlowNodeState.PlannedNegative:o=o+t[l][r].value;break;case e.ProcessFlowNodeState.Critical:n=n+t[l][r].value;break;default:break}}}return[{state:e.ProcessFlowNodeState.Positive,value:i},{state:e.ProcessFlowNodeState.Negative,value:o},{state:e.ProcessFlowNodeState.Neutral,value:s},{state:e.ProcessFlowNodeState.Planned,value:a},{state:e.ProcessFlowNodeState.Critical,value:n}]};g.prototype._setFocusOnHeader=function(e){var t=this.$("thead");if(e){t.focus();t.addClass("sapSuiteUiCommonsPFHeaderFocused");this._headerHasFocus=true}else{t.removeClass("sapSuiteUiCommonsPFHeaderFocused");this._headerHasFocus=false}};g.prototype._scroll=function(e,t){var i=this._getScrollContainer().get(0);var o=i.scrollLeft;if(!n.browser.edge&&this._bRtl){e=-e}var s=o+e;jQuery(i).stop(true,true).animate({scrollLeft:s},t,jQuery.proxy(this._adjustAndShowArrow,this))};g.prototype._adjustAndShowArrow=function(){this._checkOverflow(this._getScrollContainer().get(0),this.$());if(this.getScrollable()){this._moveArrowAndCounterVertical()}if(this._isFocusChanged){this._setFocusToNode(this._lastNavigationFocusElement);this._isFocusChanged=false}};g.prototype._getScrollingArrow=function(e){var t;if(n.system.desktop){t="sap-icon://navigation-"+e+"-arrow"}else{t="sap-icon://slim-arrow-"+e}var o={src:t};var s="sapPFHArrowScrollLeft";var a="sapPFHArrowScrollRight";var r=["sapPFHArrowScroll",s];var l=["sapPFHArrowScroll",a];if(e===g._constants.left){if(!this._oArrowLeft){this._oArrowLeft=i.getImageControl(this.getId()+g._constants.arrowScrollLeftMinus,null,this,o,r)}return this._oArrowLeft}if(e===g._constants.right){if(!this._oArrowRight){this._oArrowRight=i.getImageControl(this.getId()+g._constants.arrowScrollRightMinus,null,this,o,l)}return this._oArrowRight}};g.prototype._checkScrolling=function(e,t){var i=false;if(e){if(e.scrollWidth>e.clientWidth){i=true}}if(this._arrowScrollable!==i){t.toggleClass("sapPFHScrollable",i);t.toggleClass("sapPFHNotScrollable",!i);this._arrowScrollable=i}return i};g.prototype._updateLeftCounter=function(){var e;if(!this._bRtl){e=this._getScrollContainer().scrollLeft()}else{e=this._getScrollContainer().scrollRightRTL()}var t=Math.round(e/this._scrollStep);this.$(g._constants.counterLeft).text(t.toString());return t};g.prototype._updateRightCounter=function(e,t){var i;var o;if(!this._bRtl){i=this._getScrollContainer().scrollLeft();o=Math.round((t-i-e)/this._scrollStep)}else{i=this._getScrollContainer().scrollLeftRTL();o=Math.round(i/this._scrollStep)}this.$(g._constants.counterRight).text(o.toString());return o};g.prototype._moveArrowAndCounterVertical=function(){var e=this._getScrollContainer().scrollTop();if(e>0){var t=this._iInitialArrowTop-e;var i=this._iInitialCounterTop-e;var o=this._iInitialCounterTop-this._iInitialArrowTop;if(t>0){this.$(g._constants.arrowScrollRight).css(g._constants.top,t+g._constants.px);this.$(g._constants.arrowScrollLeft).css(g._constants.top,t+g._constants.px)}else{this.$(g._constants.arrowScrollRight).css(g._constants.top,"0px");this.$(g._constants.arrowScrollLeft).css(g._constants.top,"0px")}if(i>o){this.$(g._constants.counterRight).css(g._constants.top,i+g._constants.px);this.$(g._constants.counterLeft).css(g._constants.top,i+g._constants.px)}else{this.$(g._constants.counterRight).css(g._constants.top,o+g._constants.px);this.$(g._constants.counterLeft).css(g._constants.top,o+g._constants.px)}}else{this.$(g._constants.arrowScrollRight).css(g._constants.top,this._iInitialArrowTop+g._constants.px);this.$(g._constants.arrowScrollLeft).css(g._constants.top,this._iInitialArrowTop+g._constants.px);this.$(g._constants.counterRight).css(g._constants.top,this._iInitialCounterTop+g._constants.px);this.$(g._constants.counterLeft).css(g._constants.top,this._iInitialCounterTop+g._constants.px)}};g.prototype._checkOverflow=function(e,t){if(this._checkScrolling(e,t)&&e){this._setScrollWidth();var i=false;var o=false;var s=20;var a=this._getScrollContainer().scrollLeft();var n=e.scrollWidth;var r=e.clientWidth;if(Math.abs(n-r)===1){n=r}if(!this._bRtl){if(a>s){i=true}if(n>r&&a+r+s<n){o=true}}else{var l=jQuery(e);if(l.scrollLeftRTL()>s){o=true}if(l.scrollRightRTL()>s){i=true}}this._updateLeftCounter();this._updateRightCounter(r,n);if(o!==this._bPreviousScrollForward||i!==this._bPreviousScrollBack){this._bPreviousScrollForward=o;this._bPreviousScrollBack=i;t.toggleClass("sapPFHScrollBack",i);t.toggleClass("sapPFHNoScrollBack",!i);t.toggleClass("sapPFHScrollForward",o);t.toggleClass("sapPFHNoScrollForward",!o)}}else{this._bPreviousScrollForward=false;this._bPreviousScrollBack=false}};g.prototype._setParentForNodes=function(e){var t=e?e.length:0;var i;var o,s;for(var a in e){e[a].removeAllAssociation(g._constants.parents,true)}for(o=0;o<t;o++){i=e[o].getChildren();if(i){for(s=0;s<i.length;s++){var n=this._getNode(g._getChildIdByElement(i[s]),e);if(n){n.addAssociation(g._constants.parents,e[o],true)}}}}};g.prototype._getConnectionsMap=function(){var e=[];var t=this.getNodes();for(var i=0;i<t.length;i++){var o=this._getPositionOfNodeInMatrix(this._internalCalcMatrix,t[i]);var s=t[i].getChildren();if(s){for(var a=0;a<s.length;a++){var n={};n.sourceNode=t[i];var r=g._getChildIdByElement(s[a]);var l=this._getNode(r,t);if(l){if(typeof s[a]==="object"){n.label=s[a].connectionLabel}n.targetNode=l;var c=this._getPositionOfNodeInMatrix(this._internalCalcMatrix,n.targetNode);n.connectionParts=this._calculateConnectionParts(o,c);e.push(n)}}}}this._internalConnectionMap=e;return e};g.prototype._getPositionOfNodeInMatrix=function(e,t){var i={};for(var o=0;o<e.length;o++){var s=e[o];for(var a=0;a<s.length;a++){var n=s[a];if(n&&n.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&n.getNodeId()===t.getNodeId()){i.y=o;i.x=a;return i}}}return i};g.prototype._calculateConnectionParts=function(e,t){var i=[];var o=e.y;var s=e.x;s++;i.push({x:s,y:o});if(t.y>=e.y){while(o<t.y){o++;i.push({x:s,y:o})}}else{while(o>t.y){o--;i.push({x:s,y:o})}}while(s<t.x-1){s++;i.push({x:s,y:o})}return i};g.prototype._getConnectionMapEntries=function(e){var t=[];var i=null;var o=null;if(this._internalConnectionMap){for(var s=0;s<this._internalConnectionMap.length;s++){o=this._internalConnectionMap[s];if(o.label&&o.label.getId()===e.getId()){i=o;break}}o=null;for(var a=0;a<this._internalConnectionMap.length;a++){o=this._internalConnectionMap[a];if(o.targetNode&&o.targetNode.getNodeId()===i.targetNode.getNodeId()){t.push(o)}}}return t};g.prototype._createLabelPressEventArgs=function(e,t){var i={};var o=[];if(t){for(var s=0;s<t.length;s++){var a={sourceNode:t[s].sourceNode,targetNode:t[s].targetNode,label:t[s].label};o.push(a)}}i.selectedLabel=e;i.connections=o;return i};g.prototype.applyNodeDisplayState=function(){var e=this.getNodes(),t=e?e.length:0,i=0;if(t!==0){while(i<t){e[i]._setRegularState();i++}i=0;while(i<t&&!e[i].getHighlighted()&&!e[i].getSelected()){i++}if(i<t){i=0;while(i<t){if(!e[i].getHighlighted()&&!e[i].getSelected()){e[i]._setDimmedState()}i++}}}};g.InternalMatrixCalculation.prototype.checkInputNodeConsistency=function(e){var t=[],i,o,s,a,n,r=0;Object.keys(e).forEach(function(l){n=e[l];a=n.oNode.getChildren();s=a?a.length:0;if(n.oNode.getFocused()){r++}i=0;while(i<s){o=g._getChildIdByElement(a[i]);if(!e[o]){t.push("Node identificator "+o+" used in children definition is not presented as the node itself. Element : "+n.nodeId)}i++}});if(t.length>0){throw t}return r>1};g.InternalMatrixCalculation.prototype.processCurrentElement=function(e,t,i){var o,s,a=true,n=true;if(e.isProcessed){return i}this.nodePositions[e.nodeId]={c:e,x:this.iPositionX,y:this.iPositionY*2};i[this.iPositionX][this.iPositionY++]=e;o=e.oNode.getChildren();e.isProcessed=true;s=this._sortBasedOnChildren(o,t);if(s){s.forEach(function(e){if(!e.isProcessed){n=false;while(this.iPositionY<e.lane){i[this.iPositionX][this.iPositionY++]=null}i=this.processCurrentElement(e,t,i)}else if(a&&n){this.iPositionX++;a=false}}.bind(this))}if(!o||n){if(a){this.iPositionX++}this.iPositionY=0}return i};g.prototype.getZoomLevel=function(){return this._zoomLevel};g.prototype.setZoomLevel=function(t){if(!this._getScrollContainer()){return}var i=this._getScrollContainer();var o=null;var s;if(i.get().length){o={scrollWidth:i.get()[0].scrollWidth,scrollHeight:i.get()[0].scrollHeight,scrollLeft:i.get()[0].scrollLeft,scrollTop:i.get()[0].scrollTop};s=o;if(this._zoomLevel===t){this._isInitialZoomLevelNeeded=false;return}}if(!(t in e.ProcessFlowZoomLevel)){this._handleException('"'+t+'" is not a valid entry of the enumeration for property zoom level of ProcessFlow');return}this._zoomLevel=t;if(this._isInitialZoomLevelNeeded){this._isInitialZoomLevelNeeded=false;this.invalidate()}else{this.rerender()}if(o){if(n.support.touch){var a=parseInt(this._getScrollContainer().css("height").slice(0,-2),10);var r=parseInt(this._getScrollContainer().css("width").slice(0,-2),10);var l=this._getScrollContainer()[0].scrollHeight;var c=this._getScrollContainer()[0].scrollWidth;if(this.getScrollable()&&(l>a||c>r)){this._switchCursors(this._getScrollContainer(),this._defaultCursorClass,this._grabCursorClass);this._getScrollContainer().css("overflow","auto")}}i=this._getScrollContainer();s=this._getScrollContainerOnZoomChanged(o,i);i.scrollLeft(s.scrollLeft);i.scrollTop(s.scrollTop);this._adjustAndShowArrow();if(this._isFocusChanged){this._setFocusToNode();this._isFocusChanged=false}}};g.prototype.zoomOut=function(){var t=this.getZoomLevel();var i=t;switch(t){case e.ProcessFlowZoomLevel.One:i=e.ProcessFlowZoomLevel.Two;break;case e.ProcessFlowZoomLevel.Two:i=e.ProcessFlowZoomLevel.Three;break;case e.ProcessFlowZoomLevel.Three:i=e.ProcessFlowZoomLevel.Four;break;default:break}this.setZoomLevel(i);return this.getZoomLevel()};g.prototype.zoomIn=function(){var t=this.getZoomLevel();var i=t;switch(t){case e.ProcessFlowZoomLevel.Four:i=e.ProcessFlowZoomLevel.Three;break;case e.ProcessFlowZoomLevel.Three:i=e.ProcessFlowZoomLevel.Two;break;case e.ProcessFlowZoomLevel.Two:i=e.ProcessFlowZoomLevel.One;break;default:break}this.setZoomLevel(i);return this.getZoomLevel()};g.prototype.updateModel=function(){this._lastNavigationFocusElement=null;var e=this.getNodes();e.forEach(function(e){e._mergedLaneId=false});var t=this.getLanes();t.forEach(function(e){e._mergedLanePosition=false});this._internalLanes=[];if(this._isHeaderMode()){var i=this.getBindingInfo("lanes");this.getModel(i.model).refresh()}else{var o=this.getBindingInfo("nodes");this.getModel(o.model).refresh()}this.rerender()};g.prototype.optimizeLayout=function(e){if(e===undefined){e=true}if(this._isLayoutOptimized!==e){this._isLayoutOptimized=e;this.updateModel()}return this};g.prototype.getFocusedNode=function(){return this._lastNavigationFocusElement&&this._lastNavigationFocusElement.sId};g.prototype.updateNodesOnly=function(){var e=this.getBindingInfo("nodes");this.getModel(e.model).refresh();this.rerender()};g.prototype.setSelectedPath=function(e,t){var i=this.getNodes(),o;if(i){if(e&&t){var s=0;for(o=0;o<i.length;o++){if(i[o].getNodeId()===e||i[o].getNodeId()===t){i[o].setSelected(true);s++}else{i[o].setSelected(false)}}if(s===2){this.rerender()}}else if(!e&&!t){for(o=0;o<i.length;o++){i[o].setSelected(false)}this.rerender()}}};g.prototype.setShowLabels=function(e){var t=this.getShowLabels();if(t&&!e){this.setProperty("showLabels",e,true);if(!this.getShowLabels()){this.setSelectedPath(null,null)}}else{this.setProperty("showLabels",e)}return this};g.prototype.setFocusToLabel=function(e){this._changeNavigationFocus(this._lastNavigationFocusElement,e)};g.prototype._labelCanGetFocus=function(e){return e&&e.getEnabled()&&(!this._bHighlightedMode||e._bHighlighted)};g.prototype.getNode=function(e){var t=this.getNodes();for(var i=0;i<t.length;i++){if(t[i].getProperty("nodeId")===e){return t[i]}}};g.prototype.getFocusInfo=function(){var e=document.activeElement;if(e&&e.nodeName){return{sFocusId:e.id,oFocusedElement:e,oFocusInfo:{}}}else{return{}}};g.prototype.applyFocusInfo=function(e){if(e.sFocusId){var t=this._lastNavigationFocusElement;this._changeNavigationFocus(null,t)}};g.prototype.getLane=function(e){var t=this.getLanes();for(var i=0;i<t.length;i++){if(t[i].getProperty("laneId")===e){return t[i]}}};g.prototype.removeAllLanes=function(){this.removeAllAggregation("lanes");this._internalLanes=[]};return g});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowConnection", ["./library","sap/ui/core/Control","./ProcessFlowConnectionRenderer"],function(e,t,o){"use strict";var a=t.extend("sap.suite.ui.commons.ProcessFlowConnection",{metadata:{library:"sap.suite.ui.commons",properties:{drawData:{type:"object[]",group:"Misc",defaultValue:null},zoomLevel:{type:"sap.suite.ui.commons.ProcessFlowZoomLevel",group:"Misc",defaultValue:"Two"},type:{type:"sap.suite.ui.commons.ProcessFlowConnectionType",group:"Appearance",defaultValue:"Normal",deprecated:true},state:{type:"sap.suite.ui.commons.ProcessFlowConnectionState",group:"Appearance",defaultValue:"Regular",deprecated:true}},defaultAggregation:"_labels",aggregations:{_labels:{type:"sap.suite.ui.commons.ProcessFlowConnectionLabel",multiple:true,singularName:"_label",visibility:"hidden"}}}});a.prototype._oResBundle=null;a.prototype._showLabels=false;a.prototype._oStateOrderMapping=null;a.prototype.init=function(){if(!this._oResBundle){this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}this._oStateOrderMapping={};this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Neutral]=1;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Positive]=2;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Critical]=3;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Negative]=4};a.prototype._getAriaText=function(e){var t="";var o=" "+this._oResBundle.getText("PF_CONNECTION_ENDS");if(this._isHorizontalLine(e)){t=this._oResBundle.getText("PF_CONNECTION_HORIZONTAL_LINE");if(e.arrow){t+=o}}else if(this._isVerticalLine(e)){t=this._oResBundle.getText("PF_CONNECTION_VERTICAL_LINE");if(e.arrow){t+=o}}else{t=this._oResBundle.getText("PF_CONNECTION_BRANCH");if(e.arrow){t+=o}}return t};a.prototype._getVisibleLabel=function(){var e=null;if(this.getAggregation("_labels")){var t=this.getAggregation("_labels");for(var o=0;o<t.length;o++){var a=t[o];if(a&&a.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){if(e){if(this._oStateOrderMapping[e.getState()]<this._oStateOrderMapping[a.getState()]){e=a}else if(this._oStateOrderMapping[e.getState()]===this._oStateOrderMapping[a.getState()]){if(e.getPriority()<a.getPriority()){e=a}}}else{e=a}}}}return e};a.prototype._getShowLabels=function(){return a.prototype._showLabels};a.prototype._setShowLabels=function(e){a.prototype._showLabels=e};a.prototype._traverseConnectionData=function(){var e=this.getDrawData();if(!e){return{}}var t=this._createConnection(e);if(this.getAggregation("_labels")){t.labels=this.getAggregation("_labels")}return t};a.prototype._isVerticalLine=function(e){return e.hasOwnProperty("left")&&!e.left.draw&&e.hasOwnProperty("right")&&!e.right.draw&&e.hasOwnProperty("top")&&e.top.draw&&e.hasOwnProperty("bottom")&&e.bottom.draw};a.prototype._isHorizontalLine=function(e){return e.hasOwnProperty("left")&&e.left.draw&&e.hasOwnProperty("right")&&e.right.draw&&e.hasOwnProperty("top")&&!e.top.draw&&e.hasOwnProperty("bottom")&&!e.bottom.draw};a.prototype._createConnection=function(e){var t={draw:false,type:"",state:""};var o={right:t,top:t,left:t,bottom:t,arrow:false};for(var a=0;a<e.length;a++){o.right=this._createLine(e[a],"r",o.right);o.top=this._createLine(e[a],"t",o.top);o.left=this._createLine(e[a],"l",o.left);o.bottom=this._createLine(e[a],"b",o.bottom);if(e[a].flowLine.indexOf("r")>=0){if(e[a].hasArrow){o.arrow=true}}}return o};a.prototype._createLine=function(t,o,a){var r={draw:a.draw,type:a.type,state:a.state};if(t.flowLine.indexOf(o)>=0){r.draw=true;if(t.targetNodeState===e.ProcessFlowNodeState.Neutral||t.targetNodeState===e.ProcessFlowNodeState.Positive||t.targetNodeState===e.ProcessFlowNodeState.Negative||t.targetNodeState===e.ProcessFlowNodeState.Critical){r.type=e.ProcessFlowConnectionType.Normal}else if(t.targetNodeState===e.ProcessFlowNodeState.Planned||t.targetNodeState===e.ProcessFlowNodeState.PlannedNegative){if(r.type!==e.ProcessFlowConnectionType.Normal){r.type=e.ProcessFlowConnectionType.Planned}}if(t.displayState===e.ProcessFlowDisplayState.Selected||t.displayState===e.ProcessFlowDisplayState.SelectedHighlighted||t.displayState===e.ProcessFlowDisplayState.SelectedHighlightedFocused||t.displayState===e.ProcessFlowDisplayState.SelectedFocused){r.state=e.ProcessFlowConnectionState.Selected}else if(t.displayState===e.ProcessFlowDisplayState.Highlighted||t.displayState===e.ProcessFlowDisplayState.HighlightedFocused){if(r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Highlighted}}else if(t.displayState===e.ProcessFlowDisplayState.Regular||t.displayState===e.ProcessFlowDisplayState.RegularFocused){if(r.state!==e.ProcessFlowConnectionState.Highlighted&&r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Regular}}else if(t.displayState===e.ProcessFlowDisplayState.Dimmed||t.displayState===e.ProcessFlowDisplayState.DimmedFocused){if(r.state!==e.ProcessFlowConnectionState.Highlighted&&r.state!==e.ProcessFlowConnectionState.Regular&&r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Dimmed}}}return r};a.prototype.addConnectionData=function(e){var t=this.getDrawData();if(!t){t=[]}t.push(e);this.setDrawData(t);return t};a.prototype.destroyAggregation=function(e,t){this.removeAllAggregation("_labels",true)};return a});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowConnectionLabel", ["sap/m/Button","./library","sap/ui/core/InvisibleText","./ProcessFlowConnectionLabelRenderer"],function(e,t,s,i){"use strict";var o=e.extend("sap.suite.ui.commons.ProcessFlowConnectionLabel",{metadata:{library:"sap.suite.ui.commons",properties:{priority:{type:"int",group:"Misc",defaultValue:0},state:{type:"sap.suite.ui.commons.ProcessFlowConnectionLabelState",group:"Appearance",defaultValue:"Neutral"}}}});o.prototype._bNavigationFocus=false;o.prototype._bSelected=false;o.prototype._bHighlighted=false;o.prototype.ACTIVE_CSS_CLASS="sapSuiteUiCommonsProcessFlowLabelActive";o.prototype.HOVER_CSS_CLASS="sapSuiteUiCommonsProcessFlowLabelHover";o.prototype.MOUSE_EVENTS="mouseenter mousedown mouseup mouseleave";o.prototype._oResBundle=null;o.prototype._bDimmed=false;o.prototype.init=function(){if(e.prototype.init){e.prototype.init.apply(this,arguments)}this.addStyleClass("sapSuiteUiCommonsProcessFlowConnectionLabel");if(!this._oResBundle){this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}};o.prototype.exit=function(){this.$().off(this.MOUSE_EVENTS,this._handleEvents)};o.prototype.onBeforeRendering=function(){this.$().off(this.MOUSE_EVENTS,this._handleEvents);this._configureStateClasses();this._setLabelWidth();this._setAriaDetails()};o.prototype.onAfterRendering=function(){if(!this.getText()){if(this.$().children().hasClass("sapMBtnIconFirst")){this.$().children().removeClass("sapMBtnIconFirst")}}this.$().bind(this.MOUSE_EVENTS,this._handleEvents.bind(this));document.getElementById(this.getId()).setAttribute("aria-haspopup","dialog")};o.prototype._handleEvents=function(e){var t=sap.ui.require("sap/suite/ui/commons/ProcessFlow");if(!t){return}switch(e.type){case t._mouseEvents.mouseEnter:this.$().find("*").addClass(this.HOVER_CSS_CLASS);break;case t._mouseEvents.mouseDown:this.$().find("*").removeClass(this.HOVER_CSS_CLASS);this.$().find("*").addClass(this.ACTIVE_CSS_CLASS);break;case t._mouseEvents.mouseUp:this.$().find("*").removeClass(this.ACTIVE_CSS_CLASS);this.$().find("*").addClass(this.HOVER_CSS_CLASS);break;case t._mouseEvents.mouseLeave:this.$().find("*").removeClass(this.ACTIVE_CSS_CLASS);this.$().find("*").removeClass(this.HOVER_CSS_CLASS);break;default:}};o.prototype._getNavigationFocus=function(){return this._bNavigationFocus};o.prototype._setNavigationFocus=function(e){this._bNavigationFocus=e};o.prototype._setSelected=function(e){this._bSelected=e};o.prototype._getSelected=function(){return this._bSelected};o.prototype._setHighlighted=function(e){this._bHighlighted=e};o.prototype._getHighlighted=function(){return this._bHighlighted};o.prototype._setDimmed=function(e){this._bDimmed=e};o.prototype._getDimmed=function(){return this._bDimmed};o.prototype.setWidth=function(){return this};o.prototype.setIconFirst=function(){return this};o.prototype._setLabelWidth=function(){if(this.getIcon()){if(this.getText()){this.setProperty("width","4.5rem",false)}else{this.setProperty("width","2rem",false)}}else if(this.getText()&&this.getText().length>2){this.setProperty("width","4.5rem",false)}else{this.setProperty("width","2rem",false)}};o.prototype._configureStateClasses=function(){switch(this.getState()){case t.ProcessFlowConnectionLabelState.Positive:this.addStyleClass("sapSuiteUiCommonsLabelStatePositive");break;case t.ProcessFlowConnectionLabelState.Critical:this.addStyleClass("sapSuiteUiCommonsLabelStateCritical");break;case t.ProcessFlowConnectionLabelState.Negative:this.addStyleClass("sapSuiteUiCommonsLabelStateNegative");break;default:this.addStyleClass("sapSuiteUiCommonsLabelStateNeutral")}if(this._getDimmed()&&this.getEnabled()){this.addStyleClass("sapSuiteUiCommonsLabelDimmed")}else{this.removeStyleClass("sapSuiteUiCommonsLabelDimmed")}if(this._getSelected()){this.addStyleClass("sapSuiteUiCommonsLabelSelected")}else{this.removeStyleClass("sapSuiteUiCommonsLabelSelected")}if(this._getHighlighted()){this.addStyleClass("sapSuiteUiCommonsLabelHighlighted")}else{this.removeStyleClass("sapSuiteUiCommonsLabelHighlighted")}};o.prototype._setAriaDetails=function(){var e=new s;e.setText(this._oResBundle.getText("PF_CONNECTIONLABEL"));e.toStatic();if(this.getAriaLabelledBy().length===0){this.addAriaLabelledBy(e)}};return o});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowConnectionLabelRenderer", ["sap/m/ButtonRenderer","sap/ui/core/Renderer"],function(e,r){"use strict";var n=r.extend(e);n.apiVersion=2;return n},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowConnectionRenderer", ["./library"],function(e){"use strict";var o={apiVersion:2};o.render=function(e,o){var s=o._traverseConnectionData();var t=o.getZoomLevel();e.openStart("div");e.attr("id",o.getId());e.attr("role","presentation");e.attr("aria-label",o._getAriaText(s));e.openEnd();if(o._isHorizontalLine(s)){this._writeHorizontalLine(e,s,t,o)}else if(o._isVerticalLine(s)){this._writeVerticalLine(e,s,t,o._getShowLabels())}else{this._writeSpecialLine(e,s,t,o)}e.close("div")};o._writeVerticalLine=function(s,t,i,a){s.openStart("div");s.class("sapSuiteUiCommonsFloatLeft");if(a){s.class("sapSuiteUiCommonsPFWithLabel")}switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxZoom1Width");s.class("sapSuiteUiCommonsBoxWideZoom1Height");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxZoom3Width");s.class("sapSuiteUiCommonsBoxWideZoom3Height");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxZoom4Width");s.class("sapSuiteUiCommonsBoxWideZoom4Height");break;default:s.class("sapSuiteUiCommonsBoxZoom2Width");s.class("sapSuiteUiCommonsBoxWideZoom2Height")}s.openEnd();s.close("div");s.openStart("div");s.class("sapSuiteUiCommonsFloatLeft");s.class("sapSuiteUiCommonsBoxMiddleBorderWidth");switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxWideZoom1Height");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxWideZoom3Height");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxWideZoom4Height");break;default:s.class("sapSuiteUiCommonsBoxWideZoom2Height")}s.class("sapSuiteUiCommonsBorderLeft");if(t.top.type===e.ProcessFlowConnectionType.Planned){s.class("sapSuiteUiCommonsBorderLeftTypePlanned")}else{s.class("sapSuiteUiCommonsBorderLeftTypeNormal")}if(t.top.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderLeftStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.top.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderLeftStateDimmed")}else if(t.top.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderLeftStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else{s.class("sapSuiteUiCommonsBorderLeftStateRegular");s.class("sapSuiteUiCommonsStateRegular")}s.openEnd();s.close("div");o._resetFloat(s)};o._writeHorizontalLine=function(s,t,i,a){s.openStart("div");s.class("sapSuiteUiCommonsBoxWideWidth");switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxTopZoom1Height");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxTopZoom3Height");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxTopZoom4Height");break;default:s.class("sapSuiteUiCommonsBoxTopZoom2Height")}s.openEnd();s.close("div");s.openStart("div");if(t.arrow){s.class("sapSuiteUiCommonsParentPosition");if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxWideArrowZoom1Width");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxWideArrowZoom3Width");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxWideArrowZoom4Width");break;default:s.class("sapSuiteUiCommonsBoxWideArrowZoom2Width")}}else{s.class("sapSuiteUiCommonsBoxWideWidth")}s.class("sapSuiteUiCommonsBoxMiddleBorderHeight");s.class("sapSuiteUiCommonsBorderBottom");if(t.right.type===e.ProcessFlowConnectionType.Planned){s.class("sapSuiteUiCommonsBorderBottomTypePlanned")}else{s.class("sapSuiteUiCommonsBorderBottomTypeNormal")}if(t.right.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderBottomStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.right.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderBottomStateDimmed")}else if(t.right.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderBottomStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else{s.class("sapSuiteUiCommonsBorderBottomStateRegular");s.class("sapSuiteUiCommonsStateRegular")}s.openEnd();if(t.labels&&a._showLabels){o._renderLabel(s,a,t)}if(t.arrow){s.openStart("div");s.class("sapSuiteUiCommonsArrowRight");if(t.right.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderLeftStateHighlighted")}else if(t.right.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderLeftStateDimmed")}else if(t.right.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderLeftStateSelected")}else{s.class("sapSuiteUiCommonsBorderLeftStateRegular")}s.openEnd();s.close("div")}s.close("div")};o._writeSpecialLine=function(e,s,t,i){o._writeFirstRowOfSpecialLine(e,s,t,i);o._writeSecondRowOfSpecialLine(e,s,t,i);o._writeThirdRowOfSpecialLine(e,s,t,i);o._resetFloat(e)};o._writeFirstRowOfSpecialLine=function(o,s,t,i){o.openStart("div");o.class("sapSuiteUiCommonsFloatLeft");if(i._getShowLabels()){o.class("sapSuiteUiCommonsPFWithLabel")}switch(t){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsBoxZoom1Width");o.class("sapSuiteUiCommonsBoxTopZoom1Height");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsBoxZoom3Width");o.class("sapSuiteUiCommonsBoxTopZoom3Height");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsBoxZoom4Width");o.class("sapSuiteUiCommonsBoxTopZoom4Height");break;default:o.class("sapSuiteUiCommonsBoxZoom2Width");o.class("sapSuiteUiCommonsBoxTopZoom2Height")}o.openEnd();o.close("div");o.openStart("div");if(i._getShowLabels()){o.class("sapSuiteUiCommonsPFWithLabel")}o.class("sapSuiteUiCommonsFloatLeft");switch(t){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsBoxTopZoom1Height");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsBoxTopZoom3Height");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsBoxTopZoom4Height");break;default:o.class("sapSuiteUiCommonsBoxTopZoom2Height")}if(s.hasOwnProperty("top")&&s.top.draw){o.class("sapSuiteUiCommonsBoxMiddleBorderWidth");o.class("sapSuiteUiCommonsBorderLeft");if(s.top.type===e.ProcessFlowConnectionType.Planned){o.class("sapSuiteUiCommonsBorderLeftTypePlanned")}else{o.class("sapSuiteUiCommonsBorderLeftTypeNormal")}if(s.top.state===e.ProcessFlowConnectionState.Highlighted){o.class("sapSuiteUiCommonsBorderLeftStateHighlighted");o.class("sapSuiteUiCommonsStateHighlighted")}else if(s.top.state===e.ProcessFlowConnectionState.Dimmed){o.class("sapSuiteUiCommonsBorderLeftStateDimmed")}else if(s.top.state===e.ProcessFlowConnectionState.Selected){o.class("sapSuiteUiCommonsBorderLeftStateSelected");o.class("sapSuiteUiCommonsStateSelected")}else{o.class("sapSuiteUiCommonsBorderLeftStateRegular");o.class("sapSuiteUiCommonsStateRegular")}}else{o.class("sapSuiteUiCommonsBoxMiddleWidth")}o.openEnd();o.close("div")};o._writeSecondRowOfSpecialLine=function(s,t,i,a){o._resetFloat(s);s.openStart("div");s.class("sapSuiteUiCommonsFloatLeft");if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxZoom1Width");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxZoom3Width");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxZoom4Width");break;default:s.class("sapSuiteUiCommonsBoxZoom2Width")}if(t.hasOwnProperty("left")&&t.left.draw){s.class("sapSuiteUiCommonsBoxMiddleBorderHeight");s.class("sapSuiteUiCommonsBorderBottom");if(t.left.type===e.ProcessFlowConnectionType.Planned){s.class("sapSuiteUiCommonsBorderBottomTypePlanned")}else{s.class("sapSuiteUiCommonsBorderBottomTypeNormal")}if(t.left.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderBottomStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.left.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderBottomStateDimmed")}else if(t.left.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderBottomStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else{s.class("sapSuiteUiCommonsBorderBottomStateRegular");s.class("sapSuiteUiCommonsStateRegular")}}else{s.class("sapSuiteUiCommonsBoxMiddleHeight")}s.openEnd();s.close("div");s.openStart("div");s.class("sapSuiteUiCommonsFloatLeft");if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}s.class("sapSuiteUiCommonsBoxMiddleWidth");s.class("sapSuiteUiCommonsBoxMiddleBorderHeight");if(t.hasOwnProperty("left")&&t.left.draw||t.hasOwnProperty("right")&&t.right.draw||t.hasOwnProperty("top")&&t.top.draw||t.hasOwnProperty("bottom")&&t.bottom.draw){s.class("sapSuiteUiCommonsBorderBottom");s.class("sapSuiteUiCommonsBorderBottomTypeNormal");if(t.right.state===e.ProcessFlowConnectionState.Highlighted||t.top.state===e.ProcessFlowConnectionState.Highlighted||t.left.state===e.ProcessFlowConnectionState.Highlighted||t.bottom.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderBottomStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.right.state===e.ProcessFlowConnectionState.Selected||t.top.state===e.ProcessFlowConnectionState.Selected||t.left.state===e.ProcessFlowConnectionState.Selected||t.bottom.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderBottomStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else if(t.right.state===e.ProcessFlowConnectionState.Dimmed||t.top.state===e.ProcessFlowConnectionState.Dimmed||t.left.state===e.ProcessFlowConnectionState.Dimmed||t.bottom.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderBottomStateDimmed")}else{s.class("sapSuiteUiCommonsBorderBottomStateRegular");s.class("sapSuiteUiCommonsStateRegular")}}s.openEnd();s.close("div");s.openStart("div");if(a._getShowLabels()&&t.arrow||!a._getShowLabels()){s.class("sapSuiteUiCommonsFloatLeft")}if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}if(t.arrow){s.class("sapSuiteUiCommonsParentPosition");switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxArrowZoom1Width");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxArrowZoom3Width");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxArrowZoom4Width");break;default:s.class("sapSuiteUiCommonsBoxArrowZoom2Width")}}else if(a._getShowLabels()){switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxZoom1WidthWithLabel");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxZoom3WidthWithLabel");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxZoom4WidthWithLabel");break;default:s.class("sapSuiteUiCommonsBoxZoom2WidthWithLabel")}}else{switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxZoom1Width");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxZoom3Width");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxZoom4Width");break;default:s.class("sapSuiteUiCommonsBoxZoom2Width")}}if(t.hasOwnProperty("right")&&t.right.draw){s.class("sapSuiteUiCommonsBoxMiddleBorderHeight");s.class("sapSuiteUiCommonsBorderBottom");if(t.right.type===e.ProcessFlowConnectionType.Planned){s.class("sapSuiteUiCommonsBorderBottomTypePlanned")}else{s.class("sapSuiteUiCommonsBorderBottomTypeNormal")}if(t.right.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderBottomStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.right.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderBottomStateDimmed")}else if(t.right.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderBottomStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else{s.class("sapSuiteUiCommonsBorderBottomStateRegular");s.class("sapSuiteUiCommonsStateRegular")}}else{s.class("sapSuiteUiCommonsBoxMiddleHeight")}s.openEnd();if(t.labels&&a._showLabels){o._renderLabel(s,a,t)}if(t.arrow){s.openStart("div");s.class("sapSuiteUiCommonsArrowRight");if(t.hasOwnProperty("right")){if(t.right.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderLeftStateHighlighted")}else if(t.right.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderLeftStateDimmed")}else if(t.right.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderLeftStateSelected")}else{s.class("sapSuiteUiCommonsBorderLeftStateRegular")}}s.openEnd();s.close("div")}s.close("div")};o._writeThirdRowOfSpecialLine=function(s,t,i,a){o._resetFloat(s);s.openStart("div");s.class("sapSuiteUiCommonsFloatLeft");if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxZoom1Width");s.class("sapSuiteUiCommonsBoxBottomZoom1Height");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxZoom3Width");s.class("sapSuiteUiCommonsBoxBottomZoom3Height");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxZoom4Width");s.class("sapSuiteUiCommonsBoxBottomZoom4Height");break;default:s.class("sapSuiteUiCommonsBoxZoom2Width");s.class("sapSuiteUiCommonsBoxBottomZoom2Height")}s.openEnd();s.close("div");s.openStart("div");if(a._getShowLabels()){s.class("sapSuiteUiCommonsPFWithLabel")}s.class("sapSuiteUiCommonsFloatLeft");switch(i){case e.ProcessFlowZoomLevel.One:s.class("sapSuiteUiCommonsBoxBottomZoom1Height");break;case e.ProcessFlowZoomLevel.Three:s.class("sapSuiteUiCommonsBoxBottomZoom3Height");break;case e.ProcessFlowZoomLevel.Four:s.class("sapSuiteUiCommonsBoxBottomZoom4Height");break;default:s.class("sapSuiteUiCommonsBoxBottomZoom2Height")}if(t.hasOwnProperty("bottom")&&t.bottom.draw){s.class("sapSuiteUiCommonsBoxMiddleBorderWidth");s.class("sapSuiteUiCommonsBorderLeft");if(t.bottom.type===e.ProcessFlowConnectionType.Planned){s.class("sapSuiteUiCommonsBorderLeftTypePlanned")}else{s.class("sapSuiteUiCommonsBorderLeftTypeNormal")}if(t.bottom.state===e.ProcessFlowConnectionState.Highlighted){s.class("sapSuiteUiCommonsBorderLeftStateHighlighted");s.class("sapSuiteUiCommonsStateHighlighted")}else if(t.bottom.state===e.ProcessFlowConnectionState.Dimmed){s.class("sapSuiteUiCommonsBorderLeftStateDimmed")}else if(t.bottom.state===e.ProcessFlowConnectionState.Selected){s.class("sapSuiteUiCommonsBorderLeftStateSelected");s.class("sapSuiteUiCommonsStateSelected")}else{s.class("sapSuiteUiCommonsBorderLeftStateRegular");s.class("sapSuiteUiCommonsStateRegular")}}else{s.class("sapSuiteUiCommonsBoxMiddleWidth")}s.openEnd();s.close("div")};o._resetFloat=function(e){e.openStart("div");e.class("sapSuiteUiCommonsFloatClear");e.openEnd();e.close("div")};o._renderLabel=function(e,o){var s=o._getVisibleLabel();if(o.getAggregation("_labels")){var t=o.getAggregation("_labels");for(var i=0;i<t.length;i++){if(t[i]._getSelected()){s._setDimmed(false);if(t[i].getId()!==s.getId()){s._setSelected(true);t[i]._setSelected(false)}}}}if(s){e.renderControl(s)}};return o},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowLaneHeader", ["sap/ui/thirdparty/jquery","sap/m/Image","./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/Icon","./ProcessFlowLaneHeaderRenderer"],function(jQuery,e,t,o,s,r,i,n){"use strict";var a=o.extend("sap.suite.ui.commons.ProcessFlowLaneHeader",{metadata:{library:"sap.suite.ui.commons",properties:{text:{type:"string",group:"Misc",defaultValue:null},iconSrc:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},position:{type:"int",group:"Misc",defaultValue:null},laneId:{type:"string",group:"Misc",defaultValue:null},state:{type:"object",group:"Misc",defaultValue:null},zoomLevel:{type:"sap.suite.ui.commons.ProcessFlowZoomLevel",group:"Misc",defaultValue:null}},events:{press:{parameters:{oEvent:{type:"object"}}}}}});a.prototype._oResBundle=null;a.prototype._mergedLanePosition=null;a.symbolType={startSymbol:"startSymbol",endSymbol:"endSymbol",processSymbol:"processSymbol",standardType:"standardType"};a._constants={halfGapSize:.0241,minPercentage:.025,ringThickness:5,ringInnerRadius:23,positionX:32,positionY:32,outerCircleRadius:31,outerCircleStrokeColor:"OuterCircleStrikeColor",outerCircleStrokeWidth:1,sectorPositiveColor:"suiteUiCommonsProcessFlowHeaderPositiveColor",sectorNegativeColor:"suiteUiCommonsProcessFlowHeaderNegativeColor",sectorNeutralColor:"suiteUiCommonsProcessFlowHeaderNeutralColor",sectorCriticalColor:"suiteUiCommonsProcessFlowHeaderCriticalColor",sectorPlannedColor:"suiteUiCommonsProcessFlowHeaderPlannedColor",ellipsis:"...",ellipsisLength:3};a.prototype.init=function(){this._virtualTableSpan=1;if(!this._oResBundle){this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}};a.prototype.exit=function(){this._destroyImage();this.$().off("click",this.ontouchend)};a.prototype.onBeforeRendering=function(){this.$("lh-icon").off("click",jQuery.proxy(this.ontouchend,this));this.$().off("click",this.ontouchend)};a.prototype.onAfterRendering=function(){var e=this.$();var t=this.$("lh-icon");var o="click";if(r.support.touch){o="touchend"}if(t.length>0){t.on(o,jQuery.proxy(this.ontouchend,this));t.css("cursor","inherit")}this.$().on("click",jQuery.proxy(this.ontouchend,this));if(this._isHeaderMode()){e.addClass("suiteUiProcessFlowLaneHeaderPointer")}else{e.removeClass("suiteUiProcessFlowLaneHeaderPointer")}if(r.browser.mozilla){this.$("lh-text").css("word-break","break-all")}if(!this._ellipsisDisabled&&!a._hasNativeLineClamp){this._clampText()}};a.prototype.ontouchend=function(e){if(e&&!e.isDefaultPrevented()){e.preventDefault()}if(this){this.firePress(this)}if(e&&!e.isPropagationStopped()){e.stopPropagation()}if(e&&!e.isImmediatePropagationStopped()){e.stopImmediatePropagation()}};a.prototype._setMergedPosition=function(e){this._mergedLanePosition=e};a.prototype._getSymbolType=function(){return this._oSymbolType?this._oSymbolType:a.symbolType.standardType};a.prototype._setSymbolType=function(e,t){t._oSymbolType=e};a.prototype._getImage=function(t,o){this._destroyImage();if(this._oImageControl){this._oImageControl.setSrc(o)}else{this._oImageControl=s.createControlByURI(o,e);this._oImageControl.sId=t;this._oImageControl.setParent(this,null,true)}if(this._oImageControl instanceof i){this._oImageControl.setUseIconTooltip(false)}return this._oImageControl};a.prototype._setHeaderMode=function(e){this._bHeaderMode=e};a._setVirtualTableSpan=function(e){this._virtualTableSpan=e};a._getVirtualTableSpan=function(){return this._virtualTableSpan};a.prototype._isHeaderMode=function(){return this._bHeaderMode};a.prototype._clampValues=function(e,t,o){var s=e.length-1,r=false,i;while(s>=0){i=e[s];if(i<t){e[s]=o;r=true}s--}return r};a.prototype._rescaleToUnit=function(e,t){var o,s,r,i,n,a;if(!t){t=0}s=e.length-1;o=0;r=i=0;while(s>=0){n=e[s];if(n>0){if(n<=t){i++}else{o+=e[s]}r++}s--}o-=(r-i)*t;a=(1-r*t)/o;s=e.length-1;while(s>=0){n=e[s];if(n>0){if(n<=t){e[s]=t}else{e[s]=(n-t)*a+t}}s--}};a.prototype._countGaps=function(e){var t=e.length-1,o=0;while(t>=0){if(e[t]>0){o++}t--}if(o===1){o=0}return o};a.prototype._rescaleByFactor=function(e,t){var o=e.length-1;while(o>=0){e[o]*=t;o--}};a.prototype._colorMap=[a._constants.sectorPositiveColor,a._constants.sectorNegativeColor,a._constants.sectorNeutralColor,a._constants.sectorPlannedColor,a._constants.sectorCriticalColor];a.prototype._calculateSectorRangeDefinitions=function(e,t){var o=[],s=-Math.PI/2,r,i=e.length,n=0;while(n<i){if(e[n]>0){r=s+2*Math.PI*e[n];o.push({start:s,end:r,color:this._colorMap[n]});s=r+t}n++}return o};a.prototype._renderDonutPercentages=function(e){var o=this.getState(),s=0,r,i=[0,0,0,0],n,l,c=a._constants.halfGapSize,u=a._constants.ringInnerRadius,p=a._constants.ringThickness,d=a._constants.ringInnerRadius+p,h=a._constants.outerCircleStrokeColor,_=a._constants.outerCircleStrokeWidth,y=a._constants.outerCircleRadius,f=a._constants.positionX,g=a._constants.positionY,m=a._constants.minPercentage;if(o&&Object.prototype.toString.call(o)==="[object Array]"&&o.length>0){o.forEach(function(e){switch(e.state){case t.ProcessFlowNodeState.Positive:i[0]=e.value;break;case t.ProcessFlowNodeState.Negative:i[1]=e.value;break;case t.ProcessFlowNodeState.Neutral:i[2]=e.value;break;case t.ProcessFlowNodeState.Planned:i[3]=e.value;break;case t.ProcessFlowNodeState.Critical:i[4]=e.value;break;default:i[3]=e.value}});this._clampValues(i,0,0);this._rescaleToUnit(i);this._rescaleToUnit(i,m);s=this._countGaps(i);n=1-s*c/Math.PI;this._rescaleByFactor(i,n);this._renderCircle(e,h,_,f,g,y);if(s>0){r=this._calculateSectorRangeDefinitions(i,2*c);this._renderDonutSectors(e,r,f,g,u,d)}else{l=this._selectColor(i);this._renderCircle(e,l,p,f,g,u+p/2,true)}}else{this._renderCircle(e,h,_,f,g,y)}};a.prototype._renderCircle=function(e,t,o,s,r,i,n){e.openStart("circle");var l=n?this.getId()+"-donut-circle-inner":this.getId()+"-donut-circle";e.attr("id",l);if(t!==a._constants.outerCircleStrokeColor){e.class("suiteUiCommonsProcessFlowHeaderIconFill").class(t)}else{e.class("suiteUiCommonsProcessFlowHeaderIconFill")}e.attr("stroke-width",o);e.attr("cx",s);e.attr("cy",r);e.attr("r",i);e.openEnd().close("circle")};a.prototype._renderDonutSectors=function(e,t,o,s,r,i){var n=0,a=t.length,l,c;while(n<a){l=t[n];c=this._getDonutSectorPath(o,s,l.start,l.end,r,i);e.openStart("path");e.attr("id",this.getId()+"-donut-segment-"+n);e.attr("d",c);e.attr("class",l.color);e.attr("opacity","1");e.openEnd().close("path");n++}};a.prototype._selectColor=function(e){var t;if(e[0]){t=a._constants.sectorPositiveColor}else if(e[1]){t=a._constants.sectorNegativeColor}else if(e[2]){t=a._constants.sectorNeutralColor}else if(e[3]){t=a._constants.sectorPlannedColor}else if(e[4]){t=a._constants.sectorCriticalColor}else{t=a._constants.sectorNeutralColor}return t};a.prototype._getDonutSectorPath=function(e,t,o,s,r,i){var n=0,a,l,c,u,p,d,h,_,y;if((s-o)%(Math.PI*2)>Math.PI){n=1}d=Math.cos(o);h=Math.cos(s);_=Math.sin(o);y=Math.sin(s);a=(e+r*d).toFixed(3)+","+(t+r*_).toFixed(3);l=(e+i*d).toFixed(3)+","+(t+i*_).toFixed(3);c=(e+i*h).toFixed(3)+","+(t+i*y).toFixed(3);u=(e+r*h).toFixed(3)+","+(t+r*y).toFixed(3);p="M"+a+"L"+l+"A"+i+","+i+" 0 "+n+" 1 "+c+"L"+u+"A"+r+","+r+" 0 "+n+" 0 "+a+"z";return p};a.prototype._destroyImage=function(){if(this._oImageControl){this._oImageControl.destroy()}this._oImageControl=null};a.prototype._clampText=function(){var e=this.$("lh-text").length?this.$("lh-text"):null,t=this.getText(),o="",s=a._constants.ellipsis,r=a._constants.ellipsisLength,i=r+1,n,l=t.length,c,u;if(e){c=parseInt(e.css("height").slice(0,-2),10);if(e[0].scrollHeight>c){u=e.css("visibility");e.css("visibility","hidden");o=t;do{n=i+l>>1;e.textContent=t.slice(0,n-r)+s;if(e.scrollHeight>c){l=n}else{i=n;o=e.textContent}}while(l-i>1);e.css("visibility",u)}if(e.scrollHeight>c){e.textContent=o}}};a._hasNativeLineClamp=function(){return document.documentElement.style.webkitLineClamp!==undefined}();a.prototype._getAriaTextForStatusValue=function(e){switch(e){case t.ProcessFlowNodeState.Positive:return this._oResBundle.getText("PF_ARIA_STATUS_POSITIVE");case t.ProcessFlowNodeState.Negative:return this._oResBundle.getText("PF_ARIA_STATUS_NEGATIVE");case t.ProcessFlowNodeState.Critical:return this._oResBundle.getText("PF_ARIA_STATUS_CRITICAL");case t.ProcessFlowNodeState.Planned:return this._oResBundle.getText("PF_ARIA_STATUS_PLANNED");case t.ProcessFlowNodeState.PlannedNegative:return this._oResBundle.getText("PF_ARIA_STATUS_PLNNEGATIVE");case t.ProcessFlowNodeState.Neutral:default:return this._oResBundle.getText("PF_ARIA_STATUS_NEUTRAL")}};a.prototype._getAriaText=function(){var e=this.getText();var t=this.getState();if(t){var o=[];for(var s in t){o.push(t[s].value)}this._clampValues(o,0,0);this._rescaleToUnit(o);var r=this._oResBundle.getText("PF_ARIA_STATUS");var i=false;for(var n in t){if(t[n].value!==0){var a=this._getAriaTextForStatusValue(t[n].state);var l=" "+Math.round(o[n]*100)+"% "+a+",";r=r.concat(l);i=true}}if(i){if(e==""){e=r.slice(0,-1)}else{e=e+", "+r.slice(0,-1)}}}return e};a.prototype._getSymbolAriaText=function(){var e="";switch(this._getSymbolType()){case a.symbolType.startSymbol:e=this._oResBundle.getText("PF_ARIA_SYMBOL_LANE_START");break;case a.symbolType.endSymbol:e=this._oResBundle.getText("PF_ARIA_SYMBOL_LANE_END");break;case a.symbolType.processSymbol:e=this._oResBundle.getText("PF_ARIA_SYMBOL_LANE_PROCESS");break;default:}return e};a.createNewStartSymbol=function(e){var t=new a({laneId:"processFlowLaneStart"});t._setSymbolType(a.symbolType.startSymbol,t);t._setHeaderMode(e);return t};a.createNewEndSymbol=function(e){var t=new a({laneId:"processFlowLaneEnd"});t._setSymbolType(a.symbolType.endSymbol,t);t._setHeaderMode(e);return t};a.createNewProcessSymbol=function(e){var t=new a({laneId:"processFlowLaneProcess",iconSrc:"sap-icon://process"});t._setSymbolType(a.symbolType.processSymbol,t);t._setHeaderMode(e);return t};a.enableEllipsisSupportForText=function(e){this._ellipsisDisabled=!e};a.prototype.getPosition=function(){if(this._mergedLanePosition){return this._mergedLanePosition}else{return this.getProperty("position")}};return a});
/*
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowLaneHeaderRenderer", ["sap/base/security/encodeXML"],function(e){"use strict";var t;var o={apiVersion:2};o.render=function(e,o){t=t||sap.ui.require("sap/suite/ui/commons/ProcessFlowLaneHeader");switch(o._getSymbolType()){case t.symbolType.startSymbol:this._writeSymbolNodeType(e,o,"-start",["suiteUiProcessFlowLaneHeaderStartEndSymbol","suiteUiProcessFlowLaneHeaderStartSymbol"],["suiteUiProcessFlowLaneHeaderStartEndSymbolContainer","suiteUiProcessFlowLaneHeaderNoSelection"],false,o._isHeaderMode());break;case t.symbolType.endSymbol:this._writeSymbolNodeType(e,o,"-end",["suiteUiProcessFlowLaneHeaderStartEndSymbol","suiteUiProcessFlowLaneHeaderEndSymbol"],["suiteUiProcessFlowLaneHeaderStartEndSymbolContainer","suiteUiProcessFlowLaneHeaderNoSelection"],false,o._isHeaderMode());break;case t.symbolType.processSymbol:this._writeSymbolNodeType(e,o,"-process",["suiteUiProcessFlowLaneHeaderProcessSymbol"],["suiteUiProcessFlowLaneHeaderProcessSymbolContainer","suiteUiProcessFlowLaneHeaderNoSelection"],true,o._isHeaderMode());break;default:this._writeDefaultNodeType(e,o)}};o._writeSymbolNodeType=function(t,o,a,r,s,i){t.openStart("div",o);s.forEach(function(o){t.class(e(o))});t.attr("role","separator");t.attr("aria-label",o._getSymbolAriaText());t.openEnd();t.openStart("div");t.attr("id",o.getId()+a);r.forEach(function(o){t.class(e(o))});t.openEnd();if(i){var n=o.getIconSrc();if(n){var d=o._getImage(o.getId()+"-lh-icon",n);t.renderControl(d)}}t.close("div");t.close("div")};o._writeDefaultNodeType=function(e,t){e.openStart("div",t);e.class("suiteUiProcessFlowLaneHeaderContainer");e.class("suiteUiProcessFlowLaneHeaderNoSelection");e.openEnd();e.openStart("div");e.attr("id",t.getId()+"-standard");e.attr("role","img");var o=t._getAriaText();e.attr("aria-label",o);var a=t.getTooltip()?t.getTooltip():o;e.attr("title",a);e.class("suiteUiProcessFlowLaneHeaderBodyContainer");e.openEnd();e.openStart("div");e.attr("id",t.getId()+"-horizontal-line");e.class("suiteUiProcessFlowLaneHeaderHorizontalLine");e.openEnd().close("div");e.openStart("svg");e.attr("id",t.getId()+"-donut-chart");e.class("suiteUiProcessFlowLaneHeaderDonutSvg");e.openEnd();t._renderDonutPercentages(e);e.close("svg");e.openStart("div");e.attr("id",t.getId()+"-lh-icon-container");e.class("suiteUiProcessFlowLaneHeaderIconContainer");e.openEnd();var r=t.getIconSrc();if(r){var s=t._getImage(t.getId()+"-lh-icon",r);s.addStyleClass("suiteUiProcessFlowLaneHeaderProcessSymbolIcon");e.renderControl(s)}e.close("div");e.close("div");e.openStart("div");e.attr("id",t.getId()+"-lh-text-container");e.class("suiteUiProcessFlowLaneHeaderTextContainer");e.openEnd();e.openStart("span");e.attr("id",t.getId()+"-lh-text");e.class("suiteUiProcessFlowLaneHeaderText");e.attr("aria-hidden",true);e.openEnd();e.text(t.getText());e.close("span");e.close("div");e.close("div")};return o},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowNode", ["sap/ui/thirdparty/jquery","sap/m/Text","./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/Icon","sap/base/Log","./ProcessFlowNodeRenderer"],function(jQuery,e,s,o,t,a,l,r,i){"use strict";var d=o.extend("sap.suite.ui.commons.ProcessFlowNode",{metadata:{library:"sap.suite.ui.commons",properties:{title:{type:"string",group:"Misc",defaultValue:null},isTitleClickable:{type:"boolean",group:"Behavior",defaultValue:false,deprecated:true},laneId:{type:"string",group:"Misc",defaultValue:null},nodeId:{type:"string",group:"Misc",defaultValue:null},state:{type:"sap.suite.ui.commons.ProcessFlowNodeState",group:"Appearance",defaultValue:"Neutral"},type:{type:"sap.suite.ui.commons.ProcessFlowNodeType",group:"Appearance",defaultValue:"Single"},children:{type:"any[]",group:"Misc",defaultValue:null},titleAbbreviation:{type:"string",group:"Data",defaultValue:null},stateText:{type:"string",group:"Data",defaultValue:null},texts:{type:"string[]",group:"Misc",defaultValue:null},highlighted:{type:"boolean",group:"Appearance",defaultValue:false},focused:{type:"boolean",group:"Appearance",defaultValue:false},tag:{type:"object",group:"Misc",defaultValue:null},selected:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{zoomLevelOneContent:{type:"sap.ui.core.Control",multiple:false,group:"Misc"},zoomLevelTwoContent:{type:"sap.ui.core.Control",multiple:false,group:"Misc"},zoomLevelThreeContent:{type:"sap.ui.core.Control",multiple:false,group:"Misc"},zoomLevelFourContent:{type:"sap.ui.core.Control",multiple:false,group:"Misc"},ariaProperties:{type:"sap.suite.ui.commons.AriaProperties",multiple:false,group:"Misc"}},associations:{parents:{type:"sap.suite.ui.commons.ProcessFlowNode",multiple:true,singularName:"parent"}},events:{titlePress:{deprecated:true,parameters:{oEvent:{type:"object"}}},press:{parameters:{oEvent:{type:"object"}}}}}});d.prototype._zoomLevel=s.ProcessFlowZoomLevel.Two;d.prototype._tag=null;d.prototype._displayState=s.ProcessFlowDisplayState.Regular;d.prototype._oResBundle=null;d.prototype._mergedLaneId=null;d.prototype._foldedCorner=false;d.prototype._foldedCornerControl=null;d.prototype._parent=null;d.prototype._headerControl=null;d.prototype._stateTextControl=null;d.prototype._iconControl=null;d.prototype._text1Control=null;d.prototype._text2Control=null;d.prototype._navigationFocus=false;d.prototype._sMouseEvents=" mousedown mouseup mouseenter mouseleave ";d.prototype._sMouseTouchEvents=a.support.touch?"saptouchstart saptouchcancel touchstart touchend":"";d.prototype._grabCursorClass="sapSuiteUiGrabCursorPF";d.prototype._grabbingCursorClass="sapSuiteUiGrabbingCursorPF";d.prototype._nodeHoverClass="sapSuiteUiCommonsProcessFlowNodeHover";d.prototype._nodeActiveClass="sapSuiteUiCommonsProcessFlowNodeActive";d.prototype._nodePlannedClass="sapSuiteUiCommonsProcessFlowNodeStatePlanned";d.prototype._nodePlannedClassIdentifier="."+d.prototype._nodePlannedClass;d.prototype._nodeFCHoverClass="sapSuiteUiCommonsProcessFlowFoldedCornerNodeHover";d.prototype._nodeFCActiveClass="sapSuiteUiCommonsProcessFlowFoldedCornerNodeActive";d.prototype._nodeFCIconHoverClass="sapSuiteUiCommonsProcessFlowFoldedCornerNodeIconHover";d.prototype._nodeAggregatedClass="sapSuiteUiCommonsProcessFlowNodeAggregated";d.prototype._nodeAggregatedHoveredClass="sapSuiteUiCommonsProcessFlowNodeAggregatedHovered";d.prototype._nodeAggregatedDimmedClass="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmed";d.prototype._nodeAggregatedFocusedClass="sapSuiteUiCommonsProcessFlowNodeAggregatedFocused";d.prototype._nodeAggregatedPressedClass="sapSuiteUiCommonsProcessFlowNodeAggregatedPressed";d.prototype._nodeAggregatedDimmedPressedClass="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedPressed";d.prototype._nodeAggregatedDimmedHoveredClass="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedHovered";d.prototype._nodeAggregatedClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedZoomLevel4";d.prototype._nodeAggregatedHoveredClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedHoveredZoomLevel4";d.prototype._nodeAggregatedPressedClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedPressedZoomLevel4";d.prototype._nodeAggregatedDimmedClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedZoomLevel4";d.prototype._nodeAggregatedFocusedClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedFocusedZoomLevel4";d.prototype._nodeAggregatedDimmedPressedClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedPressedZoomLevel4";d.prototype._nodeAggregatedDimmedHoveredClassZoomLevel4="sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedHoveredZoomLevel4";d.prototype.init=function(){t.addIcon("context-menu","businessSuite","PFBusinessSuiteInAppSymbols","e02b",true);if(!this._oResBundle){this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}};d.prototype.exit=function(){if(this._foldedCornerControl){this._foldedCornerControl.destroy();this._foldedCornerControl=null}if(this._headerControl){this._headerControl.destroy();this._headerControl=null}if(this._stateTextControl){this._stateTextControl.destroy();this._stateTextControl=null}if(this._iconControl){this._iconControl.destroy();this._iconControl=null}if(this._text1Control){this._text1Control.destroy();this._text1Control=null}if(this._text2Control){this._text2Control.destroy();this._text2Control=null}this.$().off(this._sMouseEvents,this._handleEvents);if(a.support.touch){this.$().off(this._sMouseTouchEvents,this._handleEvents)}};d.prototype.onBeforeRendering=function(){this.$().off(this._sMouseEvents,this._handleEvents);if(a.support.touch){this.$().off(this._sMouseTouchEvents,this._handleEvents)}};d.prototype.onAfterRendering=function(){this._sMouseEvents=this._sMouseEvents.concat(" ",this._sMouseTouchEvents);this.$().bind(this._sMouseEvents,jQuery.proxy(this._handleEvents,this))};d.prototype._handleClick=function(e){if(this._parent&&this._parent._bHighlightedMode&&this._getDisplayState()===s.ProcessFlowDisplayState.Dimmed||this._getDisplayState()===s.ProcessFlowDisplayState.DimmedFocused){r.info("Event ignored, node in dimmed state.")}else if(this._parent){this.getParent()._changeNavigationFocus(this.getParent()._getLastNavigationFocusElement(),this);if(e.target.id.indexOf("title")>=0&&this.getIsTitleClickable()){this._parent.fireNodeTitlePress(this)}else{this._parent.fireNodePress(this)}}if(e&&!e.isPropagationStopped()){e.stopPropagation()}if(e&&!e.isImmediatePropagationStopped()){e.stopImmediatePropagation()}};d.prototype.onclick=function(e){if(e&&!e.isDefaultPrevented()){e.preventDefault()}this._handleClick(e)};d.prototype._handleEvents=function(e){var o=this.$().find("*");var t=this.$().attr("id");var l=this._getFoldedCorner();var r=this.getParent();var i=o.not(".sapUiIconTitle");if(e&&!e.isDefaultPrevented()){e.preventDefault()}if(this._parent&&this._parent._bHighlightedMode&&this._getDimmed()){return}if(this.getType()===s.ProcessFlowNodeType.Aggregated){this._adjustClassesForAggregation(e)}var d=sap.ui.require("sap/suite/ui/commons/ProcessFlow");if(!d){return}function n(e){return e.replace(/([:.\[\],=@])/g,"\\$1")}switch(e.type){case d._mouseEvents.mouseDown:case"keydown":this.$().removeClass(this._nodeHoverClass).addClass(this._nodeActiveClass);o.removeClass(this._nodeHoverClass);i.addClass(this._nodeActiveClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeFCHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeFCIconHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeFCIconHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass)}break;case d._mouseEvents.mouseUp:if(r.$().hasClass(this._grabbingCursorClass)){r.$().removeClass(this._grabbingCursorClass)}this.$().removeClass(this._nodeActiveClass).addClass(this._nodeHoverClass);o.removeClass(this._nodeActiveClass).addClass(this._nodeHoverClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeHoverClass+" "+this._nodeFCActiveClass).addClass(this._nodeFCHoverClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeHoverClass+" "+this._nodeFCActiveClass).addClass(this._nodeFCIconHoverClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeHoverClass+" "+this._nodeFCActiveClass).addClass(this._nodeFCIconHoverClass)}break;case d._mouseEvents.mouseEnter:if(!r.$().hasClass(this._grabbingCursorClass)){this.$().addClass(this._nodeHoverClass);i.addClass(this._nodeHoverClass);this.$().find(this._nodePlannedClassIdentifier).find("*").addClass(this._nodePlannedClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeHoverClass).addClass(this._nodeFCHoverClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeHoverClass).addClass(this._nodeFCIconHoverClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeHoverClass).addClass(this._nodeFCIconHoverClass)}}break;case d._mouseEvents.mouseLeave:case"keyup":this.$().removeClass(this._nodeActiveClass+" "+this._nodeHoverClass);o.removeClass(this._nodeActiveClass+" "+this._nodeHoverClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeFCActiveClass+" "+this._nodeFCHoverClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeFCActiveClass+" "+this._nodeFCIconHoverClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeFCActiveClass+" "+this._nodeFCIconHoverClass)}if(!r.$().hasClass(this._grabbingCursorClass)){r.$().addClass(this._grabCursorClass)}break;case d._mouseEvents.touchStart:if(a.support.touch){this.$().addClass(this._nodeActiveClass);i.addClass(this._nodeActiveClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeActiveClass).addClass(this._nodeFCActiveClass)}}break;case d._mouseEvents.sapTouchStart:this.$().removeClass(this._nodeHoverClass).addClass(this._nodeActiveClass);o.removeClass(this._nodeHoverClass);i.addClass(this._nodeActiveClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeFCHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeFCIconHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeFCIconHoverClass+" "+this._nodeActiveClass).addClass(this._nodeFCActiveClass)}break;case d._mouseEvents.touchEnd:if(a.support.touch){this.$().removeClass(this._nodeActiveClass+" "+this._nodeHoverClass);o.removeClass(this._nodeActiveClass+" "+this._nodeHoverClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeFCActiveClass+" "+this._nodeFCHoverClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeFCActiveClass+" "+this._nodeFCIconHoverClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeFCActiveClass+" "+this._nodeFCIconHoverClass)}}this._handleClick(e);break;case d._mouseEvents.sapTouchCancel:this.$().removeClass(this._nodeActiveClass).addClass(this._nodeHoverClass);o.removeClass(this._nodeActiveClass).addClass(this._nodeHoverClass);if(l){jQuery(document.getElementById(t)).removeClass(this._nodeFCActiveClass+" "+this._nodeHoverClass).addClass(this._nodeFCHoverClass);jQuery("div[id^="+n(t)+"][id$=-corner-container]").removeClass(this._nodeFCActiveClass+" "+this._nodeHoverClass).addClass(this._nodeFCIconHoverClass);jQuery("span[id^="+n(t)+"][id$=-corner-icon]").removeClass(this._nodeFCActiveClass+" "+this._nodeHoverClass).addClass(this._nodeFCIconHoverClass)}break;default:break}};d.prototype._setMergedLaneId=function(e){this._mergedLaneId=e};d.prototype._setParentFlow=function(e){this._parent=e};d.prototype._getFoldedCornerControl=function(){if(this._foldedCornerControl){this._foldedCornerControl.destroy()}this._foldedCornerControl=new l({id:this.getId()+"-corner-icon",src:t.getIconURI("context-menu","businessSuite"),visible:true});if(this._parent&&!this._parent._bHighlightedMode||!this._getDimmed()){this._foldedCornerControl.addStyleClass("sapUiIconPointer")}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._foldedCornerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode1ZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._foldedCornerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode1ZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._foldedCornerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode1ZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._foldedCornerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode1ZoomLevel4");break;default:break}this._foldedCornerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode1");return this._foldedCornerControl};d.prototype._getHeaderControl=function(){if(this._headerControl){this._headerControl.destroy()}var o=0;var t="";var a=true;var l=this.getTitle();switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:o=3;break;case s.ProcessFlowZoomLevel.Two:o=3;break;case s.ProcessFlowZoomLevel.Three:o=2;l=this.getTitleAbbreviation();break;case s.ProcessFlowZoomLevel.Four:l="";o=0;t="0px";a=false;break;default:break}this._headerControl=new e({id:this.getId()+"-nodeid-anchor-title",text:l,visible:a,wrapping:true,wrappingType:sap.m.WrappingType.Hyphenated,width:t,maxLines:o});if(this.getIsTitleClickable()){this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TitleClickable")}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel4");break;default:break}this._headerControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3Title");return this._headerControl};d.prototype._getIconControl=function(){if(this._iconControl){this._iconControl.destroy()}var e=null;var o=true;switch(this.getState()){case s.ProcessFlowNodeState.Positive:e="sap-icon://message-success";break;case s.ProcessFlowNodeState.Negative:case s.ProcessFlowNodeState.PlannedNegative:e="sap-icon://message-error";break;case s.ProcessFlowNodeState.Planned:e=null;break;case s.ProcessFlowNodeState.Neutral:e="sap-icon://process";break;case s.ProcessFlowNodeState.Critical:e="sap-icon://message-warning";break;default:break}this._iconControl=new l({id:this.getId()+"-icon",src:e,visible:o});if(this._parent&&!this._parent._bHighlightedMode||!this._getDimmed()){this._iconControl.addStyleClass("sapUiIconPointer")}var t=sap.ui.getCore().getConfiguration().getRTL();if(t){this._iconControl.addStyleClass("sapUiIconSuppressMirrorInRTL")}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:case s.ProcessFlowZoomLevel.Two:var a="sapSuiteUiCommonsProcessFlowNode3StateIconLeft";if(t){a="sapSuiteUiCommonsProcessFlowNode3StateIconRight"}this._iconControl.addStyleClass(a);break;case s.ProcessFlowZoomLevel.Three:case s.ProcessFlowZoomLevel.Four:this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIconCenter");break;default:break}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel4");break;default:break}this._iconControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateIcon");return this._iconControl};d.prototype._getStateTextControl=function(){if(this._stateTextControl){this._stateTextControl.destroy()}var o=2;var t="";var a=true;var l=this.getState();var r=l===s.ProcessFlowNodeState.Planned?"":this.getStateText();if(l===s.ProcessFlowNodeState.PlannedNegative&&r.length===0){r="Planned Negative"}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:case s.ProcessFlowZoomLevel.Two:case s.ProcessFlowZoomLevel.Three:o=2;break;case s.ProcessFlowZoomLevel.Four:r="";o=0;t="0px";a=false;break;default:break}this._stateTextControl=new e({id:this.getId()+"-stateText",text:r,visible:a,wrapping:true,wrappingType:sap.m.WrappingType.Hyphenated,width:t,maxLines:o});switch(l){case s.ProcessFlowNodeState.Positive:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StatePositive");break;case s.ProcessFlowNodeState.Negative:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNodeStateNegative");break;case s.ProcessFlowNodeState.Planned:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StatePlanned");break;case s.ProcessFlowNodeState.Neutral:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateNeutral");break;case s.ProcessFlowNodeState.PlannedNegative:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StatePlanned");break;case s.ProcessFlowNodeState.Critical:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateCritical");break;default:break}switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel4");break;default:break}this._stateTextControl.addStyleClass("sapSuiteUiCommonsProcessFlowNode3StateText");return this._stateTextControl};d.prototype._getZoomLevel=function(){return this._zoomLevel};d.prototype._setZoomLevel=function(e){this._zoomLevel=e};d.prototype._setNavigationFocus=function(e){this._navigationFocus=e};d.prototype._getNavigationFocus=function(){return this._navigationFocus};d.prototype._setFoldedCorner=function(e){this._foldedCorner=e};d.prototype._getFoldedCorner=function(){return this._foldedCorner};d.prototype._setTag=function(e){this._tag=e};d.prototype._getTag=function(){return this._tag};d.prototype._setDimmedState=function(){var e=this.getFocused();var o=this.getHighlighted();var t=this.getSelected();if(o||t){throw new Error("Cannot set highlighed or selected node to dimmed state"+this.getNodeId())}this._displayState=s.ProcessFlowDisplayState.Dimmed;if(e){this._displayState=s.ProcessFlowDisplayState.DimmedFocused}};d.prototype._setRegularState=function(){this._displayState=s.ProcessFlowDisplayState.Regular};d.prototype._getLane=function(){var e=this.getParent();var s=null;if(e){s=e._getLane(this.getLaneId())}return s};d.prototype._getDimmed=function(){return this._displayState===s.ProcessFlowDisplayState.Dimmed||this._displayState===s.ProcessFlowDisplayState.DimmedFocused};d.prototype._getAriaText=function(){var e=this.getParents().length;var o=this._getCurrentZoomLevelContent();var t=0;if(this._hasChildren()){t=this.getChildren().length}var a="";var l=this._getLane();if(l){a=l.getText();if(!a){a=this._oResBundle.getText("PF_VALUE_UNDEFINED")}}var r="";var i=this.getTexts();if(i){for(var d in i){if(i[d]){var n=i[d].concat(", ");r=r.concat(n)}}r=r.slice(0,-1)}var C=this.getTitle();if(!C&&!o){C=this._oResBundle.getText("PF_VALUE_UNDEFINED")}var c=this.getState();if(!c){c=this._oResBundle.getText("PF_VALUE_UNDEFINED")}var m=this.getStateText();if(this.getState()===s.ProcessFlowNodeState.Planned){m=""}var p="";if(this.getType()===s.ProcessFlowNodeType.Aggregated){p=this._oResBundle.getText("PF_ARIA_TYPE")}return this._oResBundle.getText("PF_ARIA_NODE",[C,c,m,a,r,e,t,p])};d.prototype._getDisplayState=function(){var e=this.getFocused();var o=this.getHighlighted();var t=this.getSelected();if(this._displayState===s.ProcessFlowDisplayState.Dimmed||this._displayState===s.ProcessFlowDisplayState.DimmedFocused){return this._displayState}if(t){if(o){if(e){this._displayState=s.ProcessFlowDisplayState.SelectedHighlightedFocused}else{this._displayState=s.ProcessFlowDisplayState.SelectedHighlighted}}else if(e){this._displayState=s.ProcessFlowDisplayState.SelectedFocused}else{this._displayState=s.ProcessFlowDisplayState.Selected}}else if(e&&o){this._displayState=s.ProcessFlowDisplayState.HighlightedFocused}else if(e){this._displayState=s.ProcessFlowDisplayState.RegularFocused}else if(o){this._displayState=s.ProcessFlowDisplayState.Highlighted}else if(this._displayState===s.ProcessFlowDisplayState.HighlightedFocused||this._displayState===s.ProcessFlowDisplayState.RegularFocused||this._displayState===s.ProcessFlowDisplayState.Highlighted||this._displayState===s.ProcessFlowDisplayState.Selected){this._setRegularState()}return this._displayState};d.prototype._createTextControlInternal=function(o,t,a){if(a){a.destroy()}var l=2;var r="";var i=true;var d=t;switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:case s.ProcessFlowZoomLevel.Two:l=2;break;case s.ProcessFlowZoomLevel.Three:l=0;r="0px";i=false;break;case s.ProcessFlowZoomLevel.Four:d="";l=0;r="0px";i=false;break;default:break}if(this.getState){a=new e({id:this.getId()+o,text:d,visible:i,wrapping:true,wrappingType:sap.m.WrappingType.Hyphenated,width:r,maxLines:l})}return a};d.prototype._createText1Control=function(){var e=this.getTexts();if(e&&e.length>0){e=e[0]}this._text1Control=this._createTextControlInternal("-text1-control",e,this._text1Control);switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextWithGapZoomLevel1");this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextWithGapZoomLevel2");this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel4");break;default:break}this._text1Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3Text");return this._text1Control};d.prototype._createText2Control=function(){var e=this.getTexts();if(e&&e.length>1){e=e[1]}else{e=""}this._text2Control=this._createTextControlInternal("-text2-control",e,this._text2Control);switch(this._getZoomLevel()){case s.ProcessFlowZoomLevel.One:this._text2Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel1");break;case s.ProcessFlowZoomLevel.Two:this._text2Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel2");break;case s.ProcessFlowZoomLevel.Three:this._text2Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel3");break;case s.ProcessFlowZoomLevel.Four:this._text2Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel4");break;default:break}this._text2Control.addStyleClass("sapSuiteUiCommonsProcessFlowNode3Text");return this._text2Control};d.prototype._adjustClassesForAggregation=function(e){var o=[s.ProcessFlowDisplayState.RegularFocused,s.ProcessFlowDisplayState.HighlightedFocused,s.ProcessFlowDisplayState.DimmedFocused];var t=[s.ProcessFlowDisplayState.DimmedFocused,s.ProcessFlowDisplayState.Dimmed];var a=sap.ui.require("sap/suite/ui/commons/ProcessFlow");if(!a){return}switch(e.type){case a._mouseEvents.mouseDown:case a._mouseEvents.touchStart:case a._mouseEvents.sapTouchStart:l(this);break;case a._mouseEvents.mouseUp:r(this);break;case a._mouseEvents.sapTouchCancel:case a._mouseEvents.touchEnd:r(this);d(this);break;case a._mouseEvents.mouseEnter:i(this);break;case a._mouseEvents.mouseLeave:r(this);d(this);break;default:break}function l(e){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){if(t&&Array.prototype.indexOf.call(t,e._getDisplayState())>=0){e.$().removeClass(e._nodeAggregatedDimmedHoveredClassZoomLevel4).addClass(e._nodeAggregatedDimmedPressedClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedClassZoomLevel4).removeClass(e._nodeAggregatedHoveredClassZoomLevel4).addClass(e._nodeAggregatedPressedClassZoomLevel4)}}else if(t&&Array.prototype.indexOf.call(t,e._getDisplayState())>=0){e.$().removeClass(e._nodeAggregatedDimmedHoveredClass).addClass(e._nodeAggregatedDimmedPressedClass)}else{e.$().removeClass(e._nodeAggregatedClass).removeClass(e._nodeAggregatedHoveredClass).addClass(e._nodeAggregatedPressedClass)}}function r(e){if(o&&Array.prototype.indexOf.call(o,e._getDisplayState())>=0&&(e.$().hasClass(e._nodeAggregatedPressedClass)||e.$().hasClass(e._nodeAggregatedPressedClassZoomLevel4))){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedPressedClassZoomLevel4).addClass(e._nodeAggregatedFocusedClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedPressedClass).addClass(e._nodeAggregatedFocusedClass)}}else if(e.$().hasClass(e._nodeAggregatedDimmedPressedClass)||e.$().hasClass(e._nodeAggregatedDimmedPressedClassZoomLevel4)){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedDimmedPressedClassZoomLevel4).addClass(e._nodeAggregatedDimmedHoveredClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedDimmedPressedClass).addClass(e._nodeAggregatedDimmedHoveredClass)}}else if(e.$().hasClass(e._nodeAggregatedPressedClass)||e.$().hasClass(e._nodeAggregatedPressedClassZoomLevel4)){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedPressedClassZoomLevel4).addClass(e._nodeAggregatedClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedPressedClass).addClass(e._nodeAggregatedClass)}}}function i(e){if(t&&Array.prototype.indexOf.call(t,e._getDisplayState())>=0){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedDimmedClassZoomLevel4).addClass(e._nodeAggregatedDimmedHoveredClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedDimmedClass).addClass(e._nodeAggregatedDimmedHoveredClass)}}else if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().addClass(e._nodeAggregatedHoveredClassZoomLevel4)}else{e.$().addClass(e._nodeAggregatedHoveredClass)}}function d(e){if(t&&Array.prototype.indexOf.call(t,e._getDisplayState())>=0){if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedDimmedHoveredClassZoomLevel4).addClass(e._nodeAggregatedDimmedClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedDimmedHoveredClass).addClass(e._nodeAggregatedDimmedClass)}}else if(e._getZoomLevel()===s.ProcessFlowZoomLevel.Four){e.$().removeClass(e._nodeAggregatedHoveredClassZoomLevel4)}else{e.$().removeClass(e._nodeAggregatedHoveredClass)}}};d.prototype._hasChildren=function(){var e=this.getChildren();return e&&e.length>0};d.prototype._hasChildrenWithNodeId=function(e){var s=this.getChildren();if(s&&s.length>0){for(var o=0;o<s.length;o++){if(typeof s[o]==="object"&&s[o].nodeId===e||s[o]===e){return true}}}return false};d.prototype.getLaneId=function(){if(this._mergedLaneId){return this._mergedLaneId}else{return this.getProperty("laneId")}};d.prototype._getCurrentZoomLevelContent=function(){var e=this.getParent();if(!e||e.getMetadata().getName()!=="sap.suite.ui.commons.ProcessFlow"){return null}return this["getZoomLevel"+e.getZoomLevel()+"Content"]()};return d});
/*
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowNodeRenderer", ["./library","sap/ui/Device","sap/base/security/encodeXML"],function(e,o,s){"use strict";var a={apiVersion:2};a._constants={top:"top",right:"right",bottom:"bottom",left:"left",corner:"corner"};a._nodeLevels={iLevel0:0,iLevel1:1,iLevel2:2,iLevel3:3};a.render=function(o,s){var t=null;var l=s._getCurrentZoomLevelContent();if(s._getFoldedCorner()){t=s._getFoldedCornerControl()}var i=s._getHeaderControl();var r=s._getIconControl();var c=s._getStateTextControl();var d=s._createText1Control();var n=s._createText2Control();o.openStart("div",s);if(l){o.class("sapSuiteUiCommonsProcessFlowNodeCustom")}a._assignNodeClasses(o,s,0);o.openEnd();switch(s._getDisplayState()){case e.ProcessFlowDisplayState.Highlighted:case e.ProcessFlowDisplayState.HighlightedFocused:case e.ProcessFlowDisplayState.SelectedHighlighted:case e.ProcessFlowDisplayState.SelectedHighlightedFocused:o.openStart("div");a._assignShadowClasses(o,s,"top");o.openEnd().close("div");o.openStart("div");a._assignShadowClasses(o,s,"right");o.openEnd().close("div");o.openStart("div");a._assignShadowClasses(o,s,"bottom");o.openEnd().close("div");o.openStart("div");a._assignShadowClasses(o,s,"left");o.openEnd().close("div");if(s._getFoldedCorner()){o.openStart("div");a._assignShadowClasses(o,s,"corner");o.openEnd().close("div")}break;default:}o.openStart("div");a._assignNodeClasses(o,s,1);o.openEnd();if(s._getFoldedCorner()){o.renderControl(t)}o.close("div");o.openStart("div");a._assignNodeClasses(o,s,2);o.openEnd();o.close("div");o.openStart("div");a._assignNodeClasses(o,s,3);o.openEnd();if(l){o.openStart("div");o.class("sapSuiteUiCommonsProcessFlowNode3ContentPadding");o.openEnd();o.renderControl(l);o.close("div")}else{o.openStart("div");a._assignNodeTitleClasses(o,s);o.openEnd();o.renderControl(i);o.close("div");o.openStart("div");a._assignNodeStateClasses(o,s);o.openEnd();o.openStart("div");a._assignNodeIconClasses(o,s);o.openEnd();o.renderControl(r);o.close("div");o.openStart("div");a._assignNodeStateTextClasses(o,s);o.openEnd();o.renderControl(c);o.close("div");o.close("div");o.openStart("div");a._assignNodeText1Classes(o,s);o.openEnd();o.renderControl(d);o.close("div");o.openStart("div");a._assignNodeText2Classes(o,s);o.openEnd();o.renderControl(n);o.close("div")}o.close("div");o.close("div")};a._assignNodeClasses=function(o,t,l){switch(l){case a._nodeLevels.iLevel0:break;case a._nodeLevels.iLevel1:o.attr("id",t.getId()+"-corner-container");break;case a._nodeLevels.iLevel2:o.attr("id",t.getId()+"-top-container");break;case a._nodeLevels.iLevel3:o.attr("id",t.getId()+"-content-container");break;default:}if(l>a._nodeLevels.iLevel0){switch(t.getState()){case e.ProcessFlowNodeState.Planned:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerPlanned")}else{o.class("sapSuiteUiCommonsProcessFlowNodeStatePlanned");o.class("sapSuiteUiCommonsProcessFlowNodeStatePlannedDashedBorder")}break;case e.ProcessFlowNodeState.PlannedNegative:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerPlanned")}else{o.class("sapSuiteUiCommonsProcessFlowNodeStatePlanned");o.class("sapSuiteUiCommonsProcessFlowNodeStatePlannedDashedBorder")}break;default:}if(t._getNavigationFocus()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateNavigation")}switch(t._getDisplayState()){case e.ProcessFlowDisplayState.RegularFocused:case e.ProcessFlowDisplayState.HighlightedFocused:case e.ProcessFlowDisplayState.DimmedFocused:case e.ProcessFlowDisplayState.SelectedHighlightedFocused:case e.ProcessFlowDisplayState.SelectedFocused:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateFocused")}else{o.class("sapSuiteUiCommonsProcessFlowNodeDisplayStateFocused")}break;default:}switch(t._getDisplayState()){case e.ProcessFlowDisplayState.Regular:case e.ProcessFlowDisplayState.RegularFocused:case e.ProcessFlowDisplayState.Selected:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateRegular")}else{o.class("sapSuiteUiCommonsProcessFlowNodeDisplayStateRegular")}break;case e.ProcessFlowDisplayState.Highlighted:case e.ProcessFlowDisplayState.HighlightedFocused:case e.ProcessFlowDisplayState.SelectedHighlighted:case e.ProcessFlowDisplayState.SelectedHighlightedFocused:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateHighlighted")}else{o.class("sapSuiteUiCommonsProcessFlowNodeDisplayStateHighlighted")}break;case e.ProcessFlowDisplayState.Dimmed:case e.ProcessFlowDisplayState.DimmedFocused:if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateDimmed")}else{o.class("sapSuiteUiCommonsProcessFlowNodeDisplayStateDimmed")}break;default:}}if(l===a._nodeLevels.iLevel0){if(t._getNavigationFocus()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerDisplayStateNavigation")}if(t._getDisplayState()===e.ProcessFlowDisplayState.Highlighted){o.class("sapSuiteUiCommonsProcessFlowNodeDisplayStateHighlighted")}if(t.getType()===e.ProcessFlowNodeType.Aggregated){a._assignAggregatedNodeClasses(o,t)}}switch(t._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class(s("sapSuiteUiCommonsProcessFlowNode"+l+"ZoomLevel1"));break;case e.ProcessFlowZoomLevel.Two:o.class(s("sapSuiteUiCommonsProcessFlowNode"+l+"ZoomLevel2"));break;case e.ProcessFlowZoomLevel.Three:o.class(s("sapSuiteUiCommonsProcessFlowNode"+l+"ZoomLevel3"));break;case e.ProcessFlowZoomLevel.Four:o.class(s("sapSuiteUiCommonsProcessFlowNode"+l+"ZoomLevel4"));break;default:}if(l===a._nodeLevels.iLevel1){if(t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowNode1FoldedBorderStyle")}else{o.class("sapSuiteUiCommonsProcessFlowNode1BorderStyle");o.class("sapSuiteUiCommonsProcessFlowNodeBorderStandard")}}else if(l>a._nodeLevels.iLevel1){o.class(s("sapSuiteUiCommonsProcessFlowNode"+l+"BorderStyle"));o.class("sapSuiteUiCommonsProcessFlowNodeBorderStandard")}if(l===a._nodeLevels.iLevel1&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerNode1")}else{o.class(s("sapSuiteUiCommonsProcessFlowNode"+l))}if(l===a._nodeLevels.iLevel0&&t._getFoldedCorner()){o.class("sapSuiteUiCommonsProcessFlowFoldedCornerIndication")}};a._assignAggregatedNodeClasses=function(o,s){switch(s._getDisplayState()){case e.ProcessFlowDisplayState.Highlighted:case e.ProcessFlowDisplayState.Regular:case e.ProcessFlowDisplayState.Selected:if(s._getZoomLevel()===e.ProcessFlowZoomLevel.Four){o.class("sapSuiteUiCommonsProcessFlowNodeAggregatedZoomLevel4")}else{o.class("sapSuiteUiCommonsProcessFlowNodeAggregated")}break;case e.ProcessFlowDisplayState.Dimmed:if(s._getZoomLevel()===e.ProcessFlowZoomLevel.Four){o.class("sapSuiteUiCommonsProcessFlowNodeAggregatedDimmedZoomLevel4")}else{o.class("sapSuiteUiCommonsProcessFlowNodeAggregatedDimmed")}break;default:if(s._getZoomLevel()===e.ProcessFlowZoomLevel.Four){o.class("sapSuiteUiCommonsProcessFlowNodeAggregatedFocusedZoomLevel4")}else{o.class("sapSuiteUiCommonsProcessFlowNodeAggregatedFocused")}break}};a._assignShadowClasses=function(e,s,t){e.class("sapSuiteUiCommonsShadowedDivCommon");switch(t){case a._constants.top:if(s._getFoldedCorner()){e.class("sapSuiteUiCommonsShadowedDivFoldedCornerBorderTop")}else{e.class("sapSuiteUiCommonsShadowedDivBorderTop")}break;case a._constants.right:e.class("sapSuiteUiCommonsShadowedDivBorderRight");break;case a._constants.bottom:e.class("sapSuiteUiCommonsShadowedDivBorderBottom");break;case a._constants.left:if(s._getFoldedCorner()){e.class("sapSuiteUiCommonsShadowedDivFoldedCornerBorderLeft")}else{e.class("sapSuiteUiCommonsShadowedDivBorderLeft")}break;case a._constants.corner:if(o.browser.safari){e.class("sapSuiteUiCommonsShadowedDivFoldedCornerSafari")}else{e.class("sapSuiteUiCommonsShadowedDivFoldedCorner")}break;default:}};a._assignNodeTitleClasses=function(o,s){o.attr("id",s.getId()+"-title");switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3TitleZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3Title")};a._assignNodeStateClasses=function(o,s){o.attr("id",s.getId()+"-state");switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3StateZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3StateZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3StateZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3StateZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3State")};a._assignNodeIconClasses=function(o,s){o.attr("id",s.getId()+"-icon-container");switch(s.getState()){case e.ProcessFlowNodeState.Positive:o.class("sapSuiteUiCommonsProcessFlowNodeStatePositive");break;case e.ProcessFlowNodeState.Negative:o.class("sapSuiteUiCommonsProcessFlowNodeStateNegative");break;case e.ProcessFlowNodeState.Planned:o.class("sapSuiteUiCommonsProcessFlowNodeStatePlanned");break;case e.ProcessFlowNodeState.Neutral:o.class("sapSuiteUiCommonsProcessFlowNodeStateNeutral");break;case e.ProcessFlowNodeState.PlannedNegative:o.class("sapSuiteUiCommonsProcessFlowNodeStateNegative");break;case e.ProcessFlowNodeState.Critical:o.class("sapSuiteUiCommonsProcessFlowNodeStateCritical");break;default:}switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3StateIconZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3StateIcon")};a._assignNodeStateTextClasses=function(o,s){o.attr("id",s.getId()+"-state-text");switch(s.getState()){case e.ProcessFlowNodeState.Positive:o.class("sapSuiteUiCommonsProcessFlowNodeStatePositive");break;case e.ProcessFlowNodeState.Negative:o.class("sapSuiteUiCommonsProcessFlowNodeStateNegative");break;case e.ProcessFlowNodeState.Planned:o.class("sapSuiteUiCommonsProcessFlowNodeStatePlanned");break;case e.ProcessFlowNodeState.Neutral:o.class("sapSuiteUiCommonsProcessFlowNodeStateNeutral");break;case e.ProcessFlowNodeState.PlannedNegative:o.class("sapSuiteUiCommonsProcessFlowNodeStateNegative");break;case e.ProcessFlowNodeState.Critical:o.class("sapSuiteUiCommonsProcessFlowNodeStateCritical");break;default:}switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3StateTextZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3StateText")};a._assignNodeText1Classes=function(o,s){o.attr("id",s.getId()+"-text1");switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3TextWithGapZoomLevel1");o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3TextWithGapZoomLevel2");o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3Text")};a._assignNodeText2Classes=function(o,s){o.attr("id",s.getId()+"-text2");switch(s._getZoomLevel()){case e.ProcessFlowZoomLevel.One:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel1");break;case e.ProcessFlowZoomLevel.Two:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel2");break;case e.ProcessFlowZoomLevel.Three:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel3");break;case e.ProcessFlowZoomLevel.Four:o.class("sapSuiteUiCommonsProcessFlowNode3TextZoomLevel4");break;default:}o.class("sapSuiteUiCommonsProcessFlowNode3Text")};return a},true);
/*
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ProcessFlowRenderer", ["sap/ui/thirdparty/jquery","./library","./ProcessFlowLaneHeader","./AriaProperties","sap/ui/Device","sap/base/security/encodeXML"],function(jQuery,e,t,o,r,a){"use strict";var n=e.ProcessFlowZoomLevel;var l={apiVersion:2};l.render=function(e,t){var o=this._getZoomStyleClass(t),r,n,s,d=l,i,c;c=d._renderBasicStructure(e,t);if(c){return}try{r=t._getOrCreateProcessFlow();n=t._getOrCreateLaneMap();i=t._getConnectionsMap()}catch(e){t._handleException(e);return}e.openStart("table");e.attr("id",t.getId()+"-table");e.attr("aria-label",t._getAriaText());e.class("sapSuiteUiCommonsPF");e.class(a(o));e.openEnd();s=Object.keys(n).length;d._renderTableHeader(e,t,n,s);d._renderTableBody(e,t,s,r,i);e.close("table");e.close("div");e.close("div");this._writeCounter(e,t,"Right");e.renderControl(t._getScrollingArrow("right"));e.close("div")};l._renderNormalNodeHeader=function(e,o,r,a,n){e.openStart("th").attr("scope","colgroup").attr("colspan","3").openEnd();e.renderControl(r);e.close("th");if(a<n-1){e.openStart("th").attr("scope","colgroup").attr("colspan","2").openEnd();var l=t.createNewProcessSymbol(o._isHeaderMode());l.attachPress(jQuery.proxy(o.ontouchend,o));e.renderControl(l);e.close("th")}};l._renderMergedNodeHeader=function(e,o,r,a,n,l){var s=o._mergeLaneIdNodeStates(n);r.setState(s);a++;var d=a*3+(a-1)*2;e.openStart("th").attr("scope","colgroup").attr("colspan",d).openEnd();e.renderControl(r);e.close("th");if(l){e.openStart("th").attr("scope","colgroup").attr("colspan","2").openEnd();var i=t.createNewProcessSymbol(o._isHeaderMode());i.attachPress(jQuery.proxy(o.ontouchend,o));e.renderControl(i);e.close("th")}};l._renderNode=function(e,t,r,a){if(a){var n=r.getId()+"-node";var l=r._getCurrentZoomLevelContent();e.attr("id",n);e.attr("tabindex",0);var s={};s.label=r._getAriaText();if(l){s.labelledBy=n+" "+l.getId()}o.writeAriaProperties(e,s,r.getAriaProperties());e.openEnd();a=false}r._setParentFlow(t);r._setZoomLevel(t.getZoomLevel());r._setFoldedCorner(t.getFoldedCorners());e.renderControl(r);return a};l._renderConnection=function(e,t,o,r){if(r){if(o.getAggregation("_labels")&&o.getAggregation("_labels").length>0){e.attr("tabindex",0)}e.openEnd();r=false}o.setZoomLevel(t.getZoomLevel());t.addAggregation("_connections",o);e.renderControl(o);return r};l._renderTableHeader=function(e,o,r,a){var n,l=null,s=null,d,i;e.openStart("thead");e.attr("id",o.getId()+"-thead");e.openEnd();e.openStart("tr");e.class("sapSuiteUiCommonsPFHeader");e.class("sapSuiteUiCommonsPFHeaderHidden");if(o.getShowLabels()){e.class("sapSuiteUiPFWithLabel")}e.openEnd();e.openStart("th").openEnd().close("th");n=0;while(n<a-1){e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");n++}e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.openStart("th").openEnd().close("th");e.close("tr");e.openStart("tr");e.class("sapSuiteUiCommonsPFHeaderRow");e.openEnd();e.openStart("th").attr("scope","col").openEnd();d=t.createNewStartSymbol(o._isHeaderMode());e.renderControl(d);e.close("th");n=0;var c=0;var p=[];var g="1";i=false;while(n<a-1){l=r[n];s=r[n+1];if(l.getLaneId()+g===s.getLaneId()){c=c+1;p.push(l.getState())}else if(c===0){this._renderNormalNodeHeader(e,o,l,n,a)}else{p.push(l.getState());i=true;this._renderMergedNodeHeader(e,o,l,c,p,i);p=[];c=0}n++}if(c===0){if(!s){s=r[0]}this._renderNormalNodeHeader(e,o,s,n,a)}else{p.push(s.getState());i=false;this._renderMergedNodeHeader(e,o,l,c,p,i);c=0}e.openStart("th").attr("scope","col").openEnd();d=t.createNewEndSymbol(o._isHeaderMode());e.renderControl(d);e.close("th");e.close("tr");e.close("thead")};l._renderTableBody=function(e,t,o,a,n){var s,d,i,c,p;var g=l._checkIfHighlightedOrSelectedNodesExists(n);e.openStart("tbody").openEnd();i=a.length;if(i>0){e.openStart("tr").openEnd();e.openStart("td");e.attr("colspan",(o*5).toString());e.openEnd();e.close("td");e.close("tr")}s=0;while(s<i){e.openStart("tr").openEnd();e.openStart("td").openEnd().close("td");c=a[s].length;d=0;while(d<c-1){p=a[s][d];var h=true;if(d==0||d%2){e.openStart("td")}else{e.openStart("td").attr("colspan","4");if(r.browser.chrome){e.class("sapSuiteUiCommonsProcessFlowZIndexForConnectors")}}if(p){if(p.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"){h=l._renderNode(e,t,p,h)}else{p._setShowLabels(t.getShowLabels());l._setLabelsInConnection(a,n,p,{row:s,column:d},t,g);h=l._renderConnection(e,t,p,h)}}if(h){e.openEnd()}e.close("td");d++}e.openStart("td").openEnd().close("td");e.openStart("td").openEnd().close("td");e.close("tr");s++}e.close("tbody")};l._renderBasicStructure=function(e,t){e.openStart("div",t);var r={};r.label=t._getAriaText();o.writeAriaProperties(e,r,t.getAriaProperties());e.class("sapSuiteUiPFContainer");if(t._arrowScrollable){e.class("sapPFHScrollable");if(t._bPreviousScrollForward){e.class("sapPFHScrollForward")}else{e.class("sapPFHNoScrollForward")}if(t._bPreviousScrollBack){e.class("sapPFHScrollBack")}else{e.class("sapPFHNoScrollBack")}}else{e.class("sapPFHNotScrollable")}e.openEnd();this._writeCounter(e,t,"Left");e.renderControl(t._getScrollingArrow("left"));e.openStart("div");e.attr("id",t.getId()+"-scrollContainer");e.class("sapSuiteUiScrollContainerPF");e.class("sapSuiteUiDefaultCursorPF");e.openEnd();e.openStart("div");e.attr("id",t.getId()+"-scroll-content");e.attr("tabindex",0);e.openEnd();if(!t.getLanes()||t.getLanes().length==0){e.close("div");e.close("div");e.close("div");return true}return false};l._getZoomStyleClass=function(e){switch(e.getZoomLevel()){case n.One:return"sapSuiteUiCommonsPFZoomLevel1";case n.Two:return"sapSuiteUiCommonsPFZoomLevel2";case n.Three:return"sapSuiteUiCommonsPFZoomLevel3";case n.Four:return"sapSuiteUiCommonsPFZoomLevel4";default:break}};l._setLabelsInConnection=function(e,t,o,r,a,n){for(var s=0;s<t.length;s++){var d=t[s];if(d&&d.label){for(var i=0;i<d.connectionParts.length;i++){var c=d.connectionParts[i];if(c.x===r.column&&c.y===r.row){if(e[r.row][r.column+1]&&e[r.row][r.column+1].getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowNode"&&e[r.row][r.column+1].getNodeId()===d.targetNode.getNodeId()){l._setLineTypeInLabel(d,n);if(a._bHighlightedMode&&!d.label._getHighlighted()){d.label.setEnabled(false)}if(d.label.getEnabled()){if(d.label.hasListeners("press")){d.label.detachEvent("press",a._handleLabelClick,a)}d.label.attachPress(a._handleLabelClick,a)}o.addAggregation("_labels",d.label,true)}}}}}};l._setLineTypeInLabel=function(e,t){var o=false,r,a=false,n=false;if(e.sourceNode.getSelected()&&e.targetNode.getSelected()){o=true;e.label._setSelected(true)}else{e.label._setSelected(false)}r=e.targetNode;if(r.getHighlighted()){var l=r.getParents(),s;for(var d=0;d<l.length;d++){s=sap.ui.getCore().byId(l[d]);if(s.getHighlighted()){a=true;break}}}if(a){n=true;e.label._setHighlighted(true)}else{e.label._setHighlighted(false)}if(t&&!o&&!n){e.label._setDimmed(true)}else{e.label._setDimmed(false)}};l._checkIfHighlightedOrSelectedNodesExists=function(e){var t=false;for(var o=0;o<e.length;o++){var r=e[o];if(r.label){if(r.sourceNode.getSelected()&&r.targetNode.getSelected()||r.sourceNode.getHighlighted()&&r.targetNode.getHighlighted()){t=true}}}return t};l._writeCounter=function(e,t,o){e.openStart("span");e.attr("id",t.getId()+"-counter"+o);e.class("suiteUiPFHCounter");e.class(a("suiteUiPFHCounter"+o));e.openEnd();e.text("0");e.close("span")};return l},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ThreePanelThingViewer", ["sap/ui/thirdparty/jquery","./library","sap/ui/ux3/library","sap/ui/commons/library","./VerticalNavigationBar","sap/ui/ux3/ThingViewer","sap/ui/commons/Button","sap/suite/ui/commons/ThreePanelThingViewerRenderer","sap/ui/events/ControlEvents","sap/ui/dom/containsOrEquals"],function(jQuery,e,t,n,i,o,r,s,u,a){"use strict";var p=o.extend("sap.suite.ui.commons.ThreePanelThingViewer",{metadata:{deprecated:true,library:"sap.suite.ui.commons",properties:{logo:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},showHeader:{type:"boolean",group:"Misc",defaultValue:null},sidebarWidth:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"244px"}},aggregations:{menuContent:{type:"sap.ui.commons.Link",multiple:true,singularName:"menuContent"}}}});p.prototype.init=function(){this._rb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");this._oNavBar=new i;this.setAggregation("navBar",this._oNavBar);this._oNavBar.attachSelect(function(e){var t=e.getParameters().item;if(this.fireFacetSelected({id:t.getId(),key:t.getKey(),item:t})){this.setSelectedFacet(t)}else{e.preventDefault()}},this);this._iSelectedMenuItem=0;this._oMenuButton=new r({id:this.getId()+"-menu-button",tooltip:this._rb.getText("THREEPANELTHINGVIEWER_BUTTON_MENU_TOOLTIP"),lite:true,press:[this._toggleMenuPopup,this]});this._oMenuButton.addStyleClass("sapSuiteTvTitleMb");this.fAnyEventHandlerProxy=jQuery.proxy(this.onAnyEvent,this)};p.prototype.exit=function(){this._oMenuButton.destroy();u.unbindAnyEvent(this.fAnyEventHandlerProxy)};p.prototype.onAfterRendering=function(){this._bMenuOpened=false;this._updateMenuPopup();this._toggleHeaderContent()};p.prototype.selectDefaultFacet=function(){this._selectDefault();return this};p.prototype._toggleMenuPopup=function(){jQuery(document.getElementById(this.getId()+"-menu-popup")).toggle();this._bMenuOpened=!this._bMenuOpened;if(this._bMenuOpened){u.bindAnyEvent(this.fAnyEventHandlerProxy);this.getMenuContent()[0].focus();this._iSelectedMenuItem=0}else{u.unbindAnyEvent(this.fAnyEventHandlerProxy)}};p.prototype._updateMenuPopup=function(){var e=jQuery(document.getElementById(this.getId()+"-header")).width();var t=jQuery(document.getElementById(this.getId()+"-menu-popup"));var n=sap.ui.getCore().getConfiguration().getRTL()?"right":"left";var i=this.getMenuContent().length;t.css(n,e-22+"px");t.children().each(function(e){var t=jQuery(this);t.attr("tabindex","-1");t.attr("role","menuitem");t.attr("aria-posinset",e+1);t.attr("aria-setsize",i)})};p.prototype._rerenderFacetContent=function(){var e=jQuery(document.getElementById(this.getId()+"-facetContent"));if(e.length>0){var t=sap.ui.getCore().createRenderManager();s.renderFacetContent(t,this);t.flush(e[0]);t.destroy();this._resize=false;this._setTriggerValue();this._onresize()}};p.prototype._rerenderHeader=function(){var e=jQuery(document.getElementById(this.getId()+"-header"));if(e.length>0){var t=sap.ui.getCore().createRenderManager();s.renderHeader(t,this);t.flush(e[0]);t.destroy()}};p.prototype._rerenderHeaderContent=function(){var e=jQuery(document.getElementById(this.getId()+"-headerContent"));if(e.length>0){var t=sap.ui.getCore().createRenderManager();s.renderHeaderContent(t,this);t.flush(e[0]);t.destroy()}};p.prototype._toggleHeaderContent=function(){var e=jQuery(document.getElementById(this.getId()+"-headerContent"));if(this.getShowHeader()){e.show()}else{e.hide()}};p.prototype.onAnyEvent=function(e){if(this._bMenuOpened&&(e.type==="mousedown"||e.type==="focusin")){var t=e.target;var n=this.getId()+"-menu-popup"?window.document.getElementById(this.getId()+"-menu-popup"):null;if(!a(n,t)||t.tagName==="BODY"){this._toggleMenuPopup()}}};p.prototype.onsapescape=function(){if(this._bMenuOpened){this._toggleMenuPopup();this._oMenuButton.focus()}};p.prototype.onsapnext=function(e){if(this._bMenuOpened){var t=this.getMenuContent();this._iSelectedMenuItem++;if(this._iSelectedMenuItem>=t.length){this._iSelectedMenuItem=0}t[this._iSelectedMenuItem].focus();e.preventDefault();e.stopPropagation()}};p.prototype.onsapprevious=function(e){if(this._bMenuOpened){var t=this.getMenuContent();this._iSelectedMenuItem--;if(this._iSelectedMenuItem<0){this._iSelectedMenuItem=t.length-1}t[this._iSelectedMenuItem].focus();e.preventDefault();e.stopPropagation()}};p.prototype.setShowHeader=function(e){this.setProperty("showHeader",e,true);this._toggleHeaderContent();return this};return p});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/ThreePanelThingViewerRenderer", ["sap/ui/core/Renderer","sap/ui/ux3/ThingViewerRenderer"],function(e,t){"use strict";var i=e.extend(t);i.renderContent=function(e,t){e.write("<div");e.addClass("sapSuiteTvMinHeight");e.writeClasses();e.write(">");e.write("<header");e.writeAttribute("id",t.getId()+"-header");e.addClass("sapSuiteTvTitle");e.writeClasses();e.addStyle("width",t.getSidebarWidth());e.writeStyles();e.write(">");this.renderHeader(e,t);e.write("</header>");e.write("<nav");e.writeAttribute("id",t.getId()+"-navigation");e.addClass("sapSuiteTvNav");if(!t.getLogo()){e.addClass("sapSuiteTvNavNoLogo")}e.writeClasses();e.addStyle("width",t.getSidebarWidth());e.writeStyles();e.write(">");e.renderControl(t._getNavBar());e.write("</nav>");e.write("<aside");e.writeAttribute("id",t.getId()+"-headerContent");e.addClass("sapSuiteTvHeader");e.writeClasses();e.write(">");this.renderHeaderContent(e,t);e.write("</aside>");e.write("<div");e.writeAttribute("id",t.getId()+"-facetContent");e.addClass("sapSuiteTvFacet");e.writeClasses();e.write(">");this.renderFacetContent(e,t);e.write("</div>");if(t.getLogo()){e.write("<footer");e.writeAttribute("id",t.getId()+"-footer");e.addClass("sapSuiteTvLogo");e.writeClasses();e.addStyle("width",t.getSidebarWidth());e.writeStyles();e.write(">");e.write("<img");e.writeAttribute("id",t.getId()+"-logo");e.writeAttribute("role","presentation");e.writeAttributeEscaped("src",t.getLogo());e.addClass("sapSuiteTvLogoIcon");e.writeClasses();e.write("/>");e.write("</footer>")}e.write("</div>")};i.renderHeader=function(e,t){var i=t.getMenuContent().length;e.write("<div");e.addClass("sapSuiteTvTitleBar");e.writeClasses();e.write(">");if(t.getIcon()){e.write("<img");e.writeAttribute("id",t.getId()+"-swatch");e.writeAttribute("role","presentation");e.writeAttributeEscaped("src",t.getIcon());e.addClass("sapSuiteTvTitleIcon");e.writeClasses();e.write("/>")}if(i>0){e.renderControl(t._oMenuButton)}e.write("<div");e.writeAttribute("role","heading");e.writeAttribute("aria-level",1);e.writeAttributeEscaped("title",t.getType());e.addClass("sapSuiteTvTitleType");e.addClass("sapSuiteTvTextCrop");e.writeClasses();e.write(">");e.writeEscaped(t.getType());e.write("</div>");e.write("<div");e.writeAttribute("role","heading");e.writeAttribute("aria-level",2);e.writeAttributeEscaped("title",t.getTitle());e.addClass("sapSuiteTvTitleFirst");e.writeClasses();e.write(">");e.writeEscaped(t.getTitle());e.write("</div>");e.write("<div");e.writeAttribute("role","heading");e.writeAttribute("aria-level",3);e.writeAttributeEscaped("title",t.getSubtitle());e.addClass("sapSuiteTvTitleSecond");e.addClass("sapSuiteTvTextCrop");e.writeClasses();e.write(">");e.writeEscaped(t.getSubtitle());e.write("</div>");e.write("</div>");this.renderFlyOutMenu(e,t)};i.renderFacetContent=function(e,t){var i=t.getFacetContent();for(var r=0;r<i.length;r++){var a=i[r];e.write("<div");e.writeAttribute("role","form");if(a.getColspan()){e.addClass("sapUiUx3TVFacetThingGroupSpan")}else{e.addClass("sapUiUx3TVFacetThingGroup")}e.writeClasses();e.write(">");e.write("<div");e.writeAttributeEscaped("title",a.getTitle());e.addClass("sapUiUx3TVFacetThingGroupContentTitle");e.writeClasses();e.write(">");e.write("<span>");e.writeEscaped(a.getTitle());e.write("</span>");e.write("</div>");e.write("<div");e.addClass("sapUiUx3TVFacetThingGroupContent");e.writeClasses();e.write(">");var s=a.getContent();for(var d=0;d<s.length;d++){e.renderControl(s[d])}e.write("</div>");e.write("</div>")}};i.renderFlyOutMenu=function(e,t){e.write("<div");e.writeAttribute("id",t.getId()+"-menu-popup");e.writeAttribute("role","menu");e.addClass("sapSuiteTvPopupMenu");e.writeClasses();e.write(">");var i=t.getMenuContent();for(var r=0;r<i.length;r++){var a=i[r];a.addStyleClass("sapSuiteTvPopupMenuLink");e.renderControl(a)}e.write("</div>")};return i},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/Timeline", ["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","sap/ui/core/ResizeHandler","sap/ui/core/format/DateFormat","sap/ui/model/ClientListBinding","sap/ui/model/FilterType","sap/suite/ui/commons/TimelineNavigator","sap/suite/ui/commons/util/DateUtils","sap/suite/ui/commons/util/ManagedObjectRegister","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/base/ManagedObject","sap/suite/ui/commons/TimelineItem","sap/suite/ui/commons/TimelineRenderManager","sap/ui/core/delegate/ScrollEnablement","sap/ui/base/Object","sap/base/assert","sap/base/Log","sap/ui/core/date/UI5Date","sap/ui/core/Configuration","./TimelineRenderer"],function(jQuery,t,e,i,r,s,n,o,a,l,u,h,p,g,c,f,d,_,m,y,I,F,D,S){"use strict";var T=t.TimelineScrollingFadeout,b=t.TimelineAlignment,v=t.TimelineGroupType,M=t.TimelineFilterType,C=t.TimelineAxisOrientation;var B=e.extend("sap.suite.ui.commons.Timeline",{metadata:{library:"sap.suite.ui.commons",properties:{alignment:{type:"sap.suite.ui.commons.TimelineAlignment",group:"Misc",defaultValue:"Right"},axisOrientation:{type:"sap.suite.ui.commons.TimelineAxisOrientation",group:"Misc",defaultValue:"Vertical"},data:{type:"object",group:"Misc",defaultValue:null,deprecated:true},enableAllInFilterItem:{type:"boolean",group:"Behavior",defaultValue:true,deprecated:true},enableBackendFilter:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},enableBusyIndicator:{type:"boolean",group:"Misc",defaultValue:true},enableDoubleSided:{type:"boolean",group:"Misc",defaultValue:false},enableModelFilter:{type:"boolean",group:"Misc",defaultValue:true},enableScroll:{type:"boolean",group:"Misc",defaultValue:true},enableSocial:{type:"boolean",group:"Misc",defaultValue:false},filterTitle:{type:"string",group:"Misc",defaultValue:null},forceGrowing:{type:"boolean",group:"Misc",defaultValue:false},group:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},groupBy:{type:"string",group:"Misc",defaultValue:null},groupByType:{type:"sap.suite.ui.commons.TimelineGroupType",group:"Misc",defaultValue:"None"},growing:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},growingThreshold:{type:"int",group:"Misc",defaultValue:5},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:""},lazyLoading:{type:"boolean",group:"Dimension",defaultValue:false},noDataText:{type:"string",group:"Misc",defaultValue:null},scrollingFadeout:{type:"sap.suite.ui.commons.TimelineScrollingFadeout",group:"Misc",defaultValue:"None"},showFilterBar:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},showHeaderBar:{type:"boolean",group:"Misc",defaultValue:true},showIcons:{type:"boolean",group:"Misc",defaultValue:true},showItemFilter:{type:"boolean",group:"Misc",defaultValue:true},showSearch:{type:"boolean",group:"Misc",defaultValue:true},showSort:{type:"boolean",group:"Misc",defaultValue:true},showSuggestion:{type:"boolean",group:"Behavior",defaultValue:true,deprecated:true},showTimeFilter:{type:"boolean",group:"Misc",defaultValue:true},sort:{type:"boolean",group:"Misc",defaultValue:true},dateTimePath:{type:"string",group:"Misc",defaultValue:""},sortOldestFirst:{type:"boolean",group:"Misc",defaultValue:false},textHeight:{type:"string",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"}},defaultAggregation:"content",aggregations:{content:{type:"sap.suite.ui.commons.TimelineItem",multiple:true,singularName:"content"},customFilter:{type:"sap.ui.core.Control",multiple:false},filterList:{type:"sap.suite.ui.commons.TimelineFilterListItem",multiple:true,singularName:"filterList"},suggestionItems:{type:"sap.m.StandardListItem",multiple:true,singularName:"suggestionItem",deprecated:true}},events:{addPost:{deprecated:true,parameters:{value:{type:"string"}}},customMessageClosed:{},filterOpen:{},filterSelectionChange:{parameters:{type:{type:"sap.suite.ui.commons.TimelineFilterType"},searchTerm:{type:"string"},selectedItem:{type:"string"},selectedItems:{type:"object"},timeKeys:{type:"object"},clear:{type:"boolean"}}},grow:{},itemFiltering:{parameters:{item:{type:"sap.suite.ui.commons.TimelineItem"},reasons:{type:"object"},dataKeys:{type:"object"},timeKeys:{type:"object"},searchTerm:{type:"string"}}},select:{parameters:{selectedItem:{type:"sap.suite.ui.commons.TimelineItem"},userAction:{type:"boolean"}}},suggest:{deprecated:true,parameters:{suggestValue:{type:"string"}}},suggestionItemSelected:{deprecated:true,parameters:{selectedItem:{type:"sap.ui.core.Item"}}}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},designTime:true}});function w(t,e){var i;Object.defineProperty(t,e,{get:function(){return typeof i==="function"?i():i},set:function(t){i=t}})}var N=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons"),G=Object.freeze({ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"}),x=Object.freeze({UP:"UP",DOWN:"DOWN",NONE:"NONE"}),E={Year:r.getDateInstance({pattern:"yyyy"}),Quarter:r.getDateInstance({pattern:"QQQQ yyyy"}),Month:r.getDateInstance({format:"yyyyMMMM"}),Week:r.getDateInstance({pattern:"w"}),Day:r.getDateInstance({style:"long"}),MonthDay:r.getDateInstance({style:"medium"})};function P(t,e){var i;y(Array.isArray(t),"aArray must be an array.");if(typeof t.findIndex==="function"){return t.findIndex(e)}for(i=0;i<t.length;i++){if(e(t[i],i,t)){return i}}return-1}B.prototype.init=function(){this.aPrevFilters=[];this._objects=new l;this.reset();w(this,"_endDate");w(this,"_startDate");this._initControls();this.setBusyIndicatorDelay(0)};B.prototype.resetTimeLimits=function(){this._maxDate=null;this._minDate=null};B.prototype.setCustomModelFilter=function(t,e){var i=this.getBinding("content");if(i){var r=i.aFilters||[];var s=P(r,function(e){return e._customTimelineId===t});if(s!==-1){r.splice(s,1)}if(e!==null){e._customTimelineId=t;r.push(e)}i.filter(r,n.Control)}};B.prototype.setCustomGrouping=function(t){var e=this.getBindingInfo("content");this._fnCustomGroupBy=t;if(e){this._bindGroupingAndSorting(e);this.updateAggregation("content")}};B.prototype.setCurrentTimeFilter=function(t){this._startDate=t.from;this._endDate=t.to;this._rangeFilterType=t.type};B.prototype.setCurrentSearch=function(t){this._objects.getSearchField().setValue(t)};B.prototype.setCurrentFilter=function(t){var e=this,i=function(e){for(var i=0;i<t.length;i++){if(t[i]===e){return true}}return false};if(!t){return}if(!Array.isArray(t)){t=[t]}if(this._aFilterList.length===0){this._setFilterList()}e._currentFilterKeys=[];this._aFilterList.forEach(function(t){var r=t.key;if(i(r)){e._currentFilterKeys.push({key:r,text:t.text?t.text:t.key})}})};B.prototype.getGroups=function(){return this._useBinding()?this.getContent().filter(function(t){return t._isGroupHeader}):this._aGroups};B.prototype.exit=function(){this._objects.destroyAll();this.aPrevFilters=undefined;if(this.oItemNavigation){this.removeDelegate(this.oItemNavigation);this.oItemNavigation.destroy();this.oItemNavigation=null}if(this._oScroller){this._oScroller.destroy();this._oScroller=null}if(this.oResizeListener){i.deregister(this.oResizeListener);this.oResizeListener=null}};B.prototype.adjustUI=function(){this._performUiChanges(true)};B.prototype.setModelFilterMessage=function(t,e){if(t===M.Data){this._dataMessage=e}if(t===M.Time){this._rangeMessage=e}};B.prototype.setCustomFilterMessage=function(t){this._customFilterMessage=t};B.prototype.setModelFilter=function(t){switch(t.type){case M.Data:this._dataFilter=t.filter;break;case M.Time:this._rangeDataFilter=t.filter;break;case M.Search:this._searchFilter=t.filter;break;default:}if(t.refresh!==false){this.recreateFilter()}};B.prototype.getAggregation=function(t){switch(t){case"headerBar":return this.getHeaderBar();case"searchField":return this._objects.getSearchField();case"sortIcon":return this._objects.getSortIcon();case"filterIcon":return this._objects.getFilterIcon();default:return e.prototype.getAggregation.apply(this,arguments)}};B.prototype._formatGroupBy=function(t,e){if(this._fnCustomGroupBy){return this._fnCustomGroupBy(t)}var i=t,r=t;if(t instanceof Date){switch(e){case v.Year:i=t.getFullYear();r=E.Year.format(t);break;case v.Quarter:i=t.getFullYear()+"/"+Math.floor(t.getMonth()/4);r=E.Quarter.format(t);break;case v.Month:i=t.getFullYear()+"/"+t.getMonth();r=E.Month.format(t);break;case v.Week:var s=F.getInstance(t),n=F.getInstance(t),o=t.getFullYear(),a=E.Week.format(t),l=t.getDate()-t.getDay(),u=l+6,h=F.getInstance(s.setDate(l)),p=F.getInstance(n.setDate(u));i=o+"/"+a;r=E.MonthDay.format(h)+" – "+E.MonthDay.format(p);break;case v.Day:i=t.getFullYear()+"/"+t.getMonth()+"/"+t.getDate();r=E.Day.format(t);break;default:}}return{key:i,title:r,date:t}};B.prototype._fnDateDiff=function(t,e,i){var r,s,n,o,a=0;e=e||this._minDate;i=i||this._maxDate;switch(t){case v.Year:a=i.getFullYear()-e.getFullYear();break;case v.Month:r=(i.getFullYear()-e.getFullYear())*12;r+=i.getMonth()-e.getMonth();a=r<=0?0:r;break;case v.Quarter:s=(i.getFullYear()-e.getFullYear())*4;n=Math.floor(e.getMonth()/3);o=Math.floor(i.getMonth()/3);a=s+(o-n);break;case v.Day:var l=24*60*60*1e3;a=Math.round(Math.abs((e.getTime()-i.getTime())/l));break;default:}return a};B.prototype._fnAddDate=function(t,e){var i,r,s,n=function(t,e,i){this.setHours(t);this.setMinutes(e);this.setSeconds(i)},o=function(t,i,r){if(e===x.UP){n.call(r,23,59,59);return F.getInstance(Math.min.apply(null,[this._maxDate,r]))}if(e===x.DOWN){n.call(i,0,0,0);return F.getInstance(Math.max.apply(null,[this._minDate,i]))}return t};switch(this._rangeFilterType){case v.Year:i=F.getInstance(F.getInstance(this._minDate).setFullYear(this._minDate.getFullYear()+t));r=F.getInstance(i.getFullYear(),0,1);s=F.getInstance(i.getFullYear(),11,31);break;case v.Month:i=F.getInstance(F.getInstance(this._minDate).setMonth(this._minDate.getMonth()+t));r=F.getInstance(i.getFullYear(),i.getMonth(),1);s=F.getInstance(i.getFullYear(),i.getMonth()+1,0);break;case v.Quarter:i=F.getInstance(F.getInstance(this._minDate).setMonth(this._minDate.getMonth()+t*3));var a=i.getMonth()%3;r=F.getInstance(i.getFullYear(),i.getMonth()-a,1);s=F.getInstance(i.getFullYear(),i.getMonth()+(2-a)+1,0);break;case v.Day:i=r=s=F.getInstance(F.getInstance(this._minDate).setDate(this._minDate.getDate()+t));break;default:}return o.call(this,i,r,s)};B.prototype._calculateRangeTypeFilter=function(){var t=this._fnDateDiff(v.Day);if(t>500){return v.Year}else if(t>200){return v.Quarter}else if(t>62){return v.Month}return v.Day};B.prototype._setRangeFilter=function(){var t=this._fnDateDiff(this._rangeFilterType);this._objects.getTimeRangeSlider().setMin(0);this._objects.getTimeRangeSlider().setMax(t);this._objects.getTimeRangeSlider().setRange([0,t]);this._objects.getTimeRangeSlider().invalidate();var e=this._objects.getTimeRangeSlider().getRange();if(e[1]-e[0]===0){this._objects.getTimeRangeSlider().addStyleClass("sapTimelineRangeFilterNoDiff")}else{this._objects.getTimeRangeSlider().removeStyleClass("sapTimelineRangeFilterNoDiff")}};B.prototype._sortClick=function(){var t,e;this._sortOrder=this._sortOrder===G.ASCENDING?G.DESCENDING:G.ASCENDING;this._objects.getSortIcon().setIcon(this._getSorterIcon());this._objects.getSortIcon().setTooltip(this._sortOrder===G.ASCENDING?N.getText("TIMELINE_SORT_ASCENDING"):N.getText("TIMELINE_SORT_DESCENDING"));if(this._useModelFilter()){t=this.getBinding("content");e=this._findDateTimeBindingPath();t.sort(this._getDefaultSorter(e,this._sortOrder===G.ASCENDING))}else{this.invalidate()}};B.prototype._getSorterIcon=function(){return this._sortOrder===G.ASCENDING?"sap-icon://sort-ascending":"sap-icon://sort-descending"};B.prototype._sort=function(t,e){var i=e||this._sortOrder;t.sort(function(t,e){var r=t.getDateTime(),s=e.getDateTime(),n=i===G.ASCENDING?-1:1;return r<s?1*n:-1*n});return t};B.prototype._loadMore=function(){this._loadMoreDone=true;var t,e,i=function(){var t=this._displayShowMore()?this.getGrowingThreshold():this._calculateItemCountToLoad(this.$());this._iItemCount+=t;this._iItemCount=Math.min(this._getMaxItemsCount(),this._iItemCount)}.bind(this);this._lastScrollPosition.more=this._isVertical()?this._$content.get(0).scrollTop:this._$content.get(0).scrollLeft;this._setBusy(true);this.fireGrow();if(this._useBinding()){if(this._isMaxed()){this._setBusy(false);return}i();t=this.getBindingInfo("content");t.startIndex=0;if(!this._loadAllData()){t.length=this._iItemCount}e=this.getBinding("content").getContexts(0,t.length);if(e&&e.dataRequested){this.oItemNavigation.refocusOnNextUpdate();return}this.updateAggregation("content")}else{i();this.invalidate()}this.oItemNavigation.refocusOnNextUpdate()};B.prototype.recreateFilter=function(t){var e=this.getBinding("content"),i=this,r=[],s=[];if(e){if(!t){r=e.aFilters.length!=0?e.aFilters:this.aPrevFilters||[]}if(this._dataFilter){s.push(this._dataFilter)}if(this._rangeDataFilter){s.push(this._rangeDataFilter)}if(this._searchFilter){s.push(this._searchFilter)}if(this._filter&&!t){var o=P(r,function(t){return t===i._filter});if(o!==-1){r.splice(o,1)}}if(s.length>0){this._filter=new p(s,true);r.push(this._filter)}if(r.length){this.aPrevFilters=r.map(function(t){return t});e.filter(r,n.Control)}else{if(this.aPrevFilters.length==0&&s.length==0){this._setBusy(false);return}else{this.aPrevFilters=r.map(function(t){return t});e.filter(r,n.Control)}}}else{this.invalidate()}};B.prototype._getRangeMessage=function(){var t=this._rangeMessage;if(!t){var e=this._formatGroupBy(this._startDate,this._rangeFilterType).title,i=this._formatGroupBy(this._endDate,this._rangeFilterType).title;if(D.getTimezone()!==Intl.DateTimeFormat().resolvedOptions().timeZone&&e instanceof Date&&i instanceof Date){e=r.getDateTimeWithTimezoneInstance().format(e);i=r.getDateTimeWithTimezoneInstance().format(i)}t=N.getText("TIMELINE_RANGE_SELECTION")+" (";t+=e+" - "+i+")"}return t};B.prototype._getFilterMessage=function(){var t="",e=null;if(this._dataMessage){t=this._dataMessage}else if(this._currentFilterKeys.length>0){t=this._currentFilterKeys.map(function(t){return t.text?t.text:t.key}).join(", ");t=this._getFilterTitle()+" ("+t+")"}if(this._rangeDataFilter||this._rangeMessage||this._startDate&&this._endDate){t=t?t+", ":"";t+=this._getRangeMessage()}if(this._customFilterMessage){t=t?t+", "+this._customFilterMessage:this._customFilterMessage}if(t){e=N.getText("TIMELINE_FILTER_INFO_BY",t)}return e};B.prototype.refreshContent=function(){var t=this.getBinding("content"),e=this.getBindingInfo("content"),i=this.getGrowingThreshold();this._setBusy(true);if(t&&e){this._iItemCount=t.sOperationMode==="Default"||t.sOperationMode==="Server"?0:this._iItemCount;t.getContexts(0,i);e.length=i;t.attachEventOnce("dataReceived",jQuery.proxy(function(){this.updateAggregation("content")},this))}else{this.updateAggregation("content")}};B.prototype.updateContent=function(){this._setBusy(false);this._updateDone=true;this.updateAggregation("content");var t=this._objects.getSortIcon();if(this.getAggregation("content").length<=1){t.setEnabled(false)}else{t.setEnabled(true)}this.invalidate()};B.prototype.destroyContent=function(){var t=this.$("line"),e=this.$().find(".sapSuiteUiCommonsTimelineItemGetMoreButton");if(t.get(0)){t.remove()}if(e.get(0)){e.remove()}this.destroyAggregation("content");return this};B.prototype._search=function(t){var e=this,i,r,s,n,o=[];this._searchValue=t;if(this._useModelFilter()){i=this._fireSelectionChange({searchTerm:this._searchValue,type:M.Search});if(i){this._searchFilter=null;if(this._searchValue){r=this._findBindingPaths("text");s=this._findBindingPaths("title");n=this._findBindingPaths("userName");if(r.length>0){o.push(r)}if(s.length>0){o.push(s)}if(n.length>0){o.push(n)}if(o.length>0){this._searchFilter=new p(o.map(function(t){return new p(t.map(function(t){return new p(t,g.Contains,e._searchValue)}),false)}))}}this.recreateFilter()}}else{this.invalidate()}};B.prototype._filterData=function(t){var e,i;this._dataMessage="";if(this._useModelFilter()){this._dataFilter=null;e=this._fireSelectionChange({selectedItem:this._currentFilterKeys[0]?this._currentFilterKeys[0].key:"",selectedItems:this._currentFilterKeys,type:M.Data});if(e){if(this._currentFilterKeys.length>0){i=this._findBindingPath("filterValue");if(i){this._dataFilter=new p(this._currentFilterKeys.map(function(t){return new p(i,g.EQ,t.key)}),false)}}}this._rangeDataFilter=null;if(t){e=this._fireSelectionChange({type:M.Time,timeKeys:{from:this._startDate,to:this._endDate}});if(e){i=this._findDateTimeBindingPath();if(i){this._rangeDataFilter=new p({path:i,operator:g.BT,value1:this._startDate,value2:this._endDate})}}}this._setBusy(true);this.recreateFilter()}else{this.invalidate()}};B.prototype._filterRangeData=function(){var t,e;this._rangeMessage="";if(this._useModelFilter()){t=this._fireSelectionChange({from:this._startDate,to:this._endDate,type:M.Time});if(t){e=this._findDateTimeBindingPath();this._rangeDataFilter=null;if(e){this._rangeDataFilter=new p({path:e,operator:g.BT,value1:this._startDate,value2:this._endDate})}this._setBusy(true);this.recreateFilter()}}else{this.invalidate()}};B.prototype.applySettings=function(t,e){c.prototype.applySettings.apply(this,[t,e]);this._settingsApplied=true;if(this._bindOptions){this.bindAggregation("content",this._bindOptions);this._bindOptions=null}};B.prototype._setFilterList=function(){var t=false,e,i,r,s={},n,o;this._aFilterList=[];if(this._useModelFilter()){this._aFilterList=this.getFilterList().map(function(t){return{key:t.getProperty("key"),text:t.getProperty("text")}});if(this._aFilterList.length===0){o=this._findBindingData("filterValue");n=this.getBinding("content");if(o&&n){e=n.getDistinctValues(o.path);if(Array.isArray(e)){this._aFilterList=e.map(function(t){return{key:t,text:o.formatter?o.formatter(t):t}});this._aFilterList=this._aFilterList.filter(function(t){return t.key})}t=true}}}else{i=this.getContent();t=true;for(var a=0;a<i.length;a++){r=i[a].getFilterValue();if(!r){continue}if(!(r in s)){s[r]=1;this._aFilterList.push({key:r,text:r})}}}if(t){this._aFilterList.sort(function(t,e){if(t.text.toLowerCase){return t.text.toLowerCase().localeCompare(e.text.toLowerCase())}else{return t.text>e.text}})}};B.prototype._clearFilter=function(){var t=function(){var t,e=this._objects.getTimeRangeSlider();this._startDate=null;this._endDate=null;this._rangeMessage=null;e.setRange([e.getMin(),e.getMax()]);if(this._useModelFilter()){t=this._fireSelectionChange({clear:true,timeKeys:{from:null,to:null},type:M.Range})}return t}.bind(this),e=function(){var t;this._currentFilterKeys=[];if(this._useModelFilter()){t=this._fireSelectionChange({clear:true,selectedItems:[],selectedItem:"",type:M.Data})}return t}.bind(this);var i=e(),r=t();this._customFilterMessage="";if(i||r){if(i){this._dataFilter=null}if(r){this._rangeDataFilter=null}this.recreateFilter(true)}else{this.invalidate()}this._objects.destroyObject("FilterContent");this._setupFilterDialog()};B.prototype._getTimeFilterData=function(){var t=this,e,i,r,s,n=function(e,i){return l(e,t[i]).then(function(e){if(e){if(!t._objects.getTimeFilterSelect().getEnabled()){t._objects.getTimeFilterSelect().setEnabled(true)}var r=a.parseDate(e);if(r instanceof Date){t[i]=r}}}).catch(function(){t._objects.getTimeFilterSelect().setEnabled(false)})},o=function(e){var i,r,s,n,o,l="sap_suite_ui_commons_Timeline";i=this.getBinding("content").getModel();if(!i){return Promise.reject()}r=this._findDateTimeBindingPath();if(!r){return}s=new h(r,e);n=this.getBinding("content");if(!n){return Promise.reject()}if(i.submitBatch){o={$$groupId:l}}var u=i.bindList(n.getPath(),n.getContext(),s,undefined,o);u.initialize();var g=u.getContexts(0,1);if(m.isA(u,"sap.ui.model.json.JSONListBinding")&&g.length===0){return Promise.reject()}else if(g.length>0){return Promise.resolve(a.parseDate(g[0].getProperty(r)))}else if(m.isA(u,"sap.ui.model.odata.v4.ODataListBinding")){t._setBusy(true);return new Promise(function(e,s){i.submitBatch(l).then(function(){t._setBusy(false);p(u,r,e,s)})})}else if(u&&u.attachDataReceived){t._setBusy(true);return new Promise(function(e,i){u.attachDataReceived(function(){t._setBusy(false);p(u,r,e,i)})})}return Promise.reject()}.bind(this),l=function(t,e){if(e){return Promise.resolve(e)}return o(t==="max")},u=function(){e=this.getContent();if(e.length>0){this._minDate=e[0].getDateTime();this._maxDate=e[0].getDateTime();for(var t=1;t<e.length;t++){s=e[t].getDateTime();if(s<this._minDate){this._minDate=s}if(s>this._maxDate){this._maxDate=s}}}},p=function(t,e,i,r){var s=t.getContexts(0,1);if(s.length>0){i(a.parseDate(s[0].getProperty(e)))}else{r()}};return new Promise(function(e,s){if(!t._maxDate||!t._minDate){if(t._useModelFilter()){i=n("min","_minDate",i);r=n("max","_maxDate",r);Promise.all([i,r]).then(function(){e()}).catch(function(){s()})}else{u.call(t);e()}}else{e()}})};B.prototype._openFilterDialog=function(){var t=this.getCustomFilter();if(t){if(typeof t.openBy==="function"){t.openBy(this._objects.getFilterIcon())}else if(typeof t.open==="function"){t.open()}else{I.error("CustomFilter is expected to have an openBy or open function. The provided instance doesn't have either.")}this.fireFilterOpen();return}this._filterState={data:false,range:false};this._objects.getFilterContent().open();this._objects.getTimestampFilterPicker().resizeDialog(this._objects);this.fireFilterOpen()};B.prototype._createGroupHeader=function(t,e){var i=this.getId()+"-timelinegroupheader-"+this._groupId,r=t.key,s=new f(i,{text:"GroupHeader",dateTime:t.date,userName:r,title:t.title,icon:"sap-icon://arrow-down"});s._isGroupHeader=true;if(e){s.setParent(this,"content");this._aGroups.push(s)}else{this.addAggregation("content",s,false)}this._groupId++;return s};B.prototype._getDefaultSorter=function(t,e){var i=this;if(t){return new h(t,!e,function(e){var r=e.getProperty(t),s=a.parseDate(r);return s instanceof Date?i._formatGroupBy(s,i.getGroupByType()):{date:s}})}};B.prototype._findBindingInfoFromTemplate=function(t,e){if(!e){var i=this.getBindingInfo("content");if(i){e=i.template}}if(e){var r=e.getBindingInfo(t);if(r&&r.parts&&r.parts[0]){return r}}return null};B.prototype._findBindingPaths=function(t,e){var i=this._findBindingInfoFromTemplate(t,e);if(i&&i.parts){return i.parts.map(function(t){return t.path})}return[]};B.prototype._findDateTimeBindingPath=function(t){var e=this.getDateTimePath();if(e){return e}var i=this._findBindingInfoFromTemplate("dateTime",t);if(i){return i.parts[0].path}return null};B.prototype._findBindingPath=function(t,e){var i=this._findBindingInfoFromTemplate(t,e);if(i){return i.parts[0].path}return null};B.prototype._findBindingData=function(t,e){var i=this._findBindingInfoFromTemplate(t,e);if(i){return{path:i.parts[0].path,formatter:i.formatter}}return null};B.prototype._bindGroupingAndSorting=function(t){if(!this._isGrouped()&&this.getSort()){var e=this._findDateTimeBindingPath(t.template);if(e){t.sorter=this._getDefaultSorter(e,this.getSortOldestFirst())}}t.groupHeaderFactory=null;if(this._isGrouped()){t.sorter=this._getDefaultSorter(this.getGroupBy(),this.getSortOldestFirst());t.groupHeaderFactory=jQuery.proxy(this._createGroupHeader,this)}};B.prototype.updateBindingContext=function(){this.reset();return c.prototype.updateBindingContext.apply(this,arguments)};B.prototype.bindAggregation=function(t,e){if(t==="content"){if(!this._settingsApplied){this._bindOptions=e;return null}this._bindGroupingAndSorting(e);if(this._lazyLoading()){this._iItemCount=this._calculateItemCountToLoad(jQuery(window));if(!this._loadAllData(true)){e.length=this._iItemCount}}else if(this._displayShowMore()&&!this._loadAllData(e.template||e.factory)){this._iItemCount=this.getGrowingThreshold();e.length=this._iItemCount}this._oOptions=e}return c.prototype.bindAggregation.apply(this,[t,e])};B.prototype._calculateItemCountToLoad=function(t){var e=C.Vertical===this.getAxisOrientation(),i=e?t.height():t.width(),r=this.getEnableDoubleSided(),s=r?.6:1,n=e?1200:2e3,o=e?120:280,a=13*s,l;if(!i){i=n}l=i/(o*s)*1.5;return Math.floor(Math.max(l,a))};B.prototype.onBeforeRendering=function(){var t=this.getGrowingThreshold(),e;this._bRtlMode=D.getRTL();this._objects.getSortIcon().setIcon(this._getSorterIcon());this._objects.getSortIcon().setTooltip(this._sortOrder===G.ASCENDING?N.getText("TIMELINE_SORT_ASCENDING"):N.getText("TIMELINE_SORT_DESCENDING"));this._aGroups=[];this._bRendered=false;e=this.getContent();if(!this._iItemCount&&!this._useBinding()&&this._lazyLoading()){this._iItemCount=this._calculateItemCountToLoad(jQuery(window))}if(!this._iItemCount){if(t!==0){this._iItemCount=t}}if(!this._iItemCount||!this._useGrowing()){this._iItemCount=e.filter(function(t){return!t._isGroupHeader}).length}this._setOutput(e)};B.prototype.addContentGroup=function(t){};B.prototype._performScroll=function(t){var e=this,i=this._isVertical()?this._$content.get(0).scrollTop+t:this._$content.get(0).scrollLeft+t;i=Math.max(i,0);if(this._isVertical()){this._$content.get(0).scrollTop=i}else{this._$content.get(0).scrollLeft=i}if(this._manualScrolling){setTimeout(e._performScroll.bind(e,t),50)}};B.prototype._moveScrollBar=function(t){if(this._lastScrollPosition.more||this._lastScrollPosition.backup){if(t){this._lastScrollPosition.more=this._lastScrollPosition.backup}if(!t){this._lastScrollPosition.backup=this._lastScrollPosition.more}this._lastScrollPosition.more=0}};B.prototype.onAfterRendering=function(){var t=this.$();if(this._isVertical()){this._$content=this.$("content");this._$scroll=this.$("scroll")}else{this._$content=this.$("contentH");this._$scroll=this.$("scrollH")}if(this._updateDone||this._loadMoreDone){this.setBusy(false);this._updateDone=false;this._loadMoreDone=false}if(!this._oScroller){this._oScroller=new _(this,this._$scroll.attr("id"),{})}this._oScroller._$Container=this._$scroll.parent();this._oScroller.setVertical(this._isVertical());this._oScroller.setHorizontal(!this._isVertical());this._startItemNavigation();this._scrollersSet=false;this._scrollMoreEvent=true;this._lastStateDblSided=null;this._showCustomMessage();this._setupScrollEvent();this._performUiChanges();this._moveScrollBar();this._bRendered=true;t.css("opacity",1)};B.prototype._clientFilter=function(t){var e=[],i,r,s,n,o,a,l,u,h,p;function g(t){return t.key===i.getProperty("filterValue")}for(var c=0;c<t.length;c++){i=t[c];r=false;s={};if(this._currentFilterKeys.length>0){n=P(this._currentFilterKeys,g);if(n===-1){r=true;s[M.Data]=1}}if(this._startDate&&this._endDate){o=i.getDateTime();if(o<this._startDate||o>this._endDate){r=true;s[M.Time]=1}}if(this._searchValue){a=this._searchValue.toLowerCase();l=i.getProperty("text")||"";u=i.getProperty("title")||"";h=i.getProperty("userName")||"";if(!(l.toLowerCase().indexOf(a)!==-1||u.toLowerCase().indexOf(a)!==-1||h.toLowerCase().indexOf(a)!==-1)){r=true;s[M.Search]=1}}p=!this.fireEvent("itemFiltering",{item:i,reasons:s,dataKeys:this._currentFilterKeys,timeKeys:{from:this._startDate,to:this._endDate},searchTerm:this._searchValue},true);if(p){r=!r}if(!r){e.push(i)}}return e};B.prototype._setOutput=function(t){var e;var i=function(){var t=0,i=[],r=0;if(this._iItemCount!==e.length){for(;r<e.length;r++){if(!e[r]._isGroupHeader){t++}if(t>this._iItemCount){break}i.push(e[r])}e=i}},r=function(){var t=[],i,r,s={key:""};for(var n=0;n<e.length;n++){i=e[n];r=this._formatGroupBy(i.getDateTime(),this.getGroupByType());if(r.key!=s.key){t.push(this._createGroupHeader(r,true));s=r}t.push(i)}return t},s=function(){var e;if(!this._maxDate&&!this._minDate){if(this.getSort()||this._isGrouped()){for(var i=0;i<t.length;i++){e=t[i];if(!e._isGroupHeader){this._sortOrder===G.ASCENDING?this._minDate=e.getDateTime():this._maxDate=e.getDateTime();break}}}}},n,o,a,l;s.call(this);if((!this._useBinding()||!this._useModelFilter())&&this.getSort()){t=this._sort(t)}e=this._useModelFilter()?t:this._clientFilter(t);e=e.filter(function(t){return!t._isGroupHeader});this._showMore=this.getForceGrowing();if(!this._showMore&&this._displayShowMore()){this._showMore=e.length>this._iItemCount;if(!this._showMore&&this._useModelFilter()){this._showMore=e.length===this._iItemCount&&this._iItemCount<this._getMaxItemsCount()}}e=e.filter(function(t){return t.getVisible()});i.call(this);this._outputItem=[];if(this._isGrouped()){if(!this._useBinding()){t=r.call(this)}var u=t.filter(function(t){return t._isGroupHeader});this._groupCount=u.length;for(var h=0;h<u.length;h++){n=u[h];a=n.getUserName();l=true;n._groupID=a;for(var p=0;p<e.length;p++){var g=e[p];o=this._formatGroupBy(g.getDateTime(),this.getGroupByType());if(o.key==a&&!g._isGroupHeader){if(l){this._outputItem.push(n);l=false}g._groupID=a;this._outputItem.push(g)}}}}else{this._outputItem=jQuery.extend(true,[],e)}};B.prototype._getMaxItemsCount=function(){var t=this.getBinding("content"),e,i,r;if(t){r=t.getLength()||0;e=t.getModel();i=e&&e.iSizeLimit;return Math.min(r,i||r)}return this.getContent().length};B.prototype._showCustomMessage=function(){var t=!!this._customMessage,e=this._objects.getMessageStrip().$();this._objects.getMessageStrip().setVisible(t);this._objects.getMessageStrip().setText(this._customMessage);if(t){e.show()}else{e.hide()}};B.prototype._performExpandCollapse=function(t,e){var i=this,r,s,n=this.$(),o=e?"slideDown":"slideUp",a=250;n.find('li[groupid="'+t+'"][nodeType="GroupHeaderBar"]').each(function(t,i){var r=jQuery(i);if(!e){r.addClass("sapSuiteUiCommonsTimelineItemGroupCollapsedBar")}else{r.removeClass("sapSuiteUiCommonsTimelineItemGroupCollapsedBar")}});r=n.find('li[groupid="'+t+'"][nodeType!="GroupHeader"][nodeType!="GroupHeaderBar"]');if(this.getAxisOrientation()==="Vertical"){s=r.parent()}return new Promise(function(t,n){if(i._noAnimation){if(e){if(s){s.show()}else{r.show()}}else{if(s){s.hide()}else{r.hide()}}t()}else{if(i._isVertical()){r[o](a)}else{r.animate({width:"toggle"},350)}r.promise().done(function(){t()})}})};B.prototype._itemRendered=function(){if(this._bRendered){this.adjustUI()}};B.prototype._startItemNavigation=function(t){var e=this._getItemsForNavigation(),i=this.$("content").get(0)||this.$("contentH").get(0),r=function(t,e){return e.filter(function(e){return e.getFocusDomRef()===t})};if(!this.oItemNavigation){this.oItemNavigation=new o(i,e.items,false,e.rows);this.oItemNavigation.setPageSize(10);this.oItemNavigation.attachEvent("AfterFocus",function(t){var e=this.oItemNavigation.getItemDomRefs()[t.getParameter("index")],i=r(e,this._outputItem);if(i[0]){this.fireSelect({selectedItem:i[0],userAction:t.mParameters.event&&t.mParameters.event.type==="mousedown"})}},this);this.oItemNavigation.attachEvent("Enter",function(t){var e=r(t.getParameter("domRef"),this._outputItem);if(e[0]){this.fireSelect({selectedItem:e[0],userAction:true})}},this);this.addDelegate(this.oItemNavigation)}else{this.oItemNavigation.updateReferences(i,e.items,e.rows)}if(e.columns){this.oItemNavigation.setColumns(e.columns,false)}};B.prototype._getItemsForNavigation=function(){var t={},e,i,r,s,n;if(this._renderDblSided){if(this._isVertical()){t.items=this._outputItem;t.rows=[];s=[];t.items.forEach(function(e){var i=e.$(),r=i.hasClass("sapSuiteUiCommonsTimelineItemWrapperVLeft")||i.hasClass("sapSuiteUiCommonsTimelineItemOdd");if(r&&s.length===1){s.push(null)}else if(!r&&s.length===0){s.push(null)}if(s.length>1){t.rows.push(s);s=[]}s.push(e)});if(s.length>0){t.rows.push(s)}}else{i=[];r=[];this._outputItem.forEach(function(t){if(t._placementLine==="top"){i.push(t)}else{while(r.length+1<i.length){r.push(null)}r.push(t)}});t.items=this._outputItem;t.rows=[i,r]}}else{t.items=this._outputItem}t.items=t.items.map(function(t){return t.getFocusDomRef()});if(t.rows){n=0;t.rows=t.rows.map(function(t){if(t.length>n){n=t.length}return t.map(function(t){return t===null?null:t.getFocusDomRef()})});t.rows.forEach(function(t){while(t.length<n){t.push(null)}})}if(this._showMore){e=this._objects.getMoreButton().getFocusDomRef();t.items.push(e);if(t.rows){if(this._isVertical()){if(t.rows.length>0){t.rows.push(t.rows[0].map(function(t,i,r){if(i===r.length-1){return e}else{return null}}))}else{t.rows.push([e])}}else{t.rows.forEach(function(t,i,r){if(i===r.length-1){t.push(e)}else{t.push(null)}})}}}return t};B.prototype.setShowItemFilter=function(t){this.setProperty("showItemFilter",t,true);if(this._objects.isObjectInitialized("FilterContent")){this._setupFilterFirstPage(this._objects.getFilterContent())}this._objects.getFilterIcon().setVisible(t||this.getShowTimeFilter());return this};B.prototype.setShowTimeFilter=function(t){this.setProperty("showTimeFilter",t,true);if(this._objects.isObjectInitialized("FilterContent")){this._setupFilterFirstPage(this._objects.getFilterContent())}this._objects.getFilterIcon().setVisible(t||this.getShowItemFilter());return this};B.prototype._getFilterTitle=function(){var t=this.getFilterTitle();if(!t){t=N.getText("TIMELINE_FILTER_ITEMS")}return t};B.prototype.getNoDataText=function(){var t=this.getProperty("noDataText");if(!t){t=N.getText("TIMELINE_NO_DATA")}return t};B.prototype.setSortOldestFirst=function(t){this._sortOrder=t?G.ASCENDING:G.DESCENDING;this._objects.getSortIcon().setIcon(this._getSorterIcon());this._objects.getSortIcon().setTooltip(this._sortOrder===G.ASCENDING?N.getText("TIMELINE_SORT_ASCENDING"):N.getText("TIMELINE_SORT_DESCENDING"));this.setProperty("sortOldestFirst",t);return this};B.prototype.setGrowingThreshold=function(t){this.setProperty("growingThreshold",t,true);this._iItemCount=t;return this};B.prototype.setShowHeaderBar=function(t){this.setProperty("showHeaderBar",t,true);this._objects.getHeaderBar().setVisible(t);return this};B.prototype.setSort=function(t){this.setProperty("sort",t);this._objects.getSortIcon().setVisible(t&&this.getShowSort());return this};B.prototype.setAxisOrientation=function(t){this.setProperty("axisOrientation",t);if(this._oScroller){this._oScroller.destroy();this._oScroller=null}return this};B.prototype.setEnableDoubleSided=function(t){this.setProperty("enableDoubleSided",t);this._renderDblSided=t;return this};B.prototype.getCurrentFilter=function(){return this._currentFilterKeys.map(function(t){return{key:t.key,text:t.text||t.key}})};B.prototype.reset=function(){this._iItemCount=0;this._aFilterList=[];this._collapsedGroups={};this._renderDblSided=null;this._groupId=0;this._lastScrollPosition={x:0,y:0,more:0};this._sortOrder=this.getSortOldestFirst()?G.ASCENDING:G.DESCENDING;this._scrollersSet=false;this._currentFilterKeys=[];this._bRendered=false;this._noAnimation=true};B.prototype.setShowFilterBar=function(t){this.setProperty("showFilterBar",t,true);this.setShowHeaderBar(t);return this};B.prototype.setShowSearch=function(t){this.setProperty("showSearch",t,true);this._objects.getSearchField().setVisible(!!t);return this};B.prototype.setShowSort=function(t){this.setProperty("showSort",t,true);this._objects.getSortIcon().setVisible(this.getSort()&&t);return this};B.prototype.setCustomMessage=function(t){this._customMessage=t;this._showCustomMessage();return this};B.prototype.getHeaderBar=function(){return this._objects.getHeaderBar()};B.prototype.getMessageStrip=function(){return this._objects.getMessageStrip()};B.prototype.setContent=function(t){this.removeAllContent();var e=0;for(var i=0;i<t.length;i++){var r=t[i];if(r instanceof f){if(this._isGrouped()){var s=this._formatGroupBy(r.getDateTime(),this.getGroupByType());if(s.key!==e.key){this._createGroupHeader(s);e=s}}this.addContent(r)}}this._iItemCount=0;return this};B.prototype.setData=function(t){var e="sapsuiteuicommonsTimelineInternalModel",i=new u,r,s,n=function(t,e){var i=new f({dateTime:e.getProperty("dateTime"),icon:e.getProperty("icon"),userName:e.getProperty("userName"),title:e.getProperty("title"),text:e.getProperty("text"),filterValue:e.getProperty("filterValue")});if(e.getProperty("content")){i.setEmbeddedControl(e.getProperty("content"))}return i},o=function(t,e){var i=t;if(e){i=e+">"+t}return i};if(typeof t==="undefined"){return this}r=o("/",e);i.setData(t);this.setModel(i,e);this.setProperty("data",t,true);s={path:r,sorter:this._getDefaultSorter("dateTime",this.getSortOldestFirst()),factory:jQuery.proxy(n,this)};if(this._isGrouped()){s.groupHeaderFactory=jQuery.proxy(this._getGroupHeader,this)}this.bindAggregation("content",s);return this};B.prototype.getSuspendSocialFeature=function(){return this._suspenseSocial};B.prototype.setSuspendSocialFeature=function(t){this._suspenseSocial=t;if(!this.getEnableSocial()){return}var e=this.getContent();for(var i=0;i<e.length;i++){e[i]._objects.getReplyLink().setEnabled(!t)}this.invalidate();return this};B.prototype.updateFilterList=function(){this.updateAggregation("filterList");this._setFilterList()};B.prototype.setGroupByType=function(t){var e=this.getBindingInfo("content");this.setProperty("groupByType",t);if(e){this._bindGroupingAndSorting(e);this.updateAggregation("content")}return this};B.prototype.getGroup=function(){return this.getGroupByType()!=="None"};B.prototype.setGroup=function(t){if(t&&this.getGroupByType()===v.None){this.setGroupByType(v.Year)}if(!t){this.setGroupByType(v.None)}return this};B.prototype.setGrowing=function(t){if(!t){this.setGrowingThreshold(0)}return this};B.prototype.getGrowing=function(t){return this.getGrowingThreshold()!==0};B.prototype.setEnableBackendFilter=function(t){this.setProperty("enableModelFilter",t);return this};B.prototype.getEnableBackendFilter=function(){return this.getProperty("enableModelFilter")};B.prototype._isGrouped=function(){return(this.getGroupByType()!==v.None||this._fnCustomGroupBy)&&this.getGroupBy()!==""};B.prototype._lazyLoading=function(){return this.getEnableScroll()&&this.getLazyLoading()};B.prototype._loadAllData=function(t){return!this._useModelFilter(t)};B.prototype._isVertical=function(){return C.Vertical===this.getAxisOrientation()};B.prototype._displayShowMore=function(){return this.getForceGrowing()||this.getGrowingThreshold()!==0&&!this._lazyLoading()};B.prototype._useGrowing=function(){return this.getForceGrowing()||this.getGrowingThreshold()!==0||this._lazyLoading()};B.prototype._isMaxed=function(){return this._iItemCount>=this._getMaxItemsCount()};B.prototype._useModelFilter=function(t){return this.getEnableModelFilter()&&(t||this._useTemplateBinding()||this._useFactoryBinding())};B.prototype._scrollingFadeout=function(t){return this.getScrollingFadeout()!==T.None&&this.getEnableScroll()};B.prototype._setBusy=function(t){if(this.getEnableBusyIndicator()){this.setBusy(t)}};B.prototype._fireSelectionChange=function(t){return this.fireEvent("filterSelectionChange",t,true)};B.prototype._isLeftAlignment=function(){return this.getAlignment()===b.Left||this.getAlignment()===b.Top};B.prototype._useBinding=function(t){return this.getBindingInfo("content")!=null};B.prototype._useTemplateBinding=function(){var t=this.getBindingInfo("content");return t&&t.template!=null};B.prototype._useFactoryBinding=function(){var t=this.getBindingInfo("content");return t&&t.factory!=null};B.prototype._useAutomaticHeight=function(){return this.getTextHeight().toLowerCase()==="automatic"&&!this._isVertical()};B.prototype._getItemsCount=function(){return this._outputItem?this._outputItem.length:0};d.extendTimeline(B);return B});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineFilterListItem", ["./library","sap/ui/core/Control"],function(e,t){"use strict";var r=t.extend("sap.suite.ui.commons.TimelineFilterListItem",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Data",defaultValue:null},text:{type:"string",group:"Misc",defaultValue:null}}},renderer:null});return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineItem", ["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/m/Text","sap/m/Toolbar","sap/m/Link","sap/m/TextArea","sap/m/Popover","sap/m/ToolbarSpacer","sap/m/Avatar","sap/m/Button","sap/ui/Device","sap/suite/ui/commons/util/ManagedObjectRegister","sap/suite/ui/commons/util/DateUtils","sap/ui/core/Icon","sap/m/library","sap/ui/core/format/DateFormat","sap/ui/base/Object","sap/ui/dom/containsOrEquals","sap/base/security/encodeXML","./TimelineItemRenderer","sap/ui/events/KeyCodes"],function(jQuery,e,t,i,s,r,o,n,a,l,p,u,c,h,g,d,f,m,_,y,T){"use strict";var x=g.PlacementType;var C=g.ToolbarDesign;var I=g.AvatarShape;var v=g.AvatarSize;var b=e.extend("sap.suite.ui.commons.TimelineItem",{metadata:{library:"sap.suite.ui.commons",properties:{dateTime:{type:"any",group:"Misc",defaultValue:null},filterValue:{type:"string",group:"Misc",defaultValue:null},icon:{type:"string",group:"Misc",defaultValue:null},iconDisplayShape:{type:"sap.m.AvatarShape",defaultValue:I.Circle},iconInitials:{type:"string",defaultValue:""},iconSize:{type:"sap.m.AvatarSize",defaultValue:v.XS},iconTooltip:{type:"string",group:"Misc",defaultValue:null},useIconTooltip:{type:"boolean",group:"Accessibility",defaultValue:true},maxCharacters:{type:"int",group:"Behavior",defaultValue:null},replyCount:{type:"int",group:"Misc",defaultValue:null},status:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},text:{type:"string",group:"Misc",defaultValue:null},userName:{type:"string",group:"Misc",defaultValue:null},userNameClickable:{type:"boolean",group:"Misc",defaultValue:false},userPicture:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null}},defaultAggregation:"embeddedControl",aggregations:{customAction:{type:"sap.ui.core.CustomData",multiple:true,singularName:"customAction"},customReply:{type:"sap.ui.core.Control",multiple:false},embeddedControl:{type:"sap.ui.core.Control",multiple:false},replyList:{type:"sap.m.List",multiple:false},suggestionItems:{type:"sap.m.StandardListItem",multiple:true,singularName:"suggestionItem",deprecated:true}},events:{userNameClicked:{parameters:{uiElement:{type:"sap.ui.core.Control"}}},select:{},press:{},replyPost:{parameters:{value:{type:"string"}}},replyListOpen:{},customActionClicked:{parameters:{value:{type:"string"},key:{type:"string"},linkObj:{type:"sap.m.Link"}}},suggest:{deprecated:true,parameters:{suggestValue:{type:"string"}}},suggestionItemSelected:{deprecated:true,parameters:{selectedItem:{type:"sap.ui.core.Item"}}}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}}}});var S=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons"),L={Warning:"sapSuiteUiCommonsTimelineStatusWarning",Error:"sapSuiteUiCommonsTimelineStatusError",Success:"sapSuiteUiCommonsTimelineStatusSuccess",Information:"sapSuiteUiCommonsTimelineStatusInformation"};b.prototype.init=function(){this._customReply=false;this._objects=new u;this._nMaxCharactersMobile=500;this._nMaxCharactersDesktop=800;this._sTextShowMore=S.getText("TIMELINE_TEXT_SHOW_MORE");this._registerControls();this._registerPopup();this._orientation="V"};b.prototype.setCustomMessage=function(e){this._objects.getInfoText().setText(e);this._objects.getInfoBar().setVisible(e&&e.length>0);this.invalidate()};b.prototype.setDateTime=function(e){var t="";var i=RegExp(/^(?:[0-9]{4}-[0-9]{2}-[0-9]{2})?(?:[ T][0-9]{2}:[0-9]{2}:[0-9]{2})(?:[.][0-9]{1,12})?[Z]/);var s=RegExp(/^(?:[0-9]{4}-[0-9]{2}-[0-9]{2})?(?:[ T][0-9]{2}:[0-9]{2}:[0-9]{2})/);if(i.test(e)){if(e.indexOf(".")>0&&e.split(".")[1]){var r=e.split(".")[1].length-1;for(var o=0;o<r;o++){t=t+"S"}var n="yyyy-MM-dd'T'HH:mm:ss."+t+"X";var a=d.getDateTimeInstance({pattern:n});var l=a.parse(e);if(l instanceof Date){e=l}}else{e=e?c.parseDate(e):e}}else if(s.test(e)){e=e?c.parseDate(e):e}this.setProperty("dateTime",e);return this};b.prototype.applyFocusInfo=function(){this.focus();this.getParent()._moveScrollBar(true)};b.prototype.getFocusDomRef=function(){return this.$("outline")[0]};b.prototype._replyPost=function(){var e=this._objects.getReplyInputArea().getValue();this.fireReplyPost({value:e})};b.prototype._registerPopup=function(){var e=this;this._objects.register("fullText",function(){var i=new t(e.getId()+"-fullText",{text:e.getText()});i.addStyleClass("sapSuiteUiCommonsTimelineItemPopoverText");return i});this._objects.register("fullTextPopover",function(){var t=new o({placement:x.Bottom,showArrow:false,showHeader:false,contentMinWidth:"300px",contentWidth:"450px",resizable:true,content:[e._objects.getFullText()]});t.addStyleClass("sapSuiteUiCommonsTimelineItemShowMorePopover");return t})};b.prototype._openReplyDialog=function(){if(this._customReply){this.getCustomReply().openBy(this._objects.getReplyLink());this.fireReplyListOpen()}else{this.fireReplyListOpen();this._objects.getReplyInputArea().setValue("");this._oldReplyInputArea="";this._list=this.getReplyList();if(this._list!==null){this.setAggregation("replyList",null,true);this._objects.getReplyPop().addContent(this._list)}this._objects.getReplyPop().addContent(this._objects.getReplyInputArea());this._objects.getReplyPop().openBy(this._objects.getReplyLink())}};b.prototype._callParentFn=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),i=this.getParent();if(i&&typeof i[t]==="function"){return i[t].apply(i,e)}};b.prototype._getCorrectGroupIcon=function(){var e="",t=function(){return this.getParent()&&this.getParent()._renderDblSided}.bind(this),i=this._isGroupCollapsed();if(this._orientation==="H"){e="sap-icon://navigation-right-arrow";if(!i){e=this._callParentFn("_isLeftAlignment")||t()?"sap-icon://navigation-down-arrow":"sap-icon://navigation-up-arrow"}}else{e="sap-icon://navigation-down-arrow";if(i){e=this._callParentFn("_isLeftAlignment")||t()?"sap-icon://navigation-right-arrow":"sap-icon://navigation-left-arrow"}}return e};b.prototype.onclick=function(e){var t=this;var i=e.srcControl;if(m(this.$("outline").get(0),e.target)){if(this._isGroupHeader){t._performExpandCollapse(t._groupID)}}if(i&&(i instanceof h||i.getId().indexOf("userNameLink")>-1)||i instanceof sap.m.Avatar){return}if(i instanceof s){this.firePress()}else{this.fireSelect()}};b.prototype.onkeydown=function(e){if(e.which===T.ENTER||e.which===T.SPACE){if(e.srcControl.getId().indexOf("userNameLink")>-1){return}else if(e.srcControl instanceof s){this.firePress()}else{this.fireSelect()}}};b.prototype._performExpandCollapse=function(e){var t=false,i=this._isGroupCollapsed(e);var s=function(e,t){var i=e.find(".sapSuiteUiCommonsTimelineItemBarV"),s,r;if(t.get(0)){s=t.attr("groupId");r=!this._isGroupCollapsed(s);if(r){i.addClass("sapSuiteUiCommonsTimelineGroupNextExpanded")}else{i.removeClass("sapSuiteUiCommonsTimelineGroupNextExpanded")}}}.bind(this),r=function(){var e,i,s;if(!t){e=this._objects.getGroupCollapseIcon&&this._objects.getGroupCollapseIcon();i=this.$();s=this._isGroupCollapsed();if(!s){i.removeClass("sapSuiteUiCommonsTimelineGroupCollapsed");i.addClass("sapSuiteUiCommonsTimelineGroupExpanded")}else{i.addClass("sapSuiteUiCommonsTimelineGroupCollapsed");i.removeClass("sapSuiteUiCommonsTimelineGroupExpanded")}e.setSrc(this._getCorrectGroupIcon());t=true}}.bind(this),o=function(){if(this.getParent()){this.getParent()._collapsedGroups[e]=!i}}.bind(this),n=this.$(),a=this,l=n.parent(),p,u,c,h,g,d;o();if(this._orientation==="H"){p=this.$("line")}else{p=n.find(".sapSuiteUiCommonsTimelineGroupHeaderBarWrapper");u=l.next().children("li").first();c=l.prev().children(":visible:last");if(c.get(0)){s(c,n)}if(i){h=l.children().last();s(h,u)}else{s(n,u)}}if(i){p.hide()}else{p.show()}d=n.find(".sapSuiteUiCommonsTimelineGroupHeaderMainWrapper");d.attr("aria-expanded",!!i);n.attr("aria-expanded",!!i);if(i){d.attr("aria-label",S.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+d.prevObject[0].outerText+" "+S.getText("TIMELINE_ACCESSIBILITY_GROUP_EXPAND"),true)}else{d.attr("aria-label",S.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+d.prevObject[0].outerText+" "+S.getText("TIMELINE_ACCESSIBILITY_GROUP_COLLAPSE"),true)}if(this._orientation!=="H"||i){r()}g=this._callParentFn("_performExpandCollapse",e,i,this);if(g){return new Promise(function(e,t){g.then(function(){r();a._callParentFn("_performUiChanges");e()})})}};b.prototype._getStatusColorClass=function(){var e=this.getStatus();return L[e]||""};b.prototype._getLineIcon=function(){var e=this,t;this._objects.register("lineIcon",function(){var i="sap-icon://circle-task",s=e.getText()==="GroupHeader";if(!s){i=e.getIcon()?e.getIcon():"sap-icon://activity-items"}t=new h(e.getId()+"-icon",{src:i,tooltip:e.getIconTooltip(),useIconTooltip:e.getUseIconTooltip()});t.addStyleClass("sapSuiteUiCommonsTimelineBarIcon");return t});return this._objects.getLineIcon()};b.prototype._isGroupCollapsed=function(e){var t=this.getParent();e=e||this._groupID;return t&&t._collapsedGroups&&t._collapsedGroups[e]};b.prototype._getCollapsedText=function(){var e=this.getText().substring(0,this._nMaxCollapsedLength);var t=e.lastIndexOf(" ");if(t>0){this._sShortText=e.substr(0,t)}else{this._sShortText=e}return this._sShortText};b.prototype._toggleTextExpanded=function(e){var t=this,i=e.getSource(),s=i.$(),r=this.$("realtext"),o=s.height(),n=s.position().top,a=r.parent().position().top,l=s.parent().prev(),p,u,c=this.getParent()&&this.getParent()._noAnimation,h=8,g=function(){return t.getParent()&&t.getParent()._renderDblSided},d=function(e,i,s){l.css("-webkit-line-clamp",s+"px");if(g()||c){l.css("height",e+"px");t._callParentFn("_performUiChanges")}else{l.animate({height:i},250,t._callParentFn("_performUiChanges"))}};if(this._orientation==="V"){u=this.$("threeDots");p=l.children().first();if(!this._expanded){this._textProperties={height:l.css("height"),clamp:l.css("-webkit-line-clamp"),text:p.html()};l.attr("expanded",true);u.hide();p.html(this._encodeHTMLAndLineBreak(this.getText()));var f=S.getText("TIMELINE_TEXT_SHOW_LESS");i.setText(f);i.rerender();d("",p.height(),"")}else{l.attr("expanded",false);i.setText(this._sTextShowMore);i.rerender();u.show();p.html(this._textProperties.text);d(this._textProperties.height,this._textProperties.height,this._textProperties.clamp)}t._expanded=!t._expanded}else{var m=a-n-o-h,_=jQuery(window).height()-s.offset().top,y=200;if(_<y){m-=y-_}this._objects.getFullText().setText(this.getText());this._objects.getFullTextPopover().setOffsetY(Math.floor(m));this._objects.getFullTextPopover().openBy(this._objects.getExpandButton())}};b.prototype._getButtonExpandCollapse=function(){var e=this;this._objects.register("expandButton",function(){return new s(e.getId()+"-fullTextBtn",{text:e._sTextShowMore,press:e._toggleTextExpanded.bind(e)})});return this._objects.getExpandButton()};b.prototype._checkTextIsExpandable=function(){this._nMaxCollapsedLength=this.getMaxCharacters();if(this._nMaxCollapsedLength===0){this._nMaxCollapsedLength=p.system.phone?this._nMaxCharactersMobile:this._nMaxCharactersDesktop}return this.getText().length>this._nMaxCollapsedLength};b.prototype.onBeforeRendering=function(){var e=this;if(!this._list){this._list=this.getReplyList()}if(this.getReplyCount()>0){this._objects.getReplyLink().setText(S.getText("TIMELINE_REPLY")+" ("+this.getReplyCount()+")")}else if(this._list&&this._list.getItems().length>0){this._objects.getReplyLink().setText(S.getText("TIMELINE_REPLY")+" ("+this._list.getItems().length+")")}this._objects.getSocialBar().removeAllContent();if(this._callParentFn("getEnableSocial")){this._objects.getSocialBar().addContent(this._objects.getReplyLink())}this._actionList=this.getCustomAction();function t(t,i){e.fireCustomActionClicked({value:i.value,key:i.key,linkObj:this})}for(var i=0;i<this._actionList.length;i++){var r=this._actionList[i].getKey();var o=this._actionList[i].getValue();var n=new s({text:o});n.addStyleClass("sapSuiteUiCommonsTimelineItemActionLink");n.attachPress({value:o,key:r},t);this._objects.getSocialBar().addContent(n)}};b.prototype._encodeHTMLAndLineBreak=function(e){return _(e).replace(/&#xa;/g,"<br>")};b.prototype._getUserPictureControl=function(){var e=this.getId()+"-userPictureControl",t=this.getUserPicture(),i=this.getIconInitials(),s=this.getIconDisplayShape(),r=this.getIconSize();if(!t){return null}this._objects.register("userPictureControl",function(){var o=new a({id:e,src:t,initials:i,displayShape:s,displaySize:r,tooltip:S.getText("TIMELINE_USER_PICTURE")});return o});return this._objects.getUserPictureControl()};b.prototype._getUserNameLinkControl=function(){var e=this;if(this.getUserNameClickable()){this._objects.register("userNameLink",function(){var t=new s(e.getId()+"-userNameLink",{text:e.getUserName(),press:function(t){e.fireUserNameClicked({uiElement:this})}});t.addStyleClass("sapUiSelectable");return t});return this._objects.getUserNameLink()}};b.prototype.onAfterRendering=function(){this._expanded=false;this._callParentFn("_itemRendered")};b.prototype._registerControls=function(){var e=this;this._objects.register("infoText",new t(this.getId()+"-infoText",{maxLines:1,width:"100%"}));this._objects.register("infoBar",new i(this.getId()+"-infoBar",{id:this.getId()+"-customMessageInfoBar",content:[this._objects.getInfoText()],design:C.Info,visible:false}));this._objects.register("replyLink",function(){var t=new s(e.getId()+"-replyLink",{text:S.getText("TIMELINE_REPLY"),press:[e._openReplyDialog,e]});t.addStyleClass("sapSuiteUiCommonsTimelineItemActionLink");return t});this._objects.register("socialBar",function(){var t=new i(e.getId()+"-socialBar",{});t.data("sap-ui-fastnavgroup",null);return t});this._objects.register("replyInputArea",new r(this.getId()+"-replyInputArea",{height:"4rem",width:"100%"}));this._objects.register("replyPop",function(){return new o(e.getId()+"-replyPop",{initialFocus:e._objects.getReplyInputArea(),title:S.getText("TIMELINE_REPLIES"),placement:x.Vertical,footer:new i({content:[new n,new l(e.getId()+"-replyButton",{text:S.getText("TIMELINE_REPLY"),press:function(){e._replyPost();e._objects.getReplyPop().close()}})]}),contentHeight:"15rem",contentWidth:"20rem"})})};b.prototype.exit=function(){this._objects.destroyAll()};b.prototype.getDateTimeWithoutStringParse=function(){var e=this.getProperty("dateTime");return c.parseDate(e,false)||""};b.prototype.setCustomReply=function(e){if(e){this._customReply=true;this.setAggregation("customReply",e,true)}else{this._customReply=false}return this};b.prototype.setReplyList=function(e){if(e===null){return this}this.setAggregation("replyList",e,true);var t=this;this.getReplyList().attachUpdateFinished(function(e){var i=t._objects.getReplyInputArea().getDomRef("inner");if(i){jQuery(i.id).focus()}});return this};b.prototype.getDateTime=function(){var e=this.getProperty("dateTime");e=c.parseDate(e);if(typeof e==="string"&&this instanceof b&&this.getBinding("dateTime")){var t=this.getBinding("dateTime").getValue();if(t instanceof Date){return t}else{return c.parseDate(t)}}else{return e}};b.prototype.onkeyup=function(e){if(e.which==T.ENTER||e.which==T.SPACE){if(m(this.$("outline").get(0),e.target)){if(this._isGroupHeader){this._performExpandCollapse(this._groupID)}}}};return b});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineItemRenderer", ["./library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/format/DateFormat","sap/ui/core/Icon","sap/base/security/encodeXML","sap/base/security/encodeCSS","sap/ui/core/InvisibleText","sap/ui/core/date/UI5Date"],function(e,i,t,a,d,s,l,n){"use strict";var o=e.TimelineAlignment;var r={};r.apiVersion=2;var m=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons"),C=24*60*60*1e3;r.render=function(e,i){this._getTimelineItemElement(i).getRenderer().render(e)};r._getTimelineItemElement=function(e){if(e._orientation==="V"){return this._getVerticalTimelineItemElement(e)}else{return this._getHorizontalTimelineItemElement(e)}};r._getFormatedDateTime=function(e,i){i=i||{};var a=i.resBundle||m,d=i.dateFormat||t.getDateInstance({style:"short"}),s=i.timeFormat||t.getTimeInstance({style:"short"}),l=e.getDateTimeWithoutStringParse(),o,r,p,u;if(!(l instanceof Date)||isNaN(l.getTime())){return l}o=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate());r=n.getInstance();r=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());p=Math.floor((r-o)/C);switch(p){case 0:u=a.getText("TIMELINE_TODAY");break;case 1:u=a.getText("TIMELINE_YESTERDAY");break;default:u=d.format(l)}return u+" "+a.getText("TIMELINE_AT")+" "+s.format(l)};r._getHorizontalTimelineItemElement=function(e){var t=e._placementLine==="top",a=t?"sapSuiteUiCommonsTimelineItemHTop":"sapSuiteUiCommonsTimelineItemHBottom",l=e.getText()==="GroupHeader",n=e._groupID,o,r;if(l){return this._getGroupHeaderElement(e)}var m=new i("li"),C=new i("div"),p=new i("div"),u=new i("div"),I=new i("div"),T=new i("div"),S=new i("div"),g=this._getTimelineItemShell(e);if(n){m.setAttribute("groupid",e._groupID)}if(e._isFirstGroupEvenItem){m.setAttribute("firstgroupevenitem",e._isFirstGroupEvenItem)}m.addControlData(e);m.addClass("sapSuiteUiCommonsTimelineItemLiWrapperV");m.addClass(d(a));C.addClass("sapSuiteUiCommonsTimelineItemWrapperH");C.addClass("sapSuiteUiCommonsTimelineItemBaseLength");m.addChild(C);p.addClass("sapSuiteUiCommonsTimelineItemBubbleSpacer");C.addChild(p);u.addClass("sapSuiteUiCommonsTimelineItemBubble");p.addChild(u);I.addClass("sapSuiteUiCommonsTimelineItemOutline");I.setId(e.getId()+"-outline");I.setAttribute("tabindex","0");this._addAccessibilityTags(I,e);T.addClass("sapSuiteUiCommonsTimelineItemBox");I.addChild(T);S.addClass("sapSuiteUiCommonsTimelineItemArrow");if(t){u.addChild(I);u.addChild(S)}else{u.addChild(S);u.addChild(I)}if(!e._callParentFn("_isGrouped")&&e._callParentFn("getEnableDoubleSided")&&e._index===1){r=e.getParent();o="margin-left";if(r&&r._bRtlMode){o="margin-right"}m.addStyle(s(o),"100px")}T.addChild(g);if(e._isGroupCollapsed()){m.addStyle("display","none")}return m};r._getGroupHeaderElement=function(e){var t=new i("li"),s=new i("div"),l=new i("div"),n=new i("div"),r=new i("div"),m=new i("div"),C=new i("span"),p=new i("div"),u=new i("div"),I=new i("div"),T=e._orientation==="V"?l:n,S=new i("div"),g=new i("div"),h=new i("div");var c=e._isGroupCollapsed(),_=e._callParentFn("getShowIcons"),U;if(e._groupID){t.setAttribute("groupid",e._groupID)}if(e._isLastGroup){t.addClass("sapSuiteUiCommonsTimelineLastItem")}t.addControlData(e);t.addClass("sapSuiteUiCommonsTimelineGroupHeader");t.addChild(s);s.addChild(l);s.addClass("sapSuiteUiCommonsTimelineGroupHeaderDirectChild");l.addClass("sapSuiteUiCommonsTimelineGroupHeaderMainWrapper");l.setId(e.getId()+"-outline");l.setAttribute("tabindex","0");this._addAccessibilityTags(l,e,true);l.setAttribute("data-sap-ui-fastnavgroup",true);l.addChild(n);t.addChild(I);t.setAttribute("nodetype","GroupHeader");r.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpanWrapper");if(e._orientation==="V"){t.addClass(e._position===o.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");t.setAttribute("role","treeitem");t.setAttribute("aria-expanded",c?false:true);t.setAttribute("aria-level",1)}else{t.setAttribute("role","presentation")}n.addClass("sapSuiteUiCommonsTimelineGroupHeaderWrapper");n.addClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");T.addChild(m);n.addChild(u);n.addChild(r);t.addClass(c?"sapSuiteUiCommonsTimelineGroupCollapsed":"sapSuiteUiCommonsTimelineGroupExpanded");u.addClass("sapSuiteUiCommonsTimelineGroupHeaderIconWrapper");U=e._getCorrectGroupIcon();e._objects.register("groupCollapseIcon",function(){var i=new a(e.getId()+"-groupCollapseIcon",{src:U,decorative:true});i.addStyleClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");i.setParent(e);return i});u.addChild(e._objects.getGroupCollapseIcon());m.addClass("sapSuiteUiCommonsTimelineItemArrow");I.addClass("sapSuiteUiCommonsTimelineGroupHeaderLineWrapper");p.addClass("sapSuiteUiCommonsTimelineGroupHeaderLine");I.addChild(p);r.addChild(C);C.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpan");C.addChildEscaped(" "+e.getTitle());if(e._orientation==="V"){t.addChild(S);g.addChild(e._getLineIcon());S.addChild(g);g.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");S.addClass("sapSuiteUiCommonsTimelineGroupHeaderBarWrapper");if(!e._isGroupCollapsed()){S.addStyle("display","none")}h.addClass("sapSuiteUiCommonsTimelineItemBarV");if(!_){h.addClass("sapSuiteUiCommonsTimelineItemBarNoIcon")}S.addChild(h);if(e._additionalBarClass){h.addClass(d(e._additionalBarClass))}}return t};r._getVerticalTimelineItemElement=function(e){var t=new i("li"),a=new i("div"),s=new i("div"),l=new i("div"),n=new i("div"),r=new i("div"),m=new i("div"),C=new i("div"),p=new i("div"),u=new i("div"),I=new i("div"),T,S=new i("ul");var g=e._callParentFn("getShowIcons"),h=e._groupID,c=e.getText()==="GroupHeader",_=e._getStatusColorClass();if(c){return this._getGroupHeaderElement(e)}if(h){t.setAttribute("groupid",h);t.setAttribute("aria-level",2)}else{t.setAttribute("role","presentation")}t.addClass("sapSuiteUiCommonsTimelineItem");t.setAttribute("aria-labelledby",e.getAriaLabelledBy().join(" "),true);if(e._isLast){t.addClass("sapSuiteUiCommonsTimelineLastItem")}a.addClass(c?"sapSuiteUiCommonsTimelineItemWrapperGrp":"sapSuiteUiCommonsTimelineItemWrapperV");t.addChild(a);a.addClass(e._position===o.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");a.addChild(n);a.addChild(s);s.addClass("sapSuiteUiCommonsTimelineItemBarWrapperV");l.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");if(_){l.addClass(d(_))}else{l.addClass("sapSuiteUiCommonsTimelineNoStatus")}if(g){s.addChild(l);l.addChild(e._getLineIcon("",h))}else{I.addChild(u);I.addClass("sapSuiteUiCommonsTimelineItemNoIconWrapper");u.addClass("sapSuiteUiCommonsTimelineItemNoIcon");s.addChild(I);if(_){u.addClass(d(_))}r.addClass("sapSuiteUiCommonsTimelineItemBarNoIcon")}r.addClass("sapSuiteUiCommonsTimelineItemBarV");s.addChild(r);if(e._additionalBarClass){r.addClass(d(e._additionalBarClass))}n.addClass("sapSuiteUiCommonsTimelineItemBubble");p.addClass("sapSuiteUiCommonsTimelineItemArrow");n.addChild(p);n.addChild(C);C.addClass("sapSuiteUiCommonsTimelineItemOutline");C.setId(e.getId()+"-outline");C.setAttribute("tabindex","0");this._addAccessibilityTags(C,e);m.addClass("sapSuiteUiCommonsTimelineItemBox");C.addChild(m);T=this._getTimelineItemShell(e);m.addChild(T);if(e._isGroupCollapsed()){S.addStyle("display","none")}if(h){S.addControlData(e);S.addClass("sapSuiteUiCommonsTimelineItemUlWrapper");S.addChild(t);return S}else{t.addControlData(e)}return t};r._getTimelineItemShell=function(e){var t=new i("div"),a=new i("div"),d=new i("div"),s=new i("span"),l,n,o=new i("span"),r=new i("div"),m=new i("div"),C=new i("div"),p=new i("span"),u=new i("div"),I=new i("span"),T=new i("div"),S;var g=e.getEmbeddedControl();t.setId(e.getId()+"-shell");t.addClass("sapSuiteUiCommonsTimelineItemShell");t.addChild(e._objects.getInfoBar());t.addChild(a);a.addClass("sapSuiteUiCommonsTimelineItemHeaderWrapper");l=e._getUserPictureControl();if(l){l.addStyleClass("sapSuiteUiCommonsTimelineItemUserPicture");a.addChild(l)}d.setId(e.getId()+"-header");d.addClass("sapSuiteUiCommonsTimelineItemHeader");d.addClass("sapSuiteUiCommonsTimelineItemTextLineClamp");s.setId(e.getId()+"-username");s.addClass("sapSuiteUiCommonsTimelineItemShellUser");d.addChild(s);n=e._getUserNameLinkControl();if(n){s.addChild(n)}else{s.addChildEscaped(e.getUserName());s.addClass("sapUiSelectable")}a.addChild(d);o.addClass("sapSuiteUiCommonsTimelineItemShellHdr");o.addClass("sapUiSelectable");o.addChildEscaped(" "+e.getTitle());d.addChild(o);r.addClass("sapSuiteUiCommonsTimelineItemShellDateTime");r.addClass("sapUiSelectable");r.addChildEscaped(this._getFormatedDateTime(e));d.addChild(r);m.addClass("sapSuiteUiCommonsTimelineItemShellBody");t.addChild(m);if(g!==null){m.addChild(g)}else if(e.getText()){C.addChild(p);C.addClass("sapSuiteUiCommonsTimelineItemTextWrapper");p.setId(e.getId()+"-realtext");p.addClass("sapUiSelectable");m.addChild(C);S=e._checkTextIsExpandable();if(S){I.setId(e.getId()+"-threeDots");I.addClass("sapMFeedListItemTextString");I.addChildEscaped(" ");C.addChild(I);p.addChildEscaped(e._getCollapsedText(),true);I.addChildEscaped("... ");C.setAttribute("expandable",true)}else{p.addChildEscaped(e.getText(),true);u.addStyle("display","none")}m.addChild(u);u.addClass("sapSuiteUiCommonsTimelineItemShowMore");u.addChild(e._getButtonExpandCollapse())}if(e.getParent()&&e.getParent()._aFilterList&&(e._callParentFn("getEnableSocial")||e.getCustomAction().length>0)){T.addClass("sapSuiteUiCommonsTimelineItemShellBottom");T.addChild(e._objects.getSocialBar());t.addChild(T)}return t};r._addAccessibilityTags=function(e,i,t){var a;e.setAttribute("role","option");if(i.getStatus()){var d=new l;d.setText("status "+i.getStatus());d.toStatic();e.setAttribute("aria-describedby",d.getId(),true)}if(typeof i._index==="number"){e.setAttribute("aria-posinset",i._index+1);e.setAttribute("aria-setsize",i._callParentFn("_getItemsCount"))}if(t){e.setAttribute("aria-expanded",!i._isGroupCollapsed());if(!i._isGroupCollapsed()){a=m.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+i.getTitle()+" "+m.getText("TIMELINE_ACCESSIBILITY_GROUP_EXPAND")}else{a=m.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+i.getTitle()+" "+m.getText("TIMELINE_ACCESSIBILITY_GROUP_COLLAPSE")}e.setAttribute("aria-label",a,false)}};return r},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineNavigator", ["sap/ui/thirdparty/jquery","sap/ui/core/delegate/ItemNavigation","sap/base/assert","sap/ui/dom/containsOrEquals","sap/ui/events/KeyCodes"],function(jQuery,t,e,i,s){"use strict";function o(t,e){var i=t.length-e.length;return i>=0&&t.lastIndexOf(e)===i}var n=t.extend("sap.suite.ui.commons.TimelineNavigator",{constructor:function(e,i,s,o){t.apply(this,arguments);this.setDisabledModifiers({sapnext:["alt"],sapprevious:["alt"]});this.setCycling(false);this._aRows=o;this.iActiveTabIndex=0;this.iTabIndex=0;this.bRefocusOnNextUpdate=false;this.oLastFocused=null}});n.prototype.updateReferences=function(t,e,i){this.oDomRef=t;this.setItemDomRefs(e);this._aRows=i;if(this.bRefocusOnNextUpdate){this._refocusItem();this.bRefocusOnNextUpdate=false}this.setBeforeAfterTabIndex()};n.prototype.refocusOnNextUpdate=function(){this.bRefocusOnNextUpdate=true};n.prototype._refocusItem=function(){var t=this.iFocusedIndex;if(t<0){return}while(!jQuery(this.aItemDomRefs[t]).is(":visible")){t++;if(t>=this.aItemDomRefs.length){t=0}if(t===this.iFocusedIndex){break}}setTimeout(function(){if(this.aItemDomRefs){this.focusItem(t)}}.bind(this),0)};n.prototype.setItemDomRefs=function(t){e(Array.isArray(t),"aItemDomRefs must be an array of DOM elements");this.aItemDomRefs=t;if(this.iFocusedIndex>t.length-1){this.iFocusedIndex=t.length-1}for(var i=0;i<this.aItemDomRefs.length;i++){if(this.aItemDomRefs[i]){var s=jQuery(this.aItemDomRefs[i]);if(i==this.iFocusedIndex&&!s.data("sap.INRoot")){s.attr("tabIndex",this.iActiveTabIndex)}else if(s.attr("tabindex")=="0"){s.attr("tabIndex",this.iTabIndex)}s.data("sap.INItem",true);s.data("sap.InNavArea",true);if(s.data("sap.INRoot")&&i!=this.iFocusedIndex){s.data("sap.INRoot").setNestedItemsTabindex()}}}return this};n.prototype.setItemsTabindex=function(){for(var t=0;t<this.aItemDomRefs.length;t++){if(this.aItemDomRefs[t]){var e=jQuery(this.aItemDomRefs[t]);if(e.is(":sapFocusable")){if(t==this.iFocusedIndex&&!e.data("sap.INRoot")){e.attr("tabIndex",this.iActiveTabIndex)}else{e.attr("tabIndex",this.iTabIndex)}}}}return this};n.prototype.setBeforeAfterTabIndex=function(){if(this.oDomRef){var t=this.oDomRef.id+"-after";jQuery(window.document.getElementById(t)).attr("tabindex",-1);t=this.oDomRef.id+"-before";jQuery(window.document.getElementById(t)).attr("tabindex",-1);jQuery(this.oDomRef).attr("tabindex",-1)}};n.prototype.setFocusedIndex=function(t){var e;if(this.aItemDomRefs.length<0){this.iFocusedIndex=-1;return this}if(t<0){t=0}if(t>this.aItemDomRefs.length-1){t=this.aItemDomRefs.length-1}if(this.iFocusedIndex!==-1&&this.aItemDomRefs.length>this.iFocusedIndex){jQuery(this.aItemDomRefs[this.iFocusedIndex]).attr("tabIndex",this.iTabIndex);e=jQuery(this.aItemDomRefs[this.iFocusedIndex]);if(e.data("sap.INRoot")&&t!=this.iFocusedIndex){jQuery(e.data("sap.INRoot").aItemDomRefs[e.data("sap.INRoot").iFocusedIndex]).attr("tabIndex",this.iTabIndex)}}this.iFocusedIndex=t;var i=this.aItemDomRefs[this.iFocusedIndex];e=jQuery(this.aItemDomRefs[this.iFocusedIndex]);if(!e.data("sap.INRoot")){jQuery(i).attr("tabIndex",this.iActiveTabIndex)}return this};n.prototype._callParent=function(e,i){if(typeof t.prototype[e]==="function"){t.prototype[e].apply(this,i)}};n.prototype._onF7=function(t){if(!i(this.oDomRef,t.target)){return}var e=this.getFocusedIndex();if(e>=0){this.focusItem(e,t);t.preventDefault();t.stopPropagation()}};n.prototype.onsapspace=function(t){this.onsapenter(t)};n.prototype.onsapenter=function(t){var e,i;if(this._skipNavigation(t,false,true)){return}i=jQuery(this.getFocusedDomRef());e=i.attr("id");if(o(e,"-outline")){if(i.hasClass("sapSuiteUiCommonsTimelineGroupHeaderMainWrapper")){e=e.substr(0,e.length-"outline".length)+"groupCollapseIcon";i.find("#"+e).keyup()}else{i.find("div[role='toolbar']").children().first().mousedown().mouseup().click();this.fireEvent("Enter",{domRef:i.get(0)})}t.preventDefault();t.stopPropagation()}};n.prototype.onsaphome=function(t){if(this.aItemDomRefs.length===0){return}if(this._skipNavigation(t,false,false)){return}this._callParent("onsaphome",arguments)};n.prototype.onkeydown=function(t){this._callParent("onkeydown",arguments);if(t.keyCode===s.F7){this._onF7(t)}};n.prototype.onmousedown=function(t){var e=t.target;var s=function(t,e){var i=false;var s=jQuery(t);while(!s.is(":sapFocusable")&&s.get(0)!=e){s=s.parent()}if(s.get(0)!=e){i=true}return i};if(i(this.oDomRef,e)){for(var o=0;o<this.aItemDomRefs.length;o++){var n=this.aItemDomRefs[o];if(i(n,e)){if(n===e||!s(e,n)){this.focusItem(o,t)}return}}this._bMouseDownHappened=true;setTimeout(function(){this._bMouseDownHappened=false}.bind(this),20)}};n.prototype.onsapnext=function(t){var e,i=true,o,n,a;if(!this._aRows){this._callParent("onsapnext",arguments);return}if(this._skipNavigation(t,true,false)){return}t.preventDefault();t.stopPropagation();if(this.getFocusedIndex()<0){return}o=this._findPosition(this.iFocusedIndex);if(o===null){throw new Error("TimelineNavigation cannot obtain a position of focused item and hance it cannot senect next.")}n=Object.assign({},o);do{if(t.keyCode===s.ARROW_DOWN){n.iY++;if(n.iY>=this._aRows.length){if(n.iX+1>=this._aRows[this._aRows.length-1].length){return}n.iY=0;n.iX++}}else{n.iX++;if(n.iX>=this._aRows[n.iY].length){if(n.iY+1>=this._aRows.length){return}n.iX=0;n.iY++}}if(n.iX===o.iX&&n.iY===o.iY){if(i){i=false}else{return}}a=this._aRows[n.iY][n.iX]}while(!a||!jQuery(a).is(":sapFocusable"));e=this._findIndex(n);this.focusItem(e,t)};n.prototype.onsapprevious=function(t){var e,i=true,o,n,a;if(!this._aRows){this._callParent("onsapprevious",arguments);return}if(this._skipNavigation(t,true,false)){return}t.preventDefault();t.stopPropagation();if(this.getFocusedIndex()<0){return}o=this._findPosition(this.iFocusedIndex);if(o===null){throw new Error("TimelineNavigation cannot obtain a position of focused item and hance it cannot senect next.")}n=Object.assign({},o);do{if(t.keyCode===s.ARROW_UP){n.iY--;if(n.iY<0){if(n.iX<=0){return}n.iY=this._aRows.length-1;n.iX--}}else{n.iX--;if(n.iX<0){if(n.iY<=0){return}n.iX=this._aRows[n.iY].length-1;n.iY--}}if(n.iX===o.iX&&n.iY===o.iY){if(i){i=false}else{return}}a=this._aRows[n.iY][n.iX]}while(!a||!jQuery(a).is(":sapFocusable"));e=this._findIndex(n);this.focusItem(e,t)};n.prototype._isInDomRefs=function(t){return this.aItemDomRefs.indexOf(t)>-1};n.prototype._isInTimeline=function(t){while(t){if(this._isInDomRefs(t)){return true}t=t.parentElement}return false};n.prototype._hasTabbableChildren=function(t){var e=jQuery(t.closest(".sapSuiteUiCommonsTimelineItemOutline")).find(":sapTabbable");if(e&&e.index(t)>=0){if(e.index(t)==e.length-1){return false}else{return true}}else if(e.length==0){return false}else{return true}};n.prototype._isLastChildInTimeline=function(t){return this._isInTimeline(t.target)&&!this._hasTabbableChildren(t.target)};n.prototype.onsaptabnext=function(t){if(t.target.id&&this._isLastChildInTimeline(t)){if(t.target.closest(".sapSuiteUiCommonsTimelineItemOutline")){t.target.closest(".sapSuiteUiCommonsTimelineItemOutline").focus();t.preventDefault()}}};n.prototype.onsaptabprevious=function(t){if(this._isInDomRefs(t.target)){var e=jQuery(t.target).find(":sapTabbable");if(this.aItemDomRefs.indexOf(t.target)==0){var i=this.oDomRef.id+"-before";jQuery(window.document.getElementById(i)).focus();return}if(e.length){e[e.length-1].focus();t.preventDefault()}else{t.target.focus();t.preventDefault();return}}};n.prototype.onfocusin=function(t){if(this._isInTimeline(t.target)){this.oLastFocused=t.target}if(!t.relatedTarget||!this._isInTimeline(t.relatedTarget)){if(this._isInTimeline(t.target)&&this.oLastFocused&&this.oLastFocused!==t.target){jQuery(this.oLastFocused).focus()}}};n.prototype._findPosition=function(t){var e,i,s=this.aItemDomRefs[t];for(i=0;i<this._aRows.length;i++){for(e=0;e<this._aRows[i].length;e++){if(s===this._aRows[i][e]){return{iX:e,iY:i}}}}return null};n.prototype._findIndex=function(t){var e=this._aRows[t.iY][t.iX],i;for(i=0;i<this.aItemDomRefs.length;i++){if(e===this.aItemDomRefs[i]){return i}}return null};n.prototype._skipNavigation=function(t,e,s){return!i(this.oDomRef,t.target)||this.getFocusedIndex()<0&&s||this.aItemDomRefs&&Array.prototype.indexOf.call(this.aItemDomRefs,t.target)===-1||jQuery(this.oDomRef).data("sap.InNavArea")&&e};return n});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineRenderManager",["sap/ui/thirdparty/jquery","./library","sap/m/Text","sap/ui/core/Icon","sap/m/ViewSettingsDialog","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/m/ToolbarSpacer","sap/m/SearchField","sap/m/OverflowToolbar","sap/m/Select","sap/m/RangeSlider","sap/m/Label","sap/m/Panel","sap/m/FlexBox","sap/m/OverflowToolbarButton","sap/m/MessageStrip","sap/m/ViewSettingsFilterItem","sap/m/ViewSettingsCustomItem","sap/m/OverflowToolbarLayoutData","sap/m/library","sap/m/MessageToast","sap/ui/core/InvisibleText","sap/m/SliderTooltip","sap/suite/ui/commons/TimelineRenderManagerTimestamp","sap/suite/ui/commons/util/StringSliderTooltip","sap/m/ResponsiveScale","sap/ui/core/library"],function(jQuery,e,t,i,s,r,n,o,a,l,m,p,c,g,u,f,h,d,_,S,T,C,b,I,v,y,U,D){"use strict";var x=D.CSSSize;var F=T.ButtonType;var L=T.OverflowToolbarPriority;var R=e.TimelineGroupType;var w=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var E=680;var M=Object.freeze({UP:"UP",DOWN:"DOWN",NONE:"NONE"});function P(e,t,i){e.removeClass(t).addClass(i)}function H(e,t){return parseInt(e.css(t).replace("px",""),10)}var j={extendTimeline:function(e){e.prototype._initControls=function(){this._setupMessageStrip();this._setupFilterDialog();this._setupHeaderToolbar();this._setupAccessibilityItems()};e.prototype._registerResizeListener=function(){var e=this.$().parent().get(0);if(e){this.oResizeListener=r.register(e,jQuery.proxy(this._performResizeChanges,this))}};e.prototype._deregisterResizeListener=function(){if(this.oResizeListener){r.deregister(this.oResizeListener)}};e.prototype._performUiChanges=function(e){this._deregisterResizeListener();if(!this.getDomRef()){return}if(this._isVertical()){this._performUiChangesV(e)}else{this._performUiChangesH()}this._setupScrollers();this._startItemNavigation();this._registerResizeListener()};e.prototype._performDoubleSidedChangesLi=function(e,t){var i=e.children().first(),s=this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight";if(this._renderDblSided){if(e.hasClass("sapSuiteUiCommonsTimelineItem")){e.removeClass("sapSuiteUiCommonsTimelineItem").addClass(t?"sapSuiteUiCommonsTimelineItemOdd":"sapSuiteUiCommonsTimelineItemEven");if(!t){P(i,"sapSuiteUiCommonsTimelineItemWrapperVLeft","sapSuiteUiCommonsTimelineItemWrapperVRight")}else{P(i,"sapSuiteUiCommonsTimelineItemWrapperVRight","sapSuiteUiCommonsTimelineItemWrapperVLeft")}}}else{e.removeClass("sapSuiteUiCommonsTimelineItemOdd").removeClass("sapSuiteUiCommonsTimelineItemEven").addClass("sapSuiteUiCommonsTimelineItem");i.removeClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight").addClass(s)}};e.prototype._performDoubleSidedChanges=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineItemUlWrapper").not(".sapSuiteUiCommonsTimelineShowMoreWrapper"),i=e.find(".sapSuiteUiCommonsTimelineScrollV .sapSuiteUiCommonsTimelineGroupHeader"),s;if(this._renderDblSided){this._$content.addClass("sapSuiteUiCommonsTimelineDblSided");i.addClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided");i.addClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight")}else{this._$content.removeClass("sapSuiteUiCommonsTimelineDblSided");i.removeClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided sapSuiteUiCommonsTimelineItemWrapperVLeft");i.addClass(this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight")}for(var r=0;r<t.length;r++){var n=jQuery(t[r]),o=n.find("> li").not(".sapSuiteUiCommonsTimelineGroupHeader");o.eq(1).css("margin-top",this._renderDblSided?"40px":"auto");for(var a=0;a<o.length;a++){s=jQuery(o[a]);this._performDoubleSidedChangesLi(s,a%2===0)}}e.find(".sapSuiteUiCommonsTimelineItemBarV").css("height","");e.find(".sapSuiteUiCommonsTimelineItem").css("margin-bottom","")};e.prototype._performUiChangesH=function(){var e=this.$(),t,i;var s=function(t){return e.width()-(t.position().left+t.outerWidth())};if(this.getEnableDoubleSided()&&this._isGrouped()){i=e.find(".sapSuiteUiCommonsTimelineHorizontalBottomLine ul");e.find("[firstgroupevenitem = true]:visible").each(function(e,r){var n=function(e){return e+"-"+(this._bRtlMode?"right":"left")}.bind(this),o=jQuery("#"+r.id+"-line"),a=this._bRtlMode?s(o):o.position().left,l=30,m=jQuery(r),p=H(i,n("padding")),c,g;if(e===0){c=a-l-p}else{t=m.prevAll(".sapSuiteUiCommonsTimelineItemLiWrapperV:visible:first");g=this._bRtlMode?s(t):t.position().left+H(t,n("margin"));c=a-l-(g+t.outerWidth())}m.css(n("margin"),c+"px")}.bind(this))}if(!this.getEnableScroll()){e.find(".sapSuiteUiCommonsTimelineContentsH").css("overflow-x","hidden")}this._calculateTextHeight()};e.prototype._performUiChangesV=function(e){var t=this.$(),i=t.outerWidth()+50;if(this.getEnableDoubleSided()){this._renderDblSided=i>=E;if(this._renderDblSided!==this._lastStateDblSided||e){this._performDoubleSidedChanges()}this._lastStateDblSided=this._renderDblSided}this._calculateTextHeight();this._calculateHeightV()};e.prototype._calculateHeightV=function(){var e=this.$(),t=this.$("headerBar").outerHeight()||0,i=this.$("filterMessage").outerHeight()||0,s=this.$("messageStrip").outerHeight()||0,r=s+i+t,n=function(e,t){var i,s,r,n,o,a,l,m=e.length,p=this.getShowIcons()?".sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible":".sapSuiteUiCommonsTimelineItemNoIcon:visible",c=t.length>0?t.find(p+", .sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible").eq(0):jQuery(),g=8;for(var u=0;u<m;u++){i=jQuery(e[u+1]);s=jQuery(e[u]);r=u<m-1?i.find(p):c;o=s.find(p);if(r.length>0&&o.length>0){a=r.offset().top;l=o.offset().top+o.height();n=s.find(".sapSuiteUiCommonsTimelineItemBarV");g=8;n.height(a-l-g)}}},o=function(e){var t,i,s,r,n,o=40,a=100,l=function(){var e=H(s,"margin-top")+s.position().top+s.height()-t.position().top;i.css("margin-bottom",e+o+"px")};for(var m=2;m<e.length;m++){t=jQuery(e[m]);i=jQuery(e[m-1]);s=jQuery(e[m-2]);r=this._bRtlMode?!t.hasClass("sapSuiteUiCommonsTimelineItemOdd"):t.hasClass("sapSuiteUiCommonsTimelineItemOdd");n=t.position().left;if(!r&&n<a||r&&n>a){l()}else{var p=t.position().top-i.position().top,c=H(s,"margin-bottom");if(p<o){s.css("margin-bottom",c+o-p+"px")}}}},a=function(){var t=5,i=e.position().top,s=e.parent().height(),n=H(this._$content,"padding-bottom"),o=H(this._$content,"padding-top"),a=s-i-r-o-n-t;this._$content.height(a)}.bind(this),l,m,p,c;if(this.getEnableScroll()){a()}if(this._renderDblSided){l=e.find(".sapSuiteUiCommonsTimelineItemUlWrapper");for(var g=0;g<l.length;g++){m=jQuery(l[g]);p=jQuery(l[g+1]);c=m.find(" > li:not(.sapSuiteUiCommonsTimelineGroupHeader):visible");c.css("margin-bottom","");o.call(this,c,m);n.call(this,c,p)}}};e.prototype._performResizeChanges=function(){this._performUiChanges()};e.prototype._calculateTextHeight=function(){var e=this.$(),t=this.getTextHeight(),i,s,r=function(t,i){e.find(".sapSuiteUiCommonsTimelineItemTextWrapper:visible").each(function(e,s){var r=jQuery(s),n=r.children().first(),o=n.get(0).getClientRects(),a=0,l=0,m,p=-1e5,c=0,g=w.getText("TIMELINE_TEXT_SHOW_MORE"),u=r.attr("expanded");u=u=="true";r.height("auto");r.css("-webkit-line-clamp","");if(o&&o.length>0){m=o[0].top;c=0;for(var f=0;f<o.length-1;f++){if(p!==o[f].bottom){p=o[f].bottom;c++}if(t>0&&o[f+1].bottom-m>t){l=c;a=o[f].bottom-m;break}if(i>0&&c===i){a=o[f].bottom-o[0].top;l=i;break}}}if(!u){if(a>0){r.height(a);r.css("-webkit-line-clamp",l.toString());r.next().show()}else if(!r.attr("expandable")){r.next().hide()}}else{for(var h=f;h<o.length-1;h++){if(p!==o[h].bottom){p=o[h].bottom;c++}}if(i>0&&c<=i){r.attr("expanded",false);r.next().children()[0].text=g;r.next().hide()}}})},n=function(e){r(0,parseInt(e,10))},o=function(e){r(e,0)},a=function(){var t=e.find(".sapSuiteUiCommonsTimelineItemTextWrapper");t.css("height","");t.css("-webkit-line-clamp","");e.css("height","100%");var i=this._$content.height(),s=H(this._$content,"padding-bottom"),r=this._$content.get(0).scrollHeight,n=r-i-s,o={height:0},a,l=20;e.find(".sapSuiteUiCommonsTimelineItemTextWrapper").each(function(e,t){var i=jQuery(t).height();if(i>o.height){o.height=i;o.item=jQuery(this)}});if(o.item){a=o.item.parent().find(".sapSuiteUiCommonsTimelineItemShowMore:hidden").height();return o.height-n-a-l}return 1};if(t){if(this._useAutomaticHeight()){o(a.call(this))}else if(jQuery.isNumeric(t)){n(t)}else{i=/([0-9]*\.?[0-9]+)(px)+/i;s=i.exec(t);if(s&&s.length>1){o(s[1])}else if(x.isValid(t)){e.find(".sapSuiteUiCommonsTimelineItemTextWrapper").height(t)}}}};e.prototype._fixScrollerPositionH=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineHorizontalMiddleLine"),i=e.find(".sapSuiteUiCommonsTimelineHorizontalScroller"),s,r=this._$content.position().top;if(t.get(0)){s=t.position().top;e.find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").css("top",s-5+"px");i.css("top",r+"px");i.height(this._$content.outerHeight()-15)}};e.prototype._setupScrollers=function(){var e=this.$(),t=450,i="rgba(0, 0, 0, 0)",s,r,n,o,a,l,m,p,c,g,u,f,h,d=function(e){var t=i;e.parents().each(function(e,s){var r=jQuery(s).css("background-color"),n=jQuery(s).css("background-image");if(n!=="none"){t=i;return}if(r!==i&&r!=="transparent"){t=r}});return t};if(this._scrollingFadeout()){s=this._isVertical()?e.height():e.width();if(s<t){e.find(".sapSuiteUiCommonsTimelineVerticalScroller",".sapSuiteUiCommonsTimelineHorizontalScroller").hide();this._scrollersSet=false;return}if(!this._scrollersSet){r=d(this.$());if(r&&r!==i){n=r.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);if(n&&n.length>=4){o=parseInt(n[1],10);a=parseInt(n[2],10);l=parseInt(n[3],10);m="rgba("+o+","+a+","+l+", 0)";c="rgba("+o+","+a+","+l+", 0.7)";p="rgba("+o+","+a+","+l+", 1)";g=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller ");u=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller");f=this._isVertical()?"top":"left";h=this._isVertical()?"bottom":"right";g.css("background-image","linear-gradient(to "+f+", "+m+", "+p+")");u.css("background-image","linear-gradient(to "+h+", "+m+", "+p+")");g.css("background-image","-webkit-linear-gradient("+h+", "+m+", "+c+" 30%,"+p+")");u.css("background-image","-webkit-linear-gradient("+f+", "+m+", "+c+" 30%,"+p+")");this._scrollersSet=true;if(this.getContent().length>0){if(!this._isVertical()&&this._$content.get(0).scrollWidth>this._$content.outerWidth()||this._isVertical()&&this._$content.get(0).scrollHeight>this._$content.outerHeight()){u.show()}}}}else{e.find(".sapSuiteUiCommonsTimelineHorizontalScroller").hide()}}if(!this._isVertical()){this._fixScrollerPositionH()}}};e.prototype._setupScrollEvent=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineTopScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),i=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineBottomScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),s=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller"),r=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller"),n=this._$content,o=this;if(o._lazyLoading()||o._scrollingFadeout()){n.on("scroll",function(e){var n=jQuery(e.currentTarget),a=n.get(0).scrollLeft,l=n.get(0).scrollTop,m=false,p=200,c=5,g=false,u,f,h,d,_;if(o._isVertical()){u=n.outerHeight();f=n.get(0).scrollHeight;g=l+u>f-p;m=l+u>=f-c}else{h=n.width();d=n.get(0).scrollWidth;g=a+h>d-p;m=a+h>=d-c-185}if(o._lazyLoading()&&o._scrollMoreEvent){if(g&&!o._isMaxed()){o._scrollMoreEvent=false;o._loadMore()}}if(o._scrollersSet){if(a>50||l>50){s.show()}else{s.hide();o._manualScrolling=false}if(m){r.hide()}else{r.show()}var S;if(o._isVertical()){S=n.get(0).scrollTop;_=S>o._lastScrollPosition.y?i:t;o._lastScrollPosition.y=S}else{S=n.get(0).scrollLeft;_=S>o._lastScrollPosition.x?i:t;o._lastScrollPosition.x=S}_.addClass("sapSuiteUiCommonsTimelineScrolling");clearTimeout(jQuery.data(this,"scrollTimer"));jQuery.data(this,"scrollTimer",setTimeout(function(){t.removeClass("sapSuiteUiCommonsTimelineScrolling");i.removeClass("sapSuiteUiCommonsTimelineScrolling")},350))}});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").on("mousedown",function(e){var t=90,i=jQuery(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperLeft")||jQuery(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperTop")?-t:t;o._manualScrolling=true;o._performScroll(i)});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").on("mouseup",function(){o._manualScrolling=false}).on("mouseout",function(){o._manualScrolling=false})}if(this.getEnableScroll()&&!o._isVertical()){this._$content.on("wheel",function(e){if(e.originalEvent.deltaX){return}var t=e.originalEvent.deltaY,i=30;if(t<i&&t>i*-1){t=t>0?i:i*-1}this.scrollLeft+=t*2});e.find(".sapSuiteUiCommonsTimelineHorizontalScroller, .sapSuiteUiCommonsTimelineVerticalScroller").on("wheel",function(e){var t=e.originalEvent.deltaY;if(o._isVertical()){o._$content.get(0).scrollTop+=t*2}else{o._$content.get(0).scrollLeft+=t*2}})}};e.prototype._setupMessageStrip=function(){var e=this;this._objects.register("messageStrip",function(){return new h(e.getId()+"-messageStrip",{close:function(){e.setCustomMessage("");e.fireCustomMessageClosed()},showCloseButton:true})});this._objects.register("filterMessageText",function(){return new t(e.getId()+"-filterMessageText",{})});this._objects.register("filterMessage",function(){var t=e._objects.getFilterMessageText(),s,r;r=new i(e.getId()+"filterMessageIcon",{src:"sap-icon://decline",press:[e._clearFilter,e]});r.setTooltip(w.getText("TIMELINE_CLEAR_ICN_TOOLTIP"));s=new l(e.getId()+"-filterMessage",{design:"Info",content:[t,new o,r]});s.addStyleClass("sapSuiteUiCommonsTimelineFilterInfoBar");s.setHeight("auto");return s})};e.prototype._setMessageBars=function(e){var t=this._getFilterMessage();if(t){e.addChild(this._objects.getFilterMessage());this._objects.getFilterMessageText().setText(t)}};e.prototype._setupRangeFilterPage=function(){var e=this;this._rangeFilterType=null;this._objects.register("timestampFilterPicker",function(){return new v(e.getId(),{dateChanged:function(t){var i=t.getSource(),s=i.getStartDate()||e._minDate,r=i.getEndDate()||e._maxDate;e._filterDialogRangePage.setFilterCount(+(s!==e._minDate||r!==e._maxDate))}},undefined,w,e._objects)});this._objects.register("timeFilterSelect",function(){var t=new m(e.getId()+"-timeFilterSelect",{ariaLabelledBy:e._objects.getRangeTypeLbl().getId(),change:function(t){e._rangeFilterType=t.getParameter("selectedItem").getProperty("key");e.toggleGroupTypeSelector(e._rangeFilterType);e._setRangeFilter();var i=e._objects.getFilterContent()._getDialog();var s=i.getBeginButton();s.setEnabled(true);if(e._objects.getTimeFilterSelect().getSelectedItem().getText()===w.getText("TIMELINE_CUSTOM_RANGE")){e._objects.getTimestampFilterPicker()._checkDatePickerStatus()}},items:[new n({text:w.getText("TIMELINE_YEAR"),key:R.Year}),new n({text:w.getText("TIMELINE_QUARTER"),key:R.Quarter}),new n({text:w.getText("TIMELINE_MONTH"),key:R.Month}),new n({text:w.getText("TIMELINE_DAY"),key:R.Day}),new n({text:w.getText("TIMELINE_CUSTOM_RANGE"),key:R.None})]});t.addStyleClass("sapSuiteUiCommonsTimelineRangeSelect");return t});this._objects.register("timeRangeSlider",function(){var t=function(t){if(typeof t==="string"){t=Number(t)}var i=e._fnAddDate(t);return e._formatGroupBy(i,e._rangeFilterType).title};var i=new U;i.getLabel=t;var s=new p(e.getId()+"-timeRangeSlider",{enableTickmarks:true,visible:false,showAdvancedTooltip:true,step:1,change:function(t){var i=s.getMin(),r=s.getMax(),n=s.getRange();e._filterDialogRangePage.setFilterCount(+(n[0]!==i||n[1]!==r))},customTooltips:[new y({mapFunction:t}),new y({mapFunction:t,fetchValue2:true})],scale:i});s.addStyleClass("sapSuiteUiCommonsTimelineRangeFilter");return s});this._objects.register("rangeTypeLbl",function(){return new c(e.getId()+"-rangeTypeLbl",{text:w.getText("TIMELINE_GROUP_BY_PERIOD")+":"})});this._objects.register("rangeTypePanel",function(){var t=new g(e.getId()+"-rangeTypePanel",{content:[e._objects.getRangeTypeLbl(),e._objects.getTimeFilterSelect()]});t.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanel");t.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanelShadowed");return t});this._objects.register("rangePanel",function(){return new u(e.getId()+"rangePanel",{direction:"Column",items:[e._objects.getRangeTypePanel(),e._objects.getTimeRangeSlider(),e._objects.getTimestampFilterPicker().getTimestampPanelRadio(),e._objects.getTimestampFilterPicker().getTimestampPanelPicker()]})})};e.prototype._setupFilterFirstPage=function(e){if(e){e.removeAllAggregation("filterItems");if(this.getShowItemFilter()){e.addAggregation("filterItems",new d({key:"items",text:this._getFilterTitle()}))}if(this.getShowTimeFilter()){this._filterDialogRangePage=new _({key:"range",text:w.getText("TIMELINE_RANGE_SELECTION"),customControl:[this._objects.getRangePanel()]});e.addAggregation("filterItems",this._filterDialogRangePage)}}};e.prototype._setupFilterDialog=function(){var e=this;this._setupRangeFilterPage();this._objects.register("filterContent",function(){var t,i,r=function(t){if(!e._filterState.data){e._setFilterList();t.removeAllItems();e._aFilterList.forEach(function(i){var s=jQuery.grep(e._currentFilterKeys,function(e){return i.key===e.key}).length>0;t.addItem(new d({key:i.key,text:i.text,selected:s}))})}e._filterState.data=true},n=function(){C.show(w.getText("TIMELINE_NO_LIMIT_DATA"))},o=function(){if(!e._filterState.range){a.setBusy(true);e._getTimeFilterData().then(function(){a.setBusy(false);if(!e._minDate||!e._maxDate||(!(e._minDate instanceof Date)||!(e._maxDate instanceof Date))){n();return}if(!e._rangeFilterType){e._rangeFilterType=e._calculateRangeTypeFilter()}if(!e._startDate&&!e._endDate){e._setRangeFilter()}else{var s=e._objects.getTimeRangeSlider(),r=e._fnDateDiff(e._rangeFilterType),o=s.getMin(),l=s.getMax();if(l-o!==r){e._setRangeFilter()}t=e._fnDateDiff(e._rangeFilterType,e._minDate,e._startDate);i=e._fnDateDiff(e._rangeFilterType,e._minDate,e._endDate);s.setRange([t,i])}e.toggleGroupTypeSelector(e._rangeFilterType);e._objects.getTimeFilterSelect().setSelectedKey(e._rangeFilterType)}).catch(function(){a.setBusy(false);n()});e._filterState.range=true}},a=new s(e.getId()+"-filterContent",{confirm:function(t){var i=t.getParameter("filterItems"),s,r,n,o,a;e._currentFilterKeys=i.map(function(e){return{key:e.getProperty("key"),text:e.getProperty("text")}});e._startDate=null;e._endDate=null;if(e._objects.getTimestampFilterPicker().getVisible()){var l=e._objects.getTimestampFilterPicker().getStartDate()||e._minDate,m=e._objects.getTimestampFilterPicker().getEndDate()||e._maxDate;if(l!==e._minDate||m!==e._maxDate){e._startDate=l;e._endDate=m;a=true}}else{s=e._objects.getTimeRangeSlider();o=s.getRange();r=s.getMin();n=s.getMax();if(o[0]!==r||o[1]!==n){e._startDate=e._fnAddDate(Math.min.apply(null,o),M.DOWN);e._endDate=e._fnAddDate(Math.max.apply(null,o),M.UP);a=true}}e._filterData(a)},resetFilters:function(t){var i=e._objects.getTimeRangeSlider();i.setValue(i.getMin());i.setValue2(i.getMax());e._filterDialogRangePage.setFilterCount(0);e._objects.getTimestampFilterPicker().clearDates();if(e._rangeFilterType=="None"){e.toggleGroupTypeSelector()}},filterDetailPageOpened:function(e){var t=e.getParameter("parentFilterItem").getProperty("key");if(t==="items"){r(e.getParameter("parentFilterItem"))}if(t==="range"){o()}}});e._setupFilterFirstPage(a);return a})};e.prototype._setupHeaderToolbar=function(){var e=this,t=function(t){e._objects.register(t.name,function(){var i=new f(e.getId()+"-"+t.name,{type:F.Transparent,icon:t.icon,tooltip:t.tooltip,press:t.fnPress});i.setLayoutData(new S({priority:t.priority}));return i})};t({name:"filterIcon",icon:"sap-icon://add-filter",tooltip:w.getText("TIMELINE_FILTER_BY"),fnPress:[e._openFilterDialog,e],priority:L.NeverOverflow,visible:e.getShowItemFilter()||e.getShowTimeFilter()});t({name:"sortIcon",icon:"sap-icon://arrow-bottom",tooltip:w.getText("TIMELINE_SORT"),fnPress:[e._sortClick,e],priority:L.High,visible:e.getSort()&&e.getShowSort()});var i=new o;this._objects.register("searchFieldLabel",function(){return new b(e.getId()+"-searchFieldLabel",{text:w.getText("TIMELINE_ACCESSIBILITY_SEARCH")})});this._objects.register("searchField",function(){var t=new a(e.getId()+"-searchField",{width:"14rem",ariaLabelledBy:e._objects.getSearchFieldLabel().getId(),search:function(t){e._search(t.getSource().getValue())},visible:e.getShowSearch()});t.setLayoutData(new S({priority:L.Low}));return t});this._objects.register("headerBar",function(){var t=[i,e._objects.getSearchFieldLabel(),e._objects.getSearchField(),e._objects.getSortIcon(),e._objects.getFilterIcon()];var s=new l(e.getId()+"-headerBar",{content:t,visible:e.getShowHeaderBar()});s.addStyleClass("sapSuiteUiCommonsTimelineHeaderBar");s.setParent(e);return s})};e.prototype._setupAccessibilityItems=function(){var e=this;this._objects.register("accessibilityTitle",function(){return new b(e.getId()+"-accessibilityTitle",{text:w.getText("TIMELINE_ACCESSIBILITY_TITLE")})})};e.prototype.toggleGroupTypeSelector=function(e){var t=e!==R.None;this._objects.getTimestampFilterPicker().setVisible(!t);this._objects.getTimeRangeSlider().setVisible(t)}}};return j},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineRenderManagerTimestamp",["sap/ui/base/ManagedObject","sap/m/RadioButtonGroup","sap/m/RadioButton","sap/m/Panel","sap/m/DateTimePicker","sap/m/Label","sap/ui/core/library","sap/ui/core/date/UI5Date"],function(e,t,i,a,n,s,o,r){"use strict";var l=o.ValueState;var g={RANGE:0,START:1,END:2};var m=e.extend("sap.suite.ui.commons.TimelineRenderManagerTimestamp",{constructor:function(t,i,a,n,s){var o;var r;this.getText=n.getText.bind(n);this.oObject=s;this.getTimestampPanelPicker=function(){if(!o){o=this._createTimestampPanelPicker()}return o};this.getTimestampPanelRadio=function(){if(!r){r=this._createTimestampPanelRadio()}return r};e.call(this,t,i,a);this.setVisible(false)},metadata:{events:{dateChanged:{}}}});m.prototype._createTimestampPanelPicker=function(){var e=this.getId()+"-timestamp-panel-picker";var t;var i=new s({text:this.getText("TIMELINE_FROM")+":"});var o=new s({text:this.getText("TIMELINE_TO")+":"});var r=new a({id:e,content:[i,new s({text:this.getText("TIMELINE_NOW"),visible:false}),new n({width:"auto",ariaLabelledBy:[i],change:this._handlerTimePickerRange.bind(this)}),o,new s({text:this.getText("TIMELINE_NOW"),visible:false}),new n({width:"auto",ariaLabelledBy:[o],change:this._handlerTimePickerRange.bind(this)})]});r.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanel");t=r.getContent();t[1].addStyleClass("sapSuiteUiCommonsTimelineRangeLabelNow");t[2].addStyleClass("sapSuiteUiCommonsTimelineRangeDatePicker");t[4].addStyleClass("sapSuiteUiCommonsTimelineRangeLabelNow");t[5].addStyleClass("sapSuiteUiCommonsTimelineRangeDatePicker");return r};m.prototype._createTimestampPanelRadio=function(){var e=this.getId()+"-timestamp-panel-radio";return new a({id:e,content:[new t({columns:3,select:this.handlerSelectRadioButton.bind(this),buttons:[new i({id:e+"-range-of-dates",text:this.getText("TIMELINE_TIMESTAMP_RANGE_OF_DATES")}),new i({id:e+"-starting-date",text:this.getText("TIMELINE_TIMESTAMP_STARTING_DATE")}),new i({id:e+"-ending-date",text:this.getText("TIMELINE_TIMESTAMP_ENDING_DATE")})]})]})};m.prototype.resizeDialog=function(e){e.getFilterContent()._getDialog().setContentWidth("50em")};m.prototype.setVisible=function(e){this.getTimestampPanelPicker().setVisible(e);this.getTimestampPanelRadio().setVisible(e)};m.prototype.setPickerView=function(e,t){t.getContent()[1].setVisible(e===g.END);t.getContent()[2].setVisible(e===g.START||e===g.RANGE);t.getContent()[4].setVisible(e===g.START);t.getContent()[5].setVisible(e===g.END||e===g.RANGE)};m.prototype.handlerSelectRadioButton=function(e){this.setPickerView(e.getParameter("selectedIndex"),this.getTimestampPanelPicker())};m.prototype.getVisible=function(){return this.getTimestampPanelPicker().getVisible()&&this.getTimestampPanelRadio().getVisible()};m.prototype.getStartDate=function(){var e;var t=this.getTimestampPanelPicker().getContent()[2];if(t.getVisible()){e=t.getDateValue()}else{e=function(){return r.getInstance()}}return e};m.prototype.clearDates=function(){var e=this.getTimestampPanelPicker().getContent()[2],t=this.getTimestampPanelPicker().getContent()[5];var i=this.oObject.getFilterContent()._getDialog();var a=i.getBeginButton();e.setValueState(l.None);t.setValueState(l.None);a.setEnabled(true);e.setDateValue();t.setDateValue()};m.prototype.getEndDate=function(){var e;var t=this.getTimestampPanelPicker().getContent()[5];if(t.getVisible()){e=t.getDateValue()}else{e=function(){return r.getInstance()}}return e};m.prototype.destroy=function(){this.getTimestampPanelPicker().destroy();this.getTimestampPanelRadio().destroy();e.prototype.destroy.call(this)};m.prototype._handlerTimePickerRange=function(e){var t=this.getTimestampPanelPicker().getContent()[2],i=this.getTimestampPanelPicker().getContent()[5];var a=e.getSource();var n=a.getDateValue();var s=e.getParameter("valid");var o=this.oObject.getFilterContent()._getDialog();var r=o.getBeginButton();var g=s?l.None:l.Error;if(a===t){if(i.getDateValue()<n){i.setInitialFocusedDateValue(n)}i.setMinDate(n)}else if(a===i){if(t.getDateValue()>n){t.setInitialFocusedDateValue(n)}t.setMaxDate(n)}if(e.oSource.sId===t.getId()){t.setValueState(g)}else if(e.oSource.sId===i.getId()){i.setValueState(g)}if(t.getValueState()===l.None&&i.getValueState()===l.None){r.setEnabled(true)}else{r.setEnabled(false)}};m.prototype._checkDatePickerStatus=function(){var e=this.getTimestampPanelPicker().getContent()[2],t=this.getTimestampPanelPicker().getContent()[5];var i=this.oObject.getFilterContent()._getDialog();var a=i.getBeginButton();if(e.getValueState()===l.None&&t.getValueState()===l.None){a.setEnabled(true)}else{a.setEnabled(false)}};return m});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/TimelineRenderer", ["./library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/Icon","sap/m/Button","sap/base/security/encodeXML"],function(e,i,t,s,a){"use strict";var d=e.TimelineAxisOrientation,o=e.TimelineScrollingFadeout;var l={},n=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");l.apiVersion=2;l.render=function(e,i){var t=this._getHtmlModel(i);t.getRenderer().render(e)};l._getHtmlModel=function(e){if(e.getAxisOrientation()===d.Horizontal){return this._getHorizontalTimelineElement(e)}else{return this._getVerticalTimelineElement(e)}};l._getScrollerIcon=function(e,s,d){var o=new i("div"),l="scrollerIcon"+d,n="getScrollerIcon"+d;o.addClass(a("sapSuiteUiCommonsTimelineScrollerIconWrapper sapSuiteUiCommonsTimelineScrollerIconWrapper"+d));e._objects.register(l,function(){return new t({src:"sap-icon://step"})});o.addChild(e._objects[n]());return o};l._setWidthAndHeight=function(e,i){var t=e.getHeight(),s=e.getWidth();if(t&&!e._isVertical()){i.addStyle("height",t)}if(s&&(e._isVertical()||e.getEnableScroll())){i.addStyle("width",s)}};l._getHorizontalTimelineElement=function(e){var t=e.getEnableDoubleSided(),s=e._isLeftAlignment(),a=e._outputItem,d=0,l=true,n,r,m,u,C,p,c=e._isMaxed(),g,S=function(){var e=new i("ul");e.setAttribute("role","listbox");return e};var h=new i("div"),T=new i("div"),_=new i("div"),f=new i("div"),I=new i("div"),U=S(),v=new i("div"),H=S(),b=new i("div"),w=S(),B=new i("div"),G=new i("div"),A=new i("div"),E=new i("div");h.addControlData(e);h.addClass("sapSuiteUiCommonsTimelineH");if(!e.getEnableScroll()){h.addClass("sapSuiteUiCommonsTimelineNoScroll")}if(e._useAutomaticHeight()){h.addClass("sapSuiteUiCommonsTimelineAutomaticLineHeight")}this._addAccessibilityTags(h,e);this._setWidthAndHeight(e,h);if(t){h.addClass("sapSuiteUiCommonsTimelineDblSidedH")}else{h.addClass(s?"sapSuiteUiCommonsTimelineRight":"sapSuiteUiCommonsTimelineLeft")}if(e._isGrouped()){h.addClass("sapSuiteUiCommonsTimelineGrouped")}h.addChild(e._objects.getHeaderBar());e._setMessageBars(h);A.setId(e.getId()+"-contentH-before");h.addChild(A);T.setId(e.getId()+"-contentH");T.addClass("sapSuiteUiCommonsTimelineContentsH");h.addChild(T);E.setId(e.getId()+"-contentH-after");h.addChild(E);_.setId(e.getId()+"-scrollH");_.addClass("sapSuiteUiCommonsTimelineScrollH");T.addChild(_);I.addClass("sapSuiteUiCommonsTimelineHorizontalTopLine");v.addClass("sapSuiteUiCommonsTimelineHorizontalMiddleLine");v.addChild(H);b.addClass("sapSuiteUiCommonsTimelineHorizontalBottomLine");if(t||s){I.addChild(U)}if(t||!s){b.addChild(w)}U.addClass("sapSuiteUiCommonsTimelineHorizontalScrollingLine");w.addClass("sapSuiteUiCommonsTimelineHorizontalScrollingLine");H.addClass("sapSuiteUiCommonsTimelineHorizontalScrollingLine");if(a.length>0){if(e._scrollingFadeout()){h.addChild(B);h.addChild(G);B.addClass("sapSuiteUiCommonsTimelineHorizontalLeftScroller sapSuiteUiCommonsTimelineHorizontalScroller");G.addClass("sapSuiteUiCommonsTimelineHorizontalRightScroller sapSuiteUiCommonsTimelineHorizontalScroller");if(e.getScrollingFadeout()===o.AreaWithButtons){B.addChild(this._getScrollerIcon(e,"_scollerIconLeft","Left"));G.addChild(this._getScrollerIcon(e,"_scollerIconRight","Right"))}}f.addClass("sapSuiteUiCommonsTimelineHorizontalScrollContainer");_.addChild(f);f.addChild(I);f.addChild(v);f.addChild(b);H.addChild(this._getFirstHorizontalDelimiterLine(a[0]));for(var M=0;M<a.length;M++){g=c;n=a[M];r=s?"top":"bottom";m=d%2;u=n.getText()==="GroupHeader";C=a[M+1];p=s?U:w;if(t){p=U;if(!u){p=m?w:U}r=m?"bottom":"top"}if(u){d=0;l=true;r="top";if(g){for(var L=M+1;L<a.length;L++){if(a[L]._isGroupHeader){g=false;break}}}}else if(m){n._isFirstGroupEvenItem=l;l=false}n._index=M;n._orientation="H";n._placementLine=r;p.addChild(n);var x=this._getHorizontalDelimiterLine(e,n,d,C,c&&!C,g);if(x){H.addChild(x)}if(!u){d++}}}else{_.addChild(this._getEmptyTimelineElement(e))}if(e._showMore){H.addChild(this._getShowMoreElement(e))}return h};l._getFirstHorizontalDelimiterLine=function(e){var t=new i("li"),s=new i("div"),a=new i("div"),d=new i("div"),o=e._isGroupHeader;d.addClass("sapSuiteUiCommonsTimelineItemBarH");a.addClass("sapSuiteUiCommonsTimelineItemBarWrapper");a.addChild(d);s.addChild(a);s.addClass("sapSuiteUiCommonsTimelineItemBarDivWrapper");t.addChild(s);t.addClass("sapSuiteUiCommonsTimelineItemFirstBar");if(o){t.addClass(e._isGroupCollapsed()?"sapSuiteUiCommonsTimelineGroupCollapsed":"sapSuiteUiCommonsTimelineGroupExpanded")}return t};l._getHorizontalDelimiterLine=function(e,t,s,d,o,l){var n=s%2,r=t.getText()==="GroupHeader",m=r?"sapSuiteUiCommonsTimelineItemGroupHeaderH":"sapSuiteUiCommonsTimelineItemBaseLength",u="sapSuiteUiCommonsTimelineItemBarH",C=d!=null&&d._isGroupHeader,p=d===null,c=t._getStatusColorClass(),g=new i("li"),S=new i("div"),h=new i("div"),T=new i("div"),_=new i("div"),f=new i("div"),I=new i("div");g.setId(t.getId()+"-line");if(r&&!t._isGroupCollapsed()){g.addStyle("display","none")}if(t._groupID){g.setAttribute("groupid",t._groupID)}if(r){u="sapSuiteUiCommonsTimelineItemGroupHeaderBar";g.setAttribute("nodeType","GroupHeaderBar")}else if(e.getEnableDoubleSided()){if((!C||n)&&!p){m=n?"sapSuiteUiCommonsTimelineItemHOdd":"sapSuiteUiCommonsTimelineItemHEven"}}if(!r&&o||r&&l){g.addClass("sapSuiteUiCommonsTimelineLastItem")}g.addClass(a(m));T.addClass("sapSuiteUiCommonsTimelineItemBarWrapper");h.addClass("sapSuiteUiCommonsTimelineItemBarH");h.addClass(a(u));S.addStyle("display","flex");S.addStyle("height","100%");if(e.getShowIcons()||r){S.addChild(_);if(!r){if(c){_.addClass(a(c))}else{_.addClass("sapSuiteUiCommonsTimelineNoStatus")}_.addClass("sapSuiteUiCommonsTimelineItemIconWrapper")}else{_.addClass("sapSuiteUiCommonsTimelineItemGroupBarIconWrapper")}_.addChild(t._getLineIcon())}else{I.addChild(f);I.addClass("sapSuiteUiCommonsTimelineItemNoIconWrapper");f.addClass("sapSuiteUiCommonsTimelineItemNoIcon");if(c){f.addClass(a(c))}else{f.addClass("sapSuiteUiCommonsTimelineNoStatus")}S.addClass("sapSuiteUiCommonsTimelineItemWrapper");S.addChild(I)}S.addChild(T);T.addChild(h);if(e._collapsedGroups[t._groupID]){if(r){g.addClass("sapSuiteUiCommonsTimelineItemGroupCollapsedBar")}else{g.addStyle("display","none")}}g.addChild(S);return g};l._getVerticalTimelineElement=function(e){var t=new i("div"),s=new i("div"),a=new i("div"),d=new i("div"),l=new i("div"),n=new i("div"),r=new i("div"),m=new i("div"),u=new i("div"),C,p,c,g,S,h,T=function(){var t=new i("ul");t.addClass("sapSuiteUiCommonsTimelineItemUlWrapper");t.setAttribute("role","listbox");t.setAttribute("aria-labelledby",e.getAriaLabelledBy().join(" "),true);return t};t.addControlData(e);t.addClass("sapSuiteUiCommonsTimeline");this._addAccessibilityTags(t,e);n.addClass("sapSuiteUiCommonsTimelineContentWrapper");if(e._isGrouped()){t.addClass("sapSuiteUiCommonsTimelineGrouped")}if(e._scrollingFadeout()){n.addChild(s);n.addChild(a);s.addClass("sapSuiteUiCommonsTimelineTopScroller sapSuiteUiCommonsTimelineVerticalScroller");a.addClass("sapSuiteUiCommonsTimelineBottomScroller sapSuiteUiCommonsTimelineVerticalScroller");if(e.getScrollingFadeout()===o.AreaWithButtons){s.addChild(this._getScrollerIcon(e,"_scollerIconTop","Top"));a.addChild(this._getScrollerIcon(e,"_scrollerIconBottom","Bottom"))}}this._setWidthAndHeight(e,t);t.addChild(e._objects.getHeaderBar());e._setMessageBars(t);if(e.getMessageStrip()!==null&&e.getMessageStrip()!==undefined&&e.getMessageStrip().getText()!==""){t.addChild(e._objects.getMessageStrip())}m.setId(e.getId()+"-content-before");m.setAttribute("tabindex",0);t.addChild(m);t.addChild(n);n.addChild(d);d.setId(e.getId()+"-content");d.setAttribute("data-sap-ui-fastnavgroup","true");d.addClass("sapSuiteUiCommonsTimelineContents");d.addClass("sapSuiteUiCommonsTimelineScrollV");d.addClass("sapSuiteUiCommonsTimelineScroll");u.setId(e.getId()+"-content-after");u.setAttribute("tabindex",0);t.addChild(u);d.addChild(l);l.setId(e.getId()+"-scroll");l.addClass("sapSuiteUiCommonsTimelineScroll");C=T();var _=e._outputItem,f=e._isMaxed();if(_.length>0){l.addChild(C);for(var I=0;I<_.length;I++){h=f;p=_[I];c=_[I+1];g=p._isGroupHeader;p._orientation="V";p._position=e.getAlignment();p._additionalBarClass="";p._index=I;p._isLast=f&&_.length-1===I;if(g){C.setAttribute("groupId",p._groupID)}if(g){for(var U=I+1;U<_.length;U++){S=_[U];if(S._isGroupHeader){if(!S._isGroupCollapsed()&&p._isGroupCollapsed()){p._additionalBarClass="sapSuiteUiCommonsTimelineGroupNextExpanded"}h=false;break}}}p._isLastGroup=h;if(c&&c._isGroupHeader&&!c._isGroupCollapsed()){p._additionalBarClass="sapSuiteUiCommonsTimelineGroupNextExpanded"}if(g&&I!=0){C=T();l.addChild(C)}if(g){C.setAttribute("role","tree")}C.addChild(p)}}else{l.addChild(this._getEmptyTimelineElement(e))}if(e._showMore){r.addClass("sapSuiteUiCommonsTimelineShowMoreWrapper");r.addChild(this._getShowMoreElement(e));l.addChild(r)}return t};l._getEmptyTimelineElement=function(e){var t=new i("div"),s=new i("span");t.addClass("sapSuiteUiCommonsTimelineNoTextWrapper");t.addChild(s);s.addChildEscaped(e.getNoDataText());return t};l._getShowMoreElement=function(e){var t=e._isVertical()?new i("div"):new i("li"),o="sapSuiteUiCommonsTimelineItemGetMoreButtonV",l="sap-icon://drill-down";if(e.getAxisOrientation()===d.Horizontal){l="sap-icon://process";o="sapSuiteUiCommonsTimelineItemGetMoreButtonH"}e._objects.register("moreButton",function(){var i=new s({icon:l,tooltip:n.getText("TIMELINE_MORE"),press:function(){e._loadMore()}});i.addEventDelegate({onAfterRendering:function(){this.$().attr("tabindex",-1)}},i);return i});t.addClass("sapSuiteUiCommonsTimelineItemGetMoreButton");t.addClass(a(o));t.addChild(e._objects.getMoreButton());return t};l._addAccessibilityTags=function(e,i){var t=[i._objects.getAccessibilityTitle().getId()];if(i._getFilterMessage()){t.push(i._objects.getFilterMessageText().getId())}e.setAttribute("role","presentation");e.addChild(i._objects.getAccessibilityTitle());e.setAttribute("aria-labelledby",t.join(" "),true)};return l},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/Utils", [],function(){"use strict";var e={};e._setupMobileDraggable=function(e){if(sap.ui.getCore().isMobile()){var t=function(e,t){if(e.originalEvent.touches.length>1){return}e.preventDefault();var n=e.originalEvent.changedTouches[0],u=document.createEvent("MouseEvents");u.initMouseEvent(t,true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);e.target.dispatchEvent(u)};var n=false;e.bind({touchstart:function(e){if(n){return}n=true;t(e,"mouseover");t(e,"mousemove");t(e,"mousedown")},touchmove:function(e){if(!n){return}t(e,"mousemove")},touchend:function(e){if(!n){return}t(e,"mouseup");t(e,"mouseout");t(e,"click");n=false}})}};return e},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/collaboration/BaseHelperService", ["sap/ui/base/Object"],function(t){"use strict";var o=t.extend("sap.suite.ui.commons.collaboration.BaseHelperService",{constructor:function(t){this._providerConfig=t}});o.prototype.getProviderConfig=function(){return this._providerConfig};o.prototype.getOptions=function(t){return[]};o.prototype.share=function(t,o){};o.prototype.isContactsCollaborationSupported=function(){return false};return o});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/collaboration/CollaborationHelper", ["sap/base/Log","sap/ui/core/routing/HashChanger","sap/ui/base/Object"],function(e,t,r){"use strict";var n="sap-url-hash";var i="&sap-ui-xx-cardTitle";var a="transient";var s=e.getLogger("sap.suite.ui.commons.collaboration.CollaborationHelper");var o=r.extend("sap.suite.ui.commons.collaboration.CollaborationHelper");o.compactHash=function(e){var t=sap.ushell&&sap.ushell.Container;if(!t){return{url:e}}return t.getServiceAsync("AppState").then(function(t){var r=t.createEmptyAppState(undefined,false);var i=this._getNextKey(r);if(!this._isEligibleForBackendPersistency(t)){s.warning("Transient flag is true. URL will not be shortened");return{url:e}}var a=this._extractURLBeforeHash(e);var o=this._extractSemanticObjectAndAction(e);if(!o){return{url:e}}return this._storeUrl(e,r).then(function(){return{url:a+"#"+o+"&/"+n+"="+i}}).catch(function(t){s.warning("URL is not shortened due to an error."+t.toString());return{url:e}})}.bind(this))};o._getCurrentUrl=function(){var e=sap.ushell&&sap.ushell.Container;return e?new Promise(function(t){e.getFLPUrlAsync(true).done(function(e){t(e)})}):Promise.resolve(document.URL)};o.processAndExpandHash=function(){this._hideAvatarFromShellbar();return this._getCurrentUrl().then(function(e){if(e.indexOf(n)>-1){var t;if(e.indexOf(i)>0){t=e.split(n)[1].split("=")[1].split(i)[0]}else{t=e.split(n)[1].split("=")[1]}return this._retrieveURL(t).then(function(t){if(t.getData()){window.location.replace(t.getData())}else{var r=e.split(n)[0];window.location.replace(r)}return Promise.resolve()})}else if(e.indexOf(i)>-1){var r=e.split(i)[0];window.location.replace(r)}return Promise.resolve()}.bind(this))};o._hideAvatarFromShellbar=function(){this.isTeamsModeActive().then(function(e){if(e){var t=sap.ui.getCore().byId("userActionsMenuHeaderButton");if(t){t.setVisible(false)}}})};o.isTeamsModeActive=function(){var e=false;var t=sap.ushell&&sap.ushell.Container;var r=t&&t.getService("URLParsing");return this._getCurrentUrl().then(function(t){var n=t.split("#")[0];if(n.indexOf("?")!==-1){var i=r&&r.parseParameters(n.substring(n.indexOf("?")));if(i&&i["sap-collaboration-teams"]&&i["sap-collaboration-teams"][0]&&i["sap-collaboration-teams"][0]==="true"){e=true}var a=false;if(i&&i["appState"]&&i["appState"][0]&&i["appState"][0]==="lean"){a=true}return Promise.resolve(e&&a)}else{return Promise.resolve(false)}})};o._retrieveURL=function(e){if(sap.ushell&&sap.ushell.Container){return sap.ushell.Container.getServiceAsync("AppState").then(function(t){return t.getAppState(e)})}};o._isEligibleForBackendPersistency=function(e){return e&&e._oConfig&&a in e._oConfig&&!e._oConfig[a]};o._getNextKey=function(e){return e.getKey()};o._extractSemanticObjectAndAction=function(e){var t=sap.ushell&&sap.ushell.services&&new sap.ushell.services.URLParsing;if(t){var r=t.parseShellHash(this._extractURLHash(e));if(r){return r.contextRaw?r.semanticObject+"-"+r.action+"~"+r.contextRaw:r.semanticObject+"-"+r.action}}return undefined};o._extractURLBeforeHash=function(e){var t=e.split("#")[0];return t};o._extractURLHash=function(e){var t=e.substring(e.indexOf("#"));return t};o._storeUrl=function(e,t){t.setData(e);return t.save()};return o});
sap.ui.predefine("sap/suite/ui/commons/collaboration/GraphApiConfig", [],function(){"use strict";var e=location.origin+location.pathname;var o={msalConfig:{auth:{clientId:"",authority:"",redirectUri:e},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:false},system:{loggerOptions:{loggerCallback:function(e,o,t){if(t){return}switch(e){case msal.LogLevel.Error:console.error(o);return;case msal.LogLevel.Info:console.info(o);return;case msal.LogLevel.Verbose:console.debug(o);return;case msal.LogLevel.Warning:console.warn(o);return;default:break}}}}},loginRequest:{scopes:["User.Read","User.Read.All","Presence.Read.All","Chat.Create","Chat.ReadWrite"]},graphApiEndpoints:{graphUserEndpoint:"https://graph.microsoft.com/v1.0/users"}};return{getConfig:function(e){o.msalConfig.auth.clientId=e.applicationId;o.msalConfig.auth.authority=e.tenantId;return o}}});
sap.ui.predefine("sap/suite/ui/commons/collaboration/ServiceContainer", ["sap/base/Log","./BaseHelperService","./TeamsHelperService","../windowmessages/CollaborationMessageBroker"],function(e,r,o,n){"use strict";var i=e.getLogger("sap.suite.ui.commons.collaboration.ServiceContainer");var t;var a;function s(){var e;if(t){var n=t.sProvider;var s=t.oProviderConfig;if(n==="COLLABORATION_MSTEAMS"){e=new o(s);a=Promise.resolve(e);return a}}e=new r({});i.info("Collaboration provider is not activated on the tenant");return Promise.resolve(e)}function v(){}var c=new v;c.getServiceAsync=function(){if(a){return a}return s()};c.setCollaborationType=function(e,r){i.info("Collaboration properties are now configured");t={sProvider:e,oProviderConfig:r};s();n.startInstance(t)};return c},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/collaboration/TeamsHelperService", ["sap/base/Log","sap/ui/core/Core","sap/base/security/URLListValidator","./CollaborationHelper","./BaseHelperService","sap/ui/core/Element","./ContactHelper","sap/ui/Device"],function(e,t,r,i,n,a,o,s){"use strict";var l=n.extend("sap.suite.ui.commons.collaboration.TeamsHelperService",{constructor:function(e){this._providerConfig=e;this._providerConfig.shareAsLinkUrl="https://teams.microsoft.com/share";this._getShareAsTabUrl().then(function(e){this._providerConfig.shareAsTabUrl=e}.bind(this))}});var p="db5b69c6-0430-4ae1-8d6e-a65c2220b50c";var d=e.getLogger("sap.suite.ui.commons.collaboration.TeamsHelperService");var h=t.getLibraryResourceBundle("sap.suite.ui.commons");var u="sap-ui-xx-cardTitle";var f;l.prototype.getOptions=function(e){var t={isShareAsLinkEnabled:e&&typeof e.isShareAsLinkEnabled!=="undefined"?e.isShareAsLinkEnabled:true,isShareAsTabEnabled:e&&typeof e.isShareAsTabEnabled!=="undefined"?e.isShareAsTabEnabled:true,isShareAsCardEnabled:e&&typeof e.isShareAsCardEnabled!=="undefined"?e.isShareAsCardEnabled:false};var r=[];var i=[];if(s.system.desktop){if(t.isShareAsLinkEnabled){if(this._providerConfig.isShareAsLinkEnabled){r.push({text:h.getText("COLLABORATION_MSTEAMS_CHAT"),key:"COLLABORATION_MSTEAMS_CHAT",icon:"sap-icon://post",fesrStepName:"MST:ShareAsLink"})}else{d.info("Share as Chat option is not enabled in the tenant")}}else{d.info("Consumer disable Share as Chat option")}}else{d.info("Share as Chat option is not supported in Phone and Tablet")}if(s.system.desktop){if(t.isShareAsTabEnabled){if(this._providerConfig.isShareAsTabEnabled){r.push({text:h.getText("COLLABORATION_MSTEAMS_TAB"),key:"COLLABORATION_MSTEAMS_TAB",icon:"sap-icon://image-viewer",fesrStepName:"MST:ShareAsTab"})}else{d.info("Share as Tab option is not enabled in the tenant")}}else{d.info("Consumer disable Share as Tab option")}}else{d.info("Share as Tab option is not supported in Phone and Tablet")}if(s.system.desktop){if(t.isShareAsCardEnabled){if(this._isFeatureFlagEnabled()){r.push({text:h.getText("COLLABORATION_MSTEAMS_CARD"),key:"COLLABORATION_MSTEAMS_CARD",icon:"sap-icon://ui-notifications",fesrStepName:"MST:ShareAsCard"})}else{d.info("Share as Card option is not enabled in the tenant")}}else{d.info("Consumer disable Share as Card option")}}else{d.info("Share as Card option is not supported in Phone and Tablet")}if(r.length===1){i=r;if(i[0].key==="COLLABORATION_MSTEAMS_CHAT"){i[0].text=h.getText("COLLABORATION_MSTEAMS_CHAT_SINGLE")}else if(i[0].key==="COLLABORATION_MSTEAMS_TAB"){i[0].text=h.getText("COLLABORATION_MSTEAMS_TAB_SINGLE")}else if(i[0].key==="COLLABORATION_MSTEAMS_CARD"){i[0].text=h.getText("COLLABORATION_MSTEAMS_CARD_SINGLE")}return i}if(r.length>1){i.push({type:"microsoft",text:h.getText("COLLABORATION_MSTEAMS_SHARE"),icon:"sap-icon://collaborate",subOptions:r})}return i};l.prototype.share=function(e,t){if(!t.url){d.error("url is not supplied in object so terminating Click");return}if(!r.validate(t.url)){d.error("Invalid URL supplied");return}if(e.key==="COLLABORATION_MSTEAMS_CHAT"){this._shareAsChat(t);return}if(e.key==="COLLABORATION_MSTEAMS_TAB"){this._shareAsTab(t);return}if(e.key==="COLLABORATION_MSTEAMS_CARD"){this._shareAsCard(t);return}};l.prototype._shareAsChat=function(e){var t=window.open("","_blank","width=700,height=600");var r=e.appTitle;if(e.subTitle.length>0){r+=": "+e.subTitle}t.opener=null;if(e.minifyUrlForChat){i.compactHash(e.url,[]).then(function(e){t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(r)+"&href="+encodeURIComponent(e.url)}.bind(this))}else{t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(r)+"&href="+encodeURIComponent(e.url)}};l.prototype._shareAsTab=function(e){var t=e.url;var r=t.indexOf("#");if(r!==-1){var n=t.substring(0,r);var a=n.indexOf("?",0);var o="appState=lean&sap-collaboration-teams=true";if(a!==-1){n=n.substring(0,a+1)+o+"&"+n.substring(a+1)}else{n+="?"+o}t=n+t.substring(r);f=undefined;t=this._addNavmodeInUrl(t)}var s={subEntityId:{url:t,appTitle:e.appTitle,subTitle:e.subTitle,mode:"tab"}};if(e.minifyUrlForChat){i.compactHash(t,[]).then(function(e){s.subEntityId.url=this._addNavmodeInUrl(e.url);var t=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(s));sap.m.URLHelper.redirect(t,true)}.bind(this))}else{var l=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(s));sap.m.URLHelper.redirect(l,true)}};l.prototype._addNavmodeInUrl=function(e){var t=sap.ushell&&sap.ushell.Container;var r=t&&t.getService("URLParsing");var i=e;var n=i.indexOf("#");var a=r.parseShellHash(i.substring(n));if(!f){f=a}f.params["sap-ushell-navmode"]="explace";f.params["sap-ushell-next-navmode"]="explace";a.params=f.params;var o=r.constructShellHash(a);i=i.substring(0,n)+"#"+o;return i};l.prototype._shareAsCard=function(e){var t=window.open("","_blank","width=700,height=600");t.opener=null;if(e.minifyUrlForChat){i.compactHash(e.url,[]).then(function(r){t.location=this._addCardTitleInUrl(r.url,e.appTitle)}.bind(this))}else{t.location=this._addCardTitleInUrl(e.url,e.appTitle)}};l.prototype._addCardTitleInUrl=function(e,t){e=e+"&"+u+"="+t;e=this._providerConfig.shareAsLinkUrl+"?href="+encodeURIComponent(e);return e};l.prototype._getShareAsTabUrl=function(){return this._getApplicationID().then(function(e){return"https://teams.microsoft.com/l/entity/"+e+"/tab"})};l.prototype._getApplicationID=function(){var e=sap.ushell&&sap.ushell.Container;var t=e&&e.getService("URLParsing");return i._getCurrentUrl().then(function(e){var r=e.split("#")[0];if(r.indexOf("?")!==-1){var i=t&&t.parseParameters(r.substring(r.indexOf("?")));if(i&&i["sap-collaboration-xx-TeamsAppId"]&&i["sap-collaboration-xx-TeamsAppId"][0]&&i["sap-collaboration-xx-TeamsAppId"][0].length>0){return Promise.resolve(i["sap-collaboration-xx-TeamsAppId"][0])}return Promise.resolve(p)}else{return Promise.resolve(p)}})};l.prototype._isFeatureFlagEnabled=function(){if(window["sap-ushell-config"]&&window["sap-ushell-config"].renderers&&window["sap-ushell-config"].renderers.fiori2&&window["sap-ushell-config"].renderers.fiori2.componentData&&window["sap-ushell-config"].renderers.fiori2.componentData.config&&window["sap-ushell-config"].renderers.fiori2.componentData.config.sapHorizonEnabled){return true}return false};l.prototype.isContactsCollaborationSupported=function(){return true};l.prototype.enableContactsCollaboration=function(e){if(this._providerConfig.applicationId&&this._providerConfig.tenantId&&e){if(!this.oContactHelper){this.oContactHelper=new o(this._providerConfig)}return this.oContactHelper.loadContactPopover(e)}};return l});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/collaboration/flpplugins/msplugin/Component", ["sap/ui/core/Component","sap/base/Log","../../ServiceContainer"],function(n,a,e){"use strict";var o=a.getLogger("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component");return n.extend("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component",{metadata:{properties:{isShareAsLinkEnabled:{name:"isShareAsLinkEnabled",type:"boolean"},isShareAsTabEnabled:{name:"isShareAsTabEnabled",type:"boolean"},applicationId:{name:"applicationId",type:"string"},tenantId:{name:"tenantId",type:"string"}}},init:function(){var n=this._loadPluginConfigData();if(n){e.setCollaborationType("COLLABORATION_MSTEAMS",n)}else{o.error("Collaboration configuration for Microsoft Teams Integration could not be loaded.")}},_loadPluginConfigData:function(){var n=this.getComponentData();if(n){return n.config}}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/flexibility/Timeline.flexibility", ["./changeHandler/PropertyChangeMapper","sap/base/Log"],function(e,r){"use strict";var n=Object.freeze({"-sortIcon":"showSort","-filterIcon":["showItemFilter","showTimeFilter"],"-searchField":"showSearch","-headerBar":"showHeaderBar"});function t(e){var t;for(t in n){if(typeof t=="string"&&t.length>0&&e.endsWith(t)){return n[t]}}r.fatal("Unkonw id of an inner component: "+e);return null}return{hideToolbarItem:new e(function(e){var r=e.removedElement.id;return t(r)},false),unhideToolbarItem:new e(function(e){var r=e.revealedElementId;return t(r)},true),hideControl:"default",unhideControl:"default",moveControls:"default"}},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/flexibility/changeHandler/PropertyChangeMapper", ["sap/ui/base/Object","sap/ui/fl/changeHandler/PropertyChange","sap/base/Log"],function(e,t,n){var r=e.extend("sap.suite.ui.commons.flexibility.changeHandler.PropertyChangeMapper",{constructor:function(e,t){if(typeof e==="function"){this._fnProperty=e}else if(typeof e==="string"){this._fnProperty=function(){return e}}else{n.fatal("Incorrect type of property: "+typeof e)}if(typeof t==="function"){this._fnValue=t}else{this._fnValue=function(){return t}}}});r.prototype.applyChange=function(e,n,r){var o=e.getDefinition().content,a=o.property;if(Array.isArray(a)){a.forEach(function(a){o.property=a;t.applyChange(e,n,r)})}else{t.applyChange(e,n,r)}};r.prototype.completeChangeContent=function(e,n){var r=this._fnProperty(n),o=Object.assign(n,{content:{property:r,newValue:this._fnValue(r)}});t.completeChangeContent(e,o)};r.revertChange=function(e,n,r){var o=e.getDefinition().content,a=o.property;if(Array.isArray(a)){a.forEach(function(a){o.property=a;t.revertChange(e,n,r)})}else{t.revertChange(e,n,r)}};return r});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/CropCustomShapeHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.imageeditor.CropCustomShapeHistoryItem",{constructor:function(i){t.apply(this,arguments);i=i||{};e(typeof i.x==="number","X must be a number.");e(typeof i.y==="number","Y must be a number.");e(typeof i.width==="number","Width must be a number.");e(typeof i.height==="number","Height value must be a number.");e(typeof i.oldWidth==="number","Old width value must be a number.");e(typeof i.oldHeight==="number","Old height value must be a number.");this._iX=i.x;this._iY=i.y;this._iWidth=i.width;this._iHeight=i.height;this._iOldWidth=i.oldWidth;this._iOldHeight=i.oldHeight}});i.prototype.getX=function(){return this._iX};i.prototype.getY=function(){return this._iY};i.prototype.getWidth=function(){return this._iWidth};i.prototype.getHeight=function(){return this._iHeight};i.prototype.getOldWidth=function(){return this._iOldWidth};i.prototype.getOldHeight=function(){return this._iOldHeight};i.prototype.compare=function(t){var e=["getWidth","getHeight"];return this._compare(t,e)};return i});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/CropEllipseHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.imageeditor.CropEllipseHistoryItem",{constructor:function(i){t.apply(this,arguments);i=i||{};e(typeof i.x==="number","X must be a number.");e(typeof i.y==="number","Y must be a number.");e(typeof i.rx==="number","RX value must be a number.");e(typeof i.ry==="number","RY value must be a number.");e(typeof i.width==="number","Width must be a number.");e(typeof i.height==="number","Height value must be a number.");e(typeof i.oldWidth==="number","Old width value must be a number.");e(typeof i.oldHeight==="number","Old height value must be a number.");this._iX=i.x;this._iY=i.y;this._iRx=i.rx;this._iRy=i.ry;this._iWidth=i.width;this._iHeight=i.height;this._iOldWidth=i.oldWidth;this._iOldHeight=i.oldHeight}});i.prototype.getX=function(){return this._iX};i.prototype.getY=function(){return this._iY};i.prototype.getRx=function(){return this._iRx};i.prototype.getRy=function(){return this._iRy};i.prototype.getWidth=function(){return this._iWidth};i.prototype.getHeight=function(){return this._iHeight};i.prototype.getOldWidth=function(){return this._iOldWidth};i.prototype.getOldHeight=function(){return this._iOldHeight};i.prototype.compare=function(t){var e=["getWidth","getHeight"];return this._compare(t,e)};return i});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/CropRectangleHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.imageeditor.CropRectangleHistoryItem",{constructor:function(i){t.apply(this,arguments);i=i||{};e(typeof i.x==="number","X must be a number.");e(typeof i.y==="number","Y must be a number.");e(typeof i.width==="number","Width must be a number.");e(typeof i.height==="number","Height value must be a number.");e(typeof i.oldWidth==="number","Old width value must be a number.");e(typeof i.oldHeight==="number","Old height value must be a number.");this._iX=i.x;this._iY=i.y;this._iWidth=i.width;this._iHeight=i.height;this._iOldWidth=i.oldWidth;this._iOldHeight=i.oldHeight}});i.prototype.getX=function(){return this._iX};i.prototype.getY=function(){return this._iY};i.prototype.getWidth=function(){return this._iWidth};i.prototype.getHeight=function(){return this._iHeight};i.prototype.getOldWidth=function(){return this._iOldWidth};i.prototype.getOldHeight=function(){return this._iOldHeight};i.prototype.compare=function(t){var e=["getWidth","getHeight"];return this._compare(t,e)};return i});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/CustomSizeItem", ["sap/ui/core/Element"],function(e){"use strict";var t=e.extend("sap.suite.ui.commons.imageeditor.CustomSizeItem",{metadata:{properties:{width:{type:"float",defaultValue:0},height:{type:"float",defaultValue:0},label:{type:"string",defaultValue:""},icon:{type:"sap.ui.core.URI",defaultValue:""},relative:{type:"boolean",defaultValue:false}}}});return t});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/FilterHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.imageeditor.FilterHistoryItem",{constructor:function(i){t.apply(this,arguments);i=i||{};e(typeof i.type==="string","Filter type must be a string.");e(typeof i.value==="number","Filter value must be a number.");e(typeof i.unit==="string","Filter unit must be a string.");this._sType=i.type;this._iValue=i.value;this._sUnit=i.unit}});i.prototype.getType=function(){return this._sType};i.prototype.getValue=function(){return this._iValue};i.prototype.getUnit=function(){return this._sUnit};i.prototype.compare=function(t){return false};return i});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/FilterUtils", [],function(){"use strict";var a=function(){};a.grayscale=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*(.2126+.7874*(1-t))+n*(.7152-.7152*(1-t))+r*(.0722-.0722*(1-t));a.data[h+1]=d*(.2126-.2126*(1-t))+n*(.7152+.2848*(1-t))+r*(.0722-.0722*(1-t));a.data[h+2]=d*(.2126-.2126*(1-t))+n*(.7152-.7152*(1-t))+r*(.0722+.9278*(1-t))}};a.sepia=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*(.393+.607*(1-t))+n*(.769-.769*(1-t))+r*(.189-.189*(1-t));a.data[h+1]=d*(.349-.349*(1-t))+n*(.686+.314*(1-t))+r*(.168-.168*(1-t));a.data[h+2]=d*(.272-.272*(1-t))+n*(.534-.534*(1-t))+r*(.131+.869*(1-t))}};a.saturate=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*(.213+.787*t)+n*(.715-.715*t)+r*(.072-.072*t);a.data[h+1]=d*(.213-.213*t)+n*(.715+.285*t)+r*(.072-.072*t);a.data[h+2]=d*(.213-.213*t)+n*(.715-.715*t)+r*(.072+.928*t)}};a.invert=function(a,t){var d,n,r,h,o,s;for(var i=0;i<a.data.length;i+=4){d=a.data[i];n=a.data[i+1];r=a.data[i+2];h=255-d;o=255-n;s=255-r;a.data[i]=d-(d-h)*t;a.data[i+1]=n-(n-o)*t;a.data[i+2]=r-(r-s)*t}};a.brightness=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*t;a.data[h+1]=n*t;a.data[h+2]=r*t}};a.contrast=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*t+(-.5*t+.5)*255;a.data[h+1]=n*t+(-.5*t+.5)*255;a.data[h+2]=r*t+(-.5*t+.5)*255}};a.hueRotate=function(a,t){var d,n,r;for(var h=0;h<a.data.length;h+=4){d=a.data[h];n=a.data[h+1];r=a.data[h+2];a.data[h]=d*(.2126+Math.cos(t)*.7874-Math.sin(t)*.2126)+n*(.7152-Math.cos(t)*.7152-Math.sin(t)*.7152)+r*(.0722-Math.cos(t)*.0722+Math.sin(t)*.9278);a.data[h+1]=d*(.2126-Math.cos(t)*.2126+Math.sin(t)*.143)+n*(.7152+Math.cos(t)*.285+Math.sin(t)*.14)+r*(.0722-Math.cos(t)*.0722-Math.sin(t)*.283);a.data[h+2]=d*(.2126-Math.cos(t)*.2126-Math.sin(t)*.7874)+n*(.7152-Math.cos(t)*.7152+Math.sin(t)*.7152)+r*(.0722+Math.cos(t)*.9278+Math.sin(t)*.0722)}};return a},true);
sap.ui.predefine("sap/suite/ui/commons/imageeditor/FlipHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,o){"use strict";var e=t.extend("sap.suite.ui.commons.imageeditor.FlipHistoryItem",{constructor:function(e){t.apply(this,arguments);e=e||{};o(typeof e.vertical==="boolean","Vertical must be a boolean.");o(typeof e.horizontal==="boolean","Horizontal value must be a bolean.");this._bVertical=e.vertical;this._bHorizontal=e.horizontal}});e.prototype.getVertical=function(){return this._bVertical};e.prototype.getHorizontal=function(){return this._bHorizontal};e.prototype.compare=function(t){return false};return e});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/HistoryItem", ["sap/ui/base/Object"],function(t){"use strict";var e=t.extend("sap.suite.ui.commons.imageeditor.HistoryItem",{metadata:{abstract:true}});e.prototype._isSameClass=function(t){return this.getMetadata().getName()===t.getMetadata().getName()};e.prototype._compare=function(t,e){var a=this;return this._isSameClass(t)&&e.reduce(function(e,r){return a[r]()===t[r]()},true)};return e});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ImageEditor", ["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/suite/ui/commons/library","sap/ui/core/library","sap/m/library","sap/base/Log","sap/ui/Device","sap/m/MessageToast","sap/ui/core/Icon","./ResizeHistoryItem","./RotateHistoryItem","./CropRectangleHistoryItem","./CropEllipseHistoryItem","./CropCustomShapeHistoryItem","./FilterHistoryItem","./FlipHistoryItem","./FilterUtils","sap/ui/core/util/File","sap/suite/ui/commons/Utils","./ImageEditorRenderer","sap/ui/thirdparty/jqueryui/jquery-ui-draggable","sap/ui/thirdparty/jqueryui/jquery-ui-resizable"],function(jQuery,t,e,i,o,s,r,a,n,h,p,l,g,_,d,u,m,c,C){"use strict";var f=e.ImageEditorMode,y=e.ImageFormat,I=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var w=t.extend("sap.suite.ui.commons.imageeditor.ImageEditor",{metadata:{library:"sap.suite.ui.commons",properties:{src:{type:"any",defaultValue:""},customShapeSrc:{type:"any",defaultValue:""},mode:{type:"sap.suite.ui.commons.ImageEditorMode",defaultValue:f.Default},keepCropAspectRatio:{type:"boolean",defaultValue:true},keepResizeAspectRatio:{type:"boolean",defaultValue:true},scaleCropArea:{type:"boolean",defaultValue:false}},events:{loaded:{},error:{},customShapeLoaded:{},customShapeError:{},sizeChanged:{parameters:{width:{type:"int"},height:{type:"int"},originalWidth:{type:"int"},originalHeight:{type:"int"}}},cropAreaChanged:{parameters:{cropArea:{type:"object"},originalCropArea:{type:"object"}}},zoomChanged:{parameters:{zoom:{type:"int"}}},historyChanged:{history:{type:"sap.suite.ui.commons.imageeditor.HistoryItem[]"},index:{type:"int"}}}}});w.LIMITS=Object.freeze({WIDTH_MIN:1,WIDTH_MAX:8192,HEIGHT_MIN:1,HEIGHT_MAX:8192,MAX_CANVAS_SIZE:67108864,MAX_SAFARI_MOBILE_CANVAS_SIZE:16777216,ROTATION_MIN:-360,ROTATION_MAX:360,SEPIA_MIN:0,SEPIA_MAX:100,GRAYSCALE_MIN:0,GRAYSCALE_MAX:100,SATURATE_MIN:0,SATURATE_MAX:500,INVERT_MIN:0,INVERT_MAX:100,BRIGHTNESS_MIN:0,BRIGHTNESS_MAX:500,CONTRAST_MIN:0,CONTRAST_MAX:500,CROP_AREA_MIN:1});w.ZOOM_MILESTONES=[5,10,25,33,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500];var v=Object.freeze({CROP_AREA_SHORTER_SIDE_OFFSET:.8,DEFAULT_ZOOM_MILESTONE:100});w.prototype.init=function(){this._oCanvas=document.createElement("canvas");this._initCanvas();this._initOrigImg();this._initCustomShapeImg();this._fZoom=v.DEFAULT_ZOOM_MILESTONE;this._oSavedImg=document.createElement("canvas");this._oSavedImg.width=0;this._oSavedImg.height=0};w.prototype._initOrigImg=function(){var t=this;this._oOrigImg=new Image;this._oOrigImg.crossOrigin="Anonymous";this._oOrigImg.onload=function(){t._bImageLoaded=true;t._drawImage(t._oOrigImg);t._storeCurrentImg();t._applyExifOrientation();if(t._isReady()){t._onAfterIsReady()}if(t.getCustomShapeLoaded()&&!r.browser.msie){t._renderCustomShapeMask()}t.fireLoaded()};this._oOrigImg.onerror=function(e){t.fireError()}};w.prototype._initCustomShapeImg=function(){var t=this;this._oCustomShapeImg=new Image;this._oCustomShapeImg.crossOrigin="Anonymous";this._oCustomShapeImg.onload=function(){t._bCustomShapeLoaded=true;t.$().addClass("sapSuiteUiCommonsImageEditorModeCropCustomShapeLoaded");t._renderCustomShapeMask();t.fireCustomShapeLoaded()};this._oCustomShapeImg.onerror=function(){t.fireCustomShapeError()}};w.prototype._getExifOrientation=function(t){var e=new FileReader,i,o,s,r,a,n,h,p,l,g={FIRST_CHECK:65496,SECOND_CHECK:65505,CORRECT_FORMAT_CHECK:1165519206,LITTLE_CHECK:18761,FOURTH_CHECK:65280,EXIF_CHECK:274,ERR_FILE_FORMAT:-2,OFFSET_STEP:2,OFFSET_STEP_MED:4,OFFSET_STEP_BIG:6};return new Promise(function(_){e.onload=function(t){o=t.target.result;s=new DataView(o);r=s.byteLength;i=2;l=0;try{if(s.getUint16(0,false)!=g.FIRST_CHECK){return}while(i<r){a=s.getUint16(i,false);i+=g.OFFSET_STEP;if(a==g.SECOND_CHECK){i+=g.OFFSET_STEP;if(s.getUint32(i,false)!=g.CORRECT_FORMAT_CHECK){return}i+=g.OFFSET_STEP_BIG;n=s.getUint16(i,false)==g.LITTLE_CHECK;i+=s.getUint32(i+g.OFFSET_STEP_MED,n);h=s.getUint16(i,n);i+=g.OFFSET_STEP;for(p=0;p<h;p++){if(s.getUint16(i+p*12,n)==g.EXIF_CHECK){return s.getUint16(i+p*12+8,n)}}}else if((a&g.FOURTH_CHECK)!=FOURTH_CHECK){break}else{i+=s.getUint16(i,false)}}}catch(t){return _(g.ERR_FILE_FORMAT)}};e.readAsArrayBuffer(t.slice(0,64*1024))})};w.prototype._handleExifOrientation=function(t){var e=this;this._getExifOrientation(t).then(function(t){switch(t){case 1:e._iExifRotation=0;break;case 2:e._iExifRotation=0;e._bExifFlip=true;break;case 3:e._iExifRotation=180;break;case 4:e._bExifFlip=true;e._iExifRotation=180;break;case 5:e._bExifFlip=true;e._iExifRotation=90;break;case 6:e._iExifRotation=90;break;case 7:e._bExifFlip=true;e._iExifRotation=-90;break;case 8:e._iExifRotation=-90;break;default:e._iExifRotation=0;break}e._applyExifOrientation()})};w.prototype._applyExifOrientation=function(){if(this.getLoaded()){if(this._iExifRotation){this._setRotation(this._iExifRotation);this._storeCurrentImg()}if(this._bExifFlip){this._flipHorizontal();this._storeCurrentImg()}}};w.prototype._renderCustomShapeMask=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i,o;this._oCustomShapeImg.width=500;this._oCustomShapeImg.height=this._oCustomShapeImg.naturalHeight*this._oCustomShapeImg.width/this._oCustomShapeImg.naturalWidth;jQuery("body").prepend(this._oCustomShapeImg);i=this._oCustomShapeImg.clientWidth;o=this._oCustomShapeImg.clientHeight;jQuery(this._oCustomShapeImg).remove();if(i>=o){t.width=this._oCanvas.width;t.height=o*(this._oCanvas.width/i)}else{t.height=this._oCanvas.height;t.width=i*(this._oCanvas.height/o)}this._oCustomShapeImg.width=t.width;this._oCustomShapeImg.height=t.height;e.drawImage(this._oCustomShapeImg,0,0,this._oCustomShapeImg.width,this._oCustomShapeImg.height);e.globalCompositeOperation="source-in";e.fillStyle="black";e.fillRect(0,0,t.width,t.height);this._sBlackCustomShapeUrl=t.toDataURL();if(this.$("overlayMaskCustomBlack")[0]){this.$("overlayMaskCustomBlack")[0].setAttributeNS("http://www.w3.org/1999/xlink","href",this._sBlackCustomShapeUrl)}e.fillStyle="white";e.fillRect(0,0,t.width,t.height);this._sWhiteCustomShapeUrl=t.toDataURL();if(this.$("overlayMaskCustomWhite")[0]){this.$("overlayMaskCustomWhite")[0].setAttributeNS("http://www.w3.org/1999/xlink","href",this._sWhiteCustomShapeUrl)}};w.prototype.onAfterRendering=function(){this._$Container=this.$("canvasInnerContainer");this._$Container.prepend(this._oCanvas);this._initContainer();this._initCropArea();if(this._isReady()){this._onAfterIsReady()}};w.prototype.setSrc=function(t){this.setProperty("src",t,true);var e=this,i,o;this._reset();if(typeof t==="string"){i=t;this._oOriginalBlob=this._fetchUrlAsBlob(i).then(function(t){e._handleExifOrientation(t);e._oOriginalBlob=t;e._sOriginalFileType=t.type});if(!i.startsWith("data:image")){this._sOriginalFileName=this._getFileNameFromUrl(i)}}else if(t instanceof Blob){o=window.URL;i=o.createObjectURL(t);o.revokeObjectURL(t);e._handleExifOrientation(t);this._oOriginalBlob=t;this._sOriginalFileType=t.type;if(t instanceof File){this._sOriginalFileName=t.name}}if(i){this._oOrigImg.src=i}else{this.fireLoaded()}return this};w.prototype.setScaleCropArea=function(t){this.setProperty("scaleCropArea",t,true);return this};w.prototype.setCustomShapeSrc=function(t){this.setProperty("customShapeSrc",t,true);var e=this,i,o;e._bCustomShapeLoaded=false;if(typeof t==="string"){if((r.browser.msie||r.browser.firefox)&&t.startsWith("data:image/svg+xml;base64,")){this._handleSvgString(atob(t.slice("data:image/svg+xml;base64,".length)))}else{i=t}}else if(t instanceof Blob){if(t instanceof File&&t.type==="image/svg+xml"){var s=new FileReader;s.onload=function(t){e._handleSvgString(t.target.result)};s.readAsText(t)}else{o=window.URL;i=o.createObjectURL(t);o.revokeObjectURL(t);this._setCustomShapeSrc(i)}}if(i){this._setCustomShapeSrc(i)}else if(!t){this._sBlackCustomShapeUrl="";this._sWhiteCustomShapeUrl="";if(this.$("overlayMaskCustomBlack")[0]){this.$("overlayMaskCustomBlack")[0].setAttributeNS("http://www.w3.org/1999/xlink","href",this._sBlackCustomShapeUrl)}if(this.$("overlayMaskCustomWhite")[0]){this.$("overlayMaskCustomWhite")[0].setAttributeNS("http://www.w3.org/1999/xlink","href",this._sWhiteCustomShapeUrl)}this.$().removeClass("sapSuiteUiCommonsImageEditorModeCropCustomShapeLoaded");this.fireCustomShapeLoaded()}return this};w.prototype._handleSvgString=function(t){var e,i;if(r.browser.msie){throw Error("SVG files cannot be used as shapes for custom crop in Internet Explorer. Please use a different image source or a different browser.")}var o=(new DOMParser).parseFromString(t,"image/svg+xml");if(o.documentElement.width.baseVal.value>0){o.documentElement.width.baseVal.valueAsString=o.documentElement.width.baseVal.value.toString()+"px"}if(o.documentElement.height.baseVal.value>0){o.documentElement.height.baseVal.valueAsString=o.documentElement.height.baseVal.value.toString()+"px"}i=(new XMLSerializer).serializeToString(o);e="data:image/svg+xml;base64,"+btoa(i);this._setCustomShapeSrc(e)};w.prototype._setCustomShapeSrc=function(t){this._oCustomShapeImg.src=t};w.prototype.setKeepCropAspectRatio=function(t){this.setProperty("keepCropAspectRatio",t,true);this._updateResizableCropAspectRatio();return this};w.prototype.setKeepResizeAspectRatio=function(t){this.setProperty("keepResizeAspectRatio",t,true);this._updateResizableResizeAspectRatio();return this};w.prototype.getLoaded=function(){return!!this.getSrc()&&this._bImageLoaded};w.prototype.getCustomShapeLoaded=function(){return!!this.getCustomShapeSrc()&&this._bCustomShapeLoaded};w.prototype.setSize=function(t,e,i){this._throwIfNotLoaded("setSize");var o,s,r;t=this._constraintValue(t,w.LIMITS.WIDTH_MIN,w.LIMITS.WIDTH_MAX);e=this._constraintValue(e,w.LIMITS.HEIGHT_MIN,w.LIMITS.HEIGHT_MAX);r=this._limitCanvasSize(t,e);t=r.width;e=r.height;this._cancelPreview();o=this.getWidth();s=this.getHeight();this._setCanvasSize(t,e);this._addHistory(new h({width:t,height:e,oldWidth:o,oldHeight:s}),i);return this};w.prototype.getWidth=function(){this._throwIfNotLoaded("getWidth");return this._getLastImg().width};w.prototype.getPreviewWidth=function(){this._throwIfNotLoaded("getPreviewWidth");return this._oCanvas.width};w.prototype.setWidth=function(t,e){this._throwIfNotLoaded("setWidth");var i=this.getHeight(),o=this.getWidth(),s=this.getPreviewHeight(),r;t=this._constraintValue(t,w.LIMITS.WIDTH_MIN,w.LIMITS.WIDTH_MAX);if(this.getKeepResizeAspectRatio()){s=Math.round(t*s/this.getPreviewWidth())}r=this._limitCanvasSize(t,s);t=r.width;s=r.height;this._cancelPreview();this._setCanvasSize(t,s);this._addHistory(new h({width:t,height:s,oldWidth:o,oldHeight:i}),e);return this};w.prototype.getHeight=function(){this._throwIfNotLoaded("getHeight");return this._getLastImg().height};w.prototype.getPreviewHeight=function(){this._throwIfNotLoaded("getPreviewHeight");return this._oCanvas.height};w.prototype.setHeight=function(t,e){this._throwIfNotLoaded("setHeight");var i=this.getWidth(),o=this.getHeight(),s=this.getPreviewWidth(),r;t=this._constraintValue(t,w.LIMITS.HEIGHT_MIN,w.LIMITS.HEIGHT_MAX);if(this.getKeepResizeAspectRatio()){s=Math.round(t*s/this.getPreviewHeight())}r=this._limitCanvasSize(s,t);s=r.width;t=r.height;this._cancelPreview();this._setCanvasSize(s,t);this._addHistory(new h({width:s,height:t,oldWidth:i,oldHeight:o}),e);return this};w.prototype.rotate=function(t,e){this._throwIfNotLoaded("rotate");t=this._constraintValue(t,w.LIMITS.ROTATION_MIN,w.LIMITS.ROTATION_MAX);this._cancelPreview();this._setRotation(t);this._addHistory(new p({degrees:t}),e);return this};w.prototype.flipVertical=function(t){this._throwIfNotLoaded("flipVertical");this._cancelPreview();this._flipVertical();this._addHistory(new u({vertical:true,horizontal:false}),t);return this};w.prototype.flipHorizontal=function(t){this._throwIfNotLoaded("flipHorizontal");this._cancelPreview();this._flipHorizontal();this._addHistory(new u({vertical:false,horizontal:true}),t);return this};w.prototype.flip=function(t,e,i){this._throwIfNotLoaded("flip");this._cancelPreview();this._flip(t,e);this._addHistory(new u({vertical:t,horizontal:e}),i);return this};w.prototype.applyVisibleCrop=function(t){this._throwIfNotReady("applyVisibleCrop");switch(this.getMode()){case f.CropRectangle:{this._applyRectangleCrop(t);break}case f.CropEllipse:{this._applyEllipseCrop(t);break}case f.CropCustomShape:{this._throwIfCustomShapeNotLoaded("applyVisibleCrop CropCustomShape");this._applyCustomShapeCrop(t);break}default:{s.warning("No cropping mode is selected, applyVisibleCrop does nothing");break}}};w.prototype.rectangleCrop=function(t,e,i,o,s){this._throwIfNotLoaded("rectangleCrop");var r=this.getWidth(),a=this.getHeight();this._cancelPreview();this._rectangleCrop(t,e,i,o);this._addHistory(new l({x:Math.round(t),y:Math.round(e),width:Math.round(i),height:Math.round(o),oldWidth:r,oldHeight:a}),s);this._limitCurrentCropArea()};w.prototype.ellipseCrop=function(t,e,i,o,s){this._throwIfNotLoaded("ellipseCrop");var r=this.getWidth(),a=this.getHeight();this._cancelPreview();this._ellipseCrop(t,e,i,o);this._addHistory(new g({x:Math.round(t),y:Math.round(e),rx:Math.round(i),ry:Math.round(o),width:Math.round(i*2),height:Math.round(o*2),oldWidth:r,oldHeight:a}),s);this._limitCurrentCropArea()};w.prototype.customShapeCrop=function(t,e,i,o,s){this._throwIfNotLoaded("customShapeCrop");this._throwIfCustomShapeNotLoaded("customShapeCrop");var r=this.getWidth(),a=this.getHeight();this._cancelPreview();this._customShapeCrop(t,e,i,o);this._addHistory(new _({x:Math.round(t),y:Math.round(e),width:Math.round(i),height:Math.round(o),oldWidth:r,oldHeight:a}),s);this._limitCurrentCropArea()};w.prototype.setCropArea=function(t,e,i,o){this._throwIfNotLoaded("setCropArea");var s=this._limitCropArea(t,e,i,o);this._setCropArea(s.x,s.y,s.width,s.height);return this};w.prototype.setCropAreaByRatio=function(t,e){this._throwIfNotLoaded("setCropAreaByRatio");var i=this._oCanvas.width/this._oCanvas.height,o=t/e,s,r,a,n,h;if(typeof t!=="number"||typeof e!=="number"){return this}if(i>=o){r=v.CROP_AREA_SHORTER_SIDE_OFFSET;s=this._oCanvas.height*r*o;s=100*s/this._oCanvas.width;r*=100;a=(100-s)/2;n=(100-r)/2}else{s=v.CROP_AREA_SHORTER_SIDE_OFFSET;r=this._oCanvas.width*s/o;r=100*r/this._oCanvas.height;s*=100;n=(100-r)/2;a=(100-s)/2}h=this._transposePercentToImageCoordsPx(a,n,s,r);this._setCropArea(h.x,h.y,h.width,h.height);return this};w.prototype.setCustomShapeCropAreaRatio=function(){this._throwIfNotLoaded("setCustomShapeCropAreaRatio");this._throwIfCustomShapeNotLoaded("setCustomShapeCropAreaRatio");this.setCropAreaByRatio(this._oCustomShapeImg.width,this._oCustomShapeImg.height);return this};w.prototype.setCropAreaBySize=function(t,e){this._throwIfNotLoaded("setCropAreaBySize");var i=this._limitCropArea(null,null,t,e);this._setCropArea(null,null,i.width,i.height);return this};w.prototype.getCropArea=function(){return this._oCropArea?jQuery.extend({},this._oCropArea):null};w.prototype.zoom=function(t,e){this._setZoom(t,e);return this};w.prototype.zoomIn=function(t){this._zoomIn(t);return this};w.prototype.zoomOut=function(t){this._zoomOut(t);return this};w.prototype.zoomToFit=function(){this._throwIfNotReady("zoomToFit");this._zoomToFit();return this};w.prototype.getZoomLevel=function(){return this._fZoom};w.prototype.sepia=function(t,e){this._throwIfNotLoaded("sepia");this._constraintValue(t,w.LIMITS.SEPIA_MIN,w.LIMITS.SEPIA_MAX);this._cancelPreview();this._addHistory(new d({type:"sepia",value:t,unit:"%"}),e)};w.prototype.grayscale=function(t,e){this._throwIfNotLoaded("grayscale");this._constraintValue(t,w.LIMITS.GRAYSCALE_MIN,w.LIMITS.GRAYSCALE_MAX);this._cancelPreview();this._addHistory(new d({type:"grayscale",value:t,unit:"%"}),e)};w.prototype.saturate=function(t,e){this._throwIfNotLoaded("saturate");this._constraintValue(t,w.LIMITS.SATURATE_MIN,w.LIMITS.SATURATE_MAX);this._cancelPreview();this._addHistory(new d({type:"saturate",value:t,unit:"%"}),e)};w.prototype.invert=function(t,e){this._throwIfNotLoaded("invert");this._constraintValue(t,w.LIMITS.INVERT_MIN,w.LIMITS.INVERT_MAX);this._cancelPreview();this._addHistory(new d({type:"invert",value:t,unit:"%"}),e)};w.prototype.brightness=function(t,e){this._throwIfNotLoaded("brightness");this._constraintValue(t,w.LIMITS.BRIGHTNESS_MIN,w.LIMITS.BRIGHTNESS_MAX);this._cancelPreview();this._addHistory(new d({type:"brightness",value:t,unit:"%"}),e)};w.prototype.contrast=function(t,e){this._throwIfNotLoaded("contrast");this._constraintValue(t,w.LIMITS.CONTRAST_MIN,w.LIMITS.CONTRAST_MAX);this._cancelPreview();this._addHistory(new d({type:"contrast",value:t,unit:"%"}),e)};w.prototype.applyPreview=function(){this._throwIfNotLoaded("applyPreview");this._applyPreview()};w.prototype.cancelPreview=function(){this._throwIfNotLoaded("cancelPreview");this._cancelPreview()};w.prototype.undo=function(){this._throwIfNotLoaded("undo");this._jumpToHistory(this._iHistoryIndex+1)};w.prototype.redo=function(){this._throwIfNotLoaded("redo");this._jumpToHistory(this._iHistoryIndex-1)};w.prototype.jumpToHistory=function(t){this._throwIfNotLoaded("jumpToHistory");this._jumpToHistory(t)};w.prototype.getHistory=function(){return this._aHistory};w.prototype.getHistoryIndex=function(){return this._iHistoryIndex};w.prototype.getImagePngDataURL=function(){this._throwIfNotLoaded("getImagePngDataURL");return this._getFinalisedCanvas().toDataURL("image/png")};w.prototype.getImageJpegDataURL=function(t){this._throwIfNotLoaded("getImageJpegDataURL");return this._getFinalisedCanvas().toDataURL("image/jpeg",t)};w.prototype.getImageDataURL=function(t,e){this._throwIfNotLoaded("getImageDataURL");t=this._convertImageFormatEnumToMime(t)||this._getFileFormat();return this._getFinalisedCanvas().toDataURL(t,e)};w.prototype.getImageAsBlob=function(t,e){this._throwIfNotLoaded("getImageAsBlob");var i=this,o;t=this._convertImageFormatEnumToMime(t)||this._getFileFormat();if(this._aHistory.length===0){o=this._getOriginalBlob()}else{o=new Promise(function(o,s){var r=i._getFinalisedCanvas();if(r.toBlob){r.toBlob(function(t){o(t)},t,e)}else{i._createBlob(r,t,e).then(function(t){o(t)})}})}return o};w.prototype.openSaveDialog=function(t,e,i){this._throwIfNotLoaded("openSaveDialog");var o,s;t=t||this._getFileName();e=this._convertImageFormatEnumToMime(e)||this._getFileFormat();s=e.split("/")[1];if(this._aHistory.length===0){this._getOriginalBlob().then(function(i){c.save(i,t,s,e)})}else{o=this._getFinalisedCanvas();if(o.toBlob){o.toBlob(function(i){c.save(i,t,s,e)},e,i)}else{this._createBlob(o,e,i).then(function(i){c.save(i,t,s,e)})}}};w.prototype.getFileName=function(){return this._getFullFileName()};w.prototype._throwIfNotLoaded=function(t){if(!this.getLoaded()){throw Error("Cannot call "+t+" before image is set and loaded")}};w.prototype._throwIfNotReady=function(t){if(!this._isReady()){throw Error("Cannot call "+t+" before image is set and loaded and control is rendered")}};w.prototype._throwIfCustomShapeNotLoaded=function(t){if(!this.getCustomShapeLoaded()){throw Error("Cannot call "+t+" before custom shape is set and loaded")}};w.prototype._onAfterIsReady=function(){var t=this;this.$().removeClass("sapSuiteUiCommonsImageEditorEmpty");t._refreshContainerSize();this._$Container.css({width:this._oCanvas.width*this._getScale()+"px",height:this._oCanvas.height*this._getScale()+"px"});if(!this.getCropArea()){this.setCropAreaByRatio(this.getWidth(),this.getHeight())}else{this._setCropArea(this._oCropArea.x,this._oCropArea.y,this._oCropArea.width,this._oCropArea.height)}this.getDomRef().onmousewheel=this._onMouseWheel.bind(this);this.getDomRef().onmousedown=this._onMouseDown.bind(this)};w.prototype._isReady=function(){return!!this._$Container&&this.getLoaded()};w.prototype._createBlob=function(t,e,i){var o=this;return new Promise(function(s,r){var a=t.toDataURL(e,i).split(",")[1];setTimeout(function(){s(o._convertDataUriToBlob(a,e))})})};w.prototype._convertDataUriToBlob=function(t,e){var i=atob(t),o=i.length,s=new Uint8Array(o);for(var r=0;r<o;r++){s[r]=i.charCodeAt(r)}return new Blob([s],{type:e})};w.prototype._fetchUrlAsBlob=function(t){var e,i,o,s;if(window.fetch){e=fetch(t).then(function(t){return t.blob()}).then(function(t){return t})}else{if(t.startsWith("data:image")){i=t.split(",");o=i[1];s=i[0].split(";")[0].split(":")[1];e=Promise.resolve(this._convertDataUriToBlob(o,s))}else{e=new Promise(function(e,i){var o=new XMLHttpRequest;o.open("GET",t);o.responseType="blob";o.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){if(this.status===200){e(o.response)}else{i()}}};o.send()})}}return e};w.prototype._getOriginalBlob=function(){var t;if(this._oOriginalBlob instanceof Promise){t=this._oOriginalBlob}else{t=Promise.resolve(this._oOriginalBlob)}return t};w.prototype._getFileNameFromUrl=function(t){return t.split("#")[0].split("?")[0].split("/").pop()};w.prototype._getFileName=function(){var t=this._sOriginalFileName||"image",e;e=t.lastIndexOf(".");if(e>0){t=t.slice(0,e)}return t};w.prototype._getFullFileName=function(){return this._sOriginalFileName};w.prototype._convertImageFormatEnumToMime=function(t){switch(t){case y.Png:t="image/png";break;case y.Jpeg:t="image/jpeg";break;default:break}return t};w.prototype._getFileFormat=function(){return this._sOriginalFileType};w.prototype._updateTransformation=function(){this._oCanvas.style.transform="scale("+this._getScale()+")"};w.prototype._refreshContainerSize=function(){if(!this._$Container||!this._$Container[0]||!this._isReady()){return}this._$Container.css({width:this._oCanvas.width*this._getScale()+"px",height:this._oCanvas.height*this._getScale()+"px"});this._refreshOverlayMask()};w.prototype._refreshOverlayMask=function(){var t=this.$().find(".sapSuiteUiCommonsImageEditorCropOverlayContainer")[0];if(!t||!this._$Container){return}this._$Container[0].removeChild(t);this._$Container[0].insertBefore(t,this._oCanvas.nextSibling)};w.prototype._refreshCropContainerSize=function(){var t=this.getCropArea(),e,i;if(t){e=this._transposeImageCoordsPxToPercent(t.x,t.y,t.width,t.height);i=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle");i.css({left:e.x+"%",top:e.y+"%"});i.width(e.width+"%");i.height(e.height+"%")}};w.prototype._refreshCropContainerLook=function(){function t(t){return t/parseFloat(getComputedStyle(document.documentElement).fontSize)}var e=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle"),i=t(e.width()),o=t(e.height()),s=Math.min(i,o);e.removeClass("sapSuiteUiCommonsImageEditorCropInnerRectangleSmall sapSuiteUiCommonsImageEditorCropInnerRectangleVerySmall sapSuiteUiCommonsImageEditorCropInnerRectangleExtraSmall");if(s<1.25){e.addClass("sapSuiteUiCommonsImageEditorCropInnerRectangleExtraSmall")}else if(s<2){e.addClass("sapSuiteUiCommonsImageEditorCropInnerRectangleVerySmall")}else if(s<3){e.addClass("sapSuiteUiCommonsImageEditorCropInnerRectangleSmall")}};w.prototype._initCanvas=function(){this._oCanvas.id=this.getId()+"-image";this._oCanvas.classList.add("sapSuiteUiCommonsImageEditorCanvas");this._oContext=this._oCanvas.getContext("2d")};w.prototype._initContainer=function(){var t=this,e=this.$().find(".sapSuiteUiCommonsImageEditorTransformHandlers .sapSuiteUiCommonsImageEditorHandlerContainer");this._$Container.resizable({containment:"parent",aspectRatio:this.getKeepResizeAspectRatio(),start:function(e,i){t.$("image").addClass("sapSuiteUiCommonsImageEditorCanvasResize");t.$("image").css("transform","");jQuery(this).css({top:i.position.top+"px",left:i.position.left+"px",width:i.size.width+"px",height:i.size.height+"px"})},stop:function(e,i){var o=i.size.width*t._oCanvas.width/i.originalSize.width,s=i.size.height*t._oCanvas.height/i.originalSize.height,r=t._oCanvas.width,a=t._oCanvas.height;t.$("image").removeClass("sapSuiteUiCommonsImageEditorCanvasResize");t._$Container.css({top:"",left:""});t.setSize(o,s,true);t._refreshContainerSize();t._updateTransformation();t.fireSizeChanged({width:t.getPreviewWidth(),height:t.getPreviewHeight(),originalWidth:r,originalHeight:a})},handles:{nw:e.filter(".ui-resizable-nw"),ne:e.filter(".ui-resizable-ne"),sw:e.filter(".ui-resizable-sw"),se:e.filter(".ui-resizable-se"),n:e.filter(".ui-resizable-n"),s:e.filter(".ui-resizable-s"),w:e.filter(".ui-resizable-w"),e:e.filter(".ui-resizable-e")}});C._setupMobileDraggable(this._$Container)};w.prototype._initCropArea=function(){var t=this,e=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle"),i=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle .sapSuiteUiCommonsImageEditorHandlerContainer"),o=this.$().find(".sapSuiteUiCommonsImageEditorDragHandlerContainer")[0];function s(e,i){var o=getComputedStyle(i.helper[0]);t._setOverlayMaskSize(i.position.left,i.position.top,i.size?i.size.width:parseFloat(o.width),i.size?i.size.height:parseFloat(o.height),"px");t._refreshCropContainerLook()}function r(e,i){var o=jQuery(this),s=this.getBoundingClientRect(),r=o.position(),a=t._transposeViewportCoordsToImageCoords(r.left,r.top,s.width,s.height),n=t.getCropArea(),h;h=t._limitCropArea(a.x,a.y,a.width,a.height);t._setCropArea(h.x,h.y,h.width,h.height);h=t.getCropArea();t.fireCropAreaChanged({cropArea:h,originalCropArea:n})}e.resizable({aspectRatio:this.getKeepCropAspectRatio(),containment:"parent",minWidth:w.LIMITS.CROP_AREA_MIN,minHeight:w.LIMITS.CROP_AREA_MIN,resize:s,stop:r,handles:{nw:i.filter(".ui-resizable-nw"),ne:i.filter(".ui-resizable-ne"),sw:i.filter(".ui-resizable-sw"),se:i.filter(".ui-resizable-se"),n:i.filter(".ui-resizable-n"),s:i.filter(".ui-resizable-s"),w:i.filter(".ui-resizable-w"),e:i.filter(".ui-resizable-e")}});o.onmousewheel=this._onMouseWheel.bind(this);e.draggable({containment:"parent",handle:o,drag:s,stop:r});C._setupMobileDraggable(e);e.css("position","absolute")};w.prototype._getLastImg=function(){return this._oSavedImg};w.prototype._storeCurrentImg=function(){this._oSavedImg.width=this._oCanvas.width;this._oSavedImg.height=this._oCanvas.height;this._oSavedImg.getContext("2d").drawImage(this._oCanvas,0,0)};w.prototype._addHistory=function(t,e){if(e){this._oPreview=t}else{this._addNewHistory(t);this._oPreview=null}this._updateFilters()};w.prototype._applyPreview=function(){if(!this._oPreview){return}this._addNewHistory(this._oPreview);this._oPreview=null};w.prototype._addNewHistory=function(t){this._aHistory=this._aHistory.slice(this._iHistoryIndex);this._iHistoryIndex=0;if(this._aHistory.length===0||!this._aHistory[0].compare(t)){this._aHistory.unshift(t);this._storeCurrentImg();this._fireHistoryChanged()}};w.prototype._cancelPreview=function(){if(!this._oPreview){return}this._oPreview=null;this._updateFilters();this._drawImage(this._getLastImg())};w.prototype._jumpToHistory=function(t){var e=this._iHistoryIndex,i,o;this._iHistoryIndex=Math.min(this._aHistory.length,Math.max(0,t));if(e===this._iHistoryIndex){return}if(e<this._iHistoryIndex){this._drawImage(this._oOrigImg);this._storeCurrentImg();this._applyExifOrientation();o=this._aHistory.length-1}else{o=e-1}for(o;o>=this._iHistoryIndex;o--){i=this._aHistory[o];switch(i.getMetadata().getName()){case"sap.suite.ui.commons.imageeditor.RotateHistoryItem":{this._setRotation(i.getDegrees());break}case"sap.suite.ui.commons.imageeditor.ResizeHistoryItem":{this._setCanvasSize(i.getWidth(),i.getHeight());break}case"sap.suite.ui.commons.imageeditor.FlipHistoryItem":{this._flip(i.getVertical(),i.getHorizontal());break}case"sap.suite.ui.commons.imageeditor.FilterHistoryItem":{if(this._needsManualFilter()){this._applyFilterItem(i)}break}case"sap.suite.ui.commons.imageeditor.CropRectangleHistoryItem":{this._rectangleCrop(i.getX(),i.getY(),i.getWidth(),i.getHeight());break}case"sap.suite.ui.commons.imageeditor.CropEllipseHistoryItem":{this._ellipseCrop(i.getX(),i.getY(),i.getRx(),i.getRy());break}case"sap.suite.ui.commons.imageeditor.CropCustomShapeHistoryItem":{this._customShapeCrop(i.getX(),i.getY(),i.getWidth(),i.getHeight());break}default:{break}}this._storeCurrentImg()}this._updateFilters();this._fireHistoryChanged()};w.prototype._fireHistoryChanged=function(){this.fireHistoryChanged({history:this._aHistory.slice(),index:this._iHistoryIndex})};w.prototype._onMouseDown=function(t){if(t.button!==0||t.target!==this.getDomRef()&&t.target!==this._oCanvas){return}var e=this,i=t.clientX,o=t.clientY;t.preventDefault();function s(t){var s=t.clientX,r=t.clientY,a=s-i,n=r-o,h=e.getDomRef();h.scrollLeft-=a;h.scrollTop-=n;i=s;o=r}function r(){document.removeEventListener("mousemove",s);document.removeEventListener("mouseup",r)}document.addEventListener("mousemove",s);document.addEventListener("mouseup",r)};w.prototype._onMouseWheel=function(t){if(!t.ctrlKey){return}t.preventDefault();var e=t.wheelDeltaY>0?this._zoomIn.bind(this):this._zoomOut.bind(this);e({x:(t.clientX-this._$Container[0].getBoundingClientRect().x)/this.getZoomLevel()*100,y:(t.clientY-this._$Container[0].getBoundingClientRect().y)/this.getZoomLevel()*100});this.fireZoomChanged({zoom:this._fZoom})};w.prototype._limitCropArea=function(t,e,i,o,s){var r=this._getMaxCropAreaWidth(s),a=this._getMinCropAreaWidth(s),n=this._getMaxCropAreaHeight(s),h=this._getMinCropAreaHeight(s);t=t&&t<0?0:t;e=e&&e<0?0:e;i=this._constraintValue(i,a,r);o=this._constraintValue(o,h,n);if(t+i>this.getWidth()){t-=t+i-this.getWidth()}if(e+o>this.getHeight()){e-=e+o-this.getHeight()}return{x:t,y:e,width:i,height:o}};w.prototype._limitCurrentCropArea=function(){var t=this.getCropArea();if(t){this.setCropArea(t.x,t.y,t.width,t.height)}};w.prototype._getMaxCropAreaWidth=function(t){var e,i=this.getCropArea();if(t&&this.getKeepCropAspectRatio()&&i&&this.getWidth()/this.getHeight()>i.width/i.height){e=i.width*this._getMaxCropAreaHeight()/i.height}else{e=this.getWidth()}return Math.round(e)};w.prototype._getMinCropAreaWidth=function(t){var e,i=this.getCropArea();if(t&&this.getKeepCropAspectRatio()&&i&&i.width>i.height){i=this.getCropArea();e=i.width*this._getMinCropAreaHeight()/i.height}else{e=w.LIMITS.CROP_AREA_MIN}return Math.round(e)};w.prototype._getMaxCropAreaHeight=function(t){var e,i=this.getCropArea();if(t&&this.getKeepCropAspectRatio()&&i&&this.getWidth()/this.getHeight()<i.width/i.height){i=this.getCropArea();e=i.height*this._getMaxCropAreaWidth()/i.width}else{e=this.getHeight()}return Math.round(e)};w.prototype._getMinCropAreaHeight=function(t){var e,i=this.getCropArea();if(t&&this.getKeepCropAspectRatio()&&i&&i.width<i.height){i=this.getCropArea();e=i.height*this._getMinCropAreaWidth()/i.width}else{e=w.LIMITS.CROP_AREA_MIN}return Math.round(e)};w.prototype._scaleCropArea=function(t,e){var i=this.getCropArea();if(i&&typeof i.x==="number"&&typeof i.width==="number"){i.newWidth=i.width*(t/e);i.newHeight=i.height*(t/e);i.x+=(i.width-i.newWidth)/2;i.y+=(i.height-i.newHeight)/2;i=this._limitCropArea(i.x,i.y,i.newWidth,i.newHeight,true);this._setCropArea(i.x,i.y,i.width,i.height)}};w.prototype._setCropArea=function(t,e,i,o){this._oCropArea={x:t,y:e,width:i,height:o};if(!this._isReady()){return}var s;if(typeof this._oCropArea.x!=="number"){this._oCropArea.x=(this.getWidth()-i)/2;this._oCropArea.y=(this.getHeight()-o)/2}s=this._transposeImageCoordsPxToPercent(this._oCropArea.x,this._oCropArea.y,this._oCropArea.width,this._oCropArea.height);this._refreshCropContainerSize();this._setOverlayMaskSize(s.x,s.y,s.width,s.height,"%");this._refreshOverlayMask();this._refreshCropContainerLook();this._updateCropAreaHandlerColors()};w.prototype._setOverlayMaskSize=function(t,e,i,o,s){var r;r=this.$("overlayMaskRect");r.attr({x:t+s,y:e+s,width:i+s,height:o+s});r=this.$("overlayMaskEllipse");r.attr({cx:t+i/2+s,cy:e+o/2+s,rx:i/2+s,ry:o/2+s});r=this.$("overlayMaskCustomBlack");r.attr({x:t+s,y:e+s,width:i+s,height:o+s});r=this.$("overlayMaskCustomWhite");r.attr({x:t+s,y:e+s,width:i+s,height:o+s})};w.prototype._constraintValue=function(t,e,i){if(isNaN(t)||t<e){t=e}else if(t>i){t=i}return Math.round(t)};w.prototype._setZoom=function(t,e){var i=this._fZoom,o=this.getDomRef(),s,r,a,n,h,p,l,g;this._fZoom=parseFloat(t.toFixed(2));if(this._fZoom<=0){this._fZoom=1}e=e||{};if(o){a=o.clientWidth;n=o.clientHeight;h=o.scrollLeft;p=o.scrollTop}this._updateTransformation();this._refreshContainerSize();if(o){s=o.getBoundingClientRect();r=this._$Container[0].getBoundingClientRect();e.x=e.x||(o.clientWidth/2+s.x-(r.x-(a-o.clientWidth)/2))/i*100;e.y=e.y||(o.clientHeight/2+s.y-(r.y-(n-o.clientHeight)/2))/i*100}if(e.x&&e.y){l=o.scrollLeft+(e.x/100*this.getZoomLevel()-o.scrollLeft)-(e.x/100*i-h);g=o.scrollTop+(e.y/100*this.getZoomLevel()-o.scrollTop)-(e.y/100*i-p)}if(o&&e.x){o.scrollLeft=l}if(o&&e.y){o.scrollTop=g}if(this.getScaleCropArea()){this._scaleCropArea(i,this._fZoom)}this._refreshCropContainerLook()};w.prototype._getScale=function(){return this._fZoom/100};w.prototype._zoomIn=function(t){var e=w.ZOOM_MILESTONES.indexOf(this._fZoom),i=this._fZoom,o;if(e>=0&&e<w.ZOOM_MILESTONES.length-1){i=w.ZOOM_MILESTONES[e+1]}else{for(o=0;o<w.ZOOM_MILESTONES.length;o++){if(w.ZOOM_MILESTONES[o]>i){i=w.ZOOM_MILESTONES[o];break}}}this._setZoom(i,t)};w.prototype._zoomOut=function(t){var e=w.ZOOM_MILESTONES.indexOf(this._fZoom),i=this._fZoom,o;if(e>0){i=w.ZOOM_MILESTONES[e-1]}else{for(o=w.ZOOM_MILESTONES.length-1;o>=0;o--){if(w.ZOOM_MILESTONES[o]<i){i=w.ZOOM_MILESTONES[o];break}}}this._setZoom(i,t)};w.prototype._zoomToFit=function(){this._$Container.css({width:"",height:"",margin:"0px"});this._oCanvas.style.maxWidth="100%";this._oCanvas.style.maxHeight="100%";this._oCanvas.style.transform="";var t=this._oCanvas.getBoundingClientRect().width*100/this._oCanvas.width;this._oCanvas.style.maxWidth="";this._oCanvas.style.maxHeight="";this._$Container.css({margin:"auto"});this.zoom(t)};w.prototype._setCanvasSize=function(t,e){var i=this._getLastImg();this._oCanvas.width=t;this._oCanvas.height=e;this._oContext.drawImage(i,0,0,i.width,i.height,0,0,t,e);this._refreshContainerSize()};w.prototype._setRotation=function(t){var e=this._getLastImg(),i,o,s;i=this._degToRad(t);this._oCanvas.width=Math.abs(e.width*Math.cos(i))+Math.abs(e.height*Math.sin(i));this._oCanvas.height=Math.abs(e.width*Math.sin(i))+Math.abs(e.height*Math.cos(i));o=this._limitCanvasSize(this._oCanvas.width,this._oCanvas.height);s=o.width/this._oCanvas.width;this._oCanvas.width=o.width;this._oCanvas.height=o.height;this._oContext.save();this._oContext.translate(this._oCanvas.width/2,this._oCanvas.height/2);this._oContext.rotate(i);this._oContext.translate(-this._oCanvas.width/2,-this._oCanvas.height/2);this._oContext.drawImage(e,0,0,e.width,e.height,Math.round((this._oCanvas.width-e.width*s)/2),Math.round((this._oCanvas.height-e.height*s)/2),e.width*s,e.height*s);this._oContext.restore();this._refreshContainerSize()};w.prototype._flipVertical=function(){this._flip(true,false)};w.prototype._flipHorizontal=function(){this._flip(false,true)};w.prototype._flip=function(t,e){var i=this._getLastImg(),o=document.createElement("canvas"),s=o.getContext("2d");o.width=i.width;o.height=i.height;s.translate(e?i.width:0,t?i.height:0);s.scale(e?-1:1,t?-1:1);s.drawImage(i,0,0);this._oContext.clearRect(0,0,this._oCanvas.width,this._oCanvas.height);this._oContext.drawImage(o,0,0)};w.prototype._transposeViewportCoordsToImageCoords=function(t,e,i,o){if(!this._isReady()){return{x:0,y:0,width:0,height:0}}var s=this._oCanvas.getBoundingClientRect(),r=this._oCanvas.width/s.width,a=this._oCanvas.height/s.height;return{x:t*r,y:e*a,width:i*r,height:o*a}};w.prototype._transposeImageCoordsToViewportCoords=function(t,e,i,o){if(!this._isReady()){return{x:0,y:0,width:0,height:0}}var s=this._oCanvas.getBoundingClientRect(),r=this._oCanvas.width/s.width,a=this._oCanvas.height/s.height;return{x:t/r,y:e/a,width:i/r,height:o/a}};w.prototype._transposeImageCoordsPxToPercent=function(t,e,i,o){return{x:t*100/this._oCanvas.width,y:e*100/this._oCanvas.height,width:i*100/this._oCanvas.width,height:o*100/this._oCanvas.height}};w.prototype._transposePercentToImageCoordsPx=function(t,e,i,o){return{x:t*this._oCanvas.width/100,y:e*this._oCanvas.height/100,width:i*this._oCanvas.width/100,height:o*this._oCanvas.height/100}};w.prototype._transposeViewPortPxToPercent=function(t,e,i,o){var s=this._$Container[0].getBoundingClientRect();return{x:t*100/s.width,y:e*100/s.height,width:i*100/s.width,height:o*100/s.height}};w.prototype._updateCropAreaHandlerColors=function(){var t;if(!this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle").is(":visible")){return}var e=this;this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle .sapSuiteUiCommonsImageEditorHandlerContainer").each(function(){var i=jQuery(this);if(!i.is(":visible")||i.width()===0||i.height()===0){return}t=e._getContrastColorForElement(this);for(var o=0;o<this.childElementCount;o++){this.children[o].style.background=t}})};w.prototype._getContrastColorForElement=function(t){var e=this._oCanvas.getBoundingClientRect(),i=t.getBoundingClientRect(),o=this._transposeViewportCoordsToImageCoords(i.left-e.left,i.top-e.top,i.width,i.height),s=this._getContrastColorForRectangleArea(o.x,o.y,o.width,o.height);return s};w.prototype._getContrastColorForRectangleArea=function(t,e,i,o){var s=this._getRectangleAreaAvg(t,e,i,o);return s>.5*.5?"white":"black"};w.prototype._getRectangleAreaAvg=function(t,e,i,o){if(i===0||o===0){return 0}var s=this._oContext.getImageData(t,e,Math.ceil(i),Math.ceil(o)).data,r=0,a,n,h,p;for(var l=0;l<s.length;l+=4){a=1-s[l]/255;n=1-s[l+1]/255;h=1-s[l+2]/255;p=s[l+3]/255;r+=(.2126*a*a+.7152*n*n+.0722*h*h)*p}return r/(s.length/4)};w.prototype._updateResizableCropAspectRatio=function(){var t=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle"),e=this.getKeepCropAspectRatio();this._updateResizableAspectRatio(t,e)};w.prototype._updateResizableResizeAspectRatio=function(){var t=this.getKeepResizeAspectRatio();this._updateResizableAspectRatio(this._$Container,t)};w.prototype._updateResizableAspectRatio=function(t,e){if(t&&t.data("uiResizable")){t.resizable("option","aspectRatio",e).data("uiResizable")._aspectRatio=e}};w.prototype._applyRectangleCrop=function(t){var e=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle")[0].getBoundingClientRect(),i=this._oCanvas.getBoundingClientRect(),o=this._transposeViewportCoordsToImageCoords(e.left-i.left,e.top-i.top,e.width,e.height);this.rectangleCrop(o.x,o.y,o.width,o.height,t)};w.prototype._rectangleCrop=function(t,e,i,o){var s=document.createElement("canvas");s.width=Math.round(i);s.height=Math.round(o);s.getContext("2d").drawImage(this._oCanvas,t,e,i,o,0,0,i,o);this._drawImage(s);this._refreshCropContainerSize()};w.prototype._applyEllipseCrop=function(t){var e,i,o;e=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle")[0].getBoundingClientRect();i=this._oCanvas.getBoundingClientRect();o=this._transposeViewportCoordsToImageCoords(e.left-i.left,e.top-i.top,e.width,e.height);this.ellipseCrop(o.width/2+o.x,o.height/2+o.y,o.width/2,o.height/2,t)};w.prototype._ellipseCrop=function(t,e,i,o){var s=document.createElement("canvas"),r=i*2,a=o*2,n=s.getContext("2d");s.width=Math.round(r);s.height=Math.round(a);if(!n.ellipse){n.save();n.translate(i,o);n.scale(i,o);n.arc(0,0,1,0,360);n.restore()}else{n.ellipse(i,o,i,o,0,0,2*Math.PI)}n.fill();n.globalCompositeOperation="source-in";n.drawImage(this._oCanvas,t-i,e-o,r,a,0,0,r,a);this._drawImage(s);this._refreshCropContainerSize()};w.prototype._applyCustomShapeCrop=function(t){var e,i,o;e=this.$().find(".sapSuiteUiCommonsImageEditorCropInnerRectangle")[0].getBoundingClientRect();i=this._oCanvas.getBoundingClientRect();o=this._transposeViewportCoordsToImageCoords(e.left-i.left,e.top-i.top,e.width,e.height);this.customShapeCrop(o.x,o.y,o.width,o.height,t)};w.prototype._customShapeCrop=function(t,e,i,o){var s=document.createElement("canvas"),r=s.getContext("2d");s.width=i;s.height=o;r.drawImage(this._oCustomShapeImg,0,0,i,o);r.globalCompositeOperation="source-in";r.drawImage(this._oCanvas,t,e,i,o,0,0,i,o);r.globalCompositeOperation="source-over";this._drawImage(s);this._refreshCropContainerSize()};w.prototype._getFinalisedCanvas=function(){var t=this.getWidth(),e=this.getHeight(),i,o,s;i=this._getLastImg().getContext("2d").getImageData(0,0,t,e);this._applyFilterHistory(i);o=document.createElement("canvas");s=o.getContext("2d");o.width=t;o.height=e;s.putImageData(i,0,0);return o};w.prototype._applyFilterHistory=function(t){var e;for(var i=this._aHistory.length-1;i>=this._iHistoryIndex;i--){if(this._aHistory[i].isA("sap.suite.ui.commons.imageeditor.FilterHistoryItem")){e=this._aHistory[i];m[e.getType()](t,e.getValue()/100)}}};w.prototype._applyFilterItem=function(t){var e=this._getLastImg(),i=e.getContext("2d"),o=i.getImageData(0,0,e.width,e.height);m[t.getType()](o,t.getValue()/100);this._oContext.putImageData(o,0,0)};w.prototype._updateFilters=function(){var t="",e;function i(t){return t.getType()+"("+t.getValue()+t.getUnit()+") "}if(this._needsManualFilter()){if(this._isReady()){if(this._oPreview&&this._oPreview.isA("sap.suite.ui.commons.imageeditor.FilterHistoryItem")){this._applyFilterItem(this._oPreview)}}}else{for(var o=this._aHistory.length-1;o>=this._iHistoryIndex;o--){e=this._aHistory[o];if(e.isA("sap.suite.ui.commons.imageeditor.FilterHistoryItem")){t+=i(e)}}if(this._oPreview&&this._oPreview.isA("sap.suite.ui.commons.imageeditor.FilterHistoryItem")){t+=i(this._oPreview)}this._oCanvas.style.filter=t.trim()}};w.prototype._needsManualFilter=function(){return r.browser.msie||r.os.name===r.os.OS.IOS};w.prototype._isMobileSafari=function(){return r.os.name===r.os.OS.IOS&&r.browser.name===r.browser.BROWSER.SAFARI};w.prototype._reset=function(){this.$().addClass("sapSuiteUiCommonsImageEditorEmpty");this._aHistory=[];this._iHistoryIndex=0;this._oPreview=null;this._bImageLoaded=false;this._oCropArea=null;this._oCanvas.width=0;this._oCanvas.height=0;this._oOriginalBlob=null;this._sOriginalFileName=null;this._sOriginalFileType=null;this._iExifRotation=null;this._bExifFlip=false;this._updateFilters();this._refreshContainerSize()};w.prototype._drawImage=function(t){var e=this._limitCanvasSize(t.width,t.height);this._oCanvas.width=e.width;this._oCanvas.height=e.height;this._oContext.drawImage(t,0,0,t.width,t.height,0,0,this._oCanvas.width,this._oCanvas.height);this._refreshContainerSize()};w.prototype._limitCanvasSize=function(t,e,i){var o=this._isMobileSafari()?w.LIMITS.MAX_SAFARI_MOBILE_CANVAS_SIZE:w.LIMITS.MAX_CANVAS_SIZE,s=t,r=e,n;if(t*e>o){n=Math.sqrt(o/(t*e));s=Math.floor(t*n);r=Math.floor(r*s/t);if(!i){this.fireSizeChanged({width:s,height:r,originalWidth:t,originalHeight:e});a.show(I.getText("IMGEDITOR_SCALE_WARNING",[s,r,t,e]),{duration:6e3})}}return{width:s,height:r}};w.prototype._degToRad=function(t){return t*Math.PI/180};w.prototype._RadToDeg=function(t){return t*180/Math.PI};w.prototype._getCropAreaDragIcon=function(){if(!this._cropAreaDragIcon){this._cropAreaDragIcon=new n({src:"sap-icon://move",useIconTooltip:false})}return this._cropAreaDragIcon};return w});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ImageEditorContainer", ["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/suite/ui/commons/library","sap/ui/core/library","sap/m/library","./ImageEditor","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarLayoutData","sap/m/ToggleButton","sap/m/ToolbarSeparator","sap/m/ToolbarSpacer","sap/m/Label","sap/m/Slider","sap/m/Input","sap/m/CheckBox","sap/ui/model/json/JSONModel","sap/m/MenuButton","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/Select","sap/m/Button","sap/ui/core/Item","sap/m/ResponsivePopover","sap/m/List","sap/m/StandardListItem","sap/m/CustomListItem","sap/m/FlexBox","sap/m/FlexItemData","sap/m/IconTabBar","sap/m/IconTabFilter","sap/ui/core/Icon","sap/ui/core/HTML","sap/m/Switch","sap/suite/ui/commons/ControlProxy","sap/base/Log","sap/ui/unified/FileUploader","sap/ui/base/ManagedObjectObserver","sap/ui/core/ResizeHandler","./ImageEditorContainerRenderer"],function(jQuery,t,e,o,i,r,s,a,n,l,p,h,d,u,g,m,c,_,I,y,f,T,C,b,S,M,E,R,O,P,L,A,w,B,v,F,x,G,H,z){"use strict";var D=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var N=i.InputType,Z=i.ListType,k=e.ImageEditorMode,V=e.ImageEditorContainerMode,U=e.ImageEditorContainerButton,K=o.ValueState,W=i.ListMode,X=i.ButtonType,j=i.FlexDirection,Y=i.FlexRendertype,$=i.FlexJustifyContent,J=i.FlexAlignItems,q=i.IconTabDensityMode,Q=i.BackgroundDesign,tt=i.SwitchType,et=o.TextAlign,ot=Object.freeze({WIDTH:{min:r.LIMITS.WIDTH_MIN,max:r.LIMITS.WIDTH_MAX,callback:"_setWidth"},HEIGHT:{min:r.LIMITS.HEIGHT_MIN,max:r.LIMITS.HEIGHT_MAX,callback:"_setHeight"},ROTATION:{min:r.LIMITS.ROTATION_MIN,max:r.LIMITS.ROTATION_MAX,callback:"_rotate"},FILTER:{callback:"_applyCurrentFilter"}}),it=Object.freeze({CUSTOMSIZE:"sap-icon://write-new-document",ORIGINALSIZE:"sap-icon://table-view",ROTATELEFT:"sap-icon://response",ROTATERIGHT:"sap-icon://forward",CROPRECTANGLE:"sap-icon://color-fill",CROPELLIPSE:"sap-icon://circle-task-2",CROPCUSTOMSHAPE:"sap-icon://add-favorite",TRANSFORM:"sap-icon://draw-rectangle",FILTER:"sap-icon://palette",CROP:"sap-icon://crop",UNDO:"sap-icon://undo",DROPDOWN:"sap-icon://slim-arrow-down",ZONES:"sap-icon://tag",LOCK:"sap-icon://locked",RESET:"sap-icon://reset",FLIPVERTICAL:"sap-icon://resize-vertical",FLIPHORIZONTAL:"sap-icon://resize-horizontal",RELATIVE:"sap-icon://resize",ZOOMIN:"sap-icon://zoom-in",ZOOMOUT:"sap-icon://zoom-out",ZOOMFIT:"sap-icon://popup-window"});var rt=t.extend("sap.suite.ui.commons.imageeditor.ImageEditorContainer",{metadata:{library:"sap.suite.ui.commons",properties:{mode:{type:"sap.suite.ui.commons.ImageEditorContainerMode",defaultValue:V.Filter},enabledButtons:{type:"sap.suite.ui.commons.ImageEditorContainerButton[]",defaultValue:[U.Filter,U.Transform,U.Crop]}},defaultAggregation:"imageEditor",aggregations:{imageEditor:{type:"sap.suite.ui.commons.imageeditor.ImageEditor",multiple:false,singularName:"imageEditor"},customToolbarControls:{type:"sap.ui.core.Control",multiple:true,singularName:"customToolbarControl"},customResizeItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customResizeItem"},customRectangleCropItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customRectangleCropItem"},customEllipseCropItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customEllipseCropItem"}}}});var st=Object.freeze({NUM_KEPT_ITEMS:2});rt.prototype.init=function(){var t={enabled:false,mode:null,zoom:100,transform:{keepAspectRatio:true,width:null,height:null,widthValueState:K.None,widthValueStateText:null,heightValueState:K.None,heightValueStateText:null,rotate:0,rotateValueState:K.None,rotateValueStateText:null,selectedTypeKey:"Resize",flipVertical:false,flipHorizontal:false,resizes:[{key:"custom",text:D.getText("IMGEDITOR_CUSTOM_SIZE"),icon:it.CUSTOMSIZE,unlockRatio:true},{key:"original",text:D.getText("IMGEDITOR_ORIGINAL_SIZE"),icon:it.ORIGINALSIZE}],rotates:[{key:"90left",text:D.getText("IMGEDITOR_ROTATE_90LEFT"),rotate:-90,icon:it.ROTATELEFT},{key:"90right",text:D.getText("IMGEDITOR_ROTATE_90RIGHT"),rotate:90,icon:it.ROTATERIGHT},{key:"45left",text:D.getText("IMGEDITOR_ROTATE_45LEFT"),rotate:-45,icon:it.ROTATELEFT},{key:"45right",text:D.getText("IMGEDITOR_ROTATE_45RIGHT"),rotate:45,icon:it.ROTATERIGHT}],flips:[{key:"vertical",text:D.getText("IMGEDITOR_FLIP_VERTICAL"),icon:it.FLIPVERTICAL,flipVertical:true,flipHorizontal:false},{key:"horizontal",text:D.getText("IMGEDITOR_FLIP_HORIZONTAL"),icon:it.FLIPHORIZONTAL,flipVertical:false,flipHorizontal:true}]},crop:{scaleCropArea:false,customShapeLoaded:false,zoom:100,zoomValueState:K.None,zoomValueStateText:null,width:null,widthValueState:K.None,widthValueStateText:null,height:null,heightValueState:K.None,heightValueStateText:null,keepAspectRatio:true,selectedTypeKey:"Rectangle",selectedType:null,enabled:true,areaRectangle:{x:10,y:10,width:80,height:80},types:[{key:"Rectangle",text:"",icon:it.CROPRECTANGLE,apply:"applyVisibleCrop"},{key:"Ellipse",text:"",icon:it.CROPELLIPSE,apply:"applyVisibleCrop"},{key:"CustomShape",text:"",icon:it.CROPCUSTOMSHAPE,apply:"applyVisibleCrop"}],ratiosRectangle:[{key:"custom",text:D.getText("IMGEDITOR_CUSTOM_SIZE"),icon:it.CUSTOMSIZE,unlockRatio:true,relative:true},{key:"original",text:D.getText("IMGEDITOR_CROP_RATIO_ORIGINAL"),width:null,height:null,icon:it.ORIGINALSIZE,relative:true}],ratiosCircle:[{key:"custom",text:D.getText("IMGEDITOR_CUSTOM_SIZE"),icon:it.CUSTOMSIZE,unlockRatio:true,relative:true},{key:"original",text:D.getText("IMGEDITOR_CROP_RATIO_ORIGINAL"),width:null,height:null,icon:it.ORIGINALSIZE,relative:true}],ratiosCustomShape:[{key:"custom",text:D.getText("IMGEDITOR_CUSTOM_SIZE"),icon:it.CUSTOMSIZE,unlockRatio:true,relative:true},{key:"original",text:D.getText("IMGEDITOR_CROP_RATIO_ORIGINAL"),callback:"_setCustomShapeCropAreaRatio",icon:it.ORIGINALSIZE,relative:true}]},filter:{filterValueState:K.None,filterValueStateText:null,selectedFilter:null,filters:[{text:D.getText("IMGEDITOR_FILTER_BRIGHTNESS"),type:"brightness",value:100,defaultValue:100,unit:"%",min:r.LIMITS.BRIGHTNESS_MIN,max:r.LIMITS.BRIGHTNESS_MAX},{text:D.getText("IMGEDITOR_FILTER_CONTRAST"),type:"contrast",value:100,defaultValue:100,unit:"%",min:r.LIMITS.CONTRAST_MIN,max:r.LIMITS.CONTRAST_MAX},{text:D.getText("IMGEDITOR_FILTER_SATURATION"),type:"saturate",value:100,defaultValue:100,unit:"%",min:r.LIMITS.SATURATE_MIN,max:r.LIMITS.SATURATE_MAX},{text:D.getText("IMGEDITOR_FILTER_GRAYSCALE"),type:"grayscale",value:0,defaultValue:0,unit:"%",min:r.LIMITS.GRAYSCALE_MIN,max:r.LIMITS.GRAYSCALE_MAX},{text:D.getText("IMGEDITOR_FILTER_INVERT"),type:"invert",value:0,defaultValue:0,unit:"%",min:r.LIMITS.INVERT_MIN,max:r.LIMITS.INVERT_MAX},{text:D.getText("IMGEDITOR_FILTER_SEPIA"),type:"sepia",value:0,defaultValue:0,unit:"%",min:r.LIMITS.SEPIA_MIN,max:r.LIMITS.SEPIA_MAX}]},history:[],historyIndex:0};this._bFirstTimeRendered=true;this._oObserver=new H(this._onManagedObjectChange.bind(this));this._oObserver.observe(this,{properties:["enabledButtons"],aggregations:["customToolbarControls"]});this._oModel=new _(t);this._oThumbnailCanvas=document.createElement("canvas");this._updateToolbarsContent();this["_setMode"+this.getMode()]()};rt.prototype.onBeforeRendering=function(){if(this._sResizeHandlerId){z.deregister(this._sResizeHandlerId)}};rt.prototype.onAfterRendering=function(){var t=this;this._bIsSmallSize=this._isSmallSize();function e(){sap.ui.getCore().detachThemeChanged(e);t._zoomToFit()}if(this._bFirstTimeRendered&&this.getImageEditor()){this._bFirstTimeRendered=false;if(sap.ui.getCore().isThemeApplied()){this._zoomToFit()}else{sap.ui.getCore().attachThemeChanged(e)}}this._sResizeHandlerId=z.register(this,this._onResize.bind(this))};rt.prototype.onExit=function(){if(this._sResizeHandlerId){z.deregister(this._sResizeHandlerId)}};rt.prototype._onResize=function(){var t=this._isSmallSize();if(this._bIsSmallSize!==t){this._bIsSmallSize=t;this.rerender()}};rt.prototype._isSmallSize=function(){var t=sap.m.ScreenSizes&&sap.m.ScreenSizes.table||600;return this.$()[0]&&this.$().width()<t};rt.prototype._zoomToFit=function(){var t=this.getImageEditor();if(t&&t._isReady()&&this.getDomRef()){t.zoomToFit();this._oModel.setProperty("/zoom",t.getZoomLevel());this._refreshCropAreaSize()}};rt.prototype.exit=function(){this._oObserver.disconnect();this._oObserver.destroy()};rt.prototype.setMode=function(t){this.setProperty("mode",t,true);this["_setMode"+this.getMode()]();return this};rt.prototype.setImageEditor=function(t){this._detachEditorEvents(this.getImageEditor());this.setAggregation("imageEditor",t);this._attachEditorEvents(t);if(t&&t.getLoaded()){this._onImageLoaded()}if(t&&t.getCustomShapeLoaded()){this._onCustomShapeLoaded()}return this};rt.prototype.destroyImageEditor=function(){this._detachEditorEvents(this.getImageEditor());this.destroyAggregation("imageEditor");this._oModel.setProperty("/enabled",false);return this};rt.prototype.getToolbar=function(){return this._getHeaderToolbar()};rt.prototype.getToolbarIds=function(){return{filter:this.getId()+"-filterButton",crop:this.getId()+"-cropButton",transform:this.getId()+"-transformButton",undo:this.getId()+"-undoButton",history:this.getId()+"-historyButton",zoomIn:this.getId()+"-zoominButton",zoomOut:this.getId()+"-zoomoutButton",zoomToFit:this.getId()+"-zoomToFitButton",zoomLabel:this.getId()+"-zoomLabel",separator:this.getId()+"-separator"}};rt.prototype.getMobileHeaderToolbar=function(){return this._getMobileHeaderToolbar()};rt.prototype.getMobileZoomToolbar=function(){return this._getMobileZoomToolbar()};rt.prototype.getMobileZoomToolbarIds=function(){return{zoomIn:this.getId()+"-mobileZoominButton",zoomLabel:this.getId()+"-mobileZoomLabel",zoomOut:this.getId()+"-mobilezoomoutButton",zoomToFit:this.getId()+"-mobileZoomToFitButton",scaleSwitch:this.getId()+"-mobileScaleSwitch",scaleLabel:this.getId()+"-mobileScaleLabel"}};rt.prototype.getMobileFooterToolbar=function(){return this._getMobileFooterToolbar()};rt.prototype.getMobileFooterToolbarIds=function(){return{filter:this.getId()+"-mobileFilterButton",crop:this.getId()+"-mobileCropButton",transform:this.getId()+"-mobileTransformButton",undo:this.getId()+"-mobileUndoButton",history:this.getId()+"-mobileHistoryButton",apply:this.getId()+"-mobileApplyButton"}};rt.prototype._attachEditorEvents=function(t){if(!t){return}t.attachLoaded(this._onImageLoaded,this);t.attachCustomShapeLoaded(this._onCustomShapeLoaded,this);t.attachError(this._onImageError,this);t.attachCropAreaChanged(this._onCropAreaChange,this);t.attachHistoryChanged(this._onHistoryChange,this);t.attachSizeChanged(this._onSizeChange,this);t.attachZoomChanged(this._onZoomChange,this)};rt.prototype._detachEditorEvents=function(t){if(!t){return}t.detachLoaded(this._onImageLoaded,this);t.detachCustomShapeLoaded(this._onCustomShapeLoaded,this);t.detachError(this._onImageError,this);t.detachCropAreaChanged(this._onCropAreaChange,this);t.detachHistoryChanged(this._onHistoryChange,this);t.detachSizeChanged(this._onSizeChange,this);t.detachZoomChanged(this._onZoomChange,this)};rt.prototype._onManagedObjectChange=function(t){if(t.object===this._oMobileHeaderToolbar){this._oMobileHeaderToolbar.setVisible(t.object.getContent().length>0)}else if(t.object===this){this._updateToolbarsContent()}};rt.prototype._refreshImageSize=function(){if(!this.getImageEditor()||!this.getImageEditor().getLoaded()){return}var t=this.getImageEditor().getWidth(),e=this.getImageEditor().getHeight();this._oModel.setProperty("/transform/resizes/1/width",t);this._oModel.setProperty("/transform/resizes/1/height",e);this._oModel.setProperty("/crop/ratiosRectangle/1/width",t);this._oModel.setProperty("/crop/ratiosRectangle/1/height",e);this._oModel.setProperty("/crop/ratiosCircle/1/width",t);this._oModel.setProperty("/crop/ratiosCircle/1/height",e);this._updateCurrentSize(t,e)};rt.prototype._refreshCropAreaSize=function(){var t=this.getImageEditor().getCropArea();if(!t){return}this._updateCropSize(Math.round(t.width),Math.round(t.height))};rt.prototype._onImageLoaded=function(){var t=this.getImageEditor();this._resetValueStates();this._oModel.setProperty("/enabled",!!t.getSrc());if(!t.getSrc()){this._changeOptionsPanelContent();return}this["_setMode"+this.getMode()]();this._refreshImageSize();this._oModel.setProperty("/history",[]);this._oModel.setProperty("/historyIndex",0);this._zoomToFit();this._updateOrigThumbnail();this._resetCurrentPanel()};rt.prototype._onCustomShapeLoaded=function(){var t=this.getImageEditor();if(t.getCustomShapeSrc()&&t.getLoaded()&&t.getMode()===k.CropCustomShape){this._setCustomShapeCropAreaRatio()}this._oModel.setProperty("/crop/customShapeLoaded",!!t.getCustomShapeSrc())};rt.prototype._onImageError=function(){this._resetValueStates();this._changeOptionsPanelContent();this._oModel.setProperty("/enabled",false)};rt.prototype._onCropAreaChange=function(t){this._resetValueStates();this._updateCropSize(Math.round(t.getParameter("cropArea").width),Math.round(t.getParameter("cropArea").height))};rt.prototype._onHistoryChange=function(t){var e=t.getParameter("history"),o=t.getParameter("index");this._resetValueStates();this._refreshImageSize();e.push({noChange:"NoChange"});this._oModel.setProperty("/history",e);this._oModel.setProperty("/historyIndex",o)};rt.prototype._onSizeChange=function(t){this._resetValueStates();this._updateCurrentSize(t.getParameter("width"),t.getParameter("height"));this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio())};rt.prototype._onZoomChange=function(t){var e=t.getParameter("zoom");this._oModel.setProperty("/zoom",e);this._refreshCropAreaSize()};rt.prototype._updateCropSize=function(t,e){this._oModel.setProperty("/crop/width",t);this._oModel.setProperty("/crop/height",e)};rt.prototype._updateCurrentSize=function(t,e){this._oModel.setProperty("/transform/width",t);this._oModel.setProperty("/transform/height",e)};rt.prototype._updateOrigThumbnail=function(){var t=this.$("origThumbnail"),e=this.getImageEditor(),o,i,r=this._oThumbnailCanvas.getContext("2d");if(e.getWidth()>=e.getHeight()){o=300;i=Math.round(e.getHeight()*o/e.getWidth())}else{i=300;o=Math.round(e.getWidth()*i/e.getHeight())}this._oThumbnailCanvas.width=o;this._oThumbnailCanvas.height=i;r.clearRect(0,0,o,i);r.drawImage(e._oCanvas,0,0,o,i);t.attr({href:this._oThumbnailCanvas.toDataURL()});if(t[0]){t[0].setAttribute("viewBox","0 0 "+o+" "+i)}};rt.prototype._getHeaderToolbar=function(){if(!this._oHeaderToolbar){this._oHeaderToolbar=new s({enabled:"{/enabled}"}).addStyleClass("sapSuiteUiCommonsImageEditorContainerHeaderToolbar");this._oHeaderToolbar.setModel(this._oModel);this.addDependent(this._oHeaderToolbar)}return this._oHeaderToolbar};rt.prototype._updateToolbarsContent=function(){var t=this._getHeaderToolbar(),e=this._getMobileHeaderToolbar(),o=this._getMobileFooterToolbar(),i=this.getEnabledButtons(),r;t.removeAllContent();e.removeAllContent();o.removeAllContent();this._getHistoryItems().forEach(function(e){t.addContent(e)});this._getMobileHistoryItems().forEach(function(t){o.addContent(t)});this._getZoomItems().forEach(function(e){t.addContent(e)});t.addContent(this._getToolbarSeparator());for(r=0;r<i.length;r++){switch(i[r]){case U.Filter:{t.addContent(this._getFilterButton());o.addContent(this._getMobileFilterButton());break}case U.Crop:{t.addContent(this._getCropButton());o.addContent(this._getMobileCropButton());break}case U.Transform:{t.addContent(this._getTransformButton());o.addContent(this._getMobileTransformButton());break}case U.History:{break}default:break}}t.addContent(this._getToolbarSpacer());o.addContent(this._getMobileFooterToolbarSpacer());o.addContent(this._getMobileApplyButton());if(this.getCustomToolbarControls().length>0){e.addContent(this._getMobileHeaderToolbarSpacer())}this.getCustomToolbarControls().forEach(function(o){var i=new F,r=new F;this.addDependent(i);i.setAssociation("control",o);t.addContent(i);this.addDependent(r);r.setAssociation("control",o);e.addContent(r)},this)};rt.prototype._getToolbarSpacer=function(){if(!this._oSpacer){this._oSpacer=new d({id:this.getId()+"-spacer"});this.addDependent(this._oSpacer)}return this._oSpacer};rt.prototype._getMobileHeaderToolbarSpacer=function(){if(!this._oMobileHeaderSpacer){this._oMobileHeaderSpacer=new d({id:this.getId()+"-mobileSpacer"});this.addDependent(this._oMobileHeaderSpacer)}return this._oMobileHeaderSpacer};rt.prototype._getMobileFooterToolbarSpacer=function(){if(!this._oMobileFooterSpacer){this._oMobileFooterSpacer=new d({id:this.getId()+"-mobileFooterSpacer"});this.addDependent(this._oMobileFooterSpacer)}return this._oMobileFooterSpacer};rt.prototype._getMobileHeaderToolbar=function(){if(!this._oMobileHeaderToolbar){this._oMobileHeaderToolbar=new s({enabled:"{/enabled}",visible:false}).addStyleClass("sapSuiteUiCommonsImageEditorContainerMobileToolbar");this.addDependent(this._oMobileHeaderToolbar);this._oObserver.observe(this._oMobileHeaderToolbar,{aggregations:["content"]})}return this._oMobileHeaderToolbar};rt.prototype._getMobileZoomToolbar=function(){if(!this._oMobileZoomToolbar){this._oMobileZoomToolbar=new s({enabled:"{/enabled}",content:[this._getMobileZoomInButton(),this._getMobileZoomLabel(),this._getMobileZoomOutButton(),this._getMobileZoomToFitButton(),this._getMobileScaleSwitch(),this._getMobileScaleLabel()]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerMobileToolbar");this._oMobileZoomToolbar.setModel(this._oModel);this.addDependent(this._oMobileZoomToolbar)}return this._oMobileZoomToolbar};rt.prototype._getMobileFooterToolbar=function(){if(!this._oMobileFooterToolbar){this._oMobileFooterToolbar=new s({enabled:"{/enabled}"}).addStyleClass("sapSuiteUiCommonsImageEditorContainerMobileToolbar");this._oMobileFooterToolbar.setModel(this._oModel);this.addDependent(this._oMobileFooterToolbar);if(this._oMobileFooterToolbar._applyContextClassFor){this._oMobileFooterToolbar._applyContextClassFor("footer")}else{x.warning("ImageEditorContainer: _applyContextClassFor method doesn't exist, footer look is not applied on mobile footer toolbar")}}return this._oMobileFooterToolbar};rt.prototype._getHistoryPopover=function(){var t=this;if(!this._oHistoryPopover){this._oHistoryPopover=new S({title:{path:"/history",formatter:function(t){return D.getText("IMGEDITOR_HISTORY_TITLE",String(t.length-1))}},endButton:new C({text:D.getText("IMGEDITOR_HISTORY_CLOSE"),press:function(){t._oHistoryPopover.close()}}),afterOpen:function(){var e=t._oModel.getProperty("/historyIndex"),o=t._oHistoryList.getItems()[e];t._oHistoryList.setSelectedItem(o);o.focus()}});this._oHistoryList=new M({mode:W.SingleSelectMaster,selectionChange:function(e){var o=e.getParameter("listItem"),i=o.getParent().indexOfItem(o);t._jumpToHistory(i)},items:{path:"/history",factory:this._historyItemFactory.bind(this)}});this._oHistoryPopover.setModel(this._oModel);this._oHistoryPopover.addContent(this._oHistoryList);this.addDependent(this._oHistoryPopover)}return this._oHistoryPopover};rt.prototype._historyItemFactory=function(t,e){var o=this._oModel.getProperty("/history").indexOf(e.getProperty()),i=e.getProperty(),r,s,a,n;switch(i.noChange||i.getMetadata().getName()){case"sap.suite.ui.commons.imageeditor.RotateHistoryItem":{s=D.getText("IMGEDITOR_ROTATE");a=i.getDegrees();n=it.TRANSFORM;break}case"sap.suite.ui.commons.imageeditor.ResizeHistoryItem":{s=D.getText("IMGEDITOR_RESIZE");a=D.getText("IMGEDITOR_HISTORY_TEXT",[i.getOldWidth()+" x "+i.getOldHeight(),i.getWidth()+" x "+i.getHeight()]);n=it.TRANSFORM;break}case"sap.suite.ui.commons.imageeditor.FlipHistoryItem":{s=D.getText("IMGEDITOR_FLIP");if(i.getVertical()&&i.getHorizontal()){a=D.getText("IMGEDITOR_FLIP_BOTH");n=it.FLIPHORIZONTAL}else{a=i.getVertical()?D.getText("IMGEDITOR_FLIP_VERTICAL"):D.getText("IMGEDITOR_FLIP_HORIZONTAL");n=i.getVertical()?it.FLIPVERTICAL:it.FLIPHORIZONTAL}break}case"sap.suite.ui.commons.imageeditor.FilterHistoryItem":{s=i.getType();s=s[0].toUpperCase()+s.slice(1);a=i.getValue();n=it.FILTER;break}case"sap.suite.ui.commons.imageeditor.CropRectangleHistoryItem":case"sap.suite.ui.commons.imageeditor.CropEllipseHistoryItem":case"sap.suite.ui.commons.imageeditor.CropCustomShapeHistoryItem":{s=D.getText("IMGEDITOR_CROP");a=D.getText("IMGEDITOR_HISTORY_TEXT",[i.getOldWidth()+" x "+i.getOldHeight(),i.getWidth()+" x "+i.getHeight()]);n=it.CROP;break}case"NoChange":{s=D.getText("IMGEDITOR_HISTORY_ORIGINAL");a=D.getText("IMGEDITOR_HISTORY_ORIGINAL_TEXT");n=it.RESET;break}default:{break}}r=new E({title:s,description:a,icon:n,selected:{path:"/historyIndex",formatter:function(t){return o===t}}});return r};rt.prototype._getHistoryItems=function(){if(!this._aHistoryItems){this._aHistoryItems=[this._getUndoButton(),this._getHistoryArrowButton()]}return this._aHistoryItems};rt.prototype._getMobileHistoryItems=function(){if(!this._aMobileHistoryItems){this._aMobileHistoryItems=[this._getMobileUndoButton(),this._getMobileHistoryArrowButton()]}return this._aMobileHistoryItems};rt.prototype._getUndoButton=function(){if(!this._oHistoryButton){this._oHistoryButton=this._createUndoButton(this.getId()+"-undoButton");this.addDependent(this._oHistoryButton)}return this._oHistoryButton};rt.prototype._getMobileUndoButton=function(){if(!this._oMobileHistoryButton){this._oMobileHistoryButton=this._createUndoButton(this.getId()+"-mobileUndoButton");this.addDependent(this._oMobileHistoryButton)}return this._oMobileHistoryButton};rt.prototype._createUndoButton=function(t){var e=this;return new a({id:t,type:X.Transparent,icon:it.UNDO,enabled:{parts:["/history","/historyIndex"],formatter:function(t,e){return t.length>1&&e<t.length-1}},press:function(){e._undo()},tooltip:D.getText("IMGEDITOR_PANEL_UNDO")})};rt.prototype._getHistoryArrowButton=function(){var t=this;if(!this._oHistoryArrowButton){this._oHistoryArrowButton=this._createHistoryArrowButton(this.getId()+"-historyButton",function(){t._resetValueStates();t._getHistoryPopover().openBy(t._oHistoryArrowButton)});this.addDependent(this._oHistoryArrowButton)}return this._oHistoryArrowButton};rt.prototype._getMobileHistoryArrowButton=function(){var t=this;if(!this._oMobileHistoryArrowButton){this._oMobileHistoryArrowButton=this._createHistoryArrowButton(this.getId()+"-mobileHistoryButton",function(){t._resetValueStates();t._getHistoryPopover().openBy(t._oMobileHistoryArrowButton)});this.addDependent(this._oMobileHistoryArrowButton)}return this._oMobileHistoryArrowButton};rt.prototype._createHistoryArrowButton=function(t,e){return new a({id:t,type:X.Transparent,icon:it.DROPDOWN,enabled:{path:"/history",formatter:function(t){return t.length>1}},press:e,tooltip:D.getText("IMGEDITOR_PANEL_HISTORY")})};rt.prototype._getZoomItems=function(){if(!this._aZoomItems){this._aZoomItems=[this._getZoomInButton(),this._getZoomLabel(),this._getZoomOutButton(),this._getZoomToFitButton()]}return this._aZoomItems};rt.prototype._getZoomInButton=function(){if(!this._oZoomInButton){this._oZoomInButton=this._createZoomInButton(this.getId()+"-zoominButton");this.addDependent(this._oZoomInButton)}return this._oZoomInButton};rt.prototype._getMobileZoomInButton=function(){if(!this._oMobileZoomInButton){this._oMobileZoomInButton=this._createZoomInButton(this.getId()+"-mobileZoominButton");this.addDependent(this._oMobileZoomInButton)}return this._oMobileZoomInButton};rt.prototype._createZoomInButton=function(t){var e=this;return new a({id:t,type:X.Transparent,icon:it.ZOOMIN,press:function(){var t=e.getImageEditor();t.zoomIn();e._oModel.setProperty("/zoom",t.getZoomLevel());e._refreshCropAreaSize()},tooltip:D.getText("IMGEDITOR_PANEL_ZOOMIN")})};rt.prototype._getZoomLabel=function(){if(!this._oZoomLabel){this._oZoomLabel=this._createZoomLabel(this.getId()+"-zoomLabel");this.addDependent(this._oZoomLabel)}return this._oZoomLabel};rt.prototype._getMobileZoomLabel=function(){if(!this._oMobileZoomLabel){this._oMobileZoomLabel=this._createZoomLabel(this.getId()+"-mobileZoomLabel");this.addDependent(this._oMobileZoomLabel)}return this._oMobileZoomLabel};rt.prototype._createZoomLabel=function(t){return new u({id:t,text:{path:"/zoom",formatter:function(t){return t+"%"}}})};rt.prototype._getZoomOutButton=function(){if(!this._oZoomOutButton){this._oZoomOutButton=this._createZoomOutButton(this.getId()+"-zoomoutButton");this.addDependent(this._oZoomOutButton)}return this._oZoomOutButton};rt.prototype._getMobileZoomOutButton=function(){if(!this._oMobileZoomOutButton){this._oMobileZoomOutButton=this._createZoomOutButton(this.getId()+"-mobileZoomoutButton");this.addDependent(this._oMobileZoomOutButton)}return this._oMobileZoomOutButton};rt.prototype._createZoomOutButton=function(t){var e=this;return new a({id:t,type:X.Transparent,icon:it.ZOOMOUT,press:function(){var t=e.getImageEditor();t.zoomOut();e._oModel.setProperty("/zoom",t.getZoomLevel());e._refreshCropAreaSize()},tooltip:D.getText("IMGEDITOR_PANEL_ZOOMOUT")})};rt.prototype._getZoomToFitButton=function(){if(!this._oZoomToFit){this._oZoomToFit=this._createZoomToFitButton(this.getId()+"-zoomToFitButton");this.addDependent(this._oZoomToFit)}return this._oZoomToFit};rt.prototype._getMobileZoomToFitButton=function(){if(!this._oMobileZoomToFit){this._oMobileZoomToFit=this._createZoomToFitButton(this.getId()+"-mobileZoomToFitButton");this.addDependent(this._oMobileZoomToFit)}return this._oMobileZoomToFit};rt.prototype._createZoomToFitButton=function(t){var e=this;return new a({id:t,type:X.Transparent,icon:it.ZOOMFIT,press:e._zoomToFit.bind(e),tooltip:D.getText("IMGEDITOR_PANEL_ZOOMTOFIT")})};rt.prototype._getScaleSwitch=function(){if(!this._oScaleSwitch){this._oScaleSwitch=this._createScaleSwitch(this.getId()+"-scaleSwitch");this.addDependent(this._oScaleSwitch)}return this._oScaleSwitch};rt.prototype._getMobileScaleSwitch=function(){if(!this._oMobileScaleSwitch){this._oMobileScaleSwitch=this._createScaleSwitch(this.getId()+"-mobileScaleSwitch");this.addDependent(this._oMobileScaleSwitch)}return this._oMobileScaleSwitch};rt.prototype._createScaleSwitch=function(t){var e=this;return new v({id:t,type:tt.AcceptReject,state:"{/crop/scaleCropArea}",visible:{path:"/mode",formatter:function(t){return t==="Crop"}},change:function(t){e._setScaleCropArea(t.getParameter("state"))}}).addStyleClass("sapUiTinyMarginEnd")};rt.prototype._getScaleLabel=function(){if(!this._oScaleLabel){this._oScaleLabel=this._createScaleLabel(this.getId()+"-scaleLabel");this.addDependent(this._oScaleLabel)}return this._oScaleLabel};rt.prototype._getMobileScaleLabel=function(){if(!this._oMobileScaleLabel){this._oMobileScaleLabel=this._createScaleLabel(this.getId()+"-mobileScaleLabel");this.addDependent(this._oMobileScaleLabel)}return this._oMobileScaleLabel};rt.prototype._createScaleLabel=function(t){return new u({text:D.getText("IMGEDITOR_CROP_SCALE"),labelFor:t,visible:{path:"/mode",formatter:function(t){return t==="Crop"}}})};rt.prototype._getToolbarSeparator=function(){if(!this._oSeparator){this._oSeparator=new h({id:this.getId()+"-separator"});this.addDependent(this._oSeparator)}return this._oSeparator};rt.prototype._getTransformButton=function(){if(!this._oTransformButton){this._oTransformButton=this._createTransformButton(this.getId()+"-transformButton");this.addDependent(this._oTransformButton)}return this._oTransformButton};rt.prototype._getMobileTransformButton=function(){if(!this._oMobileTransformButton){this._oMobileTransformButton=this._createTransformButton(this.getId()+"-mobileTransformButton");this.addDependent(this._oMobileTransformButton)}return this._oMobileTransformButton};rt.prototype._createTransformButton=function(t){return new n({id:t,icon:it.TRANSFORM,type:X.Transparent,pressed:{path:"/mode",formatter:function(t){return t===V.Transform}},enabled:{path:"/mode",formatter:function(t){return t!==V.Transform}},press:this._onButtonPress.bind(this,this._setModeTransform.bind(this)),tooltip:D.getText("IMGEDITOR_PANEL_TRANSFORM")})};rt.prototype._getCropButton=function(){if(!this._oCropButton){this._oCropButton=this._createCropButton(this.getId()+"-cropButton");this.addDependent(this._oCropButton)}return this._oCropButton};rt.prototype._getMobileCropButton=function(){if(!this._oMobileCropButton){this._oMobileCropButton=this._createCropButton(this.getId()+"-mobileCropButton");this.addDependent(this._oMobileCropButton)}return this._oMobileCropButton};rt.prototype._createCropButton=function(t){return new n({id:t,icon:it.CROP,type:X.Transparent,pressed:{path:"/mode",formatter:function(t){return t===V.Crop}},enabled:{path:"/mode",formatter:function(t){return t!==V.Crop}},press:this._onButtonPress.bind(this,this._setModeCrop.bind(this)),tooltip:D.getText("IMGEDITOR_PANEL_CROP")})};rt.prototype._getFilterButton=function(){if(!this._oFilterButton){this._oFilterButton=this._createFilterButton(this.getId()+"-filterButton");this.addDependent(this._oFilterButton)}return this._oFilterButton};rt.prototype._getMobileFilterButton=function(){if(!this._oMobileFilterButton){this._oMobileFilterButton=this._createFilterButton(this.getId()+"-mobileFilterButton");this.addDependent(this._oMobileFilterButton)}return this._oMobileFilterButton};rt.prototype._createFilterButton=function(t){return new n({id:t,icon:it.FILTER,type:X.Transparent,pressed:{path:"/mode",formatter:function(t){return t===V.Filter}},enabled:{path:"/mode",formatter:function(t){return t!==V.Filter}},press:this._onButtonPress.bind(this,this._setModeFilter.bind(this)),tooltip:D.getText("IMGEDITOR_PANEL_FILTER")})};rt.prototype._getMobileApplyButton=function(){if(!this._oMobileApplyButton){this._oMobileApplyButton=new C({id:this.getId()+"-mobileApplyButton",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this)})}return this._oMobileApplyButton};rt.prototype._changeOptionsPanelContent=function(t){var e=this._getOptionsPanel();e.removeAllItems();if(!this.getImageEditor()||!this.getImageEditor().getLoaded()||!t){return}t().forEach(function(t){e.addItem(t)})};rt.prototype._onButtonPress=function(t){this.getImageEditor()._cancelPreview();t()};rt.prototype._setModeTransform=function(t){this._changeOptionsPanelContent(this._getTransformPanelContent.bind(this));if(this.getImageEditor()){this.getImageEditor().setMode(k.Resize)}if(this.getMode()!==V.Transform){this.setProperty("mode",V.Transform,true)}this._setTransformTypeByKey(t||"Resize");this._oModel.setProperty("/mode",V.Transform)};rt.prototype._setModeCrop=function(t){this._changeOptionsPanelContent(this._getCropPanelContent.bind(this));if(this.getImageEditor()){this._setCropTypeByKey(t||"Rectangle")}if(this.getMode()!==V.Crop){this.setProperty("mode",V.Crop,true)}this._oModel.setProperty("/mode",V.Crop);this._setScaleCropArea(this._oModel.getProperty("/crop/scaleCropArea"))};rt.prototype._setModeFilter=function(){this._changeOptionsPanelContent(this._getFilterPanelContent.bind(this));if(this.getImageEditor()){this.getImageEditor().setMode(k.Default)}if(this.getMode()!==V.Filter){this.setProperty("mode",V.Filter,true)}this._resetFilterValues();this._selectFilterItem(0);this._oModel.setProperty("/mode",V.Filter)};rt.prototype._constraintValue=function(t,e,o){var i=o.getBinding("value"),r=o.getBinding("valueState"),s=o.getBinding("valueStateText"),a;if(isNaN(t)||t<e.min||t>e.max){a=D.getText("IMGEDITOR_BAD_NUMBER",[e.min,e.max]);t=this._oModel.getProperty(i.getPath())}if(a){this._oModel.setProperty(r.getPath(),K.Warning);this._oModel.setProperty(s.getPath(),a)}this._oModel.setProperty(i.getPath(),t);o.setValue(t);return t};rt.prototype._onNumberInputChange=function(t,e){var o=e.getParameter("value"),i=e.getParameter("newValue"),r;this._resetValueStates();if(typeof o==="number"){r=o}else if(typeof i==="number"){r=i}else{r=parseInt(e.getParameter("value")||e.getParameter("newValue"),10)}r=this._constraintValue(r,t,e.getSource());this[t.callback](r)};rt.prototype._setRatio=function(t,e){if(!this.getImageEditor()||!this.getImageEditor().getLoaded()){return}this.getImageEditor().setCropAreaByRatio(t,e);this._refreshCropAreaSize()};rt.prototype._setCropAreaBySize=function(t,e){this.getImageEditor().setCropAreaBySize(t,e);this._refreshCropAreaSize()};rt.prototype._setRatioByKey=function(t){if(t==="Rectangle"){this._setRatio(this._oModel.getProperty("/crop/ratiosRectangle/1/width"),this._oModel.getProperty("/crop/ratiosRectangle/1/height"))}else if(t==="Ellipse"){this._setRatio(1,1)}else if(t==="CustomShape"&&this.getImageEditor().getCustomShapeLoaded()){this._setCustomShapeCropAreaRatio()}};rt.prototype._setCustomShapeCropAreaRatio=function(){this.getImageEditor().setCustomShapeCropAreaRatio();this._refreshCropAreaSize()};rt.prototype._setTransformTypeByKey=function(t){var e=t==="Resize"?k.Resize:k.Default;if(t==="Resize"){this._refreshImageSize();this._selectResizeCustomSizeItem()}else if(t==="Rotate"){this._oModel.setProperty("/transform/rotate",0)}else if(t==="Flip"){this._resetFlips()}this._oModel.setProperty("/transform/selectedTypeKey",t);this._resetValueStates();if(this.getImageEditor()){this.getImageEditor()._cancelPreview();this.getImageEditor().setMode(e)}};rt.prototype._setCropTypeByKey=function(t,e){var o=this._oModel.getProperty("/crop/types").filter(function(e){return e.key===t})[0];this._setRatioByKey(t);this._oModel.setProperty("/crop/selectedTypeKey",t);this._oModel.setProperty("/crop/selectedType",o);if(this["_select"+t+"CropCustomSizeItem"]){this["_select"+t+"CropCustomSizeItem"](e)}this.getImageEditor().setMode("Crop"+t);this._resetValueStates()};rt.prototype._resetCurrentPanel=function(){this.getImageEditor().cancelPreview();switch(this.getMode()){case V.Transform:{this._setTransformTypeByKey(this._oModel.getProperty("/transform/selectedTypeKey"));break}case V.Crop:{this._setCropTypeByKey(this._oModel.getProperty("/crop/selectedTypeKey"));break}case V.Filter:{this._selectFilterItem(this._getSelectedFilterIndex());break}default:break}this._resetValueStates()};rt.prototype._undo=function(){this.getImageEditor().undo();this._resetCurrentPanel()};rt.prototype._redo=function(){this.getImageEditor().redo();this._resetCurrentPanel()};rt.prototype._jumpToHistory=function(t){this.getImageEditor().jumpToHistory(t);this._resetCurrentPanel()};rt.prototype._setZoom=function(t){this._oModel.setProperty("/zoom",t);this.getImageEditor().zoom(t);this._refreshCropAreaSize()};rt.prototype._setWidth=function(t){this.getImageEditor().setWidth(t,true);this._oModel.setProperty("/transform/height",this.getImageEditor().getPreviewHeight());this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio())};rt.prototype._setHeight=function(t){this.getImageEditor().setHeight(t,true);this._oModel.setProperty("/transform/width",this.getImageEditor().getPreviewWidth());this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio())};rt.prototype._setSize=function(t,e,o){if(o){t=this.getImageEditor().getWidth()*t;e=this.getImageEditor().getHeight()*e}this._updateCurrentSize(t,e);if(this.getImageEditor().getPreviewWidth()===t&&this.getImageEditor().getPreviewHeight()===e){return}this.getImageEditor().setSize(t,e,true)};rt.prototype._rotate=function(t){t=t>r.LIMITS.ROTATION_MAX?r.LIMITS.ROTATION_MAX:t;t=t<r.LIMITS.ROTATION_MIN?r.LIMITS.ROTATION_MIN:t;this._oModel.setProperty("/transform/rotate",t);this.getImageEditor().rotate(t,true)};rt.prototype._flip=function(t,e){this.getImageEditor().flip(t,e,true)};rt.prototype._setKeepResizeAspectRatio=function(t){this._oModel.setProperty("/transform/keepAspectRatio",t);if(this.getImageEditor()){this.getImageEditor().setKeepResizeAspectRatio(t)}};rt.prototype._getKeepCropAspectRatio=function(){return this._oModel.getProperty("/crop/keepAspectRatio")};rt.prototype._setKeepCropAspectRatio=function(t){this._oModel.setProperty("/crop/keepAspectRatio",t);if(this.getImageEditor()){this.getImageEditor().setKeepCropAspectRatio(t)}};rt.prototype._setScaleCropArea=function(t){this._oModel.setProperty("/crop/scaleCropArea",t);if(this.getImageEditor()){this.getImageEditor().setScaleCropArea(t)}};rt.prototype._applyCurrentFilter=function(t){var e=this._oModel.getProperty("/filter/selectedFilter");if(typeof t!=="undefined"){this._oModel.setProperty("/filter/selectedFilter/value",t)}this.getImageEditor()[e.type](e.value,true)};rt.prototype._resetFilterValues=function(){var t=this._oModel.getProperty("/filter/filters");t.forEach(function(t,e){this._oModel.setProperty("/filter/filters/"+e+"/value",t.defaultValue)},this)};rt.prototype._resetValueStates=function(){var t=["/transform/widthValueState","/transform/heightValueState","/transform/rotateValueState","/crop/widthValueState","/crop/heightValueState","/filter/filterValueState"];t.forEach(function(t){this._oModel.setProperty(t,K.None)},this)};rt.prototype._resetFlips=function(){this._oModel.setProperty("/transform/flipVertical",false);this._oModel.setProperty("/transform/flipHorizontal",false)};rt.prototype._applyPreview=function(){this.getImageEditor().applyPreview();this._resetValueStates();switch(this.getMode()){case V.Transform:{switch(this._oModel.getProperty("/transform/selectedTypeKey")){case"Resize":{this._refreshImageSize();break}case"Rotate":{this._oModel.setProperty("/transform/rotate",0);this._refreshImageSize();break}case"Flip":{this._resetFlips();break}default:break}break}case V.Crop:{var t=this._oModel.getProperty("/crop/selectedType/apply");if(t){this.getImageEditor()[t]()}this._refreshImageSize();this._setRatioByKey(this._oModel.getProperty("/crop/selectedTypeKey"));this._deselectCropItem();this.getImageEditor().setMode(k.Default);break}case V.Filter:{this._resetFilterValues();break}default:break}};rt.prototype._createGridList=function(t,e,o){var i=this;var r=new M({width:"auto",mode:"SingleSelectMaster",itemPress:function(t){i._resetValueStates();o.call(i,t)},items:{path:t,factory:e.bind(this)}}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridList");r.setModel(this._oModel);if(!r._oItemNavigation){r._startItemNavigation()}if(r._oItemNavigation){r._oItemNavigation.setColumns(2)}return r};rt.prototype._selectResizeCustomSizeItem=function(t){var e=this._getResizeGridList(),o=e.getItems()[0];e.setSelectedItem(o);this._setKeepResizeAspectRatio(!!t)};rt.prototype._deselectCropItem=function(){this._getRectangleCropGridList().removeSelections();this._getEllipseCropGridList().removeSelections();this._disableCrop()};rt.prototype._disableCrop=function(){this._oModel.setProperty("/crop/enabled",false)};rt.prototype._enableCrop=function(){this._oModel.setProperty("/crop/enabled",true)};rt.prototype._selectRectangleCropCustomSizeItem=function(t){var e=this._getRectangleCropGridList(),o=e.getItems()[0];e.setSelectedItem(o);this._setKeepCropAspectRatio(!!t);this._enableCrop()};rt.prototype._selectEllipseCropCustomSizeItem=function(t){var e=this._getEllipseCropGridList(),o=e.getItems()[0];e.setSelectedItem(o);this._setKeepCropAspectRatio(!!t);this._enableCrop()};rt.prototype._selectCustomShapeCropCustomSizeItem=function(t){var e=this._getCustomShapeCropGridList(),o=e.getItems()[0];e.setSelectedItem(o);this._setKeepCropAspectRatio(!!t);this._enableCrop()};rt.prototype._selectFilterItem=function(t){var e=this._getFilterGridList(),o=e.getItems()[t];this._oModel.setProperty("/filter/selectedFilter",o.getBindingContext().getProperty());this._oModel.setProperty("/filter/selectedFilter/value",this._oModel.getProperty("/filter/selectedFilter/defaultValue"));e.setSelectedItem(o)};rt.prototype._getSelectedFilterIndex=function(){var t=this._oModel.getProperty("/filter/selectedFilter"),e=t?this._oModel.getProperty("/filter/filters").indexOf(t):0;return e};rt.prototype._getResizeGridList=function(){if(!this._oGridListResize){this._oGridListResize=this._createGridList("/transform/resizes",this._gridRectShapeItemFactory,this._onResizeGridListSelectionChange)}return this._oGridListResize};rt.prototype._onResizeGridListSelectionChange=function(t){var e=t.getParameter("listItem"),o=e.getBindingContext();if(o.getProperty("width")){this._setSize(o.getProperty("width"),o.getProperty("height"),o.getProperty("relative"))}this._setKeepResizeAspectRatio(!o.getProperty("unlockRatio"))};rt.prototype._getRotateGridList=function(){if(!this._oGridListRotate){this._oGridListRotate=this._createGridList("/transform/rotates",this._gridRectShapeItemFactory,this._onRotateGridListSelectionChange)}return this._oGridListRotate};rt.prototype._onRotateGridListSelectionChange=function(t){var e=t.getParameter("listItem"),o=e.getBindingContext();this._getRotateGridList().removeSelections();this._rotate(this._oModel.getProperty("/transform/rotate")+o.getProperty("rotate"))};rt.prototype._getFlipGridList=function(){if(!this._oGridListFlip){this._oGridListFlip=this._createGridList("/transform/flips",this._gridRectShapeItemFactory,this._onFlipGridListSelectionChange)}return this._oGridListFlip};rt.prototype._onFlipGridListSelectionChange=function(t){var e=t.getParameter("listItem"),o=e.getBindingContext(),i=this._oModel.getProperty("/transform/flipVertical"),r=this._oModel.getProperty("/transform/flipHorizontal");this._getFlipGridList().removeSelections();i=i!==o.getProperty("flipVertical");r=r!==o.getProperty("flipHorizontal");this._oModel.setProperty("/transform/flipVertical",i);this._oModel.setProperty("/transform/flipHorizontal",r);this._flip(i,r)};rt.prototype._getRectangleCropGridList=function(){if(!this._oGridListRectCrop){this._oGridListRectCrop=this._createGridList("/crop/ratiosRectangle",this._gridRectShapeItemFactory,this._onRectCropGridListSelectionChange)}return this._oGridListRectCrop};rt.prototype._onRectCropGridListSelectionChange=function(t){var e=t.getParameter("listItem");this._onGridListSelectionChange(e,k.CropRectangle)};rt.prototype._getEllipseCropGridList=function(){if(!this._oGridListEllipseCrop){this._oGridListEllipseCrop=this._createGridList("/crop/ratiosCircle",this._gridCircleShapeItemFactory,this._onEllipseCropGridListSelectionChange)}return this._oGridListEllipseCrop};rt.prototype._onEllipseCropGridListSelectionChange=function(t){var e=t.getParameter("listItem");this._onGridListSelectionChange(e,k.CropEllipse)};rt.prototype._getCustomShapeCropGridList=function(){if(!this._oGridListCustomShapeCrop){this._oGridListCustomShapeCrop=this._createGridList("/crop/ratiosCustomShape",this._gridRectShapeItemFactory,this._onCustomShapeCropGridListSelectionChange);this._oGridListCustomShapeCrop.setModel(this._oModel)}return this._oGridListCustomShapeCrop};rt.prototype._onCustomShapeCropGridListSelectionChange=function(t){var e=t.getParameter("listItem");this._onGridListSelectionChange(e,k.CropCustomShape)};rt.prototype._onGridListSelectionChange=function(t,e){var o=t.getBindingContext(),i=this.getImageEditor();i.setMode(e);if(o.getProperty("callback")){this[o.getProperty("callback")]()}if(o.getProperty("width")&&o.getProperty("relative")){this._setRatio(o.getProperty("width"),o.getProperty("height"))}else if(o.getProperty("width")&&!o.getProperty("relative")){this._setCropAreaBySize(o.getProperty("width"),o.getProperty("height"))}this._enableCrop();this._setKeepCropAspectRatio(!o.getProperty("unlockRatio"))};rt.prototype._getFilterGridList=function(){if(!this._oGridListFilter){this._oGridListFilter=this._createGridList("/filter/filters",this._gridFilterItemFactory,this._onFilterGridListSelectionChange)}return this._oGridListFilter};rt.prototype._onFilterGridListSelectionChange=function(t){var e=t.getParameter("listItem"),o=e.getBindingContext();this._resetFilterValues();this._oModel.setProperty("/filter/selectedFilter",o.getProperty());this.getImageEditor().cancelPreview();this.getImageEditor()[o.getProperty("type")](o.getProperty("value"),true)};rt.prototype._gridRectShapeItemFactory=function(t,e){var o;if(e.getProperty("icon")){o=new O({renderType:Y.Bare,alignItems:J.Center,justifyContent:$.Center,items:[new w({src:"{icon}"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemIcon")}else{o=this._createGridItemRectShape(e.getProperty("width"),e.getProperty("height"))}return this._createGridListItem(o)};rt.prototype._gridCircleShapeItemFactory=function(t,e){var o;if(e.getProperty("icon")){o=new O({renderType:Y.Bare,alignItems:J.Center,justifyContent:$.Center,items:[new w({src:"{icon}"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemIcon")}else{o=this._createGridItemCircleShape(e.getProperty("width"),e.getProperty("height"))}return this._createGridListItem(o)};rt.prototype._refreshGridListsItems=function(){var t=this,e=[{path:"/transform/resizes",fnGetItems:this.getCustomResizeItems.bind(this)},{path:"/crop/ratiosRectangle",fnGetItems:this.getCustomRectangleCropItems.bind(this)},{path:"/crop/ratiosCircle",fnGetItems:this.getCustomEllipseCropItems.bind(this)}];this.getCustomResizeItems().forEach(function(t){if(t.getRelative()&&!t.getIcon()){t.setIcon(it.RELATIVE)}});e.forEach(function(e){var o=t._oModel.getProperty(e.path),i=o.slice(0,st.NUM_KEPT_ITEMS);e.fnGetItems().forEach(function(t){if(t.getWidth()>0&&t.getHeight()>0){i.push({width:t.getWidth(),height:t.getHeight(),text:t.getLabel(),icon:t.getIcon(),relative:t.getRelative()})}});t._oModel.setProperty(e.path,i)})};rt.prototype._createGridListItem=function(t){return new R({type:Z.Active,content:[t,new u({text:"{text}",wrapping:false,textAlign:et.Center,layoutData:[new P({growFactor:0,shrinkFactor:0,baseSize:"auto"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemLabel")]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItem")};rt.prototype._createGridItemRectShape=function(t,e){var o,i;if(t<100){t*=10;e*=10}else if(t>100){t/=10;e/=10}o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent");o.setAttribute("viewBox","-1 -1 "+(t+2)+" "+(e+2));i=document.createElement("rect");i.setAttribute("x","0");i.setAttribute("y","0");i.setAttribute("width",t);i.setAttribute("height",e);o.appendChild(i);return new B({content:(new XMLSerializer).serializeToString(o)})};rt.prototype._createGridItemCircleShape=function(t,e){var o,i;t*=100;e*=100;o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent");o.setAttribute("viewBox","-"+(t+2)+" -"+(e+2)+" "+(t*2+4)+" "+(e*2+4));i=document.createElement("ellipse");i.setAttribute("cx","0");i.setAttribute("cy","0");i.setAttribute("rx",t);i.setAttribute("ry",e);o.appendChild(i);return new B({content:(new XMLSerializer).serializeToString(o)})};rt.prototype._gridFilterItemFactory=function(t,e){var o,i,r;i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent sapSuiteUiCommonsImageEditorContainerGridItemHeaderFilterContent");r=document.createElementNS("http://www.w3.org/2000/svg","use");r.setAttribute("href","#"+this.getId()+"-origThumbnail");r.setAttribute("filter","url(#"+this.getId()+"-"+e.getProperty("type")+")");i.appendChild(r);o=new B({content:(new XMLSerializer).serializeToString(i)});return this._createGridListItem(o)};rt.prototype._getTransformPanelContent=function(){var t=this;if(!this._oTransformToolbarContent){this._oTransformToolbarContent=[new g({min:r.LIMITS.ROTATION_MIN,max:r.LIMITS.ROTATION_MAX,showAdvancedTooltip:true,visible:{path:"/transform/selectedTypeKey",formatter:function(t){return t==="Rotate"}},value:{path:"/transform/rotate",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,ot.ROTATION),progress:true,ariaLabelledBy:[this.getId()+"-transformAngle"]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerMobileSlider"),new L({tabDensityMode:q.Compact,backgroundDesign:Q.Transparent,headerBackgroundDesign:Q.Transparent,expandable:false,select:function(e){var o=e.getParameter("key");t._setTransformTypeByKey(o)},selectedKey:"{/transform/selectedTypeKey}",items:[new A({key:"Resize",text:D.getText("IMGEDITOR_RESIZE"),content:[this._getResizeGridList(),new O({renderType:Y.Bare,direction:j.Column,items:[new O({renderType:Y.Bare,justifyContent:$.SpaceBetween,items:[new O({renderType:Y.Bare,direction:j.Column,items:[new u({text:D.getText("IMGEDITOR_WIDTH"),labelFor:this.getId()+"-transformWidth"}),new m({id:this.getId()+"-transformWidth",type:N.Number,textAlign:et.Right,change:this._onNumberInputChange.bind(this,ot.WIDTH),value:{path:"/transform/width",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/widthValueState}",valueStateText:"{/transform/widthValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:D.getText("IMGEDITOR_PX")})]}),new O({renderType:Y.Bare,direction:j.Column,justifyContent:$.End,items:[new p({tooltip:D.getText("IMGEDITOR_LOCK_RATIO"),icon:it.LOCK,type:X.Transparent,pressed:{path:"/transform/keepAspectRatio"},press:function(e){t._resetValueStates();t.getImageEditor().setKeepResizeAspectRatio(e.getParameter("pressed"));t._selectResizeCustomSizeItem(e.getParameter("pressed"))}})]}),new O({renderType:Y.Bare,direction:j.Column,items:[new u({text:D.getText("IMGEDITOR_HEIGHT"),labelFor:this.getId()+"-transformHeight"}),new m({id:this.getId()+"-transformHeight",type:N.Number,textAlign:et.Right,change:this._onNumberInputChange.bind(this,ot.HEIGHT),value:{path:"/transform/height",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/heightValueState}",valueStateText:"{/transform/heightValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:D.getText("IMGEDITOR_PX")})]})]}),new C({width:"50%",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]}),new A({key:"Rotate",text:D.getText("IMGEDITOR_ROTATE"),content:[this._getRotateGridList(),new O({renderType:Y.Bare,direction:j.Column,items:[new u({id:this.getId()+"-transformAngle",text:D.getText("IMGEDITOR_TRANSFORM_ANGLE")}),new g({min:r.LIMITS.ROTATION_MIN,max:r.LIMITS.ROTATION_MAX,value:{path:"/transform/rotate",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,ot.ROTATION),progress:true,ariaLabelledBy:[this.getId()+"-transformAngle"]}),new m({type:N.Number,textAlign:et.Right,width:"50%",fieldWidth:"50%",description:D.getText("IMGEDITOR_TRANSFORM_DEG"),change:this._onNumberInputChange.bind(this,ot.ROTATION),value:{path:"/transform/rotate",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/rotateValueState}",valueStateText:"{/transform/rotateValueStateText}",ariaLabelledBy:[this.getId()+"-transformAngle"]}),new C({width:"50%",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]}),new A({key:"Flip",text:D.getText("IMGEDITOR_FLIP"),content:[this._getFlipGridList(),new O({renderType:Y.Bare,direction:j.Column,items:[new C({width:"50%",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerTabBar")];this._oTransformToolbarContent.forEach(function(t){this.addDependent(t)},this)}return this._oTransformToolbarContent};rt.prototype._onCropSizeInputChange=function(t,e){var o=this._oModel.getProperty("/crop/width"),i=this._oModel.getProperty("/crop/height"),r=this._getKeepCropAspectRatio(),s,a,n,l,p,h=parseInt(e.getParameter("value"),10);h=isNaN(h)?0:h;if(t==="width"){n=o;s=h;a=r?s*i/o:i;p=this.getImageEditor()._getMaxCropAreaWidth(true);l=this.getImageEditor()._getMinCropAreaWidth(true)}else{n=i;a=h;s=r?a*o/i:o;p=this.getImageEditor()._getMaxCropAreaHeight(true);l=this.getImageEditor()._getMinCropAreaHeight(true)}this._resetValueStates();if(h>p||h<l){e.getSource().setValue(n);this._oModel.setProperty("/crop/"+t+"ValueState",K.Warning);this._oModel.setProperty("/crop/"+t+"ValueStateText",D.getText("IMGEDITOR_BAD_NUMBER",[l,p]))}else{this._setCropAreaBySize(s,a)}};rt.prototype._getCropPanelContent=function(){var t=this;if(!this._oCropToolbarContent){this._oCropToolbarContent=[new L({tabDensityMode:q.Compact,backgroundDesign:Q.Transparent,headerBackgroundDesign:Q.Transparent,expandable:false,select:function(e){var o=e.getParameter("key");t._setCropTypeByKey(o)},selectedKey:"{/crop/selectedTypeKey}",items:[new A({tooltip:D.getText("IMGEDITOR_CROP_RECTANGLE"),key:"Rectangle",text:"",content:[this._getRectangleCropGridList()]}),new A({tooltip:D.getText("IMGEDITOR_CROP_ELLIPSE"),key:"Ellipse",text:"",content:[this._getEllipseCropGridList()]}),new A({tooltip:D.getText("IMGEDITOR_CROP_CUSTOM"),key:"CustomShape",text:"",content:[this._getCustomShapeCropGridList(),this._getCustomShapeCropContent()]})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerTabBar").addStyleClass("sapSuiteUiCommonsImageEditorContainerFilterIcons"),new O({renderType:Y.Bare,direction:j.Column,items:[new O({renderType:Y.Bare,justifyContent:$.SpaceBetween,items:[new O({renderType:Y.Bare,direction:j.Column,items:[new u({text:D.getText("IMGEDITOR_WIDTH"),labelFor:this.getId()+"-cropWidth"}),new m({id:this.getId()+"-cropWidth",type:N.Number,textAlign:et.Right,value:{path:"/crop/width",mode:"OneWay",type:"sap.ui.model.type.Integer"},valueState:"{/crop/widthValueState}",valueStateText:"{/crop/widthValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:D.getText("IMGEDITOR_PX"),change:this._onCropSizeInputChange.bind(this,"width"),enabled:{parts:["/crop/selectedTypeKey","/crop/customShapeLoaded","/crop/enabled"],formatter:function(t,e,o){return!(t==="CustomShape"&&!e)&&o}}})]}),new O({renderType:Y.Bare,direction:j.Column,justifyContent:$.End,items:[new p({tooltip:D.getText("IMGEDITOR_LOCK_RATIO"),icon:it.LOCK,type:X.Transparent,pressed:{path:"/crop/keepAspectRatio"},press:function(e){var o=t.getImageEditor().getMode(),i,r;t._resetValueStates();if(t._oModel.getProperty("/crop/selectedTypeKey")==="Rectangle"){i=k.CropRectangle;r=t._selectRectangleCropCustomSizeItem.bind(t)}else if(t._oModel.getProperty("/crop/selectedTypeKey")==="Ellipse"){i=k.CropEllipse;r=t._selectEllipseCropCustomSizeItem.bind(t)}else{i=k.CropCustomShape;r=t._selectCustomShapeCropCustomSizeItem.bind(t)}if(o!==i){t.getImageEditor().setMode(i)}if(r){r(e.getParameter("pressed"))}}})]}),new O({renderType:Y.Bare,direction:j.Column,items:[new u({text:D.getText("IMGEDITOR_HEIGHT"),labelFor:this.getId()+"-cropHeight"}),new m({id:this.getId()+"-cropHeight",type:N.Number,textAlign:et.Right,value:{path:"/crop/height",mode:"OneWay",type:"sap.ui.model.type.Integer"},valueState:"{/crop/heightValueState}",valueStateText:"{/crop/heightValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:D.getText("IMGEDITOR_PX"),change:this._onCropSizeInputChange.bind(this,"height"),enabled:{parts:["/crop/selectedTypeKey","/crop/customShapeLoaded","/crop/enabled"],formatter:function(t,e,o){return!(t==="CustomShape"&&!e)&&o}}})]})]}),new O({renderType:Y.Bare,alignItems:J.Center,items:[this._getScaleSwitch(),this._getScaleLabel()]}).addStyleClass("sapUiSmallMarginTopBottom"),new C({width:"50%",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this),enabled:{parts:["/crop/selectedTypeKey","/crop/customShapeLoaded","/crop/enabled"],formatter:function(t,e,o){return!(t==="CustomShape"&&!e)&&o}}})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")];this._oCropToolbarContent.forEach(function(t){this.addDependent(t)},this)}return this._oCropToolbarContent};rt.prototype._getCustomShapeCropContent=function(){var t=this;if(!this.oCustomShapeContent){this.oCustomShapeContent=new O({renderType:Y.Bare,direction:j.Column,items:[new u({text:D.getText("IMGEDITOR_CROP_CUSTOM_FILE"),labelFor:this.getId()+"-customFile"}),new G({id:this.getId()+"-customFile",mimeType:"image/*",change:function(e){var o=e.getParameter("files")[0];if(!o){return}t._resetValueStates();t._enableCrop();t.getImageEditor().setMode(k.CropCustomShape);t.getImageEditor().setCustomShapeSrc(o)}})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea").addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelAreaMobile");this.addDependent(this.oCustomShapeContent)}return this.oCustomShapeContent};rt.prototype._getFilterPanelContent=function(){var t=this;if(!this._oFilterToolbarContent){this._oFilterToolbarContent=[new g({min:"{/filter/selectedFilter/min}",max:"{/filter/selectedFilter/max}",showAdvancedTooltip:true,value:{path:"/filter/selectedFilter/value",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,ot.FILTER),progress:true,ariaLabelledBy:[this.getId()+"-filterValue"]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerMobileSlider"),this._getFilterGridList(),new O({renderType:Y.Bare,direction:j.Column,items:[new g({min:"{/filter/selectedFilter/min}",max:"{/filter/selectedFilter/max}",value:{path:"/filter/selectedFilter/value",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,ot.FILTER),progress:true,ariaLabelledBy:[this.getId()+"-filterValue"]}),new u({id:this.getId()+"-filterValue",text:D.getText("IMGEDITOR_FILTER_VALUE")}),new m({type:N.Number,textAlign:et.Right,width:"5.9375rem",fieldWidth:"4.375rem",description:"{/filter/selectedFilter/unit}",change:function(e){t._onNumberInputChange(jQuery.extend(ot.FILTER,t._oModel.getProperty("/filter/selectedFilter")),e)},value:{path:"/filter/selectedFilter/value",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/filter/filterValueState}",valueStateText:"{/filter/filterValueStateText}",ariaLabelledBy:[this.getId()+"-filterValue"]}),new C({width:"50%",text:D.getText("IMGEDITOR_APPLY"),type:X.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")];this._oFilterToolbarContent.forEach(function(t){this.addDependent(t)},this)}return this._oFilterToolbarContent};rt.prototype._getOptionsPanel=function(){if(!this._oOptionsPanel){this._oOptionsPanel=new O({renderType:Y.Bare,direction:j.Column});this._oOptionsPanel.addStyleClass("sapSuiteUiCommonsImageEditorContainerPanel");this._oOptionsPanel.setModel(this._oModel);this.addDependent(this._oOptionsPanel)}return this._oOptionsPanel};rt.prototype.onkeydown=function(t){var e=this;function o(){return e._oModel.getProperty("/historyIndex")<e._oModel.getProperty("/history").length-1}if(t.ctrlKey&&t.key!=="Control"&&t.shiftKey&&t.key!=="Shift"){switch(t.key){case"z":case"Z":if(o()){this.getImageEditor().undo();if(o()){this._getUndoButton().focus()}else{this._getHistoryArrowButton().focus()}}t.preventDefault();break;case"y":case"Y":if(this._oModel.getProperty("/historyIndex")>0){this.getImageEditor().redo();this._getUndoButton().focus()}t.preventDefault();break;case"h":case"H":if(this._oModel.getProperty("/history").length>1){this._getHistoryArrowButton().focus();this._getHistoryPopover().openBy(this._oHistoryArrowButton)}t.preventDefault();break;default:break}}else if(t.ctrlKey&&t.key!=="Control"&&!t.shiftKey){switch(t.key){case"u":case"U":this._focusOnToolbar();t.preventDefault();break;case"g":case"G":this._focusOnPanel();t.preventDefault();break;case"i":case"I":this._focusOnImageEditor();t.preventDefault();break;case"e":case"E":this._setModeTransform("Resize");this._focusOnItem(this._getResizeGridList().getItems()[0]);t.preventDefault();break;case"r":case"R":this._setModeTransform("Rotate");this._focusOnItem(this._getRotateGridList().getItems()[0]);t.preventDefault();break;case"f":case"F":this._setModeTransform("Flip");this._focusOnItem(this._getFlipGridList().getItems()[0]);t.preventDefault();break;case"j":case"J":this._setModeCrop("Rectangle");this._focusOnItem(this._getRectangleCropGridList().getItems()[0]);t.preventDefault();break;case"s":case"S":this._setModeFilter();this._focusOnItem(this._getFilterGridList().getItems()[0]);t.preventDefault();break;case"Enter":this._applyPreview();break;default:break}}else if(t.altKey&&t.key!=="Alt"){switch(t.key){case"Enter":this._switchFocusPanelImage();t.preventDefault();break;default:break}}};rt.prototype._focusFirstTabbable=function(t){var e=t.find(":tabbable").get(0);if(e){e.focus()}};rt.prototype._focusOnToolbar=function(){this._focusFirstTabbable(this._getHeaderToolbar().$())};rt.prototype._focusOnPanel=function(){this._focusFirstTabbable(this._getOptionsPanel().$())};rt.prototype._focusOnImageEditor=function(){this._focusFirstTabbable(this.getImageEditor().$())};rt.prototype._focusOnItem=function(t){if(t.getDomRef()){if(!this._getHistoryPopover().isOpen()){t.focus()}}else{var e={onAfterRendering:function(){t.removeEventDelegate(e);t.focus();if(t.getParent()&&t.getParent().isA("sap.m.List")){t.getParent()._startItemNavigation()}}};t.addEventDelegate(e)}};rt.prototype._switchFocusPanelImage=function(){var t=document.activeElement;if(this._getOptionsPanel().getDomRef().contains(t)){this._focusOnImageEditor()}else{this._focusOnPanel()}};return rt});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ImageEditorContainerRenderer", ["sap/ui/Device"],function(t){"use strict";var e=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var r={apiVersion:2};r.render=function(t,r){t.openStart("div",r).class("sapSuiteUiCommonsImageEditorContainer").attr("tabindex","0").attr("aria-label",e.getText("IMGEDITOR_ACCESSIBILITY_LABEL")).openEnd();this.renderSvgFilters(t,r);this.renderHeaderToolbar(t,r);this.renderMobileHeaderToolbar(t,r);t.openStart("div").class("sapSuiteUiCommonsImageEditorContainerContent").openEnd();this.renderOptionsPanel(t,r);this.renderImageEditor(t,r);t.close("div");this.renderMobileZoomToolbar(t,r);this.renderMobileFooterToolbar(t,r);t.close("div")};r.renderSvgFilters=function(t,e){t.openStart("svg").attr("width","0").attr("height","0").style("position","absolute").openEnd();t.openStart("defs").openEnd();this.renderOriginalThumbnail(t,e);this.renderSepiaFilter(t,e);this.renderGrayscaleFilter(t,e);this.renderSaturateFilter(t,e);this.renderInvertFilter(t,e);this.renderBrightnessFilter(t,e);this.renderContrastFilter(t,e);this.renderHueRotateFilter(t,e);t.close("defs");t.close("svg")};r.renderOriginalThumbnail=function(t,e){var r=e.getImageEditor();if(!r||!r._oCanvas){return}t.voidStart("image").attr("xmlns","http://www.w3.org/1999/xlink").attr("id",e.getId()+"-origThumbnail").attr("preserveAspectRatio","xMidYMid slice").attr("viewBox","0 0 "+e._oThumbnailCanvas.width+" "+e._oThumbnailCanvas.height).attr("href",r._oCanvas.toDataURL()).attr("width","100%").attr("height","100%").voidEnd()};r.renderSepiaFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-sepia").openEnd();t.voidStart("feColorMatrix").attr("type","matrix").attr("values","0.393 0.769 0.189 0 0  0.349 0.686 0.168 0 0  0.272 0.534 0.131 0 0  0 0 0 1 0").voidEnd();t.close("filter")};r.renderGrayscaleFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-grayscale").openEnd();t.voidStart("feColorMatrix").attr("type","matrix").attr("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0  0.2126 0.7152 0.0722 0 0 0 0 0 1 0").voidEnd();t.close("filter")};r.renderSaturateFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-saturate").openEnd();t.voidStart("feColorMatrix").attr("type","saturate").attr("values","3").voidEnd();t.close("filter")};r.renderInvertFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-invert").openEnd();t.openStart("feComponentTransfer").openEnd();t.voidStart("feFuncR").attr("type","table").attr("tableValues","1 0").voidEnd();t.voidStart("feFuncG").attr("type","table").attr("tableValues","1 0").voidEnd();t.voidStart("feFuncB").attr("type","table").attr("tableValues","1 0").voidEnd();t.close("feComponentTransfer");t.close("filter")};r.renderBrightnessFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-brightness").openEnd();t.openStart("feComponentTransfer").openEnd();t.voidStart("feFuncR").attr("type","linear").attr("slope","3").voidEnd();t.voidStart("feFuncG").attr("type","linear").attr("slope","3").voidEnd();t.voidStart("feFuncB").attr("type","linear").attr("slope","3").voidEnd();t.close("feComponentTransfer");t.close("filter")};r.renderContrastFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-contrast").openEnd();t.openStart("feComponentTransfer").openEnd();t.voidStart("feFuncR").attr("type","linear").attr("slope","3").attr("intercept","-0.3").voidEnd();t.voidStart("feFuncG").attr("type","linear").attr("slope","3").attr("intercept","-0.3").voidEnd();t.voidStart("feFuncB").attr("type","linear").attr("slope","3").attr("intercept","-0.3").voidEnd();t.close("feComponentTransfer");t.close("filter")};r.renderHueRotateFilter=function(t,e){t.openStart("filter").attr("id",e.getId()+"-hueRotate").openEnd();t.voidStart("feColorMatrix").attr("type","hueRotate").attr("values","90").voidEnd();t.close("filter")};r.renderHeaderToolbar=function(e,r){if(!t.system.phone&&!r._isSmallSize()){var n=r._getHeaderToolbar();e.renderControl(n)}};r.renderMobileHeaderToolbar=function(e,r){if(t.system.phone||r._isSmallSize()){var n=r._getMobileHeaderToolbar();e.renderControl(n)}};r.renderMobileZoomToolbar=function(t,e){var r=e._getMobileZoomToolbar();t.renderControl(r)};r.renderMobileFooterToolbar=function(t,e){var r=e._getMobileFooterToolbar();t.renderControl(r)};r.renderOptionsPanel=function(t,e){var r=e._getOptionsPanel();t.renderControl(r);e._refreshGridListsItems()};r.renderImageEditor=function(t,e){var r=e.getImageEditor();t.openStart("div").class("sapSuiteUiCommonsImageEditorContainerWrapper").openEnd();if(r){t.renderControl(r)}t.close("div")};return r},true);
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ImageEditorRenderer", ["sap/ui/Device"],function(t){"use strict";var e=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var r={apiVersion:2};var a={nw:{vertical:"sapSuiteUiCommonsImageEditorTop",horizontal:"sapSuiteUiCommonsImageEditorLeft",handlers:["Horizontal","Vertical"],types:["Rectangle","CustomShape"]},ne:{vertical:"sapSuiteUiCommonsImageEditorTop",horizontal:"sapSuiteUiCommonsImageEditorRight",handlers:["Horizontal","Vertical"],types:["Rectangle","CustomShape"]},sw:{vertical:"sapSuiteUiCommonsImageEditorBottom",horizontal:"sapSuiteUiCommonsImageEditorLeft",handlers:["Horizontal","Vertical"],types:["Rectangle","CustomShape"]},se:{vertical:"sapSuiteUiCommonsImageEditorBottom",horizontal:"sapSuiteUiCommonsImageEditorRight",handlers:["Horizontal","Vertical"],types:["Rectangle","CustomShape"]},n:{vertical:"sapSuiteUiCommonsImageEditorTop",horizontal:"sapSuiteUiCommonsImageEditorCenter",handlers:["Horizontal"],types:["Rectangle","CustomShape","Ellipse"]},s:{vertical:"sapSuiteUiCommonsImageEditorBottom",horizontal:"sapSuiteUiCommonsImageEditorCenter",handlers:["Horizontal"],types:["Rectangle","CustomShape","Ellipse"]},w:{vertical:"sapSuiteUiCommonsImageEditorMiddle",horizontal:"sapSuiteUiCommonsImageEditorLeft",handlers:["Vertical"],types:["Rectangle","CustomShape","Ellipse"]},e:{vertical:"sapSuiteUiCommonsImageEditorMiddle",horizontal:"sapSuiteUiCommonsImageEditorRight",handlers:["Vertical"],types:["Rectangle","CustomShape","Ellipse"]}};r.render=function(t,e){t.openStart("div",e);t.class("sapSuiteUiCommonsImageEditor").class("sapSuiteUiCommonsImageEditorEmpty").class("sapSuiteUiCommonsImageEditorMode"+e.getMode());if(e.getCustomShapeLoaded()){t.class("sapSuiteUiCommonsImageEditorModeCropCustomShapeLoaded")}t.openEnd();this.renderNoData(t,e);t.openStart("div");t.attr("id",e.getId()+"-canvasInnerContainer");t.attr("tabindex","0");t.attr("role","img");t.class("sapSuiteUiCommonsImageEditorCanvasInnerContainer");t.openEnd();this.renderTransformHandlers(t);this.renderSvgOverlay(t,e);this.renderCropArea(t,e);t.close("div");t.close("div")};r.renderNoData=function(t,r){t.openStart("div");t.class("sapSuiteUiCommonsImageEditorNoData");t.attr("tabindex","0");t.attr("aria-label",e.getText("IMGEDITOR_NO_IMAGE"));t.openEnd();t.openStart("div");t.class("sapSuiteUiCommonsImageEditorNoDataText");t.openEnd();t.text(e.getText("IMGEDITOR_NO_IMAGE"));t.close("div");t.close("div")};r.renderSvgOverlay=function(t,e){t.openStart("svg").class("sapSuiteUiCommonsImageEditorCropOverlayContainer").openEnd();t.openStart("defs").openEnd();t.voidStart("rect").attr("id",e.getId()+"-overlayMaskRect").voidEnd();t.voidStart("ellipse").attr("id",e.getId()+"-overlayMaskEllipse").voidEnd();t.openStart("image").attr("xmlns","http://www.w3.org/1999/xlink").attr("id",e.getId()+"-overlayMaskCustomBlack").attr("preserveAspectRatio","none").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%");if(e._sBlackCustomShapeUrl){t.attr("href",e._sBlackCustomShapeUrl)}t.openEnd().close("image");t.openStart("image").attr("xmlns","http://www.w3.org/1999/xlink").attr("id",e.getId()+"-overlayMaskCustomWhite").attr("preserveAspectRatio","none").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%");if(e._sWhiteCustomShapeUrl){t.attr("href",e._sWhiteCustomShapeUrl)}t.openEnd().close("image");t.openStart("mask").attr("id",e.getId()+"-darkOverlayMask").openEnd();t.voidStart("rect").attr("fill","white").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").voidEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemRectangle").attr("fill","black").attr("href","#"+e.getId()+"-overlayMaskRect").voidEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemEllipse").attr("fill","black").attr("href","#"+e.getId()+"-overlayMaskEllipse").voidEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemCustomShape").attr("href","#"+e.getId()+"-overlayMaskCustomBlack").voidEnd();t.close("mask");t.openStart("mask").attr("id",e.getId()+"-lightOverlayClip").openEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemRectangle").attr("fill","white").attr("href","#"+e.getId()+"-overlayMaskRect").voidEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemEllipse").attr("fill","white").attr("href","#"+e.getId()+"-overlayMaskEllipse").voidEnd();t.voidStart("use").class("sapSuiteUiCommonsImageEditorCropItemCustomShape").attr("href","#"+e.getId()+"-overlayMaskCustomWhite").voidEnd();t.close("mask");t.close("defs");t.voidStart("rect").class("sapSuiteUiCommonsImageEditorCropOverlayBlack").attr("mask","url(#"+e.getId()+"-darkOverlayMask)").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").voidEnd();t.voidStart("rect").class("sapSuiteUiCommonsImageEditorCropOverlayWhite").attr("mask","url(#"+e.getId()+"-lightOverlayClip)").attr("fill","white").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").voidEnd();t.close("svg")};r.renderCropArea=function(t,e){t.openStart("div").class("sapSuiteUiCommonsImageEditorCropInnerRectangle").openEnd();t.openStart("svg").class("sapSuiteUiCommonsImageEditorCropSvg").openEnd();t.openStart("defs").openEnd();t.openStart("mask").attr("id",e.getId()+"-thirdsMask").attr("maskContentUnits","objectBoundingBox").openEnd();t.voidStart("rect").class("sapSuiteUiCommonsImageEditorCropItemRectangle").attr("fill","white").attr("width","1").attr("height","1").voidEnd();t.voidStart("ellipse").class("sapSuiteUiCommonsImageEditorCropItemEllipse").attr("fill","white").attr("cx","0.5").attr("cy","0.5").attr("rx","0.5").attr("ry","0.5").voidEnd();t.close("mask");this.renderShadowFilter(t,e.getId()+"-bottomShadow",0,2);this.renderShadowFilter(t,e.getId()+"-topShadow",0,-2);this.renderShadowFilter(t,e.getId()+"-rightShadow",2,0);this.renderShadowFilter(t,e.getId()+"-leftShadow",-2,0);t.close("defs");t.voidStart("ellipse").class("sapSuiteUiCommonsImageEditorCropItemEllipse").attr("fill","transparent").attr("stroke-width","1").attr("stroke","white").attr("cx","50%").attr("cy","50%").attr("rx","50%").attr("ry","50%").voidEnd();this.renderRectBorders(t,e);this.renderThirdLines(t,e);t.close("svg");this.renderCropAreaDragHandler(t,e);this.renderCropAreaResizeHandlers(t);t.close("div")};r.renderZones=function(t,e){t.openStart("div").class("sapSuiteUiCommonsImageEditorZones").openEnd();e.getZones().forEach(function(r){this.renderZone(t,e,r)},this);t.close("div")};r.renderZone=function(t,e,r){t.openStart("div",r);t.class("sapSuiteUiCommonsImageEditorZone");if(r.getEditable()){t.class("sapSuiteUiCommonsImageEditorZoneEditable")}if(r.getHighlighted()){t.class("sapSuiteUiCommonsImageEditorZoneHighlighted")}t.openEnd();t.openStart("div").class("sapSuiteUiCommonsImageEditorZoneInner").openEnd();if(!r.getEditable()&&!r.getHighlighted()){t.openStart("div").class("sapSuiteUiCommonsImageEditorZoneInnerColoring").openEnd().close("div")}if(r.getHighlighted()){t.openStart("div").class("sapSuiteUiCommonsImageEditorZoneLabel").openEnd();t.openStart("span");t.text(r.getLabel());t.close("span");t.close("div")}if(r.getEditable()){this.renderBWBorder(t)}t.close("div");if(r.getEditable()){this.renderZoneResizeHandlers(t)}t.close("div")};r.renderBWBorder=function(t){t.openStart("svg").class("sapSuiteUiCommonsImageEditorZoneEditBorder").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").openEnd();this.renderStrokeRect(t,"black",5,5,5,.5);this.renderStrokeRect(t,"white",5,5,0,.5);t.close("svg")};r.renderStrokeRect=function(t,e,r,a,o,i){t.openStart("rect").attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").attr("fill","none").attr("stroke",e).attr("stroke-dasharray",r+","+a).openEnd();t.openStart("animate").attr("attributeName","stroke-dashoffset").attr("repeatCount","indefinite").attr("from",o).attr("to",o+r+a).attr("dur",i).openEnd().close("animate");t.close("rect")};r.renderShadowFilter=function(t,e,r,a){t.openStart("filter").attr("id",e).attr("x","0").attr("y","0").attr("width","100%").attr("height","100%").attr("filterUnits","userSpaceOnUse").openEnd();t.voidStart("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation","2").attr("result","blur").voidEnd();t.voidStart("feOffset").attr("in","blur").attr("result","offOut").attr("x",r).attr("y",a).voidEnd();t.voidStart("feBlend").attr("in","SourceGraphic").attr("in2","offOut").attr("mode","normal").voidEnd();t.close("filter")};r.renderRectBorders=function(t,e){t.openStart("g").class("sapSuiteUiCommonsImageEditorCropItemRectangle").class("sapSuiteUiCommonsImageEditorCropItemCustomShape").openEnd();this.renderCropLine(t,e,"bottomShadow",0,0,100,0);this.renderCropLine(t,e,"leftShadow",100,0,100,100);this.renderCropLine(t,e,"topShadow",100,100,0,100);this.renderCropLine(t,e,"rightShadow",0,100,0,0);t.close("g")};r.renderThirdLines=function(t,e){t.openStart("g").class("sapSuiteUiCommonsImageEditorCropThirds").attr("mask","url("+"#"+e.getId()+"-thirdsMask"+")").openEnd();this.renderCropLine(t,e,"rightShadow",100/3,0,100/3,100);this.renderCropLine(t,e,"rightShadow",100*2/3,0,100*2/3,100);this.renderCropLine(t,e,"bottomShadow",0,100/3,100,100/3);this.renderCropLine(t,e,"bottomShadow",0,100*2/3,100,100*2/3);t.close("g")};r.renderCropLine=function(e,r,a,o,i,n,s){e.voidStart("line").class("sapSuiteUiCommonsImageEditorCropLine");if(!t.browser.msie&&!t.browser.edge){e.attr("filter","url(#"+r.getId()+"-"+a+")")}e.attr("x1",o+"%").attr("y1",i+"%").attr("x2",n+"%").attr("y2",s+"%").voidEnd()};r.renderTransformHandlers=function(t){t.openStart("div").class("sapSuiteUiCommonsImageEditorTransformHandlers").openEnd();Object.keys(a).forEach(function(e){this.renderTransformHandler(t,e)},this);t.close("div")};r.renderTransformHandler=function(t,e){var r=a[e],o;t.openStart("div");o=this.getCommonHandlerClasses(e);o.push("sapSuiteUiCommonsImageEditorHandlerContainer");o.forEach(function(e){t.class(e)});t.openEnd();r.handlers.forEach(function(e){this.renderDiv(t,["sapSuiteUiCommonsImageEditorHandler","sapSuiteUiCommonsImageEditorHandler"+e])},this);t.close("div")};r.renderCropAreaDragHandler=function(t,e){var r=e._getCropAreaDragIcon();t.openStart("div").class("sapSuiteUiCommonsImageEditorDragHandlerContainer").openEnd();t.renderControl(r);t.close("div")};r.renderCropAreaResizeHandlers=function(t){Object.keys(a).forEach(function(e){this.renderCropAreaResizeHandler(t,e)},this)};r.renderCropAreaResizeHandler=function(t,e){var r=a[e],o;t.openStart("div");o=this.getCommonHandlerClasses(e);o.push("sapSuiteUiCommonsImageEditorHandlerContainer");r.types.forEach(function(t){o.push("sapSuiteUiCommonsImageEditorCropItem"+t)});o.forEach(function(e){t.class(e)});t.openEnd();r.handlers.forEach(function(e){this.renderDiv(t,["sapSuiteUiCommonsImageEditorHandler","sapSuiteUiCommonsImageEditorHandler"+e])},this);t.close("div")};r.renderDiv=function(t,e){t.openStart("div");e.forEach(function(e){t.class(e)});t.openEnd();t.close("div")};r.renderZoneResizeHandlers=function(t){Object.keys(a).forEach(function(e){this.renderZoneResizeHandler(t,e)},this)};r.renderZoneResizeHandler=function(t,e){var r=this.getCommonHandlerClasses(e);r.push("sapSuiteUiCommonsImageEditorZoneResizeHandler");this.renderDiv(t,r)};r.getCommonHandlerClasses=function(t){var e=a[t];return["ui-resizable-handle","ui-resizable-"+t,e.vertical,e.horizontal]};return r},true);
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ImageEditorResponsiveContainer", ["sap/suite/ui/commons/imageeditor/ImageEditorContainer","./ImageEditorContainerRenderer","sap/ui/Device","sap/m/Button","sap/m/Dialog","sap/m/Bar","sap/m/Title","sap/suite/ui/commons/ControlProxy"],function(e,t,o,i,n,s,r,a){"use strict";var p=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var l=e.extend("sap.suite.ui.commons.imageeditor.ImageEditorResponsiveContainer",{renderer:function(e,i){if(!o.system.phone||i._bInDialog){t.render.apply(this,arguments)}else{e.renderControl(i._getOpenButton())}}});l.prototype._onImageLoaded=function(){e.prototype._onImageLoaded.apply(this,arguments);this._refreshTitle()};l.prototype._getOpenButton=function(){var e=this;if(!this._oOpenButton){this._oOpenButton=new i({text:p.getText("IMGEDITOR_RESPONSIVE_OPEN"),press:function(){e._refreshTitle();e._getDialog().open()}});this.addDependent(this._oOpenButton)}return this._oOpenButton};l.prototype._getTitle=function(){if(!this._oTitle){this._oTitle=new r;this.addDependent(this._oTitle)}return this._oTitle};l.prototype._refreshTitle=function(){var e=this.getImageEditor(),t=p.getText("IMGEDITOR_DIALOG_TITLE");if(e&&e.getFileName()){t+=" - "+e.getFileName()}this._getTitle().setText(t)};l.prototype._getDialog=function(){var e=this;if(!this._oDialog){var t=new a("test");t.setAssociation("control",this);this._oDialog=new n({stretch:true,verticalScrolling:false,beforeOpen:function(){e._bInDialog=true},afterOpen:function(){e._zoomToFit()},beforeClose:function(){e._bInDialog=false},customHeader:new s({contentMiddle:[e._getTitle()],contentRight:[new i({icon:"sap-icon://decline",press:function(){e._oDialog.close()}})]}),content:[t]});this.addDependent(this._oDialog)}return this._oDialog};return l});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/ResizeHistoryItem", ["./HistoryItem","sap/base/assert"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.imageeditor.ResizeHistoryItem",{constructor:function(i){t.apply(this,arguments);i=i||{};e(typeof i.width==="number","Width must be a number.");e(typeof i.height==="number","Height value must be a number.");e(typeof i.oldWidth==="number","Old width value must be a number.");e(typeof i.oldHeight==="number","Old height value must be a number.");this._iWidth=i.width;this._iHeight=i.height;this._iOldWidth=i.oldWidth;this._iOldHeight=i.oldHeight}});i.prototype.getWidth=function(){return this._iWidth};i.prototype.getHeight=function(){return this._iHeight};i.prototype.getOldWidth=function(){return this._iOldWidth};i.prototype.getOldHeight=function(){return this._iOldHeight};i.prototype.compare=function(t){var e=["getWidth","getHeight"];return this._compare(t,e)};return i});
sap.ui.predefine("sap/suite/ui/commons/imageeditor/RotateHistoryItem", ["./HistoryItem","sap/base/assert"],function(e,t){"use strict";var r=e.extend("sap.suite.ui.commons.imageeditor.RotateHistoryItem",{constructor:function(r){e.apply(this,arguments);r=r||{};t(typeof r.degrees==="number","Degrees must be a number.");this._iDegrees=r.degrees}});r.prototype.getDegrees=function(){return this._iDegrees};r.prototype.compare=function(){return false};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/library", ["sap/ui/core/Core","sap/ui/core/library","sap/m/library"],function(e){"use strict";var o=e.initLibrary({name:"sap.suite.ui.commons",dependencies:["sap.ui.core","sap.m"],types:["sap.suite.ui.commons.BulletChartMode","sap.suite.ui.commons.CalculationBuilderComparisonOperatorType","sap.suite.ui.commons.CalculationBuilderFunctionType","sap.suite.ui.commons.CalculationBuilderItemType","sap.suite.ui.commons.CalculationBuilderLayoutType","sap.suite.ui.commons.CalculationBuilderLogicalOperatorType","sap.suite.ui.commons.CalculationBuilderOperatorType","sap.suite.ui.commons.CalculationBuilderValidationType","sap.suite.ui.commons.CommonBackground","sap.suite.ui.commons.ComparisonChartView","sap.suite.ui.commons.DeviationIndicator","sap.suite.ui.commons.FacetOverviewHeight","sap.suite.ui.commons.FrameType","sap.suite.ui.commons.HeaderContainerView","sap.suite.ui.commons.ImageEditorContainerMode","sap.suite.ui.commons.ImageEditorMode","sap.suite.ui.commons.ImageFormat","sap.suite.ui.commons.InfoTileSize","sap.suite.ui.commons.InfoTileTextColor","sap.suite.ui.commons.InfoTileValueColor","sap.suite.ui.commons.LoadState","sap.suite.ui.commons.MicroAreaChartView","sap.suite.ui.commons.MicroProcessFlowRenderType","sap.suite.ui.commons.networkgraph.ActionButtonPosition","sap.suite.ui.commons.networkgraph.BackgroundColor","sap.suite.ui.commons.networkgraph.ElementStatus","sap.suite.ui.commons.networkgraph.LayoutAlgorithmType","sap.suite.ui.commons.networkgraph.LayoutRenderType","sap.suite.ui.commons.networkgraph.LineArrowOrientation","sap.suite.ui.commons.networkgraph.LineArrowPosition","sap.suite.ui.commons.networkgraph.LineType","sap.suite.ui.commons.networkgraph.HeaderCheckboxState","sap.suite.ui.commons.networkgraph.NodePlacement","sap.suite.ui.commons.networkgraph.NodeShape","sap.suite.ui.commons.networkgraph.NodeSize","sap.suite.ui.commons.networkgraph.Orientation","sap.suite.ui.commons.networkgraph.RenderType","sap.suite.ui.commons.ProcessFlowConnectionLabelState","sap.suite.ui.commons.ProcessFlowConnectionState","sap.suite.ui.commons.ProcessFlowConnectionType","sap.suite.ui.commons.ProcessFlowDisplayState","sap.suite.ui.commons.ProcessFlowLaneState","sap.suite.ui.commons.ProcessFlowNodeState","sap.suite.ui.commons.ProcessFlowNodeType","sap.suite.ui.commons.ProcessFlowZoomLevel","sap.suite.ui.commons.SelectionState","sap.suite.ui.commons.statusindicator.FillingType","sap.suite.ui.commons.statusindicator.FillingDirectionType","sap.suite.ui.commons.taccount.TAccountPanelState","sap.suite.ui.commons.ThingGroupDesign","sap.suite.ui.commons.TimelineAlignment","sap.suite.ui.commons.TimelineAxisOrientation","sap.suite.ui.commons.TimelineFilterType","sap.suite.ui.commons.TimelineGroupType","sap.suite.ui.commons.TimelineScrollingFadeout","sap.suite.ui.commons.ValueStatus"],interfaces:[],controls:["sap.suite.ui.commons.BulletChart","sap.suite.ui.commons.BusinessCard","sap.suite.ui.commons.CalculationBuilder","sap.suite.ui.commons.CalculationBuilderExpression","sap.suite.ui.commons.CalculationBuilderFunction","sap.suite.ui.commons.CalculationBuilderInput","sap.suite.ui.commons.CalculationBuilderItem","sap.suite.ui.commons.CalculationBuilderVariable","sap.suite.ui.commons.ChartContainer","sap.suite.ui.commons.ChartContainerContent","sap.suite.ui.commons.ChartContainerToolbarPlaceholder","sap.suite.ui.commons.ChartTile","sap.suite.ui.commons.ColumnMicroChart","sap.suite.ui.commons.ComparisonChart","sap.suite.ui.commons.CloudFilePicker","sap.suite.ui.commons.DateRangeScroller","sap.suite.ui.commons.DateRangeSlider","sap.suite.ui.commons.DateRangeSliderInternal","sap.suite.ui.commons.DeltaMicroChart","sap.suite.ui.commons.DynamicContainer","sap.suite.ui.commons.FacetOverview","sap.suite.ui.commons.FeedItemHeader","sap.suite.ui.commons.FeedTile","sap.suite.ui.commons.GenericTile","sap.suite.ui.commons.GenericTile2X2","sap.suite.ui.commons.HarveyBallMicroChart","sap.suite.ui.commons.HeaderCell","sap.suite.ui.commons.HeaderContainer","sap.suite.ui.commons.imageeditor.ImageEditor","sap.suite.ui.commons.imageeditor.ImageEditorContainer","sap.suite.ui.commons.InfoTile","sap.suite.ui.commons.JamContent","sap.suite.ui.commons.KpiTile","sap.suite.ui.commons.LaunchTile","sap.suite.ui.commons.LinkActionSheet","sap.suite.ui.commons.MicroAreaChart","sap.suite.ui.commons.MonitoringContent","sap.suite.ui.commons.MonitoringTile","sap.suite.ui.commons.networkgraph.Graph","sap.suite.ui.commons.networkgraph.Node","sap.suite.ui.commons.NewsContent","sap.suite.ui.commons.NoteTaker","sap.suite.ui.commons.NoteTakerCard","sap.suite.ui.commons.NoteTakerFeeder","sap.suite.ui.commons.NumericContent","sap.suite.ui.commons.NumericTile","sap.suite.ui.commons.PictureZoomIn","sap.suite.ui.commons.ProcessFlow","sap.suite.ui.commons.ProcessFlowConnection","sap.suite.ui.commons.ProcessFlowConnectionLabel","sap.suite.ui.commons.ProcessFlowLaneHeader","sap.suite.ui.commons.ProcessFlowNode","sap.suite.ui.commons.RepeaterViewConfiguration","sap.suite.ui.commons.SplitButton","sap.suite.ui.commons.statusindicator.StatusIndicator","sap.suite.ui.commons.statusindicator.ShapeGroup","sap.suite.ui.commons.statusindicator.Shape","sap.suite.ui.commons.statusindicator.Rectangle","sap.suite.ui.commons.statusindicator.Circle","sap.suite.ui.commons.statusindicator.CustomShape","sap.suite.ui.commons.statusindicator.PropertyThreshold","sap.suite.ui.commons.statusindicator.DiscreteThreshold","sap.suite.ui.commons.statusindicator.LibraryShape","sap.suite.ui.commons.taccount.TAccount","sap.suite.ui.commons.TargetFilter","sap.suite.ui.commons.ThingCollection","sap.suite.ui.commons.ThreePanelThingInspector","sap.suite.ui.commons.ThreePanelThingViewer","sap.suite.ui.commons.TileContent","sap.suite.ui.commons.TileContent2X2","sap.suite.ui.commons.Timeline","sap.suite.ui.commons.TimelineFilterListItem","sap.suite.ui.commons.TimelineItem","sap.suite.ui.commons.UnifiedThingGroup","sap.suite.ui.commons.UnifiedThingInspector","sap.suite.ui.commons.VerticalNavigationBar","sap.suite.ui.commons.ViewRepeater"],elements:["sap.suite.ui.commons.BulletChartData","sap.suite.ui.commons.CalculationBuilderValidationResult","sap.suite.ui.commons.ColumnData","sap.suite.ui.commons.ColumnMicroChartLabel","sap.suite.ui.commons.ComparisonData","sap.suite.ui.commons.CountingNavigationItem","sap.suite.ui.commons.FeedItem","sap.suite.ui.commons.HarveyBallMicroChartItem","sap.suite.ui.commons.HeaderCellItem","sap.suite.ui.commons.imageeditor.CustomSizeItem","sap.suite.ui.commons.MicroAreaChartItem","sap.suite.ui.commons.MicroAreaChartLabel","sap.suite.ui.commons.MicroAreaChartPoint","sap.suite.ui.commons.TargetFilterColumn","sap.suite.ui.commons.TargetFilterMeasureColumn","sap.suite.ui.commons.AriaProperties"],version:"1.115.0",extensions:{flChangeHandlers:{"sap.suite.ui.commons.Timeline":"sap/suite/ui/commons/flexibility/Timeline"}}});o.BulletChartMode={Actual:"Actual",Delta:"Delta"};o.CommonBackground={Lightest:"Lightest",ExtraLight:"ExtraLight",Light:"Light",MediumLight:"MediumLight",Medium:"Medium",Dark:"Dark",ExtraDark:"ExtraDark",Darkest:"Darkest"};o.ComparisonChartView={Normal:"Normal",Wide:"Wide"};o.CalculationBuilderComparisonOperatorType={"<":"<",">":">","<=":"<=",">=":">=","=":"=","!=":"!="};o.CalculationBuilderFunctionType={ABS:"ABS",Round:"ROUND",RoundUp:"RoundUp",RoundDown:"RoundDown",Case:"CASE",SQRT:"SQRT",NDIV0:"NDIV0",NODIM:"NODIM",SUMCT:"SUMCT",SUMGT:"SUMGT",SUMRT:"SUMRT"};o.CalculationBuilderItemType={Operator:"Operator",CustomOperator:"CustomOperator",Variable:"Variable",Constant:"Constant",Literal:"Literal",Function:"Function",CustomFunction:"CustomFunction",Empty:"Empty",Error:"Error"};o.CalculationBuilderLogicalOperatorType={AND:"AND",OR:"OR",XOR:"XOR",NOT:"NOT"};o.CalculationBuilderLayoutType={Default:"Default",VisualTextualReadOnly:"VisualTextualReadOnly",VisualOnly:"VisualOnly",TextualOnly:"TextualOnly"};o.CalculationBuilderOperatorType={"+":"+","-":"-","/":"/","*":"*","(":"(",")":")",",":","};o.CalculationBuilderValidationMode={FocusOut:"FocusOut",LiveChange:"LiveChange"};o.DeviationIndicator={Up:"Up",Down:"Down",None:"None"};o.FacetOverviewHeight={XS:"XS",S:"S",M:"M",L:"L",XL:"XL",XXL:"XXL",Auto:"Auto",None:"None"};o.FrameType={OneByOne:"OneByOne",TwoByOne:"TwoByOne",TwoThirds:"TwoThirds",Auto:"Auto"};o.HeaderContainerView={Horizontal:"Horizontal",Vertical:"Vertical"};o.InfoTileSize={XS:"XS",S:"S",M:"M",L:"L",Auto:"Auto"};o.InfoTileTextColor={Positive:"Positive",Critical:"Critical",Negative:"Negative"};o.InfoTileValueColor={Neutral:"Neutral",Good:"Good",Critical:"Critical",Error:"Error"};o.LoadState={Loading:"Loading",Loaded:"Loaded",Failed:"Failed",Disabled:"Disabled"};o.MicroAreaChartView={Normal:"Normal",Wide:"Wide"};o.MicroProcessFlowRenderType={Wrap:"Wrap",NoWrap:"NoWrap",Scrolling:"Scrolling",ScrollingWithResizer:"ScrollingWithResizer"};o.networkgraph=o.networkgraph||{};o.networkgraph.BackgroundColor={Default:"Default",White:"White"};o.networkgraph.ActionButtonPosition={Left:"Left",Right:"Right"};o.networkgraph.NodeShape={Circle:"Circle",Box:"Box",Custom:"Custom"};o.networkgraph.LineType={Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted"};o.networkgraph.NodePlacement={BrandesKoepf:"BrandesKoepf",LinearSegments:"LinearSegments",Simple:"Simple"};o.networkgraph.ElementStatus={Standard:"Standard",Success:"Success",Warning:"Warning",Error:"Error",Information:"Information"};o.networkgraph.Orientation={LeftRight:"LeftRight",RightLeft:"RightLeft",TopBottom:"TopBottom",BottomTop:"BottomTop"};o.networkgraph.RenderType={Html:"Html",Svg:"Svg"};o.networkgraph.LineArrowOrientation={ParentOf:"ParentOf",ChildOf:"ChildOf",None:"None",Both:"Both"};o.networkgraph.LineArrowPosition={Start:"Start",Middle:"Middle",End:"End"};o.networkgraph.LayoutRenderType={LayeredWithGroups:"LayeredWithGroups",SwimLanes:"SwimLanes",Forces:"Forces",TwoColumns:"TwoColumns"};o.networkgraph.HeaderCheckboxState={Hidden:"Hidden",Checked:"Checked",Unchecked:"Unchecked"};o.ProcessFlowConnectionLabelState={Neutral:"Neutral",Positive:"Positive",Critical:"Critical",Negative:"Negative"};o.ProcessFlowConnectionState={Highlighted:"Highlighted",Dimmed:"Dimmed",Regular:"Regular",Selected:"Selected"};o.ProcessFlowConnectionType={Planned:"Planned",Normal:"Normal"};o.ProcessFlowDisplayState={Regular:"Regular",RegularFocused:"RegularFocused",Highlighted:"Highlighted",HighlightedFocused:"HighlightedFocused",Dimmed:"Dimmed",DimmedFocused:"DimmedFocused",Selected:"Selected",SelectedHighlighted:"SelectedHighlighted",SelectedHighlightedFocused:"SelectedHighlightedFocused",SelectedFocused:"SelectedFocused"};o.ProcessFlowLaneState={value:"value",state:"state"};o.ProcessFlowNodeState={Positive:"Positive",Negative:"Negative",Critical:"Critical",Planned:"Planned",Neutral:"Neutral",PlannedNegative:"PlannedNegative"};o.ProcessFlowNodeType={Single:"Single",Aggregated:"Aggregated"};o.ProcessFlowZoomLevel={One:"One",Two:"Two",Three:"Three",Four:"Four"};o.SelectionState={Selected:"Selected",NotSelected:"NotSelected",Semantic:"Semantic"};o.statusindicator=o.statusindicator||{};o.statusindicator.FillingDirectionType={Up:"Up",Down:"Down",Left:"Left",Right:"Right",Clockwise:"Clockwise",CounterClockwise:"CounterClockwise"};o.taccount=o.taccount||{};o.taccount.TAccountPanelState={Default:"Default",Table:"Table"};o.statusindicator.HorizontalAlignmentType={Left:"Left",Middle:"Middle",Right:"Right"};o.statusindicator.VerticalAlignmentType={Top:"Top",Middle:"Middle",Bottom:"Bottom"};o.statusindicator.SizeType={None:"None",Small:"Small",Medium:"Medium",Large:"Large",ExtraLarge:"ExtraLarge"};o.statusindicator.LabelPositionType={Top:"Top",Right:"Right",Bottom:"Bottom",Left:"Left"};o.statusindicator.FillingType={Linear:"Linear",Radial:"Radial",Circular:"Circular",None:"None"};o.ThingGroupDesign={ZeroIndent:"ZeroIndent",TopIndent:"TopIndent"};o.TimelineAlignment={Right:"Right",Left:"Left",Top:"Top",Bottom:"Bottom"};o.TimelineAxisOrientation={Vertical:"Vertical",Horizontal:"Horizontal"};o.TimelineFilterType={Data:"Data",Time:"Time",Search:"Search"};o.TimelineGroupType={None:"None",Year:"Year",Month:"Month",Quarter:"Quarter",Week:"Week",Day:"Day"};o.TimelineScrollingFadeout={None:"None",Area:"Area",AreaWithButtons:"AreaWithButtons"};o.ValueStatus={Good:"Good",Neutral:"Neutral",Critical:"Critical",Bad:"Bad"};o.ImageEditorMode={Resize:"Resize",CropRectangle:"CropRectangle",CropEllipse:"CropEllipse",CropCustomShape:"CropCustomShape",Default:"Default"};o.ImageEditorContainerMode={Transform:"Transform",Crop:"Crop",Filter:"Filter"};o.ImageFormat={Png:"Png",Jpeg:"Jpeg"};o.ImageEditorContainerButton={Transform:"Transform",Crop:"Crop",Filter:"Filter"};o.FilePickerModes={All:"All",FileOnly:"FileOnly",FolderOnly:"FolderOnly"};return o});
sap.ui.predefine("sap/suite/ui/commons/mockserver/mockServer", ["sap/ui/base/ManagedObject","jquery.sap.global","sap/ui/thirdparty/sinon"],function(e,jQuery,t){"use strict";return e.extend("sap.ovp.Mockserver.mockServer",{started:null,init:function(){this.started=jQuery.get("test-resources/sap/suite/ui/commons/demokit/sample/CloudFilePicker/mockserver/FileShareItems.json").then(function(e,t,a){this.mockData=e;return jQuery.get("test-resources/sap/suite/ui/commons/demokit/sample/CloudFilePicker/mockserver/metadata.xml")}.bind(this)).then(function(e,a,n){this.metadata=n.responseText;var r=t.fakeServer.create();r.autoRespond=true;r.xhr.useFilters=true;r.xhr.addFilter(function(e,t){return!t.match(/\/sap\/opu\/odata4\//)});var i=this.metadata;var o=this.mockData;s(r);function s(e){e.respondWith("GET",RegExp("/sap","i"),function(e,t){if(e.url.indexOf("metadata")>-1){return e.respond(200,{"Content-Type":"application/xml","OData-Version":"4.0"},i)}});e.respondWith("POST",RegExp("/sap","i"),function(e,a){var n=new RegExp("\\$batch([?#].*)?");var r={};r["@odata.context"]=o["@odata.context"];r["@odata.metadataEtag"]=o["@odata.metadataEtag"];if(e.requestBody.includes("FileShareItems(FileShare='ZPERSONAL',FileShareItem='0ACGgV1bbQGeXUk9PVA')/_Children")){r["value"]=o["fileShareItemsChildrenValue"];t(e,n,r)}else{r["value"]=o["value"];if(e.requestBody.includes("GET FileShares")||e.requestBody.includes("GET FileShares('ZPERSONAL')/_Root")){t(e,n,r)}}});function t(e,t,a){if(t.test(e.url)){var n=e.requestBody;var r=new RegExp("--batch_[a-z0-9-]*");var i=r.exec(n)[0];if(i){var o=n.split(i);var s=new RegExp("GET (.*) HTTP");var c="--165E5739E3F501AD01EF9E72DC8ED0870";o.forEach(function(t,n){if(s.exec(t)){var r;var i=a;if(e.url.indexOf("$count")!==-1){r=u(i,"text/plain")}else{r=u(i)}c=c+"\r\n"+"Content-Type: application/http"+"\r\n"+"Content-Length:"+r.length+"\r\n"+"content-transfer-encoding: binary"+"\r\n\r\n"+r+"--165E5739E3F501AD01EF9E72DC8ED0870"}});c+="--";return e.respond(200,{"Content-Type":"multipart/mixed; boundary=165E5739E3F501AD01EF9E72DC8ED0870","OData-Version":"4.0"},c)}}}}function u(e,t){var a;a=JSON.stringify(e)||"";t=t||"application/json;ieee754compatible=true;odata.metadata=minimal";return"HTTP/1.1 "+"200 OK"+"\r\nContent-Type:"+t+"\r\nContent-Length: "+a.length+"\r\nodata-version: 4.0"+"\r\ncache-control: no-cache, no-store, must-revalidate\r\n\r\n"+a+"\r\n"}}.bind(this))}})},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/ActionButton", ["sap/ui/core/Element"],function(t){"use strict";var e=t.extend("sap.suite.ui.commons.networkgraph.ActionButton",{metadata:{library:"sap.suite.ui.commons",properties:{icon:{type:"string",group:"Appearance",defaultValue:null},title:{type:"string",group:"Appearance",defaultValue:null},enabled:{type:"boolean",group:"Appearance",defaultValue:true},position:{type:"sap.suite.ui.commons.networkgraph.ActionButtonPosition",group:"Appearance",defaultValue:"Right"}},events:{press:{parameters:{buttonElement:{type:"object"}}}}}});e.prototype.invalidate=function(){var t=this.getParent();if(t&&t._bActionButtonsRendered&&!this._bTimeoutRunning){this._bTimeoutRunning=true;setTimeout(function(){this._bTimeoutRunning=false;t._bActionButtonsRendered=false;t.showActionButtons(true)}.bind(this),0)}};return e});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Coordinate", ["sap/ui/core/Element"],function(t){"use strict";var e=t.extend("sap.suite.ui.commons.networkgraph.Coordinate",{metadata:{library:"sap.suite.ui.commons",properties:{x:{type:"float",group:"Misc",defaultValue:undefined},y:{type:"float",group:"Misc",defaultValue:undefined}}}});e.prototype.setX=function(t){this.setProperty("x",t,true);return this};e.prototype.setY=function(t){this.setProperty("y",t,true);return this};return e});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/ElementAttribute", ["sap/ui/core/Control","sap/m/Text","sap/suite/ui/commons/networkgraph/ElementBase"],function(e,t,o){"use strict";var i=e.extend("sap.suite.ui.commons.networkgraph.ElementAttribute",{metadata:{library:"sap.suite.ui.commons",properties:{label:{type:"string",group:"Misc",defaultValue:null},value:{type:"string",group:"Misc",defaultValue:null},labelStatus:{type:"string",group:"Misc",defaultValue:null},valueStatus:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},icon:{type:"string",group:"Misc",defaultValue:""}}},renderer:{apiVersion:2,render:function(e,t){var o=t.getId();e.openStart("div",o);e.attr("data-sap-ui",o);e.class("sapSuiteUiCommonsNetworkGraphDivNodeAttributesRow").openEnd();if(t.getVisible()){e.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeAttributesIcons").openEnd();if(t.getIcon()){e.openStart("div",t.getId()+"-icon");e.class("sapSuiteUiCommonsNetworkGraphDivNodeText").class("sapSuiteUiCommonsNetworkGraphDivAttributeIcon").openEnd();t.getParent()._renderHtmlIcon(t.getIcon(),null,null,null,null,e);e.close("div")}e.close("div");e.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeLabels").openEnd();e.renderControl(t._getLabelControl());e.close("div");e.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeValues").openEnd();e.renderControl(t._getValueControl());e.close("div")}e.close("div")}},onAfterRendering:function(){var e=this.getParent(),t=this.getLabelStatus()||e.getStatus(),i=this.getValueStatus()||e.getStatus();if(t){var a=e._getColor(o.ColorType.Content,t);if(a){this.$("label").css("color",a);this.$("icon").css("color",a)}}if(i){var a=e._getColor(o.ColorType.Content,i);if(a){this.$("value").css("color",a)}}}});i.prototype._getLabelControl=function(e){if(!this._oLabel){this._oLabel=new t(this.getId()+"-label",{textAlign:"Left",wrappingType:"Hyphenated"}).addStyleClass("sapSuiteUiCommonsNetworkGraphDivNodeText")}this._oLabel.setText(this.getLabel());return this._oLabel};i.prototype._getValueControl=function(e){if(!this._oValue){this._oValue=new t(this.getId()+"-value",{textAlign:"Right",wrappingType:"Hyphenated"}).addStyleClass("sapSuiteUiCommonsNetworkGraphDivNodeText")}this._oValue.setText(this.getValue());return this._oValue};i.prototype.exit=function(){if(this._oValue){this._oValue.destroy();this._oValue=null}if(this._oLabel){this._oLabel.destroy();this._oLabel=null}};i.Type=Object.freeze({Label:"Label",Value:"Value"});return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/ElementBase", ["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","./SvgBase","sap/ui/base/ManagedObject","sap/ui/core/theming/Parameters","sap/m/CheckBox","sap/m/library"],function(jQuery,t,e,r,i,o,s){"use strict";var n=s.ValueCSSColor,a=t.networkgraph.ElementStatus,u=t.networkgraph.HeaderCheckboxState;var l=e.extend("sap.suite.ui.commons.networkgraph.ElementBase",{metadata:{properties:{title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},status:{type:"string",group:"Appearance",defaultValue:a.Standard}},aggregations:{attributes:{type:"sap.suite.ui.commons.networkgraph.ElementAttribute",multiple:true,singularName:"attribute"}}},renderer:{}});l.prototype.scrollToElement=function(){var t=this.getParent();if(t){t._scrollToElement(this)}};l.prototype._afterRenderingBase=function(){var t=this.getParent(),e,r;var i=t&&t._isUseNodeHtml()&&this.isA("sap.suite.ui.commons.networkgraph.Node"),o=this.isA("sap.suite.ui.commons.networkgraph.Group");var s=sap.ui.getCore().createRenderManager();if(!i&&!o){if(this._cannotAppendInnerHtml()){e=this.$().parent();r=this._convertToSvg(jQuery.parseHTML(this._render()));e[0].replaceChild(r,this.$()[0])}else{var n=this._render({renderManager:s});if(n){this.$()[0].outerHTML=n}else{s.flush(this.$()[0],true,false);s.destroy()}}}this._afterRendering()};l.prototype._removeFromInvalidatedControls=function(){try{this.getUIArea()._onControlRendered(this)}catch(t){}};l.prototype._setFocus=function(t){var e=t?"addClass":"removeClass";this.$()[e](this.FOCUS_CLASS)};l.prototype._replaceId=function(t,e){if(t.attr("id")){t.attr("id",t.attr("id")+e)}t.removeAttr("data-sap-ui");var r=t.children();if(r.length===0){return}r.each(function(t,r){this._replaceId(jQuery(r),e)}.bind(this))};l.prototype._useInLayout=function(){return true};l.prototype._hasFocus=function(){return this.$().hasClass(this.FOCUS_CLASS)};l.prototype._hasDefaultStatus=function(t){t=t||this.getStatus();return t===a.Error||t===a.Information||t===a.Warning||t===a.Success};l.prototype._hasCustomStatus=function(t){t=t||this.getStatus();if(t===a.Standard||this._hasDefaultStatus(t)){return false}return!!t};l.prototype._isCustomStatusColor=function(t){return t!==l.ColorType.BorderWidth&&t!==l.ColorType.BorderStyle};l.prototype._getElementId=function(t){return t?this.getId()+t:this.getId()};l.prototype._getColor=function(t,e){var r=this.getParent(),o,s,a="";var u=function(){if(typeof this.getSelected==="function"&&this.getSelected()){if(t===l.ColorType.Background||t===l.ColorType.Content||t===l.ColorType.Border){t="Selected"+t}if(t==l.ColorType.HeaderContent&&this._isBox()){t=l.ColorType.Content}}}.bind(this);e=e||this.getStatus();if(!this._hasCustomStatus(e)){return""}if(!r||!t){return""}s=r._oStatuses[e];if(s){if(t.indexOf("Focus")!==-1){if(!s.getUseFocusColorAsContentColor()){return""}t=t.replace("Focus","Content")}u();o="get"+t+"Color";var c=s[o]();if(c){var a=i.get(c);if(!a&&c&&n.isValid(c)){a=c}}}return a?a:""};l.prototype._getStatusValue=function(t,e){var r=this.getParent(),i;e=e||this.getStatus();if(!this._hasCustomStatus(e)){return""}if(!r||!t){return""}i=r._oStatuses[e];if(i){return i["get"+t]()}return""};l.prototype._getStatusStyle=function(t,e){var r="";if(!this._hasCustomStatus()){return""}Object.keys(t).forEach(function(e){var i=this._isCustomStatusColor(t[e])?this._getColor(t[e]):this._getStatusValue(t[e]);if(i){if(r){r+=";"}r+=e+":"+i}},this);if(e&&r){r='style="'+r+'"'}return r};l.prototype._checkForProcessData=function(){var t=this.getParent();if(t&&t._bRequiresDataProcessing){t._processData()}};l.prototype.getStyleObject=function(t){var e={};if(t){var r=t.split(";");for(var i=0;i<r.length;i++){if(r[i]){var o=r[i].split(":");e[o.splice(0,1)[0]]=o.join(":")}}}return e};l.prototype.applyStyles=function(t,e){Object.keys(e).forEach(function(r){t.style(r,e[r])})};l.prototype.getVisibleAttributes=function(){return this.getAttributes().filter(function(t){return t.getVisible()})};l.prototype.setProperty=function(t,e,i){var o=Object.getPrototypeOf(this).aProcessRequiredProperties;r.prototype.setProperty.call(this,t,e,i);if(o&&o.indexOf(t)!==-1&&this.getParent()){this.getParent()._bRequiresDataProcessing=true}};l.prototype.toString=function(){return this.getMetadata()._sClassName+" - "+this.getTitle()};l.prototype._correctTitle=function(t){if(this.getTitle()){var e=this.$().find("."+t);if(e[0]){var r=e[0].getBBox().width,i=parseInt(e.attr("maxwidth"),10);if(r>i){this._createText(e[0],{text:this.getTitle(),hCenter:true})}}}};l.prototype._renderTitle=function(t){var e=10;t=t||{};var r=t.renderManager;if(!r){var i=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-title-clip)"},false);i+=this._renderText({attributes:{style:t.style,class:t.class,x:t.x,y:t.y,maxWidth:t.maxWidth},text:t.title,height:e});i+="</g>";return i}this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-title-clip)"},false,r);this._renderText({attributes:{style:t.style,class:t.class,x:t.x,y:t.y,maxWidth:t.maxWidth},text:t.title,height:e,renderManager:r});r.close("g")};l.prototype._renderClipPath=function(t){t=t||{};var e=t.renderManager;if(!e){var r=this._renderControl("clipPath",{id:t.id},false);r+=this._renderControl("rect",{x:t.x,y:t.y,width:t.width||this._iWidth,height:t.height||this._iHeight,direction:t.direction||""});r+="</clipPath>";return r}else{this._renderControl("clipPath",{id:t.id},false,e);this._renderControl("rect",{x:t.x,y:t.y,width:t.width||this._iWidth,height:t.height||this._iHeight,direction:t.direction||""},null,e);e.close("clipPath")}};l.prototype._renderClonedControl=function(t,e){if(t.mapRender){var r=e.$().clone();this._replaceId(r,t.idSufix);t.renderManager.unsafeHtml(r[0].outerHTML)}else{t.renderManager.renderControl(e)}};l.prototype._appendActionButton=function(t,e){var r=t.id?'id="'+t.id+'"':"";var i="<div "+r+' title="'+t.title+'"class="sapSuiteUiCommonsNetworkGraphDivActionButtonBackground">';i+='<div class="sapSuiteUiCommonsNetworkGraphDivActionButton ';if(!t.enable){i+='sapSuiteUiCommonsNetworkGraphDivActionButtonDisabled"';i+='style = " display: none'}i+='">';i+=this._renderHtmlIcon(t.icon,t.class||"");i+="</div>";i+='<div class="sapSuiteUiCommonsNetworkActionButtonFocusCircle"></div>';i+="</div>";var o=jQuery(i);if(t.enable&&t.click){o.on("click",t.click);o.on("click",function(t){if(this.getParent()){this.getParent().setFocus({item:this,button:o[0]},true)}}.bind(this))}e.append(o)};l._isRectOnScreen=function(t,e,r,i,o,s,n,a){return Math.max(t,e)>o&&Math.min(t,e)<s&&Math.max(r,i)>n&&Math.min(r,i)<a};l.prototype._isOnScreen=function(t,e,r,i){return false};l.prototype._setHeaderCheckBoxState=function(t){if(t!==u.Hidden){this._getHeaderCheckbox().setSelected(t===u.Checked);this._getHeaderCheckbox().setVisible(true)}else if(this.getAggregation("_checkBox")){this._getHeaderCheckbox().setVisible(false)}this.setProperty("headerCheckBoxState",t)};l.prototype.setVisible=function(t){var e=this.getParent();this.setProperty("visible",t);if(e){e.setFocus(null);e._setupKeyboardNavigation()}return this};l.prototype.setStatus=function(t){var e=this.getParent();this.setProperty("status",t);if(e&&e._bIsLayedOut){e.updateLegend()}return this};l.ColorType=Object.freeze({BorderStyle:"BorderStyle",BorderWidth:"BorderWidth",Background:"Background",Border:"Border",Content:"Content",HeaderContent:"HeaderContent",SelectedBorder:"SelectedBorder",SelectedBackground:"SelectedBackground",SelectedContent:"SelectedContent",HoverBackground:"HoverBackground",HoverBorder:"HoverBorder",HoverContent:"HoverContent",Focus:"Focus",HoverFocus:"HoverFocus",SelectedFocus:"SelectedFocus"});return l});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Graph", ["sap/suite/ui/commons/library","sap/ui/thirdparty/jquery","sap/ui/core/Control","./SvgBase","./Node","./Line","./Group","./layout/LayeredLayout","./Tooltip","sap/ui/model/json/JSONModel","sap/m/SuggestionItem","./Utils","sap/m/Label","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/SearchField","sap/m/ToolbarSpacer","sap/ui/core/CustomData","sap/ui/model/Filter","sap/m/OverflowToolbarLayoutData","./KeyboardNavigator","sap/ui/core/theming/Parameters","sap/base/Log","sap/ui/performance/Measurement","sap/base/util/uid","sap/base/security/encodeXML","./GraphRenderer","sap/m/ToggleButton","sap/ui/core/routing/HashChanger","sap/m/library","sap/m/Dialog","sap/suite/ui/commons/util/FullScreenUtil"],function(e,jQuery,t,i,s,o,r,n,a,h,l,u,g,c,p,f,d,_,m,y,L,v,T,S,b,N,C,E,I,A,w,O){"use strict";var F=A.ButtonType,R=e.networkgraph.Orientation,G=e.networkgraph.LayoutRenderType,x=e.networkgraph.RenderType;var $="nodes",U="lines",D="groups";var P=[.05,.1,.25,.33,.5,.67,.75,.8,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],k=1,B=.4,H=1e5;var M={Group:"group",Node:"node",Line:"line",IsLastKey:"islast",TypeKey:"type"};var W=Object.freeze({Node:"Node",Line:"Line",Group:"Group"});var K=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var Z=0,Y=100;var z=l.extend("sap.suite.ui.commons.networkgraph.LimitedSuggestionItem",{render:function(e,t,i,s){if(Z++<Y){l.prototype.render.call(this,e,t,i,s)}}});var X=i.extend("sap.suite.ui.commons.networkgraph.Graph",{metadata:{library:"sap.suite.ui.commons",properties:{height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},orientation:{type:"sap.suite.ui.commons.networkgraph.Orientation",group:"Behavior",defaultValue:R.LeftRight},enableZoom:{type:"boolean",group:"Behavior",defaultValue:true},enableWheelZoom:{type:"boolean",group:"Behavior",defaultValue:true},backgroundImage:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},backgroundColor:{type:"sap.suite.ui.commons.networkgraph.BackgroundColor",group:"Appearance",defaultValue:"White"},renderType:{type:"sap.suite.ui.commons.networkgraph.RenderType",group:"Appearance",defaultValue:x.Html},noData:{type:"boolean",group:"Behavior",defaultValue:false},noDataText:{type:"string",group:"Behavior",defaultValue:""}},aggregations:{lines:{type:"sap.suite.ui.commons.networkgraph.Line",multiple:true,singularName:"line"},nodes:{type:"sap.suite.ui.commons.networkgraph.Node",multiple:true,singularName:"node"},groups:{type:"sap.suite.ui.commons.networkgraph.Group",multiple:true,singularName:"group"},legend:{type:"sap.ui.core.Control",multiple:false},layoutAlgorithm:{type:"sap.suite.ui.commons.networkgraph.layout.LayoutAlgorithm",multiple:false},statuses:{type:"sap.suite.ui.commons.networkgraph.Status",multiple:true,singularName:"status"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{graphReady:{},afterLayouting:{},beforeLayouting:{},zoomChanged:{},failure:{parameters:{type:"string",message:"string"}},selectionChange:{parameters:{items:{type:"sap.suite.ui.commons.networkgraph.ElementBase[]"}}},searchSuggest:{parameters:{term:{type:"string"}}},search:{parameters:{term:{type:"string"},key:{type:"string"}}}}}});X.FAILURE_TYPE={INCONSISTENT_MODEL:"Inconsistent model",LAYOUT_FAILURE:"Layout failure"};X.prototype.ZOOM_100=k;X.prototype.init=function(){this._fZoomLevel=1;this._mSelectedNodes={};this._mSelectedLines={};this._bIsLayedOut=false;this._bIsFullScreen=false;this._mNodes={};this._bNeedNodeProcessing=true;this._oFullScreenContainer=null;this._bRequiresDataProcessing=true;this._oPanning={};this._oLegendLabels={};this._iRunningLayouts=0;this._oLastLayout=null;this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this._oFocus=null;this._tooltip=this._createTooltip();this._bIsInvalid=false;this._oStatuses={};this._aShadedNodes=[];this._createToolbar()};X.prototype.onBeforeRendering=function(){this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this.setBusy(false);this.setBusyIndicatorDelay(0);this._iNodeMaxWidth=0;this.getNodes().forEach(function(e){e._resetDimensions();var t=e.getMaxWidth();if(t>this._iNodeMaxWidth){this._iNodeMaxWidth=t}}.bind(this));this.getLines().forEach(function(e){e._resetLayoutData()});if(!this.getNoData()){this.setDisableToolbarButtons(true);this._loadData()}else{this.setDisableToolbarButtons(false)}};X.prototype.onAfterRendering=function(){var e=this.getNodes();var t=sap.ui.getCore().createRenderManager();this.$divnodes=this.$("divnodes");this.$divgroups=this.$("divgroups");this.$background=this.$("background");this.$tooltips=this.$("tooltiplayer");this.$scroller=this.$("scroller");this._$innerscroller=this.$("innerscroller");this.$legend=this.$("legend");if(this._oFullScreenContainer&&this._bIsFullScreen){this._oFullScreenContainer.$content=this.$();this.$().addClass("sapSuiteUiCommonsNetworkGraphFullScreen")}if(e.length===0||this._bIsInvalid||this.getNoData()){if(this._bIsInvalid){t.openStart("span");t.class("sapSuiteNetworkGraphErrorText");t.openEnd();t.close("span");t.flush(this.$scroller[0])}if(this._oSuggestionItemsModel){this._oSuggestionItemsModel.setData("")}this.fireGraphReady();return}this.setBusy(true);e.forEach(function(e){e.bOutput=true});if(this._isDelayedLayouting()){var i=function(){if(this._iNodeMaxWidth){this.$divnodes.css("width",this._iNodeMaxWidth+50+"px")}if(this._isUseNodeHtml()){this._createDivNodes()}else{t.openStart("svg",this.getId()+"-sizesvg");if(this._bIsRtl){t.attr("direction","rtl")}t.class("sapSuiteUiCommonsNetworkGraphSvg");t.openEnd();e.forEach(function(e){e._setupWidthAndHeight();e._render({sizeDetermination:true,renderManager:t});t.close("g")});t.openStart("rect");t.class("sapSuiteFlickerFreeRect");t.attr("x","0").attr("y","0");t.openEnd();t.close("rect");t.close("svg");t.flush(this._$innerscroller[0],true,this._$innerscroller.children().length)}e.forEach(function(e){if(this._isUseNodeHtml()){e._setupDivDimensions()}else{e.calculateSizes();e._setupWidthAndHeight()}}.bind(this));this._preprocessData();sap.ui.getCore().detachThemeChanged(i)}.bind(this);if(!sap.ui.getCore().isThemeApplied()){sap.ui.getCore().attachThemeChanged(i)}else{i()}}t.destroy()};X.prototype.exit=function(){if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this)}};X.prototype._beforeRender=function(){this.fireEvent("afterLayouting")};X.prototype._fireFailure=function(e,t){var i=t;if(typeof t==="object"&&t.text){i=t.text}var s="Graph failure: "+e+": "+i;if(e===X.FAILURE_TYPE.INCONSISTENT_MODEL){s+=" This may be due to the model size restriction. For its increase use model's 'setSizeLimit' method."}this.fireFailure([e.toString(),i]);T.error(s)};X.prototype.isFullScreen=function(){return this._bIsFullScreen};X.prototype.toggleFullScreen=function(){this._toggleFullScreen()};X.prototype.preventInvalidation=function(e){this._bPreventInvalidation=e};X.prototype.scrollToElement=function(e){this._scrollToElement(e)};X.prototype.setSearchSuggestionItems=function(e){var t=[];if(e){e.forEach(function(e){t.push({text:e.getText(),icon:e.getIcon(),key:e.getKey(),description:e.getDescription()})})}this._oSuggestionItemsModel.setData({items:t})};X.prototype.destroyAllElements=function(){this.destroyAggregation($,false);this.destroyAggregation(D,false);this.destroyAggregation(U,false)};X.prototype.deselect=function(e){var t=[],i=this.$(),s=function(e){Object.keys(e).forEach(function(i){t.push(e[i]);e[i].setSelected(false)},this)}.bind(this);i.find("."+this.HIGHLIGHT_CLASS).removeClass(this.HIGHLIGHT_CLASS);i.find("."+this.SELECT_CLASS).removeClass(this.SELECT_CLASS);i.find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);s(this._mSelectedNodes);s(this._mSelectedLines);this._aShadedNodes.forEach(function(e){e._setNodeOpacity(false)});this._aShadedNodes=[];this.$(this.LINEBUTTONSID).hide();if(!e&&t.length){this.fireSelectionChange({items:t})}return t};X.prototype.getFocus=function(){return this._oFocus};X.prototype.getToolbar=function(){return this._toolbar};X.prototype.getNodeByKey=function(e){if(this._bRequiresDataProcessing){this._processData()}return this._mNodes[e]};X.prototype.setCustomLegendLabel=function(e){var t;if(e.isGroup===true){t=W.Group}else if(e.isLine===true){t=W.Line}else{t=e.isNode===false?W.Line:W.Node}if(e.status){this._oLegendLabels[t+e.status]=e.label;this._createLegend()}};X.prototype.updateLegend=function(){this._createLegend()};X.prototype.zoom=function(e){e=e||{};e.deltaY=e.zoomin!==false?1:-1;if(e.x&&e.y){e.point={x:e.x,y:e.y}}this._zoom(e)};X.prototype.getZoomLevelMilestones=function(){return P};X.prototype.getCurrentZoomLevel=function(){return this._fZoomLevel};X.prototype.setCurrentZoomLevel=function(e){this._fZoomLevel=e;this._zoomLabel.setText(this._getZoomText())};X.prototype.getCorrectMousePosition=function(e){var t=this.$svg.offset(),i=1,s=1;if(this._iWidth!==this.$svg.width()||this._iHeight!==this.$svg.height()){i=this._iWidth/this.$svg.width();s=this._iHeight/this.$svg.height()}return{x:parseInt((e.x-t.left)*i,10),y:parseInt((e.y-t.top)*s,10)}};X.prototype._createTooltip=function(){var e=new a(this.getId()+"-tooltip");this.addDependent(e);e.create(this);e.attachEvent("afterClose",function(){var e=this.getFocus();if(e){this.setFocus(e);if(e.button=="menu"){e.item._setMenuButtonFocus(true)}}}.bind(this));return e};X.prototype.defocus=function(){this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS)};X.prototype.setFocus=function(e,t){if(!e&&!this._oFocus||e&&this._oFocus&&e.item===this._oFocus.item&&e.button===this._oFocus.button){if(t){this._updateAccessibility(e)}return}this.defocus();if(this.getFocusDomRef()){this.getFocusDomRef().focus()}if(e){if(e.button){if(e.item instanceof s||e.item instanceof o){e.item._setActionButtonFocus(e.button,true)}else if(e.item instanceof r){if(e.button===r.BUTTONS.MENU){e.item._setMenuButtonFocus(true)}else if(e.button===r.BUTTONS.COLLAPSE){e.item._setCollapseButtonFocus(true)}}}else if(e.item){e.item._setFocus(true);if(e.item instanceof r){e.button=r.BUTTONS.MENU}}}this._oFocus=e;this._ensureOnScreen(e?e.item:null);this._updateAccessibility(e)};X.prototype._updateAccessibility=function(e){var t=function(){this._setAccessibilityTitle(K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"))}.bind(this),i=function(t){if(t==="Expand/Collapse"){if(e.item.getCollapsed()){return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t+" "+K.getText("NETWORK_GRAPH_EXPANDED")}else{return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t+" "+K.getText("NETWORK_GRAPH_COLLAPSED")}}return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t};if(this.getDomRef("wrapper")){this.getDomRef("wrapper").setAttribute("aria-live","assertive");this._setAriaLabelForWrapper()}if(e){if(e.button){if(e.item instanceof s){if(e.button.title==="Expand/Collapse"){this._setAccessibilityTitle(e.item._getActionButtonTitle(e.button)+" "+e.item._oExpandState)}else{this._setAccessibilityTitle(e.item._getActionButtonTitle(e.button))}}else if(e.item instanceof r){if(e.button===r.BUTTONS.MENU){this._setAccessibilityTitle(i(K.getText("NETWORK_GRAPH_GROUP_DETAIL")))}else if(e.button===r.BUTTONS.COLLAPSE){this._setAccessibilityTitle(i(K.getText("NETWORK_GRAPH_EXPAND_COLLAPSE")))}else{t()}}else{t()}}else if(e.item){this._setAccessibilityTitle(e.item._getAccessibilityLabel())}else{this._setAriaLabelForWrapper(K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"));this._setAccessibilityTitle(" ")}}else{t()}};X.prototype._setAriaLabelForWrapper=function(e){e=e?e:" ";this.getDomRef("wrapper").setAttribute("aria-label",e)};X.prototype._processProperties=function(){if(this._bNeedNodeProcessing){this._mSelectedNodes={};this._mSelectedLines={};this.getNodes().forEach(function(e){if(e.getSelected()){this._mSelectedNodes[e.getKey()]=e}if(e.getCollapsed()){e.setCollapsed(true)}},this);this.getLines().forEach(function(e){if(e.getSelected()){this._mSelectedLines[e._getLineId()]=e}},this);this._bNeedNodeProcessing=false}};X.prototype._loadData=function(){if(this.getNodes().length>0){if(!this._processData()){return}if(!this._isDelayedLayouting()){setTimeout(this._preprocessData.bind(this),0)}}};X.prototype._preprocessData=function(){this._bIsLayedOut=false;this._bImageLoaded=false;this.fireBeforeLayouting();this._applyLayout().then(this._render.bind(this))};X.prototype._getAllElements=function(){return this.getNodes().concat(this.getGroups())};X.prototype._render=function(){this._beforeRender();this._iRunningLayouts--;if(this._iRunningLayouts>0){return}this._oLastLayout=null;this._createSearchSuggestItems();this._innerRender();this._createLegend();this._processProperties();if(this._fZoomLevel!==1){this.$svg[0].setAttribute("viewBox","0 0 "+this.$svg.width()+" "+this.$svg.height());var e=this.$svg.width(),t=this.$svg.height();this.$svg.width(e*this._fZoomLevel);this.$svg.height(t*this._fZoomLevel);this.$background.width(e*this._fZoomLevel);this.$background.height(t*this._fZoomLevel);if(this._isUseNodeHtml()){var i="scale("+this._fZoomLevel+")";this.$("divnodes").css("transform",i)}this.$("tooltiplayer").css("transform",i);this.$("divgroups").css("transform",i)}this._setLineClasses();if(this._selectElementAfterScroll){this._scrollToElement(this._selectElementAfterScroll);this._selectElementAfterScroll=null}if(this._oFocus&&this._oFocus.button===r.BUTTONS.COLLAPSE){this._oFocus.item._setCollapseButtonFocus(true)}this._bIsLayedOut=true;this._setupEvents();this._setupKeyboardNavigation();this.setFocus(this.getFocus());if(!this.getBackgroundImage()||this._bImageLoaded){this.setBusy(false);this.fireGraphReady()}if(!this._isSwimLane()&&!this._isTwoColumnsLayout()){this.$("innerscroller").addClass(" sapSuiteUiCommonsNetworkGraphInnerScrollerCenter ")}};X.prototype._createDivNodes=function(){var e=sap.ui.getCore().createRenderManager();this.getNodes().forEach(function(t){t._bMainRender=true;e.renderControl(t);t._bMainRender=false});e.flush(this.$divnodes[0]);e.destroy()};X.prototype._innerRender=function(e){var t=function(){this.$svg.find(".sapSuiteFlickerFreeRect").remove();this._bImageLoaded=true;if(this._bIsLayedOut){this.setBusy(false);this.fireGraphReady()}}.bind(this);var i=function(){var e=sap.ui.getCore().createRenderManager();this.getGroups().forEach(function(t){e.renderControl(t)});e.flush(this.$("divgroups")[0],false,true);e.destroy()}.bind(this);var s=20,o=50,r=function(){var e=0,i=0;var r=function(t,s){if(t>e){e=t}if(s>i){i=s}};this._iWidth=0;this._iHeight=0;this._getAllElements().forEach(function(e){if(!e._isIgnored()){r(e._iWidth+e.getX(),e._iHeight+e.getY())}},this);this.getLines().forEach(function(e){if(!e._isIgnored()){e.getCoordinates().forEach(function(e){r(e.getX(),e.getY())})}},this);if(this.getBackgroundImage()){var n=new Image;n.onload=function(){this._iWidth=Math.max(this._iWidth,n.width);this._iHeight=Math.max(this._iHeight,n.height);this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);this.$svg.css("background-image","url("+this.getBackgroundImage()+")");this.$svg.css("background-size","cover");t()}.bind(this);n.onerror=function(){T.warning("Unable to load background image.");t()};n.src=this.getBackgroundImage()}this._iWidth=Math.round(e+(this._isTwoColumnsLayout()?0:o));this._iHeight=Math.round(i+s);if(this.getWidth()==="auto"){this.$().width(this._iWidth)}if(this.getHeight()==="auto"){this.$("wrapper").height(this._iHeight)}if(this._isTwoColumnsLayout()){var a=this._$innerscroller.width();if(this._iWidth<a){this._iWidth=a}}this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);if(this._isUseNodeHtml()){this.$divnodes.width(this._iWidth);this.$divnodes.height(this._iHeight);this.$divnodes.css("opacity",1)}this.$divgroups.width(this._iWidth);this.$divgroups.height(this._iHeight);this.$tooltips.width(this._iWidth);this.$tooltips.height(this._iHeight)}.bind(this);var n=function(e){e.forEach(function(e){e.forEach(function(e){e._afterRendering()})})};var a=this.getNodes(),h=this.getLines();S.start(this.getId(),"Rendering of a network graph");if(!this._isUseNodeHtml()){this.$("sizesvg").remove()}i();var l=sap.ui.getCore().createRenderManager();this._renderSvg(this._isUseNodeHtml()?[]:a,h,l);l.flush(this._$innerscroller[0],true,this._$innerscroller.children().length);l.destroy();this.$svg=this.$("networkGraphSvg");this.$background=this.$("background");r();if(this._isUseNodeHtml()){a.forEach(function(e){var t=e.$();if(e._isInCollapsedGroup()){t.hide()}t.css("top",e.getY()+"px");t.css("left",e.getX()+"px")})}n([this._isUseNodeHtml()?[]:a,h]);S.end(this.getId())};X.prototype._renderSvg=function(e,t,i){var s=["sapSuiteUiCommonsNetworkGraphSvg","sapSuiteUiCommonsNetworkGraphNoSelect","sapSuiteNetworkGraphSvgMargin"];if(this._fZoomLevel<B){s.push("sapSuiteUiCommonsNetworkGraphZoomedOut")}if(!this._isUseNodeHtml()){s.push("sapSuiteNetworkGraphSvgPosition")}var o=function(e,t){e.forEach(function(e){e._render({renderManager:t});e.bOutput=true})};var r=function(e,t,s){i.openStart("g",this._getDomId(e));if(s){i.class(s)}i.openEnd();o(t,i);i.close("g")}.bind(this);i.openStart("svg",this.getId()+"-networkGraphSvg");if(this._bIsRtl){i.attr("direction","rtl")}s.forEach(function(e){i.class(e)});i.attr("preserveAspectRatio","none");i.openEnd();i.openStart("g",this.getId()+"-svgbody");i.openEnd();r("lines",t,"sapSuiteUiCommonsNetworkLines");if(!this._isUseNodeHtml()){r("nodes",e,"sapSuiteUiCommonsNetworkNodes")}i.close("g");if(this.getBackgroundImage()){i.openStart("rect");i.class("sapSuiteFlickerFreeRect");i.attr("x","0");i.attr("y","0");i.attr("height","100%");i.attr("width","100%");i.openEnd();i.close("rect")}i.close("svg");if(this._isUseNodeHtml()){i.openStart("div",this.getId()+"-background");i.openEnd();i.close("div")}};X.prototype._isProperKey=function(e){return e||e==="0"};X.prototype._processData=function(){var e=this._isSwimLane();var t=function(){var t=0,i;this.mGroups={};i=this.getGroups().some(function(i){var s=i.getKey();i._iNestedLevel=0;if(!this._isProperKey(s)){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group without a proper key [index: "+t+"] found.");return true}i._bIsSwimLane=e;i._resetSize();i._clearChildren();if(this.mGroups[s]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group with a duplicit key "+s+" found.");return true}this.mGroups[s]=i;t++;return false},this);return i||this.getGroups().some(function(e){if(e.getParentGroupKey()&&!this.mGroups[e.getParentGroupKey()]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group '"+e.getKey()+"' reffers to a nonexistent parent group '"+e.getParentGroupKey()+"'.");return true}return false},this)}.bind(this);var i=function(){var e=0;this._mNodes={};return this.getNodes().some(function(t){if(!this._isProperKey(t.getKey())){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node without a proper ID [index: "+e+"] found.");return true}var i=t.getGroup(),s;t._oGroup=null;if(i){s=this.mGroups[i];if(s){t._oGroup=s;s.aNodes.push(t)}else{this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node belonging to a nonexistent group with key "+i+" found.");return true}}this._isUseNodeHtml()?t._resetDimensions():t._setupWidthAndHeight();t._clearChildren();t._rendered=false;if(this._mNodes[t.getKey()]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node with a duplicit key "+t.getKey()+" found.");return true}this._mNodes[t.getKey()]=t;e++;return false},this)}.bind(this);var s=function(){return this.getLines().some(function(e,t){var i=this.getNodeByKey(e.getFrom()),s=this.getNodeByKey(e.getTo());if(!i){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going from a nonexistent node with key "+e.getFrom()+" found.");return true}if(!s){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going to a nonexistent node with key "+e.getTo()+" found.");return true}e._rendered=false;e._initialized=false;if(i&&s){i.aChildren.push(s);i.aLines.push(e);s.aParents.push(i);s.aParentLines.push(e);e._oFrom=i;e._oTo=s;e._sKey="line_"+i.getKey()+"-"+s.getKey()+"["+t+"]"}if(i._oGroup){i._oGroup.aLines.push(e);i._oGroup.aChildren.push(s)}if(s._oGroup){s._oGroup.aParentLines.push(e);s._oGroup.aParents.push(i)}return false},this)}.bind(this);var o=function(){this.getGroups().forEach(function(e){var t=e.getParentGroupKey();if(t){var i=this.mGroups[t];if(i){e._oParentGroup=i;i.aChildGroups.push(e)}}}.bind(this));this.getGroups().forEach(function(e){var t=0,i=e._oParentGroup,s=false,o=e;while(i){if(i.getCollapsed()&&!s){e._oCollapsedByParent=i;s=true}o=i;i=i._oParentGroup;t++}e._iNestedLevel=t;e._oTopParentGroup=o})}.bind(this);this._bRequiresDataProcessing=false;if(t()||i()||s()){this._bIsInvalid=true;return false}o();this._oStatuses={};this.getStatuses().forEach(function(e){var t=e.getKey();if(t){this._oStatuses[t]=e}},this);this._bIsInvalid=false;return true};X.prototype._validateLayout=function(){var e,t,i,s="";e=this.getNodes().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Node("+e.getKey()+")";return!(e._oGroup&&e._oGroup.getCollapsed()||isFinite(e.getX())&&isFinite(e.getY()))});if(e){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}if(this._isLayered()){t=this.getGroups().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Group("+e.getKey()+")";return!e._isEmpty()&&(!isFinite(e.getX())||!isFinite(e.getY()))});if(t){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}}i=this.getLines().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Line("+e.getKey()+")";return!e._validateLayout()});if(i){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}return true};X.prototype._suggest=function(e){var t=function(e){e.addCustomData(new _({key:M.IsLastKey,value:"true",writeToDom:true}))};var i=function(e){var t=u.find(e.getCustomData(),function(e){return e.getKey()===M.IsLastKey});if(t){e.removeCustomData(t)}};var s=function(e){var t=u.find(e.getCustomData(),function(e){return e.getKey()===M.TypeKey});return t&&t.getValue()};var o=function(){var e=this._searchField.getSuggestionItems(),o,r,n;for(var a=0;a<e.length;a++){o=e[a];i(o);if(a<e.length-1){r=s(o);n=s(e[a+1]);if(r&&n){if(r===M.Node&&n===M.Line||r===M.Line&&n===M.Group){t(o)}}}}}.bind(this);var r=[],n=this.fireEvent("searchSuggest",{term:e},true);Z=0;if(n){if(e){r=[new m([new m("text",function(t){return(t.toLowerCase()||"").indexOf(e.toLowerCase())>-1}),new m("description",function(t){return(t.toLowerCase()||"").indexOf(e.toLowerCase())>-1})],false)]}this._searchField.getBinding("suggestionItems").filter(r);o()}this._searchField.suggest()};X.prototype._getElementSelectFunctionName=function(e){var t="";if(e instanceof s){t="_selectNode"}if(e instanceof o){t="_selectLine"}if(e instanceof r){t="_selectGroup"}return t};X.prototype._search=function(e,t){var i,s,o;s=this.fireEvent("search",{term:e,key:t},true);if(!s){return}if(e){o=u.find(this.getNodes(),function(i){return t?i.getKey()===t:i.getTitle()===e});if(!o){o=u.find(this.getLines(),function(i){if(i._isLoop()){return false}return t?i._getLineId()===t:i._createSuggestionHelpText()===e})}if(!o){o=u.find(this.getGroups(),function(i){return i.aNodes.length>0&&(t?i.getKey()===t:i.getTitle()===e)})}if(o){i=this._getElementSelectFunctionName(o);if(i){this[i]({element:o,scroll:true,alwaysSelect:true})}}}else{this.deselect(false);this.setFocus(null)}};X.prototype._createToolbar=function(){var e=this;this._toolbar=new c(this.getId()+"-toolbar",{content:[new d]}).addStyleClass("sapSuiteUiCommonsNetworkGraphToolbar");this.addDependent(this._toolbar);this._toolbar.ontouchstart=function(){this.setFocus(null);this.getDomRef("wrapper").setAttribute("aria-live","off");this._setAriaLabelForWrapper(K.getText("NETWORK_GRAPH_ACCESSIBILITY_LABEL"))}.bind(this);this._searchField=new f({layoutData:new y({priority:sap.m.OverflowToolbarPriority.NeverOverflow,shrinkable:true}),enableSuggestions:true,suggest:function(t){e._suggest(t.getParameter("suggestValue"))},search:function(t){var i=t.getParameter("query"),s=t.getParameter("suggestionItem"),o;if(s){o=s.getProperty("key")}e._search(i,o)}}).addStyleClass("sapSuiteUiCommonsNetworkGraphSearchField");this._toolbar.addContent(this._searchField);this._toolbar.addContent(new E({id:this.getId()+"-legendButton",type:F.Transparent,icon:"sap-icon://legend",tooltip:K.getText("NETWORK_GRAPH_LEGEND"),press:function(t){if(e.$legend.is(":visible")){e.$legend.hide()}else{e.$legend.show()}}}));if(this.getEnableZoom()){this._zoomLabel=new g({layoutData:new y({group:1,priority:sap.m.OverflowToolbarPriority.Disappear}),text:"100%"});this._zoomIn=new p({layoutData:new y({group:1}),type:F.Transparent,ariaDescribedBy:[this._zoomLabel],text:K.getText("CHARTCONTAINER_ZOOMIN"),icon:"sap-icon://zoom-in",tooltip:K.getText("CHARTCONTAINER_ZOOMIN"),press:function(t){e._zoom({deltaY:1})}});this._toolbar.addContent(this._zoomIn);this._toolbar.addContent(this._zoomLabel);this._zoomOut=new p({layoutData:new y({group:1}),type:F.Transparent,ariaDescribedBy:[this._zoomLabel],text:K.getText("CHARTCONTAINER_ZOOMOUT"),icon:"sap-icon://zoom-out",tooltip:K.getText("CHARTCONTAINER_ZOOMOUT"),press:function(t){e._zoom({deltaY:-1})}});this._toolbar.addContent(this._zoomOut)}this._toolbar.addContent(new p({type:F.Transparent,icon:"sap-icon://popup-window",tooltip:K.getText("NETWORK_GRAPH_ZOOMTOFIT"),text:K.getText("NETWORK_GRAPH_ZOOMTOFIT"),press:this._fitToScreen.bind(this)}));this._oFullScreenButton=new p({type:F.Transparent,text:K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),icon:"sap-icon://full-screen",tooltip:K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),press:this._toggleFullScreen.bind(this)});this._toolbar.addContent(this._oFullScreenButton)};X.prototype._fitToScreen=function(){var e=this.$scroller.height()/this._iHeight,t=this.$scroller.width()/this._iWidth,i=Math.min(e,t),s=P.slice(-1);for(var o=1;o<P.length;o++){if(i<P[o]){s=P[o-1];break}}this._zoom({zoomLevel:s})};X.prototype._getZoomText=function(){return Math.floor(this._fZoomLevel*100)+"%"};X.prototype._toggleFullScreen=function(){if(this._bIsFullScreen==false){this._sControlHeight=this.getHeight();this.setHeight("100%");this._sControlWidth=this.getWidth();this.setWidth("100%")}var e=function(e,t){this._oFullScreenButton.setIcon(e);this._oFullScreenButton.setText(t);this._oFullScreenButton.setTooltip(t)}.bind(this);if(this._bIsFullScreen){e("sap-icon://full-screen",K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"))}else{e("sap-icon://exit-full-screen",K.getText("CALCULATION_BUILDER_EXIT_FULL_SCREEN_BUTTON"))}this._bIsFullScreen=!this._bIsFullScreen;if(!this._oFullScreenUtil){this._oFullScreenUtil=O}this._oFullScreenUtil.toggleFullScreen(this,this._bIsFullScreen,this._oFullScreenButton,this._toggleFullScreen);if(this._bIsFullScreen==false){this.setHeight(this._sControlHeight);this.setWidth(this._sControlWidth)}};X.prototype._setupKeyboardNavigation=function(){var e=[],t=[[]],i,s;if(!this._isLayedOut()){return}this.getNodes().forEach(function(t){if(t.isHidden()||t._isIgnored()||!t.getVisible()){return}e.push({item:t,x:t.getX(),y:t.getY()})});this.getLines().forEach(function(t){if(t.isHidden()||t._isIgnored()||!t.getVisible()||t.getCoordinates().length<2){return}var i=t.getCoordinates()[0],s=i.getX(),o=i.getY();t.getCoordinates().forEach(function(e){if(s>e.getX()){s=e.getX()}if(o>e.getY()){o=e.getY()}});e.push({item:t,x:s,y:o})});this.getGroups().forEach(function(t){if(t.isHidden()||t._isEmpty()||!t.getVisible()){return}e.push({item:t,x:t.getX(),y:t.getY()})});e.sort(function(e,t){if(e.y<t.y){return-1}else if(e.y>t.y){return 1}else if(e.x<t.x){return-1}else if(e.x>t.x){return 1}else{return 0}});if(e.length>0){s=[e[0]];t=[s];i=e[0];e.forEach(function(e,o){if(o===0){return}if(e.y===i.y){s.push(e)}else{s=[e];t.push(s)}i=e})}t=this._normalizeGrid(t,e);if(!this._oKeyboardNavigator){this._oKeyboardNavigator=new L(this);this.addDelegate(this._oKeyboardNavigator)}this._oKeyboardNavigator.setItems(t);this._oKeyboardNavigator.setWrapperDom(this.getFocusDomRef())};X.prototype._normalizeGrid=function(e,t){if(t.length===0){return e}var i=t[0],s=i.x,o=i.x,r=1,n,a,h=[],l;t.forEach(function(e){if(e.x<s){s=e.x}if(e.x>o){o=e.x}});e.forEach(function(e){if(e.length>r){r=e.length}});n=Math.abs(o-s)/r;a=s;for(l=0;l<r;l++){a+=n;h.push(a)}return e.map(function(e){var t,i;if(e.length===r){t=e}else{t=[];i=0;while(i<r-e.length&&h[i]<e[0].x){i++;t.push(null)}e.forEach(function(e){t.push(e);i++});while(i<r){t.push(null);i++}}return t.map(function(e){return e?e.item:null})})};X.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};X.prototype._setupEvents=function(){var e=5;var t=0,i={},s=this.$("ctrlalert"),o=this.$scroller;var r=function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))};var n=function(e){if(e.touches&&e.touches.length===2){i={t1:e.touches[0],t2:e.touches[1],diff:r(e.touches[0],e.touches[1])}}};var a=function(s){if(s.touches&&s.touches.length===2){if(++t===e){var o=s.touches[0],n=s.touches[1],a=r(o,n);this._zoom({point:{x:(o.clientX+n.clientX)/2,y:(o.clientY+n.clientY)/2},deltaY:a-i.diff});t=0;i={t1:o,t2:n,diff:a}}s.preventDefault()}}.bind(this);o.on("mousemove",function(e){this._mouseMove(e.clientX,e.clientY)}.bind(this));var h=this._isSwimLane()?this.$svg:this.$divgroups;h.on("mousedown",function(e){this._mouseDown(e.clientX,e.clientY);e.preventDefault()}.bind(this));o.on("mouseleave",this._endDragging.bind(this));o.on("mouseup",this._mouseUp.bind(this));if(this.getEnableZoom()){o.on("wheel",function(e){if(this._wheel({x:e.originalEvent.clientX,y:e.originalEvent.clientY,deltaY:e.originalEvent.deltaY,div:s,ctrl:e.ctrlKey})){e.preventDefault()}}.bind(this))}o.on("touchstart",function(e){n(e)});o.on("touchmove",function(e){a(e)})};X.prototype._wheel=function(e){if(this.getEnableWheelZoom()||e.ctrl){e.div.css("opacity","0");this._zoom({point:{x:e.x,y:e.y},deltaY:-e.deltaY});this._zoomLabel.setText(this._getZoomText());return true}};X.prototype._endDragging=function(){this._oPanning.dragging=false;this.$scroller.removeClass("sapSuiteUiCommonsNetworkGraphPanning")};X.prototype._mouseMove=function(e,t){var i=this.$scroller[0];if(this._oPanning.dragging){if(!this.$scroller.hasClass("sapSuiteUiCommonsNetworkGraphPanning")){this.$scroller.addClass("sapSuiteUiCommonsNetworkGraphPanning")}i.scrollTop=i.scrollTop-(t-this._oPanning.lastY);i.scrollLeft=i.scrollLeft-(e-this._oPanning.lastX);this._oPanning.lastX=e;this._oPanning.lastY=t}};X.prototype._mouseDown=function(e,t){this.deselect(false);this.setFocus(null);this._oPanning.lastX=e;this._oPanning.lastY=t;this._oPanning.dragging=true;this._tooltip.instantClose()};X.prototype._mouseUp=function(){this._endDragging()};X.prototype._preventZoomToChangeLineWidth=function(){return this._isLayered()&&(this._fZoomLevel>=.5&&this._fZoomLevel<2)};X.prototype._setLineClasses=function(){var e=this.$(),t=this._preventZoomToChangeLineWidth()?"addClass":"removeClass",i=this._fZoomLevel<.5?"removeClass":"addClass";e[t]("sapSuiteUiCommonsNetworkGraphDefaultLineWidth");e[i]("sapSuiteUiCommonsNetworkGraphCrispEdges")};X.prototype._zoom=function(e){var t=this.$svg[0].getAttribute("viewBox"),i=e.deltaY<0?-1:1,s,o,r,n;var a=function(e){var t=0,i;P.forEach(function(s,o){var r=Math.abs(e-s);if(r<i||i===undefined){t=o;i=r}});return t};if(!e.point){e.point={x:this.$scroller.width()/2,y:this.$scroller.height()/2}}s=this.getCorrectMousePosition({x:e.point.x,y:e.point.y});if(e.zoomLevel||e.zoomLevel===0){this._fZoomLevel=e.zoomLevel}else{r=a(this._fZoomLevel);if(P.indexOf(this._fZoomLevel)<0){if(this._fZoomLevel>P[r]){r=i<0?r:r+i}else{r=i>0?r:r+i}}else{r+=i}if(r<0){r=0}else if(r>P.length-1){r=P.length-1}this._fZoomLevel=P[r]}if(this._fZoomLevel<0){this._fZoomLevel=0}if(!t){n="0 0 "+Math.round(this.$svg.width())+" "+Math.round(this.$svg.height());this.$svg[0].setAttribute("viewBox",n)}this.$svg.width(Math.round(this._iWidth*this._fZoomLevel));this.$svg.height(Math.round(this._iHeight*this._fZoomLevel));this.$background.width(Math.round(this._iWidth*this._fZoomLevel));this.$background.height(Math.round(this._iHeight*this._fZoomLevel));o=this.getCorrectMousePosition({x:e.point.x,y:e.point.y});this.$scroller[0].scrollLeft+=(s.x-o.x)*this._fZoomLevel;this.$scroller[0].scrollTop+=(s.y-o.y)*this._fZoomLevel;this._zoomLabel.setText(this._getZoomText());if(this._fZoomLevel<B){this.$svg.addClass("sapSuiteUiCommonsNetworkGraphZoomedOut")}else{this.$svg.removeClass("sapSuiteUiCommonsNetworkGraphZoomedOut")}if(this._isUseNodeHtml()){this.$("divnodes").css("transform","scale("+this._fZoomLevel+")")}this.$("divgroups").css("transform","scale("+this._fZoomLevel+")");this.$tooltips.css("transform","scale("+this._fZoomLevel+")");this._setLineClasses();this.fireEvent("zoomChanged")};X.prototype._createSearchSuggestItems=function(){var e=50;var t={items:[]},i=this.getNodes().sort(function(e,t){return e.getTitle().localeCompare(t.getTitle())}),s=this.getLines().sort(function(e,t){var i=e.getTitle(),s=t.getTitle();if(i===s){return e.getFromNode().getTitle().localeCompare(t.getFromNode().getTitle())}return i.localeCompare(s)}),o=this.getGroups().sort(function(e,t){return e.getTitle().localeCompare(t.getTitle())});this._oSuggestionItemsModel=new h;this._oSuggestionItemsModel.setSizeLimit(H);i.forEach(function(i){var s=u.trimText(i.getTitle(),e);t.items.push({text:s?s:i.getKey(),type:M.Node,icon:i.getIcon(),key:i.getKey(),description:"("+K.getText("NETWORK_GRAPH_NODE")+")"})});s.forEach(function(e){if(e._isLoop()){return}if(e.getTitle()||e.getFromNode().getTitle()||e.getToNode().getTitle()){t.items.push({text:e._createSuggestionHelpText(),type:M.Line,key:e._getLineId(),description:"("+K.getText("NETWORK_GRAPH_LINE")+")"})}});o.forEach(function(i){var s=u.trimText(i.getTitle(),e);if(i.aNodes.length>0){t.items.push({text:s?s:i.getKey(),key:i.getKey(),type:M.Group,description:"("+K.getText("NETWORK_GRAPH_GROUP")+")"})}});this._oSuggestionItemsModel.setData(t);this._searchField.setModel(this._oSuggestionItemsModel);this._searchField.bindAggregation("suggestionItems",{path:"/items",template:new z({text:"{text}",icon:"{icon}",key:"{key}",description:"{description}",customData:new _({key:"type",value:"{type}"})})})};X.prototype._scrollToElement=function(e){var t=e._oGroup&&e._oGroup.getCollapsed(),i,s,r,n,a,h;if(t){e=e._oGroup}if(e instanceof o){a=e.getSource();h=e.getTarget();r=Math.abs(h.getX()-a.getX());n=Math.abs(h.getY()-a.getY());i=Math.min(a.getX(),h.getX());s=Math.max(a.getY(),h.getY())}else{i=e.getX();s=e.getY();r=e._iWidth;n=e._iHeight}this.$scroller.get(0).scrollLeft=(i+(r?r:0)/2)*this._fZoomLevel-this.$scroller.width()/2;this.$scroller.get(0).scrollTop=(s+(n?n:0)/2)*this._fZoomLevel-this.$scroller.height()/2};X.prototype._ensureOnScreen=function(e){if(!e||!this.$scroller){return}var t,i,n,a=this.$scroller[0],h=a.scrollLeft/this._fZoomLevel,l=a.scrollTop/this._fZoomLevel,u=h+this.$scroller.width()/this._fZoomLevel,g=l+this.$scroller.height()/this._fZoomLevel;if(!e._isOnScreen(h,u,l,g)){if(e instanceof s){i=e.getX()+e._iWidth/2;n=e.getY()+e._iHeight/2}else if(e instanceof o){t=e._getArrowFragmentVector();i=(t.center.x+t.apex.x)/2;n=(t.center.y+t.apex.y)/2}else if(e instanceof r){i=e.getX();n=e.getY()}if(i<h||i>u){a.scrollLeft=i*this._fZoomLevel-this.$scroller.width()/2}if(n<l||n>g){a.scrollTop=n*this._fZoomLevel-this.$scroller.height()/2}}};X.prototype._createLegend=function(){var e=sap.ui.getCore().createRenderManager();var t=this.$("legend"),i=this,s={},o={},r={};var n=function(e,t){var i=N(e.getStatus());if(i){if(t[i]){t[i].push(e)}else{t[i]=[e]}}};var a=function(e){return Object.keys(e).length>0};var h=function(t,s,o){var r=this._oStatuses[t],n=r&&r._getLegendColor(),a=n?"background-color:"+n:"";this._renderControl.call(i,"div",{status:t,elementtype:o,class:"sapSuiteUiCommonsNetworkGraphLegendLine"},false,e);this._renderControl.call(i,"div",{class:"sapSuiteUiCommonsNetworkGraphLegendColorLine "+this._getStatusClass(t),style:a},null,e);this._renderControl.call(i,"label",{class:"sapSuiteUiCommonsNetworkGraphLegendLineLabel"},false,e);e.text(this._oLegendLabels[o+t]?this._oLegendLabels[o+t]:s);e.close("label");e.close("div")}.bind(this);var l=function(t,i,s,o,r){t.forEach(function(e){n(e,i)});if(a(i)){e.openStart("div").class(s).openEnd();e.openStart("label").class("sapSuiteUiCommonsNetworkGraphLegendTitle").openEnd();e.text(K.getText(o));e.close("label");e.close("div");var l=Object.keys(i).reduce(function(e,t){var i;if(this._oLegendLabels[r+t]){i=this._oLegendLabels[r+t]}else{var s=this._oStatuses[t];i=s?s.getTitle()||t:K.getText("NETWORK_GRAPH_"+t.toUpperCase())}e[t]=i;return e}.bind(this),{});Object.keys(i).sort(function(e,t){return(l[e]||"").localeCompare(l[t])}).forEach(function(e){h(e,l[e],r)})}}.bind(this);if(this.getLegend()){return}if(!t[0]){return}l(this.getNodes(),s,"sapSuiteUiCommonsNetworkGraphLegendTitleNode","NETWORK_GRAPH_NODES",W.Node);l(this.getLines(),o,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_LINES",W.Line);l(this.getGroups(),r,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_GROUPS",W.Group);e.flush(t[0]);e.destroy();if(sap.ui.getCore().byId(this.getId()+"-legendButton").getPressed()){this.getDomRef("legend").style.display="block"}this.$().find(".sapSuiteUiCommonsNetworkGraphLegendLine").on("click",function(e){var t=jQuery(this).attr("status"),r=jQuery(this).attr("elementtype"),n;if(r===W.Node){n=s}if(r===W.Line){n=o}if(!e.ctrlKey){i.deselect(false);i.setFocus(null)}if(r!==W.Group&&n[t]){n[t].forEach(function(e){e.setSelected(true)})}})};X.prototype._selectElement=function(e){var t=e.element&&!e.element.getSelected(),i=[];var s=function(t){e.element.setSelected(t);if(e.setFocus!==false){this.setFocus({item:e.element})}}.bind(this);this.$("svg").find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);if(!e.preventDeselect){i=this.deselect(true);if(e.setFocus){this.setFocus(null)}if(t||e.alwaysSelect){s(true)}}else{s(t)}if(!e.element._hasFocus()&&e.forceFocus){this.setFocus({item:e.element})}if(!i.some(function(t){return t===e.element})){i.push(e.element)}this.fireSelectionChange({items:i})};X.prototype._selectLine=function(e){var t=e.element.getFromNode(),i=e.element.getToNode(),s=t._isInCollapsedGroup()&&t._oGroup===i._oGroup?i._oGroup:null;if(e.scroll){this._scrollToElement(s||e.element)}if(!s){this._selectElement(e)}};X.prototype._selectNode=function(e){var t=e.element._isInCollapsedGroup()?e.element._oGroup:null;if(e.scroll){this._scrollToElement(t||e.element)}if(!t){this._selectElement(e);if(e.renderActionButtons!==false){e.element.showActionButtons(true)}}};X.prototype._selectGroup=function(e){if(e.scroll){this._scrollToElement(e.element)}this.setFocus({item:e.element})};X.prototype._applyLayout=function(){var e;this._iRunningLayouts++;e=this._getLayoutAlgorithm().layout().catch(function(e){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,e);return Promise.reject()}.bind(this)).then(function(){return new Promise(function(t,i){if(e.isTerminated()){t();return}if(this._validateLayout()){t()}else{i()}}.bind(this))}.bind(this));if(this._oLastLayout&&this._iRunningLayouts>1){this._oLastLayout.terminate()}this._oLastLayout=e;return e};X.prototype._setAccessibilityTitle=function(e){var t,i=this.$("accessibility");if(e===null){t=K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT")}else if(typeof e==="string"){t=e}else{t=e._getAccessibilityLabel()}if(i){i.html(N(t))}};X.prototype._isTopBottom=function(){return this.getOrientation()===R.TopBottom||this.getOrientation()===R.BottomTop};X.prototype._getLayoutAlgorithm=function(){return this.getLayoutAlgorithm()||this._getDefalutLayout()};X.prototype._isUseNodeHtml=function(){return this.getRenderType()===x.Html};X.prototype._getDefalutLayout=function(){if(!this._oDefalutLayout){this._oDefaultLayout=new n;this._oDefaultLayout.setParent(this,null,true)}return this._oDefaultLayout};X.prototype._isLayered=function(){var e=this._getLayoutAlgorithm().getLayoutRenderType();return e===G.SwimLanes||e===G.LayeredWithGroups||e===G.TwoColumns};X.prototype._isSwimLane=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===G.SwimLanes};X.prototype._isTwoColumnsLayout=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===G.TwoColumns};X.prototype._isDelayedLayouting=function(){if(this._isUseNodeHtml()){return true}return this.getNodes().some(function(e){var t=e.hasListeners("computeSizes");return t||e._useAutomaticSize()||e.getTitleLineSize()!==1||e._displayDescription()})};X.prototype._isLayedOut=function(){return this._bIsLayedOut};X.prototype.setEnableZoom=function(e){if(this._toolbar){this._zoomLabel.setVisible(e);this._zoomIn.setVisible(e);this._zoomOut.setVisible(e)}this.setProperty("enableZoom",e);return this};X.prototype.setDisableToolbarButtons=function(e){this._toolbar.setEnabled(e);return this};X.prototype.destroyAggregation=function(e,i){this._bRequiresDataProcessing=true;t.prototype.destroyAggregation.call(this,e,i)};X.prototype.insertAggregation=function(e,i,s,o){this._bRequiresDataProcessing=true;t.prototype.insertAggregation.call(this,e,i,s,o)};X.prototype.removeAggregation=function(e,i,s){this._bRequiresDataProcessing=true;t.prototype.removeAggregation.call(this,e,i,s)};X.prototype.addAggregation=function(e,i,s){this._bRequiresDataProcessing=true;t.prototype.addAggregation.call(this,e,i,s)};X.prototype.removeAllAggregation=function(e,i){this._bRequiresDataProcessing=true;t.prototype.removeAllAggregation.call(this,e,i)};X.prototype.updateAggregation=function(e){this._bNeedNodeProcessing=true;t.prototype.updateAggregation.call(this,e)};X.prototype.invalidate=function(){if(this._bPreventInvalidation!==true){t.prototype.invalidate.call(this)}};return X});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/GraphMap", ["sap/ui/thirdparty/jquery","./SvgBase","sap/ui/core/ResizeHandler","./GraphMapRenderer"],function(jQuery,t,e,i){"use strict";var r=4;var s=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var o=t.extend("sap.suite.ui.commons.networkgraph.GraphMap",{metadata:{library:"sap.suite.ui.commons",properties:{height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:""},directRenderNodeLimit:{type:"int",group:"Behavior",defaultValue:250},title:{type:"string",group:"Misc",defaultValue:""}},associations:{graph:{type:"sap.suite.ui.commons.networkgraph.Graph",multiple:false,singularName:"graph"}},events:{mapReady:{}}}});o.prototype.init=function(){this._oResizeListener=null;this.setBusyIndicatorDelay(0)};o.prototype.onAfterRendering=function(){var t=this.getGraph();if(t&&t._bIsLayedOut){this._renderMap()}else{this.setBusy(true)}};o.prototype._renderMap=function(){var t=this.getGraph();if(!t){return}var e,i,s,o,a,h,n,p=this,d=t._fZoomLevel,g=t.getNodes().length===0,u=t._isUseNodeHtml(),l="";var f=function(t,e){if(e){t.forEach(function(t){t._render({mapRender:true,idSufix:p.getId(),renderManager:e})})}else{t.forEach(function(t){l+=t._render({mapRender:true,idSufix:p.getId()})})}};var c=function(t,e){var i=sap.ui.getCore().createRenderManager();t.forEach(function(t){t._render({mapRender:true,renderManager:i,idSufix:p.getId()})});i.flush(e);i.destroy()};var m=function(){var e=sap.ui.getCore().createRenderManager();t.getGroups().forEach(function(t){t._render({mapRender:true,renderManager:e,idSufix:p.getId()})});e.flush(this.getDomRef("divgroups"));e.destroy()}.bind(this);var v=function(e,i){if(!i){o+=this._renderControl("rect",{x:r/2,y:r/2,width:Math.min((t.$scroller.width()-r/2)/d,(t.$svg.width()-r/2)/d),height:Math.min((t.$scroller.height()-r/2)/d,(t.$svg.height()-r/2)/d),class:e,id:this._getDomId("mapNavigator")})}else{this._renderControl("rect",{x:r/2,y:r/2,width:Math.min((t.$scroller.width()-r/2)/d,(t.$svg.width()-r/2)/d),height:Math.min((t.$scroller.height()-r/2)/d,(t.$svg.height()-r/2)/d),class:e,id:this._getDomId("mapNavigator")},null,i)}}.bind(this);if(!t._iWidth||!t._iHeight||g){if(t._bIsInvalid||g){this.setBusy(false);this.$().find(".sapSuiteUiCommonsNetworkGraphMapContent").html("");this.fireMapReady()}return}e=t.$("networkGraphSvg").attr("viewBox");if(!e){e="0 0 "+t._iWidth+" "+t._iHeight}var _=sap.ui.getCore().createRenderManager();_.openStart("svg",this._getDomId("svg"));_.attr("width","100%");_.attr("height","100%");_.class("sapSuiteUiCommonsNetworkGraphMapSvg");_.attr("viewBox",e);_.attr("aria-hidden","true");if(t._bIsRtl){_.attr("direction","rtl")}_.openEnd();if(this._useGraphClone()){this._renderControl("use",{"xlink:href":"#"+t._getDomId("svgbody")},null,_)}else{f(t.getLines(),_);if(!u){f(t.getNodes(),_)}}this._renderControl("rect",{x:0,y:0,width:t._iWidth,height:t._iHeight,class:"sapSuiteUiCommonsNetworkGraphMapBoundary","pointer-events":"fill"},null,_);if(!u){v("sapSuiteUiCommonsNetworkGraphMapNavigator",_)}_.close("svg");_.openStart("div",this._getDomId("divgroups"));_.class("sapSuiteUiCommonsNetworkGraphMapDivGroups");if(sap.ui.getCore().getConfiguration().getRTL()){_.class("sapSuiteUiCommonsNetworkGraphMapDivGroupsLeft")}_.openEnd();_.close("div");if(u){_.openStart("div",this._getDomId("divnodes"));_.class("sapSuiteUiCommonsNetworkGraphMapDivNodes");if(sap.ui.getCore().getConfiguration().getRTL()){_.class("sapSuiteUiCommonsNetworkGraphMapDivGroupsLeft")}_.openEnd();_.close("div");_.openStart("svg");_.class("sapSuiteUiCommonsNetworkGraphSvgNavigator");_.attr("width","100%");_.attr("height","100%");_.attr("viewBox",e);_.openEnd();v("sapSuiteUiCommonsNetworkGraphMapNavigator",_);_.close("svg")}var y=this.$();_.flush(y.find(".sapSuiteUiCommonsNetworkGraphMapContent")[0],true,false);_.destroy();m();if(u){var G=this.getDomRef("divnodes");c(t.getNodes(),G)}a=this.$("svg");i=t._iWidth;s=t._iHeight;h=Math.max(i/a.width(),s/a.height());this._setHtmlNodesPosition(h);n=Math.ceil(h/5);this._iStrokeWidth=n;this._correctLineWidth();this.$("svg").find("circle").css("stroke-width",n+"px");this._setupEvents();this._correctPosition();this.setBusy(false);this.fireMapReady()};o.prototype._setHtmlNodesPosition=function(t){var e=this.getGraph(),i=this.$("svg"),r=1/t,s,o;s=Math.floor(i.width()/2-e._iWidth/2*r);o=Math.floor(i.height()/2-e._iHeight/2*r);this.$("divgroups").css("transform","matrix("+r+", 0, 0, "+r+", "+s+", "+o+")");if(e._isUseNodeHtml){this.$("divnodes").css("transform","matrix("+r+", 0, 0, "+r+", "+s+", "+o+")")}};o.prototype._useGraphClone=function(){var t=this.getDirectRenderNodeLimit(),e=this.getGraph();if(e){return t>e.getNodes().length&&!e._isUseNodeHtml()}return false};o.prototype._correctLineWidth=function(t){var t=this.getGraph(),e=this._isMSBrowser()||(!this._useGraphClone()||t._preventZoomToChangeLineWidth());this.$("svg").css("stroke-width",e?this._iStrokeWidth+"px":"1px")};o.prototype._correctMapNavigator=function(){var t=this.$("mapNavigator"),e=parseFloat(t.attr("width")),i=parseFloat(t.attr("height")),r=parseFloat(t.attr("x")),s=parseFloat(t.attr("y")),o=this.getGraph(),a=o._iWidth,h=o._iHeight;if(e+r>a){t.attr("width",a-r)}if(i+s>h){t.attr("height",h-s)}};o.prototype._resize=function(){var t=this.getGraph(),e=t.$scroller,i=this.$("mapNavigator");i.attr("x",Math.max(r/2,e[0].scrollLeft/t._fZoomLevel));i.attr("y",Math.max(r/2,e[0].scrollTop/t._fZoomLevel));i.attr("width",e.width()/t._fZoomLevel);i.attr("height",e.height()/t._fZoomLevel);this._correctLineWidth();this._correctMapNavigator()};o.prototype._resizeHandler=function(){this._resize();var t=this.getGraph();if(t._isUseNodeHtml()){var e=this.$("svg"),i=this.getGraph().$svg;if(i){var r=Math.max(i.width()/e.width(),i.height()/e.height())*(1/t._fZoomLevel);this._setHtmlNodesPosition(r)}}};o.prototype._correctPosition=function(){var t=this.getGraph(),e=t&&t.$scroller,i=this.$("mapNavigator");if(t&&e[0]){i.attr("x",Math.max(r/2,e[0].scrollLeft/t._fZoomLevel));i.attr("y",Math.max(r/2,e[0].scrollTop/t._fZoomLevel));this._correctMapNavigator()}};o.prototype._setupEvents=function(){var t=false,e=this.getGraph(),i=this.$("svg"),r=e.$scroller;var s=function(t){var s=e.$svg,o=Math.max(s.width()/i.width(),s.height()/i.height()),a=i.find(".sapSuiteUiCommonsNetworkGraphMapBoundary"),h=r[0],n=a.offset().left,p=a.offset().top;h.scrollLeft=(t.pageX-n)*o-r.width()/2;h.scrollTop=(t.pageY-p)*o-r.height()/2};var o=function(){i.removeClass("sapSuiteUiCommonsNetworkGraphPanning");t=false};r.on("scroll",function(){this._correctPosition()}.bind(this));i.off();i.on("mousedown",function(e){t=true;s(e);e.preventDefault()});i.on("mousemove",function(e){if(t){if(!i.hasClass("sapSuiteUiCommonsNetworkGraphPanning")){i.addClass("sapSuiteUiCommonsNetworkGraphPanning")}s(e)}});i.on("mouseleave",function(t){o()});i.on("mouseup",function(t){o()})};o.prototype._onBeforeDataProcess=function(){if(this.getDomRef("svg")){this.$("svg").html("");this.setBusy(true)}};o.prototype._onGraphReady=function(){if(this.getVisible()){setTimeout(this._renderMap.bind(this),0);if(this._oResizeListener){e.deregister(this._oResizeListener)}this._oResizeListener=e.register(this.getGraph().$("wrapper")[0],jQuery.proxy(this._resizeHandler,this))}};o.prototype._removeListeners=function(){var t=this.getGraph();if(t){t.detachBeforeLayouting(this._onBeforeDataProcess,this);t.detachGraphReady(this._onGraphReady,this);t.detachZoomChanged(this._resize,this)}};o.prototype.destroy=function(){this._removeListeners();t.prototype.destroy.apply(this,arguments)};o.prototype.exit=function(){if(this._oResizeListener){e.deregister(this._oResizeListener);this._oResizeListener=null}};o.prototype.getTitle=function(){var t=this.getProperty("title");return t?t:s.getText("NETWORK_GRAPH_MAP_TITLE")};o.prototype.getGraph=function(){var t=this.getAssociation("graph");return t?sap.ui.getCore().byId(t):null||null};o.prototype.setGraph=function(t){this._removeListeners();this.setAssociation("graph",t);var e=this.getGraph();if(e){e.attachBeforeLayouting(this._onBeforeDataProcess,this);e.attachGraphReady(this._onGraphReady,this);e.attachZoomChanged(this._resize,this);if(e._isLayedOut()){this._onGraphReady()}}return this};return o});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/GraphMapRenderer", ["sap/ui/core/Renderer","sap/ui/Device"],function(e,t){"use strict";return{_appendHeightAndWidth:function(e,t){t.style("height",e.getHeight());t.style("width",e.getWidth())},apiVersion:2,render:function(e,i){e.openStart("div",i);e.class("sapSuiteUiCommonsNetworkGraphMap");this._appendHeightAndWidth(i,e);e.openEnd();e.openStart("div");e.class("sapSuiteUiCommonsNetworkGraphMapTitle");e.openEnd();e.openStart("span");e.class("sapSuiteUiCommonsNetworkGraphMapTitleText");e.openEnd();e.text(i.getTitle());e.close("span");e.close("div");e.openStart("div");e.class("sapSuiteUiCommonsNetworkGraphMapContent");if(t.browser.msie){if(i.getHeight()){e.style("flex-direction","row-reverse");e.style("height","100%")}else{e.style("flex-direction","row-reverse")}}else{if(i.getHeight()){e.style("height","100%")}}e.openEnd();e.close("div");e.close("div")}}},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/GraphRenderer", ["sap/suite/ui/commons/library"],function(e){"use strict";var t=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var o=e.networkgraph.BackgroundColor;return{_appendHeightAndWidth:function(e,t){t.style("height",e.getHeight());t.style("width",e.getWidth())},apiVersion:2,render:function(e,a){var i=a._isLayered()?"sapSuiteUiCommonsNetworkGraphLayered":"sapSuiteUiCommonsNetworkGraphNotLayered",r=a._isSwimLane()?"sapSuiteUiCommonsNetworkGraphSwimLane":"";e.openStart("div",a);e.class("sapSuiteUiCommonsNetworkGraph");e.class(r);e.class(i);e.attr("tabindex","0");this._appendHeightAndWidth(a,e);this._writeAriaTags(e,a);e.openEnd();e.renderControl(a._toolbar);e.openStart("div",a.getId()+"-wrapper");e.class("sapSuiteUiCommonsNetworkGraphContentWrapper");e.attr("tabindex","0");e.attr("aria-live","assertive");e.attr("aria-label",t.getText("NETWORK_GRAPH_ACCESSIBILITY_LABEL"));e.attr("role","application");e.openEnd();e.openStart("div",a.getId()+"-accessibility");e.class("sapSuiteUiCommonsNetworkGraphContentWrapperAccessibility");e.openEnd();e.text(t.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"));e.close("div");e.openStart("div",a.getId()+"-scroller");e.class("sapSuiteUiCommonsNetworkGraphScroller");if(a.getBackgroundColor()===o.White){e.class("sapSuiteUiCommonsNetworkGraphBackgroundWhite")}else{e.class("sapSuiteUiCommonsNetworkGraphBackgroundDefault")}e.openEnd();if(a.getNoData()){this._renderNoData(e,a);e.close("div");e.close("div");e.close("div");return}e.openStart("div",a.getId()+"-innerscroller");e.class("sapSuiteUiCommonsNetworkGraphInnerScroller");if(a._isTwoColumnsLayout()){e.style("width","100%")}e.openEnd();e.openStart("div",a.getId()+"-tooltiplayer");e.class("sapSuiteUiCommonsNetworkGraphTooltips");e.openEnd();e.openStart("div",a.getId()+"-divlinebuttons");e.style("display","none");e.class("sapSuiteUiCommonsNetworkGraphLineButtons");e.openEnd();e.openStart("div",a.getId()+"-linetooltip");e.class("sapSuiteUiCommonsNetworkGraphLineTooltip");e.openEnd();e.close("div");e.openStart("div",a.getId()+"-linetooltipbuttons");e.class("sapSuiteUiCommonsNetworkGraphLineActionButtons");e.openEnd();e.close("div");e.close("div");e.close("div");e.openStart("div",a.getId()+"-divgroups");e.class("sapSuiteUiCommonsNetworkGraphDivGroups");e.attr("aria-hidden","true");e.openEnd();e.close("div");if(a._isUseNodeHtml()){e.openStart("div",a.getId()+"-divnodes");e.class("sapSuiteUiCommonsNetworkGraphDivNodes");e.style("opacity","0");e.attr("aria-hidden","true");e.openEnd();e.close("div")}e.close("div");e.close("div");e.openStart("div",a.getId()+"-ctrlalert");e.class("sapSuiteUiCommonsNetworkAlertWrapper");e.openEnd();e.openStart("p");e.class("sapSuiteUiCommonsNetworkAlertText");e.openEnd();e.text(t.getText("NETWORK_GRAPH_ZOOMCTRL"));e.close("p");e.close("div");e.openStart("div",a.getId()+"-legend");e.style("display","none");e.class("sapSuiteUiCommonsNetworkGraphLegend");e.attr("tabindex","0");e.openEnd();if(a.getLegend()){e.renderControl(a.getLegend())}e.close("div");e.close("div");e.close("div")},_writeAriaTags:function(e,o){var a=o.getAriaLabelledBy(),i=o.getAriaDescribedBy();e.attr("role","graphics-document");if(a.length>0){e.attr("aria-labelledby",a.join(" "))}else{e.attr("aria-label",t.getText("NETWORK_GRAPH_ACCESSIBILITY_LABEL"))}if(i.length>0){e.attr("aria-describedby",i.join(" "))}},_renderNoData:function(e,o){e.openStart("div");e.class("sapSuiteUiCommonsNetworkGraphNoDataWrapper");e.attr("tabindex","0");e.openEnd();o._renderHtmlIcon("sap-icon://document","sapSuiteUiCommonsNetworkGraphNoDataIcon",null,null,null,e);var a=o.getNoDataText(),i=a?a:t.getText("NETWORK_GRAPH_NO_DATA");e.openStart("div");e.class("sapSuiteUiCommonsNetworkGraphNoDataLabel");e.openEnd();e.text(i);e.close("div");e.close("div")}}},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Group", ["sap/suite/ui/commons/library","sap/ui/thirdparty/jquery","./ElementBase","sap/ui/core/IconPool","sap/m/CheckBox"],function(e,jQuery,t,o,i){"use strict";var r=e.networkgraph.ElementStatus,s=e.networkgraph.HeaderCheckboxState;var n={COLLAPSED_HEIGHT:32,COLLAPSED_WIDTH:160,ROUNDING:6,ICON_OFFSET:8,ICON_SIZE:15,HEADER_SIZE:32};var a="expand-all",u="collapse-all",p="horizontal-grip";var h=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var l=t.extend("sap.suite.ui.commons.networkgraph.Group",{metadata:{library:"sap.suite.ui.commons",properties:{headerCheckBoxState:{type:"sap.suite.ui.commons.networkgraph.HeaderCheckboxState",group:"Misc",defaultValue:s.Hidden},key:{type:"string",group:"Misc",defaultValue:null},collapsed:{type:"boolean",group:"Misc",defaultValue:false},icon:{type:"string",group:"Appearance",defaultValue:null},minWidth:{type:"float",defaultValue:undefined},parentGroupKey:{type:"string",group:"Misc",defaultValue:null}},events:{headerCheckBoxPress:{parameters:{checked:"boolean"}},collapseExpand:{},showDetail:{}},aggregations:{_checkBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2,render:function(e,t){t._render({renderManager:e})}},onAfterRendering:function(){this._afterRenderingBase()}});l.prototype.aProcessRequiredProperties=["key","parentGroupKey"];l.BUTTONS={MENU:"menu",COLLAPSE:"collapse"};l.prototype.init=function(){this._iWidth=n.COLLAPSED_WIDTH;this._iHeight=n.COLLAPSED_HEIGHT;this._oActionButtons={};this._clearChildren();this._bIsHidden=false};l.prototype._afterRendering=function(){this._setupEvents();if(!this._isVisible()){this.$().hide()}if(this.$().find(".sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner").length!==0){this.$().find(".sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner").attr("aria-label",this.getTitle())}this._removeFromInvalidatedControls()};l.prototype._renderTopGroup=function(e){var t=this._getElementId(e.idSufix),o=this._iTopGroupIndex===0,i=e.renderManager;var r=this.getIcon(),s=this.getTitle();var n=this._iTopGroupIndex*50;if(this.getParent()._bIsRtl){o=!o;n=o?0:50}if(o){i.openStart("div").class("sapSuiteUiCommonsNetworkTopGroupDelimiter").openEnd().close("div")}this._renderHtmlElement("div",{top:0,left:n+"%",width:"50%",height:"32px"},{id:t,"data-sap-ui":t,class:"sapSuiteUiCommonsNetworkTopGroup "+(!o?"sapSuiteUiCommonsNetworkTopGroupRight":"")},i);i.openStart("div").class("sapSuiteUiCommonsNetworkTopGroupHeader").openEnd();if(r){this._renderHtmlIcon(r,null,null,null,null,i)}if(s){i.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderTitle").attr("title",s).openEnd().text(s).close("div")}i.close("div");i.close("div")};l.prototype._render=function(e){var o=this.getParent(),i=!this.getCollapsed()||this._isCollapsedSwimLane()?this._iHeight:n.HEADER_SIZE,r;e=e||{};if(this._iNestedLevel===0&&o._isTwoColumnsLayout()){this._renderTopGroup(e);return""}if(this._isIgnored()||!this.getVisible()){return""}if(this.getParent()._isLayered()){r=this._getElementId(e.idSufix);var s=this._convertToStyle({top:this.getY()+"px",left:this.getX()+"px",width:this._iWidth+"px",height:i+"px"},this._getStatusStyle({"border-color":t.ColorType.Border,"border-width":t.ColorType.BorderWidth,"border-style":t.ColorType.BorderStyle}),true);this._renderHtmlElement("div",{},{id:r,"data-sap-ui":r,class:this._getGroupClass(),style:s},e.renderManager);this._renderHeader(e);e.renderManager.close("div")}};l.prototype._renderHeader=function(e){var o=this.getIcon(),i=this.getTitle();var s="",n="",l="",d="";if(this.getStatus()&&this.getStatus()!==r.Standard){l=this._getStatusStyle({color:t.ColorType.Content},true);d=this._getStatusStyle({color:t.ColorType.Content},false);if(this._bIsSwimLane){s=this._getStatusStyle({"background-color":t.ColorType.Background},false)}else{n=this._getStatusStyle({"background-color":t.ColorType.Background,"border-color":t.ColorType.Background},false)}}e.renderManager.openStart("div");this.applyStyles(e.renderManager,this.getStyleObject(n));e.renderManager.class("sapSuiteUiCommonsNetworkGroupHeader").openEnd();if(this._bIsSwimLane&&(s||this._hasDefaultStatus())){e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderStatus").openEnd();this.applyStyles(e.renderManager,this.getStyleObject(s));e.renderManager.close("div")}e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderInner").class("sapSuiteUiCommonsNetworkGroupHeaderInnerText").openEnd();if(this._showHeaderCheckBox()){this._renderClonedControl(e,this._getHeaderCheckbox())}if(o){this._renderHtmlIcon(o,"sapSuiteUiCommonsNetworkGroupHeaderIcon",null,l,null,e.renderManager)}if(i){e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderTitle").attr("title",i);var c=sap.ui.getCore().getConfiguration().getLanguage();var f=["ja","zh_TW","zh_CN","ko"];if(this._isVerticalSwimLane()&&f.indexOf(c)>-1){d=d.length>0?d.concat(";text-orientation:sideways"):d.concat("text-orientation:sideways")}this.applyStyles(e.renderManager,this.getStyleObject(d));e.renderManager.openEnd();e.renderManager.text(i);e.renderManager.close("div")}e.renderManager.close("div");e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderInner").class("sapSuiteUiCommonsNetworkGroupHeaderInnerIcons").openEnd();this._renderHtmlIcon(this.getCollapsed()?a:u,"sapSuiteUiCommonsNetworkGroupHeaderMenuIcon","collapse",e.renderManager?d:l,h.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),e.renderManager);this._renderHtmlIcon(p,"sapSuiteUiCommonsNetworkGroupHeaderMenuIcon","menu",e.renderManager?d:l,h.getText("NETWORK_GRAPH_GROUP_DETAILS"),e.renderManager);e.renderManager.close("div");e.renderManager.close("div")};l.prototype._getGroupClass=function(){return"sapSuiteUiCommonsNetworkGroup "+this._getStatusClass()+(this.getCollapsed()?"sapSuiteUiCommonsNetworkGroupCollapsed":"sapSuiteUiCommonsNetworkGroupExpanded")+(this._bIsSwimLane?" sapSuiteUiCommonsNetworkGroupSwimLane":" sapSuiteUiCommonsNetworkGroupClassic")+(this._isVerticalSwimLane()?" sapSuiteUiCommonsNetworkGroupVerticalSwimLane":"")+(this._isTopBottom()?" sapSuiteUiCommonsNetworkGroupTopBottom ":"")};l.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren};l.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines};l.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents};l.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines};l.prototype.getNodes=function(){this._checkForProcessData();return this.aNodes};l.prototype.isHidden=function(){return this._bIsHidden};l.prototype.setHidden=function(e){this.$()[e?"hide":"show"]();this._bIsHidden=e};l.prototype.getHeaderCheckbox=function(){return this._getHeaderCheckbox()};l.prototype._getHeaderCheckbox=function(){var e=this.getAggregation("_checkBox"),t=this;if(!e){e=new i(this.getId()+"-checkbox",{select:function(o){var i=e.getSelected();t.fireHeaderCheckBoxPress({checked:i})}}).addStyleClass("sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner");this.setAggregation("_checkBox",e,true)}return e};l.prototype._isCollapsedSwimLane=function(){return this._bIsSwimLane&&this.getCollapsed()};l.prototype._clearChildren=function(){this.aNodes=[];this.aLines=[];this.aChildren=[];this.aParentLines=[];this.aParents=[];this.aChildGroups=[]};l.prototype._hasVisibleNodes=function(e){var t=this.aNodes.some(function(e){return!e._bIsHidden});if(!t){for(var o=0;o<this.aChildGroups.length;o++){if(this.aChildGroups[o]._hasVisibleNodes()){return true}}}return t};l.prototype._hasNodes=function(){var e=this.aNodes.some(function(e){return e._useInLayout()});if(!e){e=this.aChildGroups.some(function(e){return e._hasNodes()})}return e};l.prototype._hideShow=function(e){this.$()[e?"hide":"show"]();this._bIsHidden=e;var t=this._oParentGroup;while(t){var o=t._hasVisibleNodes();if(o&&!e||!o&&e){t._hideShow(e)}else{break}t=t._oParentGroup}};l.prototype._setButtonFocus=function(e,t){var o=t?"addClass":"removeClass";e[o]("sapSuiteUiCommonsNetworkElementFocus")};l.prototype._setMenuButtonFocus=function(e){this._setButtonFocus(jQuery(this._oActionButtons.menu),e)};l.prototype._setCollapseButtonFocus=function(e){this._setButtonFocus(jQuery(this._oActionButtons.collapse),e)};l.prototype._setupEvents=function(){var e=this.$("menu"),o=this.$("header"),i=this.$("collapse"),r=this.$().find(".sapSuiteUiCommonsNetworkGroupHeaderMenuIcon");this._oActionButtons.menu=e[0];this._oActionButtons.collapse=i[0];i.off("click");e.off("click");o.off("click");r.off("mouseover");r.off("mouseout");e.on("click",function(e){var t=this.fireEvent("showDetail",{},true);if(t){this._openDetail()}if(this.getParent()){this.getParent().setFocus({item:this,button:l.BUTTONS.MENU})}this._setMenuButtonFocus(false)}.bind(this));i.on("click",function(e){this._collapse();if(this.getParent()){this.getParent().setFocus({item:this,button:l.BUTTONS.COLLAPSE})}}.bind(this));o.on("click",function(e){if(this.getParent()){this.getParent().setFocus({item:this})}this.firePress()}.bind(this));var s=function(e,t,o){if(!this._bIsSwimLane){e.css("background-color",this._getColor(t))}e.css("color",this._getColor(o))}.bind(this);r.on("mouseover",function(e){s(jQuery(e.currentTarget),t.ColorType.HoverBackground,t.ColorType.HoverContent)});r.on("mouseout",function(e){s(jQuery(e.currentTarget),t.ColorType.Background,t.ColorType.Content)})};l.prototype._collapse=function(){this.getParent()._selectElementAfterScroll=this;this.fireEvent("collapseExpand",{},true);this.setCollapsed(!this.getCollapsed())};l.prototype._openDetail=function(){var e=this.$("menu");this.getParent()._tooltip.openDetail({item:this,opener:e[0]})};l.prototype._isEmpty=function(){return this.aNodes.length===0};l.prototype._isIgnored=function(){if(!this._useInLayout()){return true}return!this._hasNodes()};l.prototype._isVisible=function(){var e=this._bIsSwimLane||this.aNodes.some(function(e){return!e.isHidden()});if(!e){e=this.aChildGroups.some(function(e){return e._isVisible()})}return e};l.prototype._useInLayout=function(){return!this._oCollapsedByParent};l.prototype._resetSize=function(){if(this.getCollapsed()){this._iHeight=n.COLLAPSED_HEIGHT;this._iWidth=n.COLLAPSED_WIDTH}};l.prototype._getAccessibilityLabel=function(){return h.getText("NETWORK_GRAPH_GROUP")+" "+this.getTitle()};l.prototype._isTopBottom=function(){var e=this.getParent();return e&&e._isTopBottom()};l.prototype._isVerticalSwimLane=function(){if(this._bIsSwimLane){var e=this._isTopBottom();return e&&!this.getCollapsed()||!e&&this.getCollapsed()}return false};l.prototype._isCollapsed=function(){return this.getCollapsed()||!!this._oCollapsedByParent};t.prototype._showHeaderCheckBox=function(){return this.getHeaderCheckBoxState()!==s.Hidden};l.prototype._getBorderSize=function(){return 1};l.prototype._setFocus=function(e){this._setMenuButtonFocus(e)};l.prototype._isOnScreen=function(e,o,i,r){var s=this.getX(),n=this.getY();return t._isRectOnScreen(s,s+this._iWidth,n,n+this._iHeight,e,o,i,r)};l.prototype.getHeaderCheckBoxState=function(){if(this.getProperty("headerCheckBoxState")===s.Hidden){return s.Hidden}return this.getHeaderCheckbox().getSelected()?s.Checked:s.Unchecked};l.prototype.setHeaderCheckBoxState=function(e){this._setHeaderCheckBoxState(e);return this};l.prototype.setX=function(e){this.fX=e;return this};l.prototype.getX=function(){return this.fX};l.prototype.setY=function(e){this.fY=e;return this};l.prototype.getY=function(){return this.fY};l.prototype._setCollapsed=function(e,t){var o=this;var i=this.getParent(),r=[];var s=function(t){t.aChildGroups.forEach(function(e){s(e)});if(o!==t){if(!t._oCollapsedByParent||t._oCollapsedByParent===o){t._oCollapsedByParent=e?o:null}}};var n=function(t){if(e){this.getNodes().forEach(function(e){if(e.getSelected()){e.setSelected(false);r.push(e)}});this.getChildLines().forEach(function(e){if(e.getSelected()&&e._isInCollapsedGroup()){e.setSelected(false);r.push(e)}})}}.bind(this);if(e!==this.getCollapsed()||t){this.setProperty("collapsed",e,true);if(e){this.getNodes().forEach(function(e){if(e.getSelected()){e.setSelected(false);r.push(e)}});this.getChildLines().forEach(function(e){if(e.getSelected()&&e._isInCollapsedGroup()){e.setSelected(false);r.push(e)}})}this.aChildGroups.forEach(function(e){n(e)});s(this);if(i&&r.length>0){i.fireSelectionChange({items:r})}if(i&&i._bIsLayedOut){i.invalidate()}}};l.prototype.setCollapsed=function(e){this._setCollapsed(e,false);return this};l.prototype.setVisible=function(e){this.setProperty("visible",e);var t=this.getParent();if(t&&t._bIsLayedOut&&!this.getCollapsed()){this.aNodes.forEach(function(t){if(!e){t.$().hide()}else if(!t._bIsHidden){t.$().show()}})}return this};return l});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/KeyboardNavigator", ["sap/ui/thirdparty/jquery","sap/ui/base/Object","./Group","./Node","./Line","sap/ui/events/KeyCodes","sap/ui/dom/containsOrEquals","sap/base/Log"],function(jQuery,t,e,o,i,s,n,r){"use strict";var u={LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down"};var a=/^on.*|setFocus|setItems$/;function l(t){var e,o=t.prototype;for(e in o){if(o.hasOwnProperty(e)&&typeof o[e]==="function"&&a.test(e)){o[e]=h(o[e])}}}function h(t){return function(){try{return t.apply(this,arguments)}catch(t){this._handleError(t)}return undefined}}var f=t.extend("sap.suite.ui.commons.networkgraph.KeyboardNavigator",{constructor:function(e){t.apply(this,arguments);this._oGraph=e;this._aItems=[[]];this._iRows=0;this._iColumns=0;this._iPageSize=5;this._oFocus=null;this._oFocusPosition=null;this._oWrapperDom=null}});f.prototype.getFocus=function(){var t=this._oGraph.getFocus();if(this._oFocus!==t){this._oFocus=t?{item:t.item,button:t.button}:null;this._oFocusPosition=null}if(this._oFocus!=null&&this._oFocus.item===null&&this._oFocus.button===null){return null}return this._oFocus?{item:this._oFocus.item,button:this._oFocus.button}:null};f.prototype.getFocusPosition=function(){var t=this.getFocus();if(!this._oFocusPosition){var e,o;this._oFocusPosition={iX:null,iY:null};if(!t){return this._oFocusPosition}for(o=0;o<this._aItems.length;o++){for(e=0;e<this._aItems[o].length;e++){if(this._aItems[o][e]===t.item){this._oFocusPosition={iX:e,iY:o};return this._oFocusPosition}}}}return this._oFocusPosition};f.prototype.setItems=function(t){this._aItems=t;this._iRows=t.length;this._iColumns=0;t.forEach(function(t){if(this._iColumns<t.length){this._iColumns=t.length}},this)};f.prototype.setWrapperDom=function(t){this._oWrapperDom=t};f.prototype.setPageSize=function(t){this._iPageSize=t};f.prototype.onsapend=function(t){this._moveThroughMatrix(t,true,true)};f.prototype.onsaphome=function(t){this._moveThroughMatrix(t,true,false)};f.prototype.onsapendmodifiers=function(t){if(t.ctrlKey){this._moveThroughMatrix(t,false,true)}};f.prototype.onsaphomemodifiers=function(t){if(t.ctrlKey){this._moveThroughMatrix(t,false,false)}};f.prototype.onsappagedown=function(t){this._moveThroughMatrix(t,false,true,this._iPageSize)};f.prototype.onsappageup=function(t){this._moveThroughMatrix(t,false,false,this._iPageSize)};f.prototype.onsappagedownmodifiers=function(t){if(t.altKey){this._moveThroughMatrix(t,true,true,this._iPageSize)}};f.prototype.onsappageupmodifiers=function(t){if(t.altKey){this._moveThroughMatrix(t,true,false,this._iPageSize)}};f.prototype.onsapspace=function(t){this._handleEnter();if(this._oGraph.getFocusDomRef()===document.activeElement){t.stopPropagation();t.preventDefault()}};f.prototype.onsapspacemodifiers=function(t){if(t.ctrlKey&&this._oGraph.getFocusDomRef()===document.activeElement){this._selectElement(true);t.stopPropagation();t.preventDefault()}};f.prototype.onsapenter=function(t){this._handleEnter()};f.prototype.onsaptabnext=function(t){this._handleTab(t,u.RIGHT)};f.prototype.onsaptabprevious=function(t){this._handleTab(t,u.LEFT)};f.prototype.onsapleft=function(t){this._handleArrow(t,u.LEFT)};f.prototype.onsapright=function(t){this._handleArrow(t,u.RIGHT)};f.prototype.onsapup=function(t){this._handleArrow(t,u.UP)};f.prototype.onsapdown=function(t){this._handleArrow(t,u.DOWN)};f.prototype.onkeydown=function(t){var n,r,a=this.getFocus();if(!a){return}n=a.item;r=a.button;if(t.ctrlKey&&t.keyCode===s.A){this._onCtrlA(t)}else if(t.keyCode===s.F2){if(n instanceof o){if(n.hasVisibleActionButtons()&&n.getShowDetailButton()){n._detailClick(n.getDomRef().querySelector("#"+n.getId()+"-actionDetail").querySelector(".sapSuiteUiCommonsNetworkGraphDivActionButton"))}}else if(n instanceof i){n.getParent()._tooltip.openDetail({item:n,point:n._getArrowFragmentVector().apex})}else if(n instanceof e){var l=n.fireEvent("showDetail",{},true);if(l){n._openDetail()}}t.stopPropagation()}else if(t.keyCode===s.F6){if(n&&r){a.button=null;this._oGraph.setFocus(a)}this._handleArrow(t,t.shiftKey?u.LEFT:u.RIGHT)}else if(t.keyCode===s.F7&&!t.shiftKey){if(n&&r){a.button=null;this._oGraph.setFocus(a)}}else if(t.ctrlKey&&(t.keyCode===s.DIGIT_0||t.keyCode===s.NUMPAD_0)){this._onCtrl0(t)}else if(t.ctrlKey&&(t.keyCode===s.PLUS||t.keyCode===s.NUMPAD_PLUS)){this._onCtrlPlus(t)}else if(t.ctrlKey&&(t.keyCode===s.SLASH||t.keyCode===s.NUMPAD_MINUS)){this._onCtrlMinus(t)}};f.prototype._handleEnter=function(){var t,s,n=this.getFocus();if(!n){return}if(n.button=="menu"){n.item._setMenuButtonFocus(false)}t=n.item;s=n.button;if(t instanceof o){if(s){this._oGraph._isUseNodeHtml()?jQuery(s).trigger("click"):jQuery(s).children().first().trigger("click")}else{t._onClick(false);if(!t.getSelected()){t.$().removeClass(t.HIGHLIGHT_CLASS);t._setStatusColors("")}}}else if(t instanceof i){var r=t._getArrowFragmentVector();t._click({ctrlKey:false,clientX:r.apex.x,clientY:r.apex.y,skipConversion:true})}else if(t instanceof e){if(s===e.BUTTONS.MENU){var u=t.fireEvent("showDetail",{},true);if(u){t._openDetail()}}else if(s===e.BUTTONS.COLLAPSE){t._collapse()}else{t._openDetail()}}};f.prototype._handleTab=function(t,e){var o=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");this._oWrapperDom.setAttribute("aria-live","assertive");this._oGraph._setAriaLabelForWrapper(o.getText("NETWORK_GRAPH_ACCESSIBILITY_LABEL"));if(this._ignoreEvent(t)){this._oWrapperDom.setAttribute("aria-live","off");this._oWrapperDom.classList.remove("sapSuiteUiCommonsNetworkGraphContentFocusHidden");return}else{this._oWrapperDom.classList.add("sapSuiteUiCommonsNetworkGraphContentFocusHidden")}if(this._handleTabOverNodeWithButtons(t,e)||this._handleTabOverGroupWithButtons(t,e)||this._handleTabOverLinesWithButtons(t,e)){t.preventDefault();t.stopPropagation();return}this._moveItemFocus(t,e)};f.prototype._handleTabOverLinesWithButtons=function(t,e){var o=this.getFocus(),s,n,r,u=false,a;if(!o){return false}s=o.item;n=o.button;r=s&&s._getEnabledActionButtons?s._getEnabledActionButtons():[];if(!(s instanceof i)||!s._hasVisibleActionButtons()||r.length===0){return false}return this._checkActionHandled(t,n,r,u,a,e)};f.prototype._handleTabOverNodeWithButtons=function(t,e){var i=this.getFocus(),s,n,r,u=false,a;if(!i){return false}s=i.item;n=i.button;r=s&&s.getEnabledActionButtons?s.getEnabledActionButtons():[];if(!(s instanceof o)||!s.hasVisibleActionButtons()||r.length===0){return false}return this._checkActionHandled(t,n,r,u,a,e)};f.prototype._handleTabOverGroupWithButtons=function(t,o){var i=this.getFocus(),s,n;if(!i){return false}s=i.item;n=i.button;if(s instanceof e){if(!n){n=e.BUTTONS.MENU}if(n){if(n===e.BUTTONS.MENU){if(o===u.RIGHT){i.button=e.BUTTONS.COLLAPSE;this._oGraph.setFocus(i);return true}else if(o===u.LEFT){return false}}else if(n===e.BUTTONS.COLLAPSE){if(o===u.RIGHT){return false}else if(o===u.LEFT){i.button=e.BUTTONS.MENU;this._oGraph.setFocus(i);return true}}}}return false};f.prototype._checkActionHandled=function(t,e,o,i,s,n){if(e){s=0;for(var r=0;r<o.length;r++){if(o[r].isEqualNode(e)){s=r;break}}if(n===u.RIGHT){if(s===o.length-1){return false}else{this._setActionButtonFocus(o[s+1])}i=true}else if(n===u.LEFT){if(s===0){this._moveItemFocus(t,this.getFocusPosition())}else{this._setActionButtonFocus(o[s-1])}i=true}}else if(n===u.RIGHT){this._setActionButtonFocus(o[0]);i=true}return i};f.prototype._setActionButtonFocus=function(t){var e=this.getFocus();if(!e){return}e.button=t;this._oGraph.setFocus(e)};f.prototype._selectElement=function(t){var e=this.getFocus(),s;if(!e){return}s=e.item;if(s instanceof o){s.getParent()._selectNode({element:s,setFocus:false,renderActionButtons:false,preventDeselect:t})}else if(s instanceof i){s.getParent()._selectLine({element:s,setFocus:false,preventDeselect:t})}};f.prototype._moveThroughMatrix=function(t,e,o,i){var s=this.getFocus(),n,r,u,a,l=this.getFocusPosition().iX,h=this.getFocusPosition().iY;if(this._ignoreEvent(t)||!s){return}n=s.item;u=0;i=i||Number.POSITIVE_INFINITY;do{for(var f=(e?l:h)+(o?1:-1);o&&f<(e?this._iColumns:this._iRows)||!o&&f>=0;f+=o?1:-1){r=e&&h>=0&&h<this._iRows||!e&&l>=0&&l<this._iColumns?this._aItems[e?h:f][e?f:l]:null;if(r&&u<i){a=r;u++;if(u>=i){break}}}if(i<Number.POSITIVE_INFINITY&&u<i){if(e){if(o){l=-1;h++}else{l=this._iColumns;h--}}else if(o){l++;h=-1}else{l--;h=this._iRows}}}while(i<Number.POSITIVE_INFINITY&&u<i&&h>=-1&&h<=this._iRows&&l>=-1&&l<=this._iColumns);if(a&&a!==n){s.item=a;s.button=null;this._oGraph.setFocus(s);t.stopPropagation()}};f.prototype._handleArrow=function(t,e){if(this._ignoreEvent(t)||!this.getFocus()){return}this._moveItemFocus(t,e,true)};f.prototype._moveItemFocus=function(t,s,n){var r,a=s===u.LEFT&&t.key==="Tab",l,h,f;if(typeof s==="string"){l=this._findNextPosition(s)}else{l=s}h=this._getItemAtPosition(l);r={item:h,button:null};if(a&&h!==null){if(h instanceof o&&h.hasVisibleActionButtons()){f=h.getEnabledActionButtons();if(f.length>0){r.button=f[f.length-1]}}else if(h instanceof i&&h._hasVisibleActionButtons()){f=h._getEnabledActionButtons();if(f.length>0){r.button=f[f.length-1]}}else if(h instanceof e){r.button=e.BUTTONS.COLLAPSE}}if(h||!n){this._oGraph.setFocus(r)}if(t&&h){t.preventDefault();t.stopPropagation()}};f.prototype._getItemAtPosition=function(t){var e;if(!t||t.iX===null){return null}else{e=this._aItems[t.iY];return e?e[t.iX]:null}};f.prototype._findNextPosition=function(t){var e,o;if(this.getFocusPosition().iX===null){if(t===u.LEFT){e=this._iColumns-1;o=this._iRows-1}else{e=0;o=0}if(this._aItems[o][e]!==null){return{iX:e,iY:o}}}else{e=this.getFocusPosition().iX;o=this.getFocusPosition().iY}do{switch(t){case u.RIGHT:e+=1;if(e>=this._iColumns){o+=1;e=0}break;case u.LEFT:e-=1;if(e<0){o-=1;e=this._iColumns-1}break;case u.UP:o-=1;if(o<0&&e>0){e-=1;o=this._iRows-1}break;case u.DOWN:o+=1;if(o>=this._iRows&&e<this._iColumns-1){e+=1;o=0}break;default:throw new Error("Unexpected direction: "+t)}}while(o>=0&&o<this._iRows&&this._aItems[o][e]===null);if(o<0||o>=this._iRows){return null}else{return{iX:e,iY:o}}};f.prototype._onCtrlA=function(t){if(this._ignoreEvent(t)){return}var o=true;this._forEach(function(t){if(t instanceof e){return false}if(!t.getSelected()){o=false;return true}return false});o=!o;this._forEach(function(t){if(!(t instanceof e)){t.setSelected(o)}});t.preventDefault();t.stopPropagation()};f.prototype._forEach=function(t){var e,o,i,s;for(o=0;o<this._iRows;o++){for(e=0;e<this._iColumns;e++){i=this._aItems[o][e];if(i){s=t.call(this,i,e,o);if(s){return}}}}};f.prototype._onCtrl0=function(t){this._oGraph._zoom({zoomLevel:this._oGraph.ZOOM_100});t.preventDefault();t.stopPropagation()};f.prototype._onCtrlPlus=function(t){this._oGraph._zoom({deltaY:1});t.preventDefault();t.stopPropagation()};f.prototype._onCtrlMinus=function(t){this._oGraph._zoom({deltaY:-1});t.preventDefault();t.stopPropagation()};f.prototype._ignoreEvent=function(t){return!n(this._oWrapperDom,t.target)};f.prototype._handleError=function(t){r.error("An error in KeyboardNavigator: "+t)};l(f);return f});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Line", ["sap/suite/ui/commons/library","./ElementBase","./layout/Geometry","./Coordinate","./Utils","sap/ui/core/RenderManager"],function(t,e,o,i,r,s){"use strict";var n=t.networkgraph.LineArrowPosition,a=t.networkgraph.LineType,h=t.networkgraph.LineArrowOrientation,g=t.networkgraph.NodeShape,p=t.networkgraph.Orientation;var u=6,l=5,d=.45,c=15,f={Apex:{x:5.5,y:0},Second:{x:-5.5,y:-7.5},Third:{x:-5.5,y:7.5}},y={Apex:{x:16,y:0},Second:{x:5,y:-7.5},Third:{x:5,y:7.5}},m={Apex:{x:-12,y:0},Second:{x:-1,y:-7.5},Third:{x:-1,y:7.5}},_=5;var C=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var v=e.extend("sap.suite.ui.commons.networkgraph.Line",{apiVersion:2,metadata:{library:"sap.suite.ui.commons",properties:{selected:{type:"boolean",group:"Misc",defaultValue:false},from:{type:"string",group:"Misc",defaultValue:null},to:{type:"string",group:"Misc",defaultValue:null},lineType:{type:"sap.suite.ui.commons.networkgraph.LineType",group:"Appearance",defaultValue:a.Solid},arrowPosition:{type:"sap.suite.ui.commons.networkgraph.LineArrowPosition",group:"Appearance",defaultValue:n.End},arrowOrientation:{type:"sap.suite.ui.commons.networkgraph.LineArrowOrientation",group:"Appearance",defaultValue:h.ParentOf},stretchToCenter:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{coordinates:{type:"sap.suite.ui.commons.networkgraph.Coordinate",multiple:true,singularName:"coordinate"},actionButtons:{type:"sap.suite.ui.commons.networkgraph.ActionButton",multiple:true,singularName:"actionButton"}},events:{hover:{},press:{parameters:{point:"Object",opener:"Object"}}}},renderer:function(t,e){var o=e._render({renderManager:t});this.oRm=t;if(o){t.unsafeHtml(o)}},onAfterRendering:function(){this._afterRenderingBase()},init:function(){this._oFrom=null;this._oTo=null;this._bFocusRendered=false;this._sKey="";this._bIsHidden=false}});v.prototype.aProcessRequiredProperties=["from","to"];v.prototype._afterRendering=function(){this._setupEvents();if(this.getFromNode()._bIsHidden||this.getToNode()._bIsHidden){this.$().hide()}this._removeFromInvalidatedControls()};v.prototype._render=function(t){var o=t.renderManager;var i=this.getSelected()?" "+this.SELECT_CLASS+" ":"",r=this._getElementId(t&&t.idSufix),s;var a=this._getStatusStyle({stroke:e.ColorType.Border,"stroke-width":e.ColorType.BorderWidth,"stroke-dasharray":e.ColorType.BorderStyle});var g=this._getStatusStyle({fill:e.ColorType.Background,stroke:e.ColorType.Border});var u=function(t,e,i){return this._renderControl("path",{d:s,class:t||this._getLineClass(),style:i?"":a,from:this.getFromNode().getKey(),to:this.getToNode().getKey(),id:r?r+"-"+e:""},null,o)}.bind(this);var l=function(t,e,o){return{id:r+"-"+o,class:"sapSuiteUiCommonsNetworkLineArrow",style:g,d:"M "+e[t+0].x+","+e[t+0].y+" L "+e[t+1].x+","+e[t+1].y+" L "+e[t+2].x+","+e[t+2].y+" Z"}};var d=function(t,e,i){var r=this._getArrowPoints(t,e);this._renderControl("path",l(0,r,i||"arrow"),null,o);if(this._isBothMiddleArrow()){this._renderControl("path",l(3,r,"arrow1"),null,o)}}.bind(this);var c=function(t,e,o){var i=t,r=e,s=" 0 0 0 ";if(o===p.LeftRight||o===p.RightLeft){e-=_;r+=_}if(o===p.TopBottom||o===p.BottomTop){t-=_;i+=_}if(o===p.BottomTop||o===p.LeftRight){s=" 0 0 1 "}return"M"+t+" "+e+"A"+_+" "+_+s+" "+i+" "+r};this._bFocusRendered=false;if(this._isIgnored()){return""}if(!this.getVisible()){o.openStart("g",r);o.style("display","none");o.attr("data-sap-ui",r);o.openEnd();o.close("g");return}s=this._createPath();this._renderControl("g",{class:"sapSuiteUiCommonsNetworkLine "+this._getStatusClass()+i,id:r,"data-sap-ui":r},false,o);u("sapSuiteUiCommonsNetworkLineInvisibleWrapper","invisibleWrapper",true);u("","path");if(this.getArrowOrientation()!==h.None&&this.getCoordinates().length>=2){if(this.getArrowOrientation()===h.Both){if(this.getArrowPosition()===n.Middle){d(h.ParentOf,n.Middle)}else{d(h.ChildOf,n.Start,"arrow");d(h.ParentOf,n.End,"arrow1")}}else{d()}}if(this._aNipples){var f=g?g:"";this._aNipples.forEach(function(t){o.openStart("path");this.applyStyles(o,this.getStyleObject(f));o.class("sapSuiteUiCommonsNetworkLineNipple");o.attr("d",c(t.x,t.y,t.orientation));o.openEnd();o.close("path")}.bind(this))}o.close("g")};v.prototype._renderFocusWrapper=function(){var t=function(t){var e=this._createElement("path",{d:this._createPath(t),class:"sapSuiteUiCommonsNetworkLineFocus"});this.$()[0].appendChild(e)}.bind(this);if(!this._bFocusRendered){t(l);t(-l);this._bFocusRendered=true}};v.prototype._resetLayoutData=function(){this._aNipples=null};v.prototype._createPath=function(t){if(!this.getSource()||!this.getTarget()){return}var e=[{x:this.getSource().getX(),y:this.getSource().getY()}],i="M"+this.getSource().getX()+","+this.getSource().getY(),r,s,n=this._isTopBottom(),a=n?"x":"y",h=n?"getX":"getY",g=this.getBends().concat([this.getTarget()]);for(var p=0;p<g.length;p++){r=e[p-1]?e[p-1][a]:NaN;s=g[p][h]();if(Math.abs(r-g[p][h]())<2){e.pop();s=r}e.push({x:n?s:g[p].getX(),y:!n?s:g[p].getY()})}for(var l=1;l<e.length;l++){i+=" L"+e[l].x+","+e[l].y}return o.getBezierPathCorners(i,u,t)};v.prototype._getLineClass=function(){var t=function(){switch(this.getLineType()){case a.Dashed:return"sapSuiteUiCommonsNetworkDashedLine";case a.Dotted:return"sapSuiteUiCommonsNetworkDottedLine";default:return""}}.bind(this);return"sapSuiteUiCommonsNetworkLinePath "+t()};v.prototype._getArrowFragmentVector=function(t){var e=this.getCoordinates(),i=e.length-1,r=0,s=function(t){return Math.abs(e[t].getX()-e[t+1].getX())+Math.abs(e[t].getY()-e[t+1].getY())};t=t||this.getArrowPosition();if(this.getBends().length===0){r=0}else if(t===n.Start){while(r<i-1&&this._doesLineFragmentCrossCollapsedGroup(r)){r++}if(s(r)<c){r++}if(this._doesLineFragmentCrossCollapsedGroup(r)){r=0}}else if(t===n.End){r=i-1;while(r>0&&this._doesLineFragmentCrossCollapsedGroup(r)){r--}if(s(r)<c){r--}}else{var a=[],h=0;for(var g=0;g<i;g++){if(e[g].getX()===e[g+1].getX()){h+=Math.abs(e[g+1].getY()-e[g].getY())}else if(e[g].getY()===e[g+1].getY()){h+=Math.abs(e[g+1].getX()-e[g].getX())}else{h+=o.getPointsDistance({x:e[g].getX(),y:e[g].getY()},{x:e[g+1].getX(),y:e[g+1].getY()})}a.push(h)}h=h/2;for(g=0;g<i&&r===0;g++){if(a[g]>=h&&!this._doesLineFragmentCrossCollapsedGroup(g)){r=g}}}if(r<0||r>i-1){r=0}return{center:{x:e[r].getX(),y:e[r].getY()},apex:{x:e[r+1].getX(),y:e[r+1].getY()}}};v.prototype._doesLineFragmentCrossCollapsedGroup=function(t){var e=this.getParent(),i=this.getCoordinates()[t],r=this.getCoordinates()[t+1];return e.getGroups().some(function(t){return t.getCollapsed()&&o.doLineRectangleIntersect({p1:{x:Math.min(i.getX(),r.getX())+1,y:Math.min(i.getY(),r.getY())+1},p2:{x:Math.max(i.getX(),r.getX())-1,y:Math.max(i.getY(),r.getY())-1}},{p1:{x:t.getX(),y:t.getY()},p2:{x:t.getX()+t._iWidth,y:t.getY()+t._iHeight}})})};v.prototype._getArrowPoints=function(t,e){var i,r,s,a,p=[];t=t||this.getArrowOrientation();e=e||this.getArrowPosition();var u=function(u){var l=c;if(e===n.Middle){s={x:(r.apex.x-r.center.x)*d+r.center.x,y:(r.apex.y-r.center.y)*d+r.center.y}}else{if(!(this.getToNode()._oGroup&&this.getToNode()._oGroup.getCollapsed())&&this.getToNode().getShape()===g.Circle&&e===n.End){l+=this.getToNode()._getCircleSize()/2}else if(!(this.getFromNode()._oGroup&&this.getFromNode()._oGroup.getCollapsed())&&this.getFromNode().getShape()===g.Circle&&e===n.Start){l+=this.getFromNode()._getCircleSize()/2}i=o.getNormalizedVector(r,l);if(e===n.Start){s=r.center}else if(e===n.End){i=o.getRotatedVector(i,Math.PI);s=r.apex}s=o.getPointSum(s,i.apex)}a=o.getAngleOfVector(r);if(t===h.ChildOf){a+=Math.PI}p.push(o.getPointSum(s,o.getRotatedPoint(u,a)))}.bind(this);r=this._getArrowFragmentVector(e);if(this._isBothMiddleArrow()){u(y.Apex);u(y.Second);u(y.Third);u(m.Apex);u(m.Second);u(m.Third)}else{u(f.Apex);u(f.Second);u(f.Third)}return p};v.prototype._getAccessibilityLabel=function(){var t=this.getFromNode().getTitle();var e=t?t:this.getFromNode().getAltText();var o=this.getToNode().getTitle();var i=o?o:this.getToNode().getAltText();return C.getText("NETWORK_GRAPH_ACCESSIBILITY_LINE_LABEL",[e,i])+" "+this.getTitle()};v.prototype.getFromNode=function(){this._checkForProcessData();if(!this._oFrom&&this.getParent()){this._oFrom=this.getParent().getNodeByKey(this.getFrom())}return this._oFrom};v.prototype.getToNode=function(){this._checkForProcessData();if(!this._oTo&&this.getParent()){this._oTo=this.getParent().getNodeByKey(this.getTo())}return this._oTo};v.prototype.setSource=function(t){var e;if(this.getCoordinates().length===0){e=new i;this.addAggregation("coordinates",e,true)}e=this.getCoordinates()[0];if(t.x||t.x===0){e.setX(t.x)}if(t.y||t.y===0){e.setY(t.y)}};v.prototype.getSource=function(){return this.getCoordinates()[0]};v.prototype.getTarget=function(){return this.getCoordinates().length>0?this.getCoordinates()[this.getCoordinates().length-1]:null};v.prototype.setTarget=function(t){var e;if(this.getCoordinates().length<2){e=new i;this.addAggregation("coordinates",e,true)}e=this.getCoordinates()[this.getCoordinates().length-1];if(t.x||t.x===0){e.setX(t.x)}if(t.y||t.y===0){e.setY(t.y)}};v.prototype.getBends=function(){return this.getCoordinates().filter(function(t,e){return e>0&&e<this.getCoordinates().length-1},this)};v.prototype.clearBends=function(){this.getBends().forEach(function(t){this.removeAggregation("coordinates",t,true)},this)};v.prototype.addBend=function(t){var e=new i;e.setX(t.x);e.setY(t.y);this.insertAggregation("coordinates",e,this.getCoordinates().length-1,true);return e};v.prototype.isHidden=function(){return this._bIsHidden};v.prototype.getKey=function(){return this._getLineId()};v.prototype.setHidden=function(t){this.$()[t?"hide":"show"]()};v.prototype._isIgnored=function(){var t=this.getFromNode(),e=this.getToNode(),o=t._oGroup&&t._oGroup.getCollapsed()&&e._oGroup&&e._oGroup.getCollapsed()&&t._oGroup===e._oGroup,i=!t._useInLayout()||!e._useInLayout();return!this._useInLayout||o||this._isLoop()||i};v.prototype._isLoop=function(){return this.getFromNode().getId()===this.getToNode().getId()};v.prototype._getLineId=function(){return this._sKey?this._sKey:"line_"+this.getFrom()+"-"+this.getTo()};v.prototype._setupEvents=function(){var t=this.$().find(".sapSuiteUiCommonsNetworkLineInvisibleWrapper");t.on("click",function(t){this._click({ctrlKey:t.ctrlKey,clientX:t.clientX,clientY:t.clientY})}.bind(this));t.on("mouseover",function(t){this._mouseOver()}.bind(this));t.on("mouseout",function(t){this._mouseOut()}.bind(this))};v.prototype._mouseOut=function(){this.$().removeClass(this.HIGHLIGHT_CLASS);if(!this.getSelected()){this._setStatusColors("")}};v.prototype._mouseOver=function(){var t=this.fireEvent("hover",{},true);if(!this.getSelected()&&t){this._setStatusColors("Hover");this.$().addClass(this.HIGHLIGHT_CLASS)}};v.prototype._setStatusColors=function(t){var o=this.$().find(".sapSuiteUiCommonsNetworkLineArrow"),i=this._getColor(e.ColorType[t+"Border"]),r=this._getColor(e.ColorType[t+"Background"]);o.css("fill",r);o.css("stroke",i);this.$("path").css("stroke",i);if(this.getParent()&&this.getParent()._isSwimLane()){var s=this.$().find(".sapSuiteUiCommonsNetworkLineNipple");s.css("fill",r);s.css("stroke",i)}};v.prototype._showActionButtons=function(t){var e=function(t,e,o){var r=i(t,e,o);if(r){t._setNodeOpacity(true);a._aShadedNodes.push(t)}return r};var i=function(t,e,i){return o.hasRectangleRectangleIntersection({p1:{x:v,y:C},p2:{x:i,y:e}},t._getContentRect())};var r=function(t,e){return{p1:{x:t.x,y:t.y},p2:{x:e.x,y:e.y}}};var s=0;var n=function(t,e){if(s<2){var o=jQuery("<div></div>",{class:t,css:{top:e.top,left:e.left,right:e.right,bottom:e.bottom}});g.append(o);s++}};var a=this.getParent(),h=a.$("divlinebuttons"),g=a.$("linetooltip"),p=a.$("linetooltipbuttons");var u=this.getFromNode(),l=this.getToNode();var d=10;a._aShadedNodes=[];var c=u.getTitle();var f=c?c:u.getAltText();var y='<span class="sapSuiteUiCommonsNetworkGraphLineTooltipText">'+f+"</span>";if(this._isBothArrow()){y+='<span class="sapSuiteUiCommonsNetworkGraphLineTooltipArrow sapSuiteUiCommonsNetworkGraphLineTooltipDualArrow"></span>'}var m=l.getTitle();var _=m?m:l.getAltText();y+='<span class="sapSuiteUiCommonsNetworkGraphLineTooltipArrow"></span>'+"</br>"+'<span class="sapSuiteUiCommonsNetworkGraphLineTooltipText">'+_+"</span>";g.html(y);p.html("");this.getActionButtons().forEach(function(t){this._appendActionButton({icon:t.getIcon(),enable:t.getEnabled(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:e.target})}},p)}.bind(this));h.show();var C=t.y-g.outerHeight()/2,v=t.x-g.outerWidth()/2,S=C+g.outerHeight(),T=v+g.outerWidth();e(l,S,v+h.width());var x=e(u,C+g.height(),v),w=e(l,S,v+g.outerWidth()+d);if(a._isLayered()){var A={x:v,y:C};var N={x:T,y:C};var L={x:T,y:S};var P={x:v,y:S};var F=this.getCoordinates();for(var b=0;b<F.length-1&&s<2;b++){var B=F[b],k=F[b+1];var I={x:B.getX(),y:B.getY()};var Y={x:k.getX(),y:k.getY()};var X=r(I,Y);var O=o.getSegmentsIntersection(X,r(A,P));if(O&&!x){n("sapSuiteUiCommonsNetworkGraphTooltipLeftArrow",{top:O.y-C-d})}O=o.getSegmentsIntersection(X,r(N,L));if(O&&!w){n("sapSuiteUiCommonsNetworkGraphTooltipRightArrow",{top:O.y-C-d})}O=o.getSegmentsIntersection(X,r(P,L));if(O){n("sapSuiteUiCommonsNetworkGraphTooltipBottomArrow",{left:O.x-v-d})}O=o.getSegmentsIntersection(X,r(A,N));if(O){n("sapSuiteUiCommonsNetworkGraphTooltipTopArrow",{left:O.x-v-d})}}h.css("top",C+"px");h.css("left",v+"px")}};v.prototype._hasVisibleActionButtons=function(){return this.getParent().$().find(".sapSuiteUiCommonsNetworkGraphLineButtons").is(":visible")};v.prototype._getEnabledActionButtons=function(){var t=[];this.getActionButtons().forEach(function(e){if(e.getEnabled()&&e.getDomRef()){t.push(e.getDomRef())}});return t};v.prototype._setActionButtonFocus=function(t,e){var o=this.getParent().$("divlinebuttons");o.removeClass(this.FOCUS_CLASS);o.find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);jQuery(t).toggleClass(this.FOCUS_CLASS,e)};v.prototype._click=function(t){var e=this.getParent(),o=t.skipConversion?{x:t.clientX,y:t.clientY}:e.getCorrectMousePosition({x:t.clientX,y:t.clientY}),i=e._tooltip._getOpener(this,o),r;e._selectLine({element:this,forceFocus:true,preventDeselect:t.ctrlKey});r=this.fireEvent("press",{opener:i,point:o},true);if(this.getSelected()&&r){this.getActionButtons().length===0?e._tooltip.openDetail({item:this,opener:i,point:o}):this._showActionButtons(o)}};v.prototype._setFocus=function(t){e.prototype._setFocus.call(this,t);if(t){this._renderFocusWrapper()}};v.prototype._isEndPosition=function(){return this.getArrowPosition()===n.End&&this.getArrowOrientation()===h.ParentOf||this.getArrowPosition()===n.Start&&this.getArrowOrientation()===h.ChildOf};v.prototype._moveToEnd=function(){return this._isEndPosition()||this.getArrowPosition()===n.Middle&&this.getArrowOrientation()===h.ParentOf};v.prototype._hideShow=function(t){if(t){this.$().hide();this._bIsHidden=true}else if(!this.getToNode()._bIsHidden&&!this.getFromNode()._bIsHidden){this.$().show();this._bIsHidden=false}};v.prototype._shift=function(t){this.getBends().forEach(function(e){e.setX(e.getX()+t.x);e.setY(e.getY()+t.y)});if(this.getSource()){this.setSource({x:this.getSource().getX()+t.x,y:this.getSource().getY()+t.y})}if(this.getTarget()){this.setTarget({x:this.getTarget().getX()+t.x,y:this.getTarget().getY()+t.y})}if(this._aNipples){this._aNipples.forEach(function(e){e.x+=t.x;e.y+=t.y})}};v.prototype._normalizePath=function(){var t,e;t=this.getFromNode().getCenterPosition();this.setSource({x:t.x,y:t.y});e=this.getToNode().getCenterPosition();this.setTarget({x:e.x,y:e.y});this.clearBends()};v.prototype._validateLayout=function(){return(!this.getSource()||isFinite(this.getSource().getX())&&isFinite(this.getSource().getY()))&&(!this.getTarget()||isFinite(this.getTarget().getX())&&isFinite(this.getTarget().getY()))&&!this.getBends().some(function(t){return!isFinite(t.getX())||!isFinite(t.getY())})};v.prototype.setSelected=function(t){var e=this.getParent(),o=t?"addClass":"removeClass";this._setStatusColors(t?"Selected":"");this.setProperty("selected",t,true);this.$()[o](this.SELECT_CLASS);if(e){if(t){e._mSelectedLines[this._getLineId()]=this}else{this._setStatusColors("");delete e._mSelectedLines[this._getLineId()]}}return this};v.prototype.setFrom=function(t){var e=this.getParent();this.setProperty("from",t,true);if(e){e.invalidate()}return this};v.prototype.setTo=function(t){var e=this.getParent();this.setProperty("to",t,true);if(e){e.invalidate()}return this};v.prototype._isTopBottom=function(){var t=this.getParent();return t&&t._isTopBottom()};v.prototype.getFocusDomRef=function(){return this.getDomRef("invisibleWrapper")};v.prototype._createSuggestionHelpText=function(){var t=25;var e=this.getTitle()?this.getTitle()+" ":"";var o=this.getFromNode().getTitle();var i=o?o:this.getFromNode().getAltText();var s=this.getToNode().getTitle();var n=s?s:this.getToNode().getAltText();return e+"("+r.trimText(i,t)+" -> "+r.trimText(n,t)+")"};v.prototype._isInCollapsedGroup=function(){var t=this.getFromNode(),e=this.getToNode();return t._oGroup===e._oGroup&&t._isInCollapsedGroup()};v.prototype._isBothMiddleArrow=function(){return this.getArrowOrientation()===h.Both&&this.getArrowPosition()===n.Middle};v.prototype._isBothArrow=function(){return this.getArrowOrientation()===h.Both};v.prototype._isOnScreen=function(t,o,i,r){var s=this.getCoordinates(),n,a;for(n=1;n<s.length;n++){a=e._isRectOnScreen(s[n-1].getX(),s[n].getX(),s[n-1].getY(),s[n].getY(),t,o,i,r);if(a){return true}}return false};return v});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Node", ["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","./ElementBase","./ElementAttribute","sap/ui/core/IconPool","sap/ui/Device","sap/base/security/encodeXML","sap/base/security/sanitizeHTML","sap/m/CheckBox","sap/m/Text","./NodeRenderer"],function(jQuery,t,e,i,s,r,o,n,a,h,l){"use strict";var d=t.networkgraph.NodeShape,p=t.networkgraph.ActionButtonPosition,u=t.networkgraph.HeaderCheckboxState;var c=32,g=5,_=160,f=4;var C={Circle:{WIDTH:96,HEIGHT:64},Box:{WIDTH:160,HEIGHT:32},Attributes:{LINE:16,OFFSET:8},ActionButtons:{RADIUS:13,MARGIN:8,OFFSET:4},Title:{LINESIZE:15,OFFSET:8,ICON_SIZE:16,INFO_BOX_SIZE:20,ICON_X_OFFSET:6,IMAGE_OFFSET_Y:6},Description:{LINESIZE:15},Image:{Box:16,Circle:32}};var S={EXPANDED:"Expanded",COLLAPSED:"Collapsed",PARTIAL:"Partial"};var m={EXPAND:"sys-add",COLLAPSE:"sys-minus",PARTIAL:"overlay"};var y=s.getIconInfo(m.EXPAND),T=s.getIconInfo(m.COLLAPSE),v=s.getIconInfo(m.PARTIAL);y=y&&y.content;T=T&&T.content;v=v&&v.content;var I=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var x=e.extend("sap.suite.ui.commons.networkgraph.Node",{metadata:{library:"sap.suite.ui.commons",properties:{headerCheckBoxState:{type:"sap.suite.ui.commons.networkgraph.HeaderCheckboxState",group:"Misc",defaultValue:u.Hidden},collapsed:{type:"boolean",group:"Misc",defaultValue:false},selected:{type:"boolean",group:"Misc",defaultValue:false},group:{type:"string",group:"Misc",defaultValue:null},key:{type:"string",group:"Misc",defaultValue:null},shape:{type:"sap.suite.ui.commons.networkgraph.NodeShape",groups:"Behavior",defaultValue:d.Circle},icon:{type:"string",group:"Appearance",defaultValue:null},statusIcon:{type:"string",group:"Appearance",defaultValue:null},width:{type:"int",group:"Misc",defaultValue:undefined},height:{type:"int",group:"Misc",defaultValue:undefined},maxWidth:{type:"int",group:"Misc",defaultValue:undefined},x:{type:"float",group:"Misc",defaultValue:0},y:{type:"float",group:"Misc",defaultValue:0},showExpandButton:{type:"boolean",defaultValue:true},showActionLinksButton:{type:"boolean",defaultValue:true},showDetailButton:{type:"boolean",defaultValue:true},titleLineSize:{type:"int",defaultValue:1},descriptionLineSize:{type:"int",defaultValue:-1},iconSize:{type:"int",group:"Appearance",defaultValue:undefined},coreNodeSize:{type:"int",group:"Appearance",defaultValue:0},visible:{type:"boolean",group:"Appearance",defaultValue:true},altText:{type:"string",group:"Appearance",defaultValue:null}},aggregations:{actionLinks:{type:"sap.ui.core.Control",multiple:true,singularName:"actionLink"},actionButtons:{type:"sap.suite.ui.commons.networkgraph.ActionButton",multiple:true,singularName:"actionButton"},image:{type:"sap.suite.ui.commons.networkgraph.NodeImage",multiple:false,singularName:"nodeImage"},content:{type:"sap.ui.core.Control",multiple:false},_checkBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"}},events:{headerCheckBoxPress:{parameters:{checked:"boolean"}},press:{},hover:{},collapseExpand:{}}},onAfterRendering:function(){this._afterRenderingBase()}});x.prototype.aProcessRequiredProperties=["key","group"];x.prototype.init=function(t){this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this))}else{this._handleCoreInitialized()}this._oExpandState=S.EXPANDED;this._oGroup=null;this._iWidth=0;this._iHeight=0;this._iLabelAttrWidth=0;this._iValueAttrWidth=0;this._aTitleLines=[[]];this._aDescriptionLines=[[]];this._bIsHidden=false;this._bActionButtonsRendered=false;this._iCircleSize=0;this._iGroupIndex=-1;this._clearChildren()};x.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this)};x.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate()};x.prototype._clearChildren=function(){this.aChildren=[];this.aParents=[];this.aLines=[];this.aParentLines=[]};x.prototype._afterRendering=function(){var t=this.$();if(this._isInCollapsedGroup()){return}this._correctTitle("sapSuiteUiCommonsNetworkNodeTitle");this._setupEvents();if(this._bIsHidden){t.hide()}if(!this.getVisible()||this._oGroup&&!this._oGroup.getVisible()){t.hide()}if(this._oExpandState===S.COLLAPSED){t.addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(this._oExpandState===S.PARTIAL){t.addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}this.$(this.getId()+"actionbuttons").detach();this._bActionButtonsRendered=false;this._removeFromInvalidatedControls();if(this._isHtml()&&!x.hasNativeLineClamp){this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeTitle"),this.getTitleLineSize());this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeDescription"),this.getDescriptionLineSize())}if(this.getSelected()){this.showActionButtons(true)}if(this._isInteractiveNode()){this.addStyleClass("sapMPointer")}else{this.removeStyleClass("sapMPointer")}};x.prototype._isInteractiveNode=function(){var t=this.getShowExpandButton()&&this._hasVisibleChildren(),e=this.getShowDetailButton()&&(this._hasDetailData()||this.getTitle()),i=this.getShowActionLinksButton()&&this._hasActionLinks(),s=this.getActionButtons(),r=s&&s.length>0,o=this.mEventRegistry.press;return t||e||i||r||o};x.prototype._render=function(t){var e=this.getParent(),i=e&&e._isUseNodeHtml();if(this._isIgnored()){return""}t=t||{};if(t.mapRender){if(this._oGroup&&!this._oGroup.getVisible()||!this.getVisible()){return""}}return i?this._renderHtml(t):this._renderSvg(t)};x.prototype._renderHtmlInfoIcon=function(t,e){t=t||{};e=e||{};var i=this.getStatusIcon(),s=this._convertToStyle(t,undefined,true),r=e.renderManager;r.openStart("div");r.attr("id",this._getElementId(e.idSufix)+"-statusiconwrapper");r.attr("title",I.getText("NETWORK_GRAPH_COLLAPSED"));this.applyStyles(r,this.getStyleObject(s));r.class("sapSuiteUiCommonsNetworkNodeDivInfoWrapper").class("sapSuiteUiCommonsNetworkNodeInfoWrapper");r.openEnd();r.openStart("div").class("sapSuiteUiCommonsNetworkNodeDivInfoIcon").class("sapSuiteUiCommonsNetworkGraphDivNodeIcon").openEnd();this._renderHtmlIcon(i||"sap-icon://hint",null,null,null,null,r);r.close("div");r.close("div")};x.prototype._renderHtmlText=function(t,e,i,s,r){this._renderHtmlElement("div",{"-webkit-line-clamp":e===0?"":e,color:s},{class:"sapSuiteUiCommonsNetworkGraphDivNodeText "+(i||"")+(e===1?" sapSuiteUiCommonsNetworkGraphDivTextBreakAll ":"")},r);r.text(t);r.close("div")};x.prototype._renderHtmlTitle=function(t,e){var i=this.getTitle();var s=i?i:this.getAltText();if(s){this._renderHtmlText(s,this.getTitleLineSize(),"sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeTitle",t,e);e.openStart("div").style("clear","both").openEnd().close("div")}};x.prototype._renderHtmlDescription=function(t,e){var i=this.getDescriptionLineSize(),s=this.getDescription();if(s&&i!=-1){this._renderHtmlText(s,i,"sapSuiteUiCommonsNetworkGraphDivNodeDescription",t,e)}};x.prototype._renderHtmlTitleAndDescription=function(t){this._renderHtmlTitle(null,t);this._renderHtmlDescription(null,t)};x.prototype._renderHtmlAttributes=function(t){var e=this.getVisibleAttributes();if(!t.renderManager){return}if(e.length>0){t.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeAttributes").openEnd();e.forEach(function(e){this._renderClonedControl(t,e)}.bind(this));t.renderManager.close("div")}};x.prototype._showDivActionButtons=function(t){var e=this,i=this.$("rightdivbuttons"),s=this.$("leftdivbuttons");if(t&&!this._bActionButtonsRendered){i.html("");s.html("");var r=0,o=0;if(this.getShowExpandButton()){this._appendActionButton({class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",icon:this._getExpandIcon(true),enable:this._hasVisibleChildren(),title:I.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)},i);r++}if(this.getShowDetailButton()){var n=this.getTitle();this._appendActionButton({icon:"sap-icon://menu",enable:this._hasDetailData()||(n?n:this.getAltText()),id:this._getDomId("actionDetail"),title:I.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(t){this._detailClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionDetail"))){document.getElementById(this._getDomId("actionDetail")).setAttribute("aria-haspopup","dialog")}r++}if(this.getShowActionLinksButton()){this._appendActionButton({icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:I.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(t){this._linksClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionLinks"))){document.getElementById(this._getDomId("actionLinks")).setAttribute("aria-haspopup","dialog")}r++}for(var a=0;r+o<f*2&&a<this.getActionButtons().length;a++){(function(t){var n=t.getPosition(),a=n===p.Right?r:o;if(a>=f){n=n===p.Left?p.Right:p.Left}var h=n===p.Right?i:s;e._appendActionButton({icon:t.getIcon(),enable:t.getEnabled(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:e.target})}},h)})(this.getActionButtons()[a])}this._bActionButtonsRendered=true}var h=t?"addClass":"removeClass";this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons")[h](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};x.prototype._getCorrectWidth=function(){var t=this._iWidth||this.getWidth()||"auto",e="";if(this.getMaxWidth()){e=this.getMaxWidth()+"px"}if(t!==""&&t!=="auto"){t+="px"}return{width:t,maxWidth:e}};x.prototype._renderHtml=function(t){var e=this._getElementId(t.idSufix),i=this._isCircle(),s=this._getCorrectWidth();this._renderHtmlElement("div",{width:i?s.width:"","max-width":i?s.maxWidth:"",top:!this._bMainRender&&this.getY()?this.getY()+"px":"",left:!this._bMainRender&&this.getX()?this.getX()+"px":"","min-width":_+"px"},{id:e,"data-sap-ui":e,class:this._getNodeClass()},t.renderManager);this.renderContent(t);t.renderManager.close("div")};x.prototype._renderHtmlContent=function(t){t=t||{};var i=this._getElementId(t.idSufix),s=this._iHeight||this.getHeight()||C.Circle.HEIGHT,r=this._isCircle();var o=function(){var e=this.getContent();if(e){t.renderManager.openStart("div",this.getId()+"-contentwrapper");t.renderManager.openEnd();this._renderClonedControl(t,e);t.renderManager.close("div")}else{this.renderItemContent(t)}}.bind(this);var n=this._getStatusStyle({"border-color":e.ColorType.Focus},false);if(r){this._iCircleSize=this._iCircleSize||s;var a=this._convertToStyle({width:this._iCircleSize+"px",height:this._iCircleSize+"px"},this._getStatusStyle({"border-color":e.ColorType.Border}),true);var h=this._getStatusStyle({"border-color":e.ColorType.Background},false);var l=this._getStatusStyle({"border-color":e.ColorType.Border,"background-color":this.getSelected()?e.ColorType.SelectedBackground:"","border-width":e.ColorType.BorderWidth,"border-style":e.ColorType.BorderStyle},false);t.renderManager.openStart("div",i+"-wrapperwithbuttons");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInnerWrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.openEnd();this.renderHtmlActionButtons(t);t.renderManager.openStart("div",i+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(l));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner");t.renderManager.openEnd();t.renderManager.openStart("div");t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleWrapper");t.renderManager.openEnd();this._renderHtmlInfoIcon({},t);t.renderManager.openStart("div",i+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus");t.renderManager.openEnd();t.renderManager.openStart("div",i+"-status");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleStatus");t.renderManager.openEnd();this.renderItemContent(t);t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");this._renderHtmlTitleAndDescription(t.renderManager)}else{var d=this._getCorrectWidth();var a=this._convertToStyle({width:d.width,"max-width":d.maxWidth?d.maxWidth:"inherit","min-width":_+"px"},this._getStatusStyle({"border-color":e.ColorType.Border,"background-color":this.getSelected()?e.ColorType.SelectedBackground:"","border-width":e.ColorType.BorderWidth,"border-style":e.ColorType.BorderStyle}),true);this.renderHtmlActionButtons(t);t.renderManager.openStart("div",i+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner").openEnd();t.renderManager.openStart("div",i+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus").openEnd();t.renderManager.close("div");var h=this._getStatusStyle({"background-color":e.ColorType.Background},false);var p=this._getColor(this.getSelected()?e.ColorType.Content:e.ColorType.HeaderContent);t.renderManager.openStart("div",i+"-header");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeader");if(this._hasHeaderContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderColor")}if(!this._hasAdditionalContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderOnly")}t.renderManager.openEnd();if(this._showHeaderCheckBox()){this._renderClonedControl(t,this._getHeaderCheckbox())}this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeIconTitle",t.renderManager);this._renderHtmlTitle(p,t.renderManager);t.renderManager.close("div");o();t.renderManager.close("div");this._renderHtmlInfoIcon({},t)}};x.prototype._getHeaderCheckbox=function(){var t=this.getAggregation("_checkBox"),e=this;if(!t){t=new a(this.getId()+"-checkbox").addStyleClass("sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner");t.addEventDelegate({onAfterRendering:function(){t.$().on("mousedown",function(i){var s=!t.getSelected();t.setSelected(s);e.fireHeaderCheckBoxPress({checked:s});i.stopPropagation()})}});this.setAggregation("_checkBox",t,true)}return t};x.prototype._renderHtmlTitleIcon=function(t,i){var s=this.getIcon(),r=this.getImage(),o=this.getIconSize()?'style="font-size:'+this.getIconSize()+'px"':"",n,a;t=(t||"")+" sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeIcon";n=this._getStatusStyle({color:this._isBox()?e.ColorType.HeaderContent:e.ColorType.Content},false);if(r){a=this._getImageSize();this._renderHtmlElement("img",{width:a.width+"px",height:a.height+"px"},{src:r.getSrc(),class:"sapSuiteUiCommonsNetworkGraphDivNodeImage"},i)}else if(s){i.openStart("div");this.applyStyles(i,this.getStyleObject(n));t.split(" ").forEach(function(t){if(t){i.class(t)}});i.openEnd();this._renderHtmlIcon(s,null,null,o,null,i);i.close("div")}};x.prototype._renderHtmlBoxContent=function(t){var i=this._hasAdditionalContent(),s=this._getElementId(t.idSufix);if(i){t.renderManager.openStart("div",s+"-additionalwarpper");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivAdditionalContent").openEnd();var r=this._getColor(e.ColorType.Content);this._renderHtmlDescription(r,t.renderManager);this._renderHtmlAttributes(t);t.renderManager.close("div")}};x.prototype._renderHtmlCircleContent=function(t){this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon",t.renderManager)};x.prototype._renderSvg=function(t){t=t||{};var e=t.renderManager;var i=this._getElementId(t.idSufix);if(!e){var s=this._renderControl("g",{id:i,"data-sap-ui":i,nodeid:o(this.getKey()),class:this._getNodeClass()},false);s+=this._renderControl("g",{id:i+"-wrapper",class:"sapSuiteUiCommonsNetworkNodeShape"},false);s+=this._renderContent(t);s+="</g>";s+="</g>";return s}this._renderControl("g",{id:i,"data-sap-ui":i,nodeid:o(this.getKey()),class:this._getNodeClass()},false,e);this._renderControl("g",{id:i+"-wrapper",class:"sapSuiteUiCommonsNetworkNodeShape"},false,e);var r=this._renderContent(t);e.close("g");e.close("g");if(r&&typeof r==="string"){return r}};x.prototype._renderSvgContent=function(t){t=t||{};var e=t.renderManager;var i=this.getParent()._bIsRtl,s,r;if(this._isCircle()){var o=this._iCircleSize/8,n=this._iCircleSize/5.3;s=i?this._getCirclePosition().x+this._iCircleSize-o:this._getCirclePosition().x+o;r=this.getY()+n}else{s=this.getX();r=this.getY()}if(!e){var a=this._isBox()?this._renderBox(t):this._renderCircle(t);a+=this.renderStatusIcon({x:s-this.getX(),y:r-this.getY()});return a}var h=this._isBox()?this._renderBox(t):this._renderCircle(t);this.renderStatusIcon({x:s-this.getX(),y:r-this.getY(),renderManager:e});if(h&&typeof h==="string"){return h}};x.prototype._renderContent=function(t){return this.renderContent(t)};x.prototype._renderCircleContent=function(t){var i=this._iCircleSize,s=this.getParent()._bIsRtl,r=this.getImage(),o,a=this.getX(),h=this.getY();var l,d,p,u,c,g,_,f;t=t||{};var S=t.renderManager;d=this.getTitle();p=d?d:this.getAltText();if(this._displayImage(r)){o=this._getImageSize();l={"xlink:href":r.getSrc(),x:a+this._iWidth/2-o.width/2,y:h+i/2-o.height/2,width:o.width,height:o.height}}else if(this.getIcon()){u={attributes:{class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkCircleNodeIcon sapSuiteUiCommonsNetworkStatusText",style:(this.getIconSize()?"font-size:"+this.getIconSize()+"px;":"")+this._getStatusStyle({fill:e.ColorType.Content}),x:a+this._iWidth/2,y:h+i/2},icon:this.getIcon(),height:this.getIconSize()?this.getIconSize()-2:22}}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){c={class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText",x:a+this._iWidth/2,y:h+i+C.Title.OFFSET,title:n(p),maxWidth:this._iWidth-5};g={id:this.getId()+"-title-clip",x:a,y:h+i+C.Title.OFFSET-10,height:C.Title.LINESIZE*2}}else{_={x:a+this._iWidth/2,y:h+i+C.Title.OFFSET*2}}}if(this._displayDescription()){f={x:s?a+this._iWidth-C.Title.OFFSET:a+C.Title.OFFSET,y:h+this._getTitleHeight()+i+C.Title.OFFSET*2+C.Title.OFFSET/2}}if(!S){var m="";if(this._displayImage(r)){m+=this._renderControl("image",l)}else if(this.getIcon()){m+=this._renderIcon(u)}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){m+=this._renderClipPath(g);m+=this._renderTitle(c)}else{m+=this._renderMultilineTitle(_)}}if(this._displayDescription()){m+=this._renderDescription(f)}return m}if(this._displayImage(r)){this._renderControl("image",l,null,S)}else if(this.getIcon()){u.renderManager=S;this._renderIcon(u)}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){g.renderManager=S;c.renderManager=S;this._renderClipPath(g);this._renderTitle(c)}else{_.renderManager=S;this._renderMultilineTitle(_)}}if(this._displayDescription()){f.renderManager=S;this._renderDescription(f)}};x.prototype._renderCircle=function(t){var i=this.getX(),s=this.getY(),r=6,o=2,n=this._iCircleSize;t=t||{};var a=t.renderManager;var h={id:this.getId()+"-innerBox",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Border}),r:n/2,class:"sapSuiteUiCommonsNetworkInnerCircle"};var l={id:this.getId()+"-statusCircle",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Background}),r:n/2-r,class:"sapSuiteUiCommonsNetworkInnerCircleStatus"};var d={id:this.getId()+"-focusCircle",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Focus}),r:n/2-o,class:"sapSuiteUiCommonsNetworkCircleFocus"};if(!a){var p="";p+=this._renderControl("circle",h);p+=this._renderControl("circle",l);p+=this._renderControl("circle",d);p+=this.renderItemContent();return p}this._renderControl("circle",h,null,a);this._renderControl("circle",l,null,a);this._renderControl("circle",d,null,a);return this.renderItemContent({renderManager:a})};x.prototype._renderBoxContent=function(t){var i=c/2,s=C.Title.ICON_X_OFFSET,r=this.getParent()._bIsRtl,o=this.getImage(),a=this.getY(),h=this.getX(),l,d=this._getImageSize();var p,u,_,f,S,m;t=t||{};var y=t.renderManager;var T=this.getTitle();var v=T?T:this.getAltText();if(this._displayImage(o)){d=this._getImageSize();p={"xlink:href":o.getSrc(),x:r?h+this._iWidth-C.Title.ICON_X_OFFSET-d.width:h+C.Title.ICON_X_OFFSET,y:a+C.Title.IMAGE_OFFSET_Y,width:d.width,height:d.height};s+=d.width+C.Title.ICON_X_OFFSET}else if(this.getIcon()){u={attributes:{style:this._getStatusStyle({fill:e.ColorType.Content}),class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeTitleIcon sapSuiteUiCommonsNetworkStatusText",x:r?h+this._iWidth-C.Title.ICON_X_OFFSET:h+C.Title.ICON_X_OFFSET,y:a+i},icon:this.getIcon(),height:C.Title.LINESIZE};s+=C.Title.ICON_SIZE+C.Title.ICON_X_OFFSET}if(v){l=this._iWidth-s-g;if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){_={id:this.getId()+"-title-clip",x:h,y:a,height:c};f={class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText sapSuiteUiCommonsNetworkStatusText",style:this._getStatusStyle({fill:e.ColorType.Content}),x:r?h+this._iWidth-s:h+s,y:a+i,maxWidth:l,title:n(v)}}else{S={x:r?h+this._iWidth-s:h+s,y:a+C.Title.OFFSET*2}}}}if(this._displayDescription()){m={x:r?h+this._iWidth-C.Title.OFFSET:h+C.Title.OFFSET-C.Title.OFFSET/3,y:a+this._getTitleHeight()+(this._hasMultiLineTitle()?C.Title.OFFSET*2+C.Title.OFFSET/2:C.Title.OFFSET*4)}}if(!y){var I="";if(this._displayImage(o)){d=this._getImageSize();I+=this._renderControl("image",p)}else if(this.getIcon()){I+=this._renderIcon(u)}if(v){if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){I+=this._renderClipPath(_);I+=this._renderTitle(f)}else{I+=this._renderMultilineTitle(S)}}}if(this._displayDescription()){I+=this._renderDescription(m)}if(this._displayAttributes()){I+=t.sizeDetermination?this._renderAttributesForSize():this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+C.Title.OFFSET+(!this._hasMultiLineTitle()?C.Attributes.OFFSET:0)})}return I}if(this._displayImage(o)){this._renderControl("image",p,null,y)}else if(this.getIcon()){u.renderManager=y;this._renderIcon(u)}if(v){if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){_.renderManager=y;f.renderManager=y;this._renderClipPath(_);this._renderTitle(f)}else{S.renderManager=y;this._renderMultilineTitle(S)}}}if(this._displayDescription()){m.renderManager=y;this._renderDescription(m)}if(this._displayAttributes()){t.sizeDetermination?this._renderAttributesForSize({renderManager:y}):this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+C.Title.OFFSET+(!this._hasMultiLineTitle()?C.Attributes.OFFSET:0),renderManager:y})}};x.prototype._renderBox=function(t){var i=6,s=4,r=(this._iTitleHeight||this._getTitleHeight())+i,o=3;var n=this.getY(),a=this.getX();var h=this._iHeight===c;t=t||{};var l=t.renderManager;var d={id:this.getId()+"-innerBox",x:a,y:n,style:this._getStatusStyle({stroke:e.ColorType.Border}),class:"sapSuiteUiCommonsNetworkInnerRect",rx:o,ry:o,width:this._iWidth,height:this._iHeight,"pointer-events":"fill"};var p={id:this.getId()+"-innerStatusBox",x:a,y:n,style:this._getStatusStyle({fill:e.ColorType.Background}),class:"sapSuiteUiCommonsNetworkNodeBoxStatus",topRight:o,topLeft:o,bottomRight:h?o:0,bottomLeft:h?o:0,width:this._iWidth,height:Math.max(r,c),"pointer-events":"fill"};var u={id:this.getId()+"-focusCircle",x:a+s,y:n+s,class:"sapSuiteUiCommonsNetworkBoxFocus",style:this._getStatusStyle({stroke:e.ColorType.Focus}),rx:5,ry:5,width:this._iWidth-s*2,height:this._iHeight-s*2};if(!l){var g=this._renderControl("rect",d);g+=this._renderRoundRect(p);g+=this._renderControl("rect",u);g+=this.renderItemContent(t);return g}this._renderControl("rect",d,null,l);p.renderManager=l;this._renderRoundRect(p);this._renderControl("rect",u,null,l);var _=this.renderItemContent(t);if(_&&typeof _==="string"){return _}};x.prototype._renderInfoIcon=function(t,e,i,s,r){var o=this.getStatusIcon(),n=o?"sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon":"";var a={class:"sapSuiteUiCommonsNetworkNodeInfoBox",cx:t,cy:e,r:i||C.Title.INFO_BOX_SIZE/2};var h={attributes:{id:this.getId()+"-statusicon",class:"sapSuiteUiCommonsNetworkNodeInfoIcon sapSuiteUiCommonsNetworkGraphIcon",x:t+C.Title.INFO_BOX_SIZE/2-10,y:e,style:s?"font-size:"+s:""},icon:o||"sap-icon://hint",height:C.Title.INFO_BOX_SIZE/2+2.5};if(!r){var l='<g id="'+this.getId()+"-statusiconwrapper"+'" class="sapSuiteUiCommonsNetworkNodeInfoWrapper '+n+'">';l+=this._renderControl("circle",a,false);l+="<title>"+I.getText("NETWORK_GRAPH_COLLAPSED")+"</title>";l+="</circle>";l+=this._renderIcon(h);l+="</g>";return l}r.openStart("g",this.getId()+"-statusiconwrapper");r.class("sapSuiteUiCommonsNetworkNodeInfoWrapper");r.class(n);r.openEnd();this._renderControl("circle",a,false,r);r.openStart("title");r.openEnd();r.text(I.getText("NETWORK_GRAPH_COLLAPSED"));r.close("title");r.close("circle");h.renderManager=r;this._renderIcon(h);r.close("g")};x.prototype._getNodeClass=function(){var t=this.getSelected()?this.SELECT_CLASS:"",e=this._hasCustomStatus()?" sapSuiteUiCommonsNetworkNodeCustomStatus ":"",i="";if(this.aCustomStyleClasses){i=this.aCustomStyleClasses.join(" ")}return(this.getParent()._isUseNodeHtml()?"sapSuiteUiCommonsNetworkGraphDivNode ":"sapSuiteUiCommonsNetworkNode ")+t+e+(this._isBox()?" sapSuiteUiCommonsNetworkBox ":" sapSuiteUiCommonsNetworkNodeCircle ")+this._getStatusClass()+i};x.prototype._renderAttributesForSize=function(t){t=t||{};var e=t.renderManager;if(!e){var i="",s="";this.getVisibleAttributes().forEach(function(t){i+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getLabel()});s+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getValue()})},this);i='<g id="'+this.getId()+'-attrLabel">'+i+"</g>";s='<g id="'+this.getId()+'-attrValue">'+s+"</g>";return i+s}e.openStart("g",this.getId()+"-attrLabel");e.openEnd();this.getVisibleAttributes().forEach(function(t){this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getLabel(),renderManager:e})},this);e.close("g");e.openStart("g",this.getId()+"-attrValue");e.openEnd();this.getVisibleAttributes().forEach(function(t){this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getValue(),renderManager:e})},this);e.close("g")};x.prototype._getAttributeColor=function(t,e,i){var s=e+"Status",r=t["get"+s]()||this.getStatus();return this._getColor(i,r)};x.prototype._getAttributeColorString=function(t,e,i){var s=this._getAttributeColor(t,e,i);return s?"fill:"+s:""};x.prototype._renderAttributes=function(t){t=t||{};var s=t.renderManager;var r=2,o=6,n=12;var a=this.getParent()._bIsRtl,h=a?this.getX()+this._iWidth-o:this.getX()+o,l=this._iLabelAttrWidth?this._iLabelAttrWidth:this._iWidth/2-n,d=a?h-l-n:h+l+n,p=a?d-this.getX()-o:this.getX()+this._iWidth-d-o;var u=t.y;if(!s){var c=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false),g=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false),_=this._renderClipPath({id:this.getId()+"-clip-attr-label",x:a?h-l-o+r:h-r,y:u,width:r*2+(a?l+o:l)});_+=this._renderClipPath({id:this.getId()+"-clip-attr-value",x:a?this.getX()+o+r:d-r,y:u,width:r*2+(a?p+o:p)});this.getVisibleAttributes().forEach(function(t,s){var r=u+C.Attributes.LINE*(s+1);g+=this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Label,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:h,id:t.getId()+"-label",y:r},text:t.getLabel()});c+=this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Value,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:d,y:r,id:t.getId()+"-value"},text:t.getValue()})},this);c+="</g>";g+="</g>";return _+g+c}this._renderClipPath({id:this.getId()+"-clip-attr-label",x:a?h-l-o+r:h-r,y:u,width:r*2+(a?l+o:l),renderManager:s});this._renderClipPath({id:this.getId()+"-clip-attr-value",x:a?this.getX()+o+r:d-r,y:u,width:r*2+(a?p+o:p),renderManager:s});this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false,s);this.getVisibleAttributes().forEach(function(t,r){var o=u+C.Attributes.LINE*(r+1);this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Label,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:h,id:t.getId()+"-label",y:o},text:t.getLabel(),renderManager:s})},this);s.close("g");this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false,s);this.getVisibleAttributes().forEach(function(t,r){var o=u+C.Attributes.LINE*(r+1);this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Value,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:d,y:o,id:t.getId()+"-value"},text:t.getValue(),renderManager:s})},this);s.close("g")};x.prototype._detailClick=function(t){t=t||this;t.useClientRect=true;this.getParent()._tooltip.openDetail({item:this,opener:t})};x.prototype._linksClick=function(t){t=t||this;this.getParent()._tooltip.openLink({item:this,opener:t})};x.prototype._expandClick=function(){var t=this.fireEvent("collapseExpand",{},true);if(t){this.setCollapsed(this._oExpandState!==S.COLLAPSED)}};x.prototype._setupMaxWidth=function(){var t=this.getMaxWidth();if(t){this._iWidth=t}};x.prototype._setTextHeight=function(t,e){if(t[0]&&e>0){var i=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeIcon.sapSuiteUiCommonsNetworkGraphDivNodeIconTitle");i.hide();var s=t.height();t.css("white-space","nowrap");var r=t.height();if(r!==0&&s!==0){t.height(Math.min(s,e*r))}t.css("white-space","");i.show()}};x.prototype._applyMaxWidth=function(){var t=30,e=10;var i,s,r,o=0,n=0,a=0,h,l=this.getMaxWidth();if(this._oGroup&&this._oGroup.getCollapsed()){return}if(!this.getWidth()&&this.getMaxWidth()){s=this.$("attrLabel");r=this.$("attrValue");if(s[0]){n=s[0].getBBox().width}if(r[0]){o=r[0].getBBox().width}a=o+n+t;i=Math.max(this.$()[0].getBBox().width+e,a);this._iWidth=Math.max(Math.min(i,l),80);if(o&&n){h=Math.max(n,o);if(h*2+t/2<this._iWidth){return}if(a>this._iWidth){if(o<l/2){this._iLabelAttrWidth=this._iWidth-o-t}if(n<this._iWidth/2){this._iLabelAttrWidth=n+t/4}}else{this._iLabelAttrWidth=this._iWidth-o-t}}}};x.prototype._resetDimensions=function(){this._iWidth=0;this._iHeight=0;this._iCircleSize=0;this._iTitleHeight=0};x.prototype._setupDivDimensions=function(){var t=this.$();this._iWidth=t.width();this._iHeight=t.height()};x.prototype._setupWidthAndHeight=function(t){var e=this._isBox()?"Box":"Circle",i=this._getTitleHeight(),s=this.getTitle()||this._hasDetailData()?C.Title.LINESIZE:0,r=this._getDescriptionHeight();r=r?r+5:0;var o=function(){var t=this._iHeight||this.getHeight();if(this._isBox()&&!t){t=r+(this._hasMultiLineTitle()?i+C.Title.OFFSET:Math.max(i+s,C.Box.HEIGHT));if(this._displayAttributes()){t+=this.getVisibleAttributes().length*C.Attributes.LINE+C.Attributes.OFFSET}}if(this._isCircle()&&!this._iHeight){t=t?t:C[e].HEIGHT;this._iCircleSize=t;t+=i+r}return Math.max(t,30)}.bind(this);var n=function(){var t=Math.max(this._iWidth||this.getWidth()||C[e].WIDTH,30);if(this._isCircle()&&t<this._iCircleSize){t=this._iCircleSize}return t}.bind(this);this._iHeight=o();this._iWidth=n()};x.prototype._getTitleHeight=function(){var t=0,e=this._getImageSize();if(this._hasMultiLineTitle()){t=(this.getTitleLineSize()>0?Math.min(this._aTitleLines.length,this.getTitleLineSize()):this._aTitleLines.length)*C.Title.LINESIZE}else{t=this._isBox()||this.getTitle()?C.Title.LINESIZE:0}return Math.max(e.height,t)};x.prototype._getDescriptionHeight=function(){var t=this.getDescriptionLineSize();if(t===-1||!this._aDescriptionLines||!this.getDescription()){return 0}return(t>0?Math.min(t,this._aDescriptionLines.length):this._aDescriptionLines.length)*C.Description.LINESIZE};x.prototype._setupEvents=function(){var t=this.$("wrapper");t.off("mouseover");t.off("mouseout");t.off("click");t.on("mouseover",function(t){this._mouseOver()}.bind(this));t.on("mouseout",function(t){this._mouseOut()}.bind(this));t.on("click",function(t){if(t.which===1){this._onClick(t.ctrlKey)}t.preventDefault()}.bind(this))};x.prototype._mouseOut=function(){this.$().removeClass(this.HIGHLIGHT_CLASS);if(!this.getSelected()){this._setStatusColors("")}};x.prototype._mouseOver=function(){var t=this.fireEvent("hover",{},true);if(t){if(!this.getSelected()){this._setStatusColors("Hover")}this.$().addClass(this.HIGHLIGHT_CLASS)}};x.prototype._onClick=function(t){var e=this.fireEvent("press",{},true);this.getParent()._selectNode({element:this,forceFocus:true,renderActionButtons:e&&!this.getSelected(),preventDeselect:t});if(!this.getSelected()){this.$().addClass(this.HIGHLIGHT_CLASS);this._setStatusColors("Hover")}};x.prototype._deselect=function(){var t=this.$("innerBox");t.css("stroke",this._getColor(e.ColorType.Border));t.css("fill",this._getColor(e.ColorType.Background))};x.prototype._getExpandIcon=function(t){switch(this._oExpandState){case S.PARTIAL:return t?m.PARTIAL:v;case S.EXPANDED:return t?m.COLLAPSE:T;case S.COLLAPSED:return t?m.EXPAND:y;default:return t?m.EXPAND:y}};x.prototype._createLineText=function(t,e,i,s){var r=[[]],o=0,n,a,h,l,d,p,u=this._createElement("tspan");if(!t||e<0){return r}l=t.split(/\s+/).reverse();i.appendChild(u);while(l.length>0){a=l.pop();if(a){h=r[o];h.push(a);u.textContent=r[o].join(" ");if(u.getComputedTextLength()>e){if(h.length>1&&s!==1){l.push(h.pop())}if(h.length===1){p=this._createText(i,{text:h[0],width:e,dots:false});if(p){d=u.textContent;h.pop();h.push(d);n=a.substring(d.length);l.push(n)}}o++;if(s>0&&o>=s){break}r[o]=[]}}}if(s>0&&l.length>0){r[r.length-1].push("...")}if(r.length>0){p=this._createText(i,{text:r[r.length-1].join(" "),width:e,dots:true});if(p){r[s-1]=[u.textContent]}}return r};x.prototype._createDescription=function(){var t,e=this._iWidth-C.Title.OFFSET,i=this.$();if(this._displayDescription()&&i[0]){t=this._createElement("text");t.setAttribute("class","sapSuiteUiCommonsNetworkNodeDescription");i[0].appendChild(t);this._aDescriptionLines=this._createLineText(this.getDescription(),e,t,this.getDescriptionLineSize())}};x.prototype._createMultilineTitle=function(){var t=function(){if(this._isBox()){if(this._displayImage()){return this._iWidth-this._getImageSize().width-C.Title.ICON_X_OFFSET*2}if(this.getIcon()){return this._iWidth-C.Title.ICON_SIZE-C.Title.ICON_X_OFFSET*2}return this._iWidth-C.Title.OFFSET*2}return this._iWidth}.bind(this);var e,i=t(),s=this.$();if(this.getTitleLineSize()!==1&&s[0]&&i>0){e=this._createElement("text");e.setAttribute("class","sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle");s[0].appendChild(e);this._aTitleLines=this._createLineText(this.getTitle(),i,e,this.getTitleLineSize())}};x.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};x.prototype._renderMultilineText=function(t){var i=this._isBox()&&t.useCustomstyle;t=t||{};var s=t.renderManager;if(!t.lines){return""}if(!s){var r="";for(var o=0;o<t.lines.length;o++){r+=this._renderText({attributes:{style:i?this._getStatusStyle({fill:e.ColorType.Content}):"",class:t.class+(i?" sapSuiteUiCommonsNetworkStatusText ":""),x:t.x,y:t.y+o*t.lineSize},close:false});r+=t.lines[o].join(" ");r+="</text>"}return r}for(var n=0;n<t.lines.length;n++){this._renderText({attributes:{style:i?this._getStatusStyle({fill:e.ColorType.Content}):"",class:t.class+(i?" sapSuiteUiCommonsNetworkStatusText ":""),x:t.x,y:t.y+n*t.lineSize},close:false,renderManager:s});s.text(t.lines[n].join(" "));s.close("text")}};x.prototype._renderDescription=function(t){t=t||{};t.class=" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle";var e=t.renderManager;var i={lines:this._aDescriptionLines,maxLineSize:this.getDescriptionLineSize(),lineSize:C.Description.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeDescription ",x:t.x,y:t.y};if(!e){return this._renderMultilineText(i)}i.renderManager=e;this._renderMultilineText(i)};x.prototype._sanitizeTitleLines=function(t){for(var e=0;e<t.length;e++){t[e]=[n(t[e])]}return t};x.prototype._renderMultilineTitle=function(t){t=t||{};var e=t.renderManager;var i=this._sanitizeTitleLines(this._aTitleLines);var s={useCustomStyle:true,lines:i,maxLineSize:this.getTitleLineSize(),lineSize:C.Title.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle",x:t.x,y:t.y,trim:this._aTitleLines.length>this.getTitleLineSize()&&this.getTitleLineSize()!==0};if(!e){return this._renderMultilineText(s)}s.renderManager=e;this._renderMultilineText(s)};x.prototype._processHideShowParents=function(t,e,i){var s=this._oGroup&&this._oGroup.getCollapsed();var r=function(t){if(t._bIsHidden){return}var i=false,s;if(t.getKey()!==e){if(t.aChildren.length>0){s=t.aChildren[0]._bIsHidden;t.aChildren.forEach(function(t){if(s!==t._bIsHidden){i=true}});t._oExpandState=i?S.PARTIAL:s?S.COLLAPSED:S.EXPANDED;if(t._oExpandState===S.COLLAPSED){t.$().addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(t._oExpandState===S.PARTIAL){t.$().addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}}}};r(this);this.aParents.forEach(function(t){if(!i[t.getKey()]){r(t)}});if(s){if(this._oGroup._bNeedParentProcessing){this._oGroup.aNodes.forEach(function(t){t.aParents.forEach(function(t){if(!i[t.getKey()]){r(t)}})});this._oGroup._bNeedParentProcessing=false}}};x.prototype._getAllChildren=function(t,e,i){var s=function(t){if(!i[t]){i[t]=this;return true}return false}.bind(this);if(e===this.getKey()){return}if(this._bIsHidden===t){return}if(!s(this.getKey())){return}if(this._oGroup&&this._oGroup.getCollapsed()){this._oGroup.aNodes.forEach(function(s){s._getAllChildren(t,e,i)})}if(this._oExpandState!==S.COLLAPSED){this.aChildren.forEach(function(s){s._getAllChildren(t,e,i)})}};x.prototype._hideShow=function(t){var e=t?"hide":"show",i;this._bIsHidden=t;this.aLines.forEach(function(e){e._hideShow(t)});this.aParentLines.forEach(function(e){e._hideShow(t)});if(this._oGroup&&!this._oGroup._bIsSwimLane){if(this._oGroup.getCollapsed()){this._oGroup._hideShow(t)}else{i=this._oGroup._hasVisibleNodes();if(i&&!t||!i&&t){this._oGroup._hideShow(t)}}}if(this._isInCollapsedGroup()&&this._isHtml()){return}if(this.$()){this.$()[e]()}};x.prototype._setActionButtonFocus=function(t,e){this.$().removeClass(this.FOCUS_CLASS);this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);var i=e?"addClass":"removeClass";jQuery(t)[i](this.FOCUS_CLASS)};x.prototype._getActionButtonTitle=function(t){if(this.getParent().getRenderType()==="Html"){var e=jQuery(t).attr("title");return I.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(e?" "+e:"")}else{var i=jQuery(t).find("title")[0];return I.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(i?" "+i.textContent:"")}};x.prototype._getAccessibilityLabel=function(){var t=this.getTitle();var e=t?t:this.getAltText();var i=I.getText("NETWORK_GRAPH_NODE")+" "+e;if(this._isBox()){this.getVisibleAttributes().forEach(function(t){i+=" "+t.getLabel()+" "+t.getValue()})}if(this.getStatus()&&this.getStatus()!=""){var s=this.getParent();var r=this.getStatus();if(s._oStatuses[r]){i+=" "+I.getText("PF_ARIA_STATUS")+" "+s._oStatuses[r].getTitle()}else{i+=" "+I.getText("PF_ARIA_STATUS")+" "+this.getStatus()}}if(this.getSelected()){i+=" "+I.getText("NETWORK_GRAPH_SELECTED_NODE")}return i};x.prototype._setStatusColors=function(t){var i=function(i,o){if(o&&i){var n=this._getColor(e.ColorType[t+"Content"],o),a=s?"color":"fill";jQuery(i).css(a,n||r)}}.bind(this);var s=this.getParent()&&this.getParent()._isUseNodeHtml();if(this._hasCustomStatus()){var r=this._getColor(e.ColorType[t+"Content"]),o=this._getColor(e.ColorType[t+"Background"]),n=this._getColor(e.ColorType[t+"Border"]);var a=t==="Selected"||t==="Hover";if(!s){var h=this.$("innerBox"),l=d?this.$("statusCircle"):this.$("innerStatusBox"),d=this._isCircle();l.css(d?"stroke":"fill",a?"none":o);h.css("fill",a?o:"");h.css("stroke",n);this.$().find(".sapSuiteUiCommonsNetworkStatusText").css("fill",r);this.$("focusCircle").css("stroke",this._getColor(e.ColorType[t+"Focus"]))}else{var p=this.$("wrapper"),u=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText");p.css("border-color",n);this.$("focus").css("border-color",this._getColor(e.ColorType[t+"Focus"]));if(this._isBox()){this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeText").css("color",r);this.$("header").css("background-color",a&&!o?"":o);u.css("color",a?r:this._getColor(e.ColorType.HeaderContent));p.css("background-color",a&&o?o:"")}else{this.$("status").css("border-color",o);p.css("background-color",a&&o?o:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon").css("color",r)}}}this.getAttributes().forEach(function(t){if(t&&t.getVisible()){var e=t.getLabelStatus(),s=t.getValueStatus();if(e){i(t.$("icon"),e);i(t.$("label"),e)}if(s){i(t.$("value"),s)}}})};x.prototype._setNodeOpacity=function(t){if(this._isCircle()){this.$("wrapper").css("opacity",t?.3:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText").css("opacity",t?.3:"");if(t){this.$("wrapperwithbuttons").append(jQuery("<div></div>",{class:"sapSuiteUiCommonsNetworkGraphDivInnerCloned sapSuiteUiCommonsNetworkGraphDivInner"}))}else{this.$("wrapperwithbuttons").find(".sapSuiteUiCommonsNetworkGraphDivInnerCloned").detach()}return}this.$().css("opacity",t?.3:"")};x.prototype._getContentRect=function(){var t=this._getCirclePosition(),e=this._isCircle();var i=e?t.x:this.getX(),s=e?t.y:this.getY(),r=e?this._iCircleSize:this._iHeight,o=e?this._iCircleSize:this._iWidth;return{p1:{x:i,y:s},p2:{x:i+o,y:s+r}}};x.prototype._setFocus=function(t){e.prototype._setFocus.apply(this,arguments);var i=t?"Selected":"";this.$("focus").css("border-color",this._getColor(e.ColorType[i+"Focus"]))};x.prototype.getHeaderCheckbox=function(){return this._getHeaderCheckbox()};x.prototype.computeTextDimensions=function(t){var e=this.getDomRef(),i,s,r;if(e){i=this._createElement("text",t.attributes);e.appendChild(i);try{s=this._createLineText(t.text,t.width,i,t.maxLines);r=i.getBBox().height}catch(t){}jQuery(i).detach();return{text:s,lineHeight:r}}};x.prototype.renderText=function(t){var e=16;var i=t.lines;if(!i){if(t.text){i=[t.text.split(" ")]}else{return""}}if(t&&t.renderManager){var s=t.renderManager;for(var r=0;r<i.length;r++){this._renderText({attributes:Object.assign({x:t.x+this.getX(),y:this.getY()+t.y+r*(t.lineSize||e)},t.attributes),close:false,renderManager:s});s.text(i[r].join(" "));s.close("text")}}else{var o="";for(var n=0;n<i.length;n++){o+=this._renderText({attributes:Object.assign({x:t.x+this.getX(),y:this.getY()+t.y+n*(t.lineSize||e)},t.attributes),close:false});o+=i[n].join(" ");o+="</text>"}return o}};x.prototype.renderIcon=function(t){t.attributes=t.attributes||{};Object.assign(t.attributes,{"font-family":"SAP-icons"});t.attributes.x=this.getX()+(t.x||0);t.attributes.y=this.getY()+(t.y||0);if(t&&t.renderManager){return this._renderIcon({attributes:t.attributes,icon:t.icon,renderManager:t.renderManager})}return this._renderIcon({attributes:t.attributes,icon:t.icon})};x.prototype.renderHtmlIcon=function(t,e){if(e&&e.renderManager){this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon",null,null,null,e.renderManager)}else{return this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon")}};x.prototype.renderHtmlActionButtons=function(t){t=t||{};var e=this._getElementId(t.idSufix)+"-rightdivbuttons",i=this._getElementId(t.idSufix)+"-leftdivbuttons",s=t.renderManager;s.openStart("div").attr("id",i).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsLeft").openEnd().close("div");s.openStart("div").attr("id",e).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsRight").openEnd().close("div")};x.prototype.renderHtmlInfoIcon=function(t,e){return this._renderHtmlInfoIcon(t,e)};x.prototype.renderContent=function(t){return this._isHtml()?this._renderHtmlContent(t):this._renderSvgContent(t)};x.prototype.renderItemContent=function(t){if(this._isHtml()){return this._isBox()?this._renderHtmlBoxContent(t):this._renderHtmlCircleContent(t)}return this._isBox()?this._renderBoxContent(t):this._renderCircleContent(t)};x.prototype.calculateSizes=function(){this._setupMaxWidth();this._createMultilineTitle();this._createDescription();this._resetDimensions();this._applyMaxWidth()};x.prototype.renderElement=function(t,e,i){if(e&&e.renderManager){return this._renderControl(t,e,i,e.renderManager)}return this._renderControl(t,e,i)};x.prototype.renderStatusIcon=function(t){if(t&&t.renderManager){return this._renderInfoIcon(this.getX()+t.x,this.getY()+t.y,t.size,t.iconSize,t.renderManager)}return this._renderInfoIcon(this.getX()+t.x,this.getY()+t.y,t.size,t.iconSize)};x.prototype.setSize=function(t){if(t){if(t.width){this._iWidth=t.width}if(t.height){this._iHeight=t.height}if(t.titleHeight){this._iTitleHeight=t.titleHeight}}};x.prototype.hasVisibleActionButtons=function(){return this.$("actionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)||this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)};x.prototype.getEnabledActionButtons=function(){return this.$().find(".sapSuiteUiCommonsNetworkNodeActionButton, .sapSuiteUiCommonsNetworkGraphDivActionButton:not(.sapSuiteUiCommonsNetworkGraphDivActionButtonDisabled)").parent().toArray()};x.prototype.showActionButtons=function(t){if(!this.getParent()){return}var e,i,s=this,r=0,o=0,n=this.getParent()._bIsRtl,a,h,l,d,u,c,g;if(this._isHtml()){this._showDivActionButtons(t);return}var _=function(){var t=this.getParent()._bIsRtl?-C.ActionButtons.RADIUS-C.ActionButtons.MARGIN:C.ActionButtons.RADIUS+C.ActionButtons.MARGIN,i=C.ActionButtons.RADIUS,s=[[t,i]];for(var r=1;r<e;r++){s.push([t,i+C.ActionButtons.RADIUS*2*r+C.ActionButtons.OFFSET*r])}return s}.bind(this);var S=function(){var t=this.getActionButtons().length;if(this.getShowExpandButton()){t++}if(this.getShowDetailButton()){t++}if(this.getShowActionLinksButton()){t++}return t}.bind(this);var m=function(t){var e=13,i=2,s=t.position&&t.position===p.Left,h=s&&!n||!s&&n;t.x=t.x+(h?d:l);var u={cx:t.x,cy:t.y,id:t.id+"-circle",class:"sapSuiteUiCommonsNetworkNodeActionButton",r:C.ActionButtons.RADIUS},c={class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeActionIcon "+(t.class?t.class:""),x:t.x,y:t.y},g,_,f,S,m,y;if(!t.enable){u.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabledBackground";a.appendChild(this._createElement("circle",u));u.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabled";c.class+=" sapSuiteUiCommonsNetworkNodeActionButtonDisabled"}m=this._createElement("g",{id:t.id});g=this._createElement("circle",{id:t.id+"-circle",cx:t.x,cy:t.y,r:C.ActionButtons.RADIUS-i,class:"sapSuiteUiCommonsNetworkActionButtonFocusCircle"});f=this._createElement("circle",u);S=this._createIcon(c,t.icon,e);if(t.title){_=this._createElement("title");_.textContent=t.title;f.appendChild(_)}m.appendChild(f);m.appendChild(S);m.appendChild(g);a.appendChild(m);y=jQuery(f);if(t.enable){y.on("click",function(){this._setActionButtonFocus(m,true);this._setFocus(false);if(this.getParent()){this.getParent().setFocus({item:this,button:m})}}.bind(this));jQuery(f).on("click",t.click)}s?o++:r++;return{icon:S,wrapper:f}}.bind(this);e=S();i=_();if(e===0){return}if(t&&!this._bActionButtonsRendered){u=this.getY();if(this._isCircle()){l=this.getX()+(this._iWidth/2+this._iCircleSize/2);d=this.getX()+(this._iWidth/2-this._iCircleSize/2)}else{l=this.getX()+this._iWidth;d=this.getX()}var a=this.$("actionButtons")[0];if(!a){a=this._createElement("g",{class:"sapSuiteUiCommonsNetworkNodeActionButtonWrapper",id:this._getDomId("actionButtons")})}else{jQuery(a).children().remove()}if(this.getParent()._isUseNodeHtml()){this.getParent().$("actiionbuttons")[0].appendChild(a)}else{this.$()[0].appendChild(a)}if(this.getShowExpandButton()){h=m({x:i[r][0],y:u+i[r][1],icon:this._getExpandIcon(true),class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",enable:this._hasVisibleChildren(),title:I.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)});this._expandIcon=h.icon}if(this.getShowDetailButton()){var y=this.getTitle();c=m({x:i[r][0],y:u+i[r][1],icon:"sap-icon://menu",enable:this._hasDetailData()||(y?y:this.getAltText()),id:this._getDomId("actionDetail"),title:I.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(){this._detailClick(c.wrapper)}.bind(this)})}if(this.getShowActionLinksButton()){g=m({x:i[r][0],y:u+i[r][1],icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:I.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(){this._linksClick(g.wrapper)}.bind(this)})}for(var T=0;r+o<f*2&&T<this.getActionButtons().length;T++){(function(t){var e=t.getPosition(),s=e===p.Right?r:o;if(s>=f){e=e===p.Left?p.Right:p.Left;s=e===p.Right?r:o}var n=m({x:i[s][0],y:u+i[s][1],icon:t.getIcon(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:n.wrapper})},enable:t.getEnabled(),position:e})})(this.getActionButtons()[T])}this._bActionButtonsRendered=true}else if(this._expandIcon){this._expandIcon.textContent=s._getExpandIcon();this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS)}var v=t?"addClass":"removeClass";this.$("actionButtons")[v](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};x.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren};x.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines};x.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents};x.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines};x.prototype.isHidden=function(){return this._bIsHidden};x.prototype.setHidden=function(t){var e=this;var i=function(i){i.forEach(function(i){var s=i.getFromNode()===e?i.getToNode():i.getFromNode();i.setHidden(t||s.isHidden())})};i(this.getChildLines());i(this.getParentLines());this.$()[t?"hide":"show"]();this._bIsHidden=t;if(this._oGroup){this._oGroup.setHidden(!this._oGroup._hasVisibleNodes())}};x.prototype.getCenterPosition=function(){var t,e;if(this._isBox()){return{x:this.getX()+this._iWidth/2,y:this.getY()+this._iHeight/2}}t=this._getCirclePosition();e=this._getCircleSize()/2;return{x:t.x+e,y:t.y+e}};x.prototype.setHeaderCheckBoxState=function(t){this._setHeaderCheckBoxState(t);return this};x.prototype.setX=function(t){this.setProperty("x",t,true);return this};x.prototype.setY=function(t){this.setProperty("y",t,true);return this};x.prototype.setSelected=function(t){var e=this.getParent(),i=t?"addClass":"removeClass",s=this.getKey();this.setProperty("selected",t,true);if(e){this._setStatusColors(t?"Selected":"");this.$()[i](this.SELECT_CLASS);if(t){e._mSelectedNodes[s]=this}else{delete e._mSelectedNodes[s]}}return this};x.prototype.setCollapsed=function(t){var e={},i,s,r=t?"addClass":"removeClass",o=this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons, .sapSuiteUiCommonsNetworkNodeActionButtonWrapper").find(".sapSuiteUiCommonsNetworkNodeActionCollapseIcon");this.setProperty("collapsed",t,true);this._oExpandState=t?S.COLLAPSED:S.EXPANDED;this.aChildren.forEach(function(i){i._getAllChildren(t,this.getKey(),e)},this);i=Object.keys(e);i.forEach(function(i){e[i]._hideShow(t,this.getKey())},this);i.forEach(function(i){e[i]._processHideShowParents(t,this.getKey(),e)},this);this.aLines.forEach(function(e){e._hideShow(t)});if(o[0]){o[0].textContent=this._getExpandIcon()}this.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");this.$()[r]("sapSuiteUiCommonsNetworkNodeCollapsed");s=this.getParent();if(s){s._setupKeyboardNavigation();if(t&&!(s.getFocus()&&s.getFocus().item===this)){s.setFocus({item:this})}}return this};x.prototype.setGroup=function(t){this.setProperty("group",t,true);this._invalidateParent();return this};x.prototype.setShape=function(t){this.setProperty("shape",t,true);this._invalidateParent();return this};x.prototype.setWidth=function(t){this.setProperty("width",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iWidth=t}else{this._iWidth=0}this._invalidateParent();return this};x.prototype.setHeight=function(t){this.setProperty("height",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iHeight=t}else{this._iHeight=0}this._invalidateParent();return this};x.prototype.setMaxWidth=function(t){this.setProperty("maxWidth",t,true);this._invalidateParent();return this};x.prototype.setTitleLineSize=function(t){this.setProperty("titleLineSize",t,true);this._invalidateParent();return this};x.prototype.addAttribute=function(){e.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};x.prototype.insertAttribute=function(){e.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};x.prototype.removeAllAttributes=function(){e.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent();return this};x.prototype.removeAttribute=function(){e.prototype.removeAttribute.apply(this,arguments);this._invalidateParent();return this};x.prototype.addAttribute=function(){e.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};x.prototype.insertAttribute=function(){e.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};x.prototype.removeAllAttributes=function(){e.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent()};x.prototype.removeAttribute=function(){e.prototype.removeAttribute.apply(this,arguments);this._invalidateParent()};x.prototype.getHeaderCheckBoxState=function(){if(this.getProperty("headerCheckBoxState")===u.Hidden){return u.Hidden}return this.getHeaderCheckbox().getSelected()?u.Checked:u.Unchecked};x.prototype._hasAdditionalContent=function(){return this._displayAttributes()||this._displayDescription()||this.getContent()};x.prototype._hasHeaderContent=function(){return this.getIcon()||this.getTitle()||this.getImage()};x.hasNativeLineClamp=typeof document.documentElement.style.webkitLineClamp!="undefined"&&r.browser.chrome;x.prototype._invalidateParent=function(){var t=this.getParent();if(t){t.invalidate()}};x.prototype._isIgnored=function(){var t=this.getParent(),e=t&&t._isSwimLane(),i=this._isInCollapsedGroup();if(e&&this._isHtml()){i=false}return i||this._isInIgnoredGroup()||!this._useInLayout()};x.prototype._getImageSize=function(){var t=function(t,e){return{width:t?parseInt(t,10):0,height:e?parseInt(e,10):0}};var e=this._isBox()?"Box":"Circle",i=this.getImage();if(!this._displayImage(i)){return t()}return t(i.getWidth()?i.getWidth():C.Image[e],i.getHeight()?i.getHeight():C.Image[e])};x.prototype._displayImage=function(t){t=t||this.getImage();return t&&t.getSrc()};x.prototype._isHtml=function(){return this.getParent()&&this.getParent()._isUseNodeHtml()};x.prototype._isInCollapsedGroup=function(){return this._oGroup&&this._oGroup._isCollapsed()};x.prototype._isInIgnoredGroup=function(){return this._oGroup&&this._oGroup._isIgnored()};x.prototype._displayAttributes=function(){return this.getVisibleAttributes().length!==0&&this._isBox()};x.prototype._displayDescription=function(){return this.getDescriptionLineSize()!==-1&&this.getDescription()};x.prototype._hasTitle=function(){return this.getTitle()||this.getIcon()};x.prototype._isBox=function(){return this.getShape()===d.Box&&this.getParent()._isLayered()};x.prototype._isCircle=function(){return this.getShape()===d.Circle};x.prototype._isCustom=function(){return this.getShape()===d.Custom};x.prototype._hasChildren=function(){return this.aChildren.length>0};x.prototype._showHeaderCheckBox=function(){return this.getHeaderCheckBoxState()!==u.Hidden&&this._isBox()};x.prototype._hasVisibleChildren=function(){return this.aChildren.some(function(t){return!(t._oGroup&&!t._oGroup.getVisible())&&t.getVisible()})};x.prototype._hasDetailData=function(){return this.getDescription()||this.getAttributes().length>0};x.prototype._hasActionLinks=function(){return this.getActionLinks().some(function(t){return t.getVisible()})};x.prototype._useAutomaticSize=function(){return!this.getWidth()&&this.getMaxWidth()>0};x.prototype._getShapeSize=function(t){if(this._isCircle()){return this._getCircleSize()}var e=this._isCustom()?this.getCoreNodeSize():0;return e||(t?this._iWidth:this._iHeight)};x.prototype._getCircleSize=function(){return this._isBox()?undefined:this._iCircleSize};x.prototype._hasMultiLineTitle=function(){return this._aTitleLines&&this._aTitleLines.length>1};x.prototype._getCirclePosition=function(){return this._isBox()?undefined:{x:this.getX()+(this._iWidth-this._getCircleSize())/2,y:this.getY()}};x.prototype._isOnScreen=function(t,i,s,r){var o=this.getX(),n=this.getY();return e._isRectOnScreen(o,o+this._iWidth,n,n+this._iHeight,t,i,s,r)};x.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};x.prototype.setVisible=function(t){this.setProperty("visible",t);var e=this.getParent();if(e&&e._bIsLayedOut){this.getParentNodes().forEach(function(t){t._bActionButtonsRendered=false})}return this};x.prototype.setStatusIcon=function(t){var e=this.$("statusicon")[0],i=s.getIconInfo(t),r=i&&i.content;this.$("statusiconwrapper")[t?"addClass":"removeClass"]("sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon");e&&(e.textContent=r);this.setProperty("statusIcon",t,true);return this};return x});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/NodeImage", ["sap/ui/core/Element"],function(e){"use strict";var a=e.extend("sap.suite.ui.commons.networkgraph.NodeImage",{metadata:{library:"sap.suite.ui.commons",properties:{src:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},width:{type:"int",group:"Appearance",defaultValue:null},height:{type:"int",group:"Appearance",defaultValue:null}}}});return a});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/NodeRenderer", ["sap/ui/core/Renderer"],function(){"use strict";return{apiVersion:2,render:function(e,r){var n=r._render({renderManager:e});if(n){e.unsafeHtml(n)}}}},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Status", ["sap/ui/core/Element","sap/ui/core/theming/Parameters","sap/m/library"],function(e,r,l){"use strict";var a=l.ValueCSSColor;var t=e.extend("sap.suite.ui.commons.networkgraph.Status",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Appearance",defaultValue:null},title:{type:"string",group:"Appearance",defaultValue:null},borderColor:{type:"string",group:"Appearance",defaultValue:null},backgroundColor:{type:"string",group:"Appearance",defaultValue:null},contentColor:{type:"string",group:"Appearance",defaultValue:null},headerContentColor:{type:"string",group:"Appearance",defaultValue:null},hoverBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},hoverBorderColor:{type:"string",group:"Appearance",defaultValue:null},hoverContentColor:{type:"string",group:"Appearance",defaultValue:null},selectedBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},selectedBorderColor:{type:"string",group:"Appearance",defaultValue:null},selectedContentColor:{type:"string",group:"Appearance",defaultValue:null},legendColor:{type:"string",group:"Appearance",defaultValue:null},useFocusColorAsContentColor:{type:"boolean",group:"Appearance",defaultValue:false},borderWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null},borderStyle:{type:"string",group:"Appearance",defaultValue:null}}}});t.prototype._getLegendColor=function(){var e=this.getLegendColor()||this.getBackgroundColor();if(e){var l=r.get(e);if(!l&&a.isValid(e)){l=e}return l}return null};return t});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/SvgBase", ["sap/suite/ui/commons/library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/base/security/encodeXML"],function(t,e,r,o,n){"use strict";var i=t.networkgraph.ElementStatus;var s="http://www.w3.org/2000/svg";var a=e.extend("sap.suite.ui.commons.networkgraph.SvgBase",{renderer:{}});a.prototype.HIGHLIGHT_CLASS="sapSuiteUiCommonsNetworkElementHighlight";a.prototype.SELECT_CLASS="sapSuiteUiCommonsNetworkElementSelected";a.prototype.VISIBLE_ACTIONS_BUTTONS_CLASS="sapSuiteUiCommonsNetworkNodeActionButtonsVisible";a.prototype.FOCUS_CLASS="sapSuiteUiCommonsNetworkElementFocus";a.prototype.LINEBUTTONSID="divlinebuttons";a.prototype._createElement=function(t,e){var r=document.createElementNS(s,t);return this._setAttributes(r,e)};a.prototype._setAttributes=function(t,e){e=e||{};Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])});return t};a.prototype._getStatusClass=function(t){var e=t||this.getStatus();switch(e){case i.Warning:return" sapSuiteUiCommonsNetworkElementWarning ";case i.Error:return" sapSuiteUiCommonsNetworkElementError ";case i.Success:return" sapSuiteUiCommonsNetworkElementSuccess ";case i.Information:return" sapSuiteUiCommonsNetworkElementInformation ";default:return""}};a.prototype._getAccessibilityLabel=function(){throw new Error("To be implemented by an extending class.")};a.prototype._renderRoundRect=function(t){t=t||{};var e=t.renderManager;if(!e){return this._renderControl("path",{d:this._renderRoundRectPath(t),style:t.style,class:t.class,id:t.id})}else{this._renderControl("path",{d:this._renderRoundRectPath(t),style:t.style,class:t.class,id:t.id},null,e)}};a.prototype._renderRoundRectPath=function(t){t.topRight=t.topRight||0;t.topLeft=t.topLeft||0;t.bottomRight=t.bottomRight||0;t.bottomLeft=t.bottomLeft||0;var e=t.x+t.width,r=t.y+t.height,o="",n=function(t,e,r){o+=" A"+t+","+t+" 0 0,1 "+e+","+r},i=function(t,e){o+=" L"+t+","+e};o="M"+(t.x+t.topLeft)+","+t.y;i(e-t.topRight,t.y);if(t.topRight){n(t.topRight,e,t.y+t.topRight)}i(e,r-t.bottomRight);if(t.bottomRight){n(t.bottomRight,e-t.bottomRight,r)}i(t.x+t.bottomLeft,r);if(t.bottomLeft){n(t.bottomLeft,t.x,r-t.bottomLeft)}i(t.x,t.y+t.topLeft);if(t.topLeft){n(t.topLeft,t.x+t.topLeft,t.y)}return o};a.prototype._appendTextAnchor=function(t){var e=sap.ui.getCore().getConfiguration().getRTL();if(e&&this._isMSBrowser()){t["text-anchor"]="end"}};a.prototype._renderText=function(t){t=t||{};var e=t.renderManager;if(t.height&&this._isMSBrowser()){t.attributes.dy=t.height/2}this._appendTextAnchor(t.attributes);if(!e){var r;r=this._renderControl("text",t.attributes,false);r+=t.text?n(t.text):"";if(t.close!==false){r+="</text>"}return r}else{this._renderControl("text",t.attributes,false,e);if(!!t.text){e.text(t.text)}if(t.close!==false){e.close("text")}}};a.prototype._renderSpanText=function(t,e,r){t=t||{};var o=t.renderManager;if(r&&this._isMSBrowser()){t.dy=r/2}if(!o){var i=this._renderControl("text",t,false);i+=this._renderControl("tspan",{},false);i+=n(e);i+="</tspan></text>";return i}else{this._renderControl("text",t,false,o);this._renderControl("tspan",{},false,o);o.text(e);o.close("tspan");o.close("text")}};a.prototype._cannotAppendInnerHtml=function(){return this._isMSBrowser()||o.browser.safari};a.prototype._isMSBrowser=function(){return o.browser.edge||o.browser.msie};a.prototype._renderIcon=function(t){t=t||{};var e=t.renderManager;var o=r.getIconInfo(t.icon);if(!e){if(o){return this._renderText({attributes:t.attributes,text:o.content,height:t.height})}return""}else{if(o){this._renderText({attributes:t.attributes,text:o.content,height:t.height,renderManager:e})}}};a.prototype._renderControl=function(t,e,r,o){if(!o){var n="<"+t+" ";e=e||{};Object.keys(e).forEach(function(t){if(typeof e[t]!=="undefined"){n+=t;n+="=";n+='"'+e[t]+'"'}});n+=">";r=r!==false;if(r){n+="</"+t+">"}return n}else{delete e["renderManager"];var i=["img","br","input","area","hr","col","link"];var s=i.indexOf(t)!==-1;o=s?o.voidStart(t):o.openStart(t);if(e){Object.keys(e).forEach(function(t){var r=e[t];if(typeof r!=="undefined"&&r!==""){switch(t){case"id":o.attr(t,r);break;case"class":r.split(" ").forEach(function(t){if(t){o.class(t)}});break;case"style":this.applyStyles(o,this.getStyleObject(r));break;default:o.attr(t,r)}}}.bind(this))}o=s?o.voidEnd():o.openEnd();r=r!==false;if(r&&!s){o.close(t)}}};a.prototype.getStyleObject=function(t){var e={};if(t){var r=t.split(";");for(var o=0;o<r.length;o++){if(r[o]){var n=r[o].split(":");e[n.splice(0,1)[0]]=n.join(":")}}}return e};a.prototype.applyStyles=function(t,e){Object.keys(e).forEach(function(r){t.style(r,e[r])})};a.prototype._createText=function(t,e){var r=t.firstChild,o=e.text.length,n=e.dots!==false,i=e.text,s=true,a=false,f=parseInt(t.getAttribute("maxwidth"),10)||e.width,l=parseFloat(t.getAttribute("x")),c=e.suffix?e.suffix:"",p=e.centerWidth?e.centerWidth:f,u="..."+c,h,d;e.trim=e.trim!==false;r.textContent=e.text+c;if(e.trim&&f>0){d=t.getBBox().width;if(d>f){a=true;while(true){o/=2;h=i.length+(s?-1:1)*Math.ceil(o);i=e.text.substring(0,h);r.textContent=i+(n?u:"");d=t.getBBox().width;s=d>f;if(o<.5&&!s){if(d>f){i=e.text.substring(0,i.length-Math.ceil(o*2));r.textContent=i+ +(n?u:"")}break}}}}if(e.hCenter&&!a){t.setAttribute("text-anchor","middle");t.setAttribute("x",l+p/2)}return a};a.prototype._createIcon=function(t,e,o){var n=r.getIconInfo(e),i;if(n){if(o&&this._isMSBrowser()){t.dy=o/2}i=this._createElement("text",t);i.textContent=n.content;return i}return null};a.prototype._getDomId=function(t){var e=this.getId();if(t){e+="-"+t}return e};a.prototype._convertToSvg=function(t){var e;var r=function(t){var e={},r;if(t.attributes){for(var o=0;o<t.attributes.length;o++){r=t.attributes[o];e[r.name]=r.value}}return e};var o=function(t,e){var n,i,s="";if(t.childNodes.length===1&&!t.childNodes[0].localName){e.textContent=t.childNodes[0].textContent;return}for(var a=0;a<t.childNodes.length;a++){n=t.childNodes[a];s=n.localName;if(s==="clippath"){s="clipPath"}i=this._createElement(s,r(n));e.appendChild(i);if(n.childNodes){o(n,i)}}}.bind(this);e=this._createElement(t[0].localName,r(t[0]));o(t[0],e);return e};a.prototype._convertToStyle=function(t,e,r){var o="";if(t){Object.keys(t).forEach(function(e){var r=t[e];if(typeof r!=="undefined"&&r!==""){o+=e;o+=":";o+=t[e]+";"}});o=o+(e||"");if(!r&&o){o='style="'+o+'"'}}return o};a.prototype._renderHtmlElement=function(t,e,r,o){if(!o){var n="";n+="<"+t+" ";n+=this._convertToStyle(e);if(r){Object.keys(r).forEach(function(t){var e=r[t];if(typeof e!=="undefined"&&e!==""){n+=t;n+="=";n+='"'+e+'"'}})}n+=">";return n}else{o=t==="img"?o.voidStart("img"):o.openStart(t);var i=this._convertToStyle(e,undefined,true);this.applyStyles(o,this.getStyleObject(i));if(r){Object.keys(r).forEach(function(t){var e=r[t];if(typeof e!=="undefined"&&e!==""){if(t==="class"){e.split(" ").forEach(function(t){if(t){o.class(t)}})}else if(t==="style"){this.applyStyles(o,this.getStyleObject(e))}else{o.attr(t,e)}}}.bind(this))}o=t==="img"?o.voidEnd():o.openEnd()}};a.prototype._renderHtmlIcon=function(t,e,o,i,s,a){var f=r.getIconInfo(t),l="",c="";if(!a){o=o?'id="'+this.getId()+"-"+o+'"':"";e=e||"";if(f){if(f.fontFamily){c='style="font-family:'+n(f.fontFamily)+'"'}l=s?' aria-label="'+n(s)+'" ':"";s=s?' title="'+n(s)+'" ':"";return"<div "+o+s+l+" "+(i||"")+'class="sapSuiteUiCommonsNetworkGraphIcon '+e+'"><span '+c+">"+n(f.content)+"</span></div>"}return""}else{if(f){a.openStart("div");if(o){a.attr("id",this.getId()+"-"+o)}if(s){a.attr("title",s)}if(s){a.attr("aria-label",s)}a.class("sapSuiteUiCommonsNetworkGraphIcon");if(e){e.split(" ").forEach(function(t){if(t){a.class(t)}})}this.applyStyles(a,this.getStyleObject(i));a.openEnd();a.openStart("span");if(f.fontFamily){a.style("font-family",n(f.fontFamily))}a.openEnd().text(f.content).close("span");a.close("div")}}};return a});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Tooltip", ["sap/ui/thirdparty/jquery","./SvgBase","./Line","./Node","./Group","sap/m/ResponsivePopover","sap/m/Popover","sap/m/List","sap/m/OverflowToolbar","sap/m/Button","sap/m/CustomListItem","sap/m/FlexBox","sap/m/HBox","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/Panel","sap/m/StandardListItem","sap/m/Text","sap/m/ToolbarSpacer","sap/ui/core/Icon","sap/m/FlexItemData","sap/ui/core/library","sap/m/library","sap/ui/Device"],function(jQuery,t,e,o,i,n,s,p,r,a,l,d,h,c,u,_,m,f,T,g,v,w,C,y){"use strict";var P=C.PlacementType;var S=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var A=t.extend("sap.suite.ui.commons.networkgraph.Tooltip",{metadata:{library:"sap.suite.ui.commons",events:{afterOpen:{},afterClose:{}}}});A.prototype.init=function(){this._oPopover=null;this._oElement=null};A.prototype.create=function(t){var e;this._oPopover=new n(this.getId()+"-tooltip",{showHeader:false,placement:this.getParent()._bIsRtl?P.PreferredLeftOrFlip:P.PreferredRightOrFlip,afterOpen:function(){this.fireAfterOpen()}.bind(this),afterClose:function(){this.fireAfterClose()}.bind(this),beforeOpen:function(){this._fnCreate()}.bind(this),contentWidth:"350px"}).addStyleClass("sapSuiteUiCommonsNetworkTooltip");this._oSimpleTooltip=new s({contentMinWidth:"350px",showHeader:false});this.addDependent(this._oPopover);e=this._oPopover.getAggregation("_popup");if(e){e._afterAdjustPositionAndArrowHook=function(){var t=this.$("arrow"),e=this.$().position().top,o=t.position().top,i=15,n=jQuery(window).height(),s=e+o-i;if(n>s+this.$().height()){t.css("top",i+"px");this.$().css("top",s+"px")}}}};A.prototype.instantClose=function(){var t=this._oPopover.getAggregation("_popup");if(t&&t.oPopup&&t.oPopup.close){t.oPopup.close(0)}if(this._oSimpleTooltip.oPopup&&this._oSimpleTooltip.oPopup.close){this._oSimpleTooltip.oPopup.close(0)}};A.prototype.close=function(){this._oPopover.close()};A.prototype.openDetail=function(t){var e=t.opener||this._getOpener(t.item,t.point);if(t.item instanceof o&&!t.item._hasDetailData()){this._oSimpleTooltip.removeAllContent();var i=t.item.getTitle();var n=i?i:t.item.getAltText();this._appendHeader(n,this._oSimpleTooltip);this._oSimpleTooltip.openBy(e);return}this._fnCreate=this._createDetail;this._oElement=t.item;this._oPopover.openBy(e)};A.prototype._createDetail=function(){var t=this._getTooltipCreateFunction(this._oElement);this._oPopover.removeAllContent();this._appendFooter();t(this._oElement)};A.prototype.openLink=function(t){this._oElement=t.item;this._fnCreate=this._createLink;this._oPopover.openBy(t.opener)};A.prototype._createLink=function(t){var e=new p,o=this._oElement;this._oPopover.removeAllContent();this._appendHeader(S.getText("NETWORK_GRAPH_TOOLTIP_EXTERNAL_LINKS"));o.getActionLinks().forEach(function(t){e.addItem(new l({content:[new h({renderType:"Bare",items:t.clone(null,null,{cloneChildren:true,cloneBindings:false}).addStyleClass("sapUiTinyMargin")})]}))});this._oPopover.addContent(e);this._appendFooter()};A.prototype._getOpener=function(t,o){if(t instanceof e&&o){if(this._oElement===t&&this._tooltipRect){var i=parseInt(this._tooltipRect.getAttribute("x"),10),n=parseInt(this._tooltipRect.getAttribute("y"),10),s=10;if(Math.abs(i-o.x)<s&&Math.abs(n-o.y)<s){return this._tooltipRect}}this._cleanUpLineTooltip();this._tooltipRect=this._createElement("rect",{x:o.x,y:o.y,width:y.browser.firefox?.01:0,height:y.browser.firefox?.01:0});this.getParent().$svg.append(this._tooltipRect);return this._tooltipRect}return t};A.prototype._getTooltipCreateFunction=function(t){if(t instanceof o){return this._createNodeTooltip.bind(this)}if(t instanceof e){return this._createLineTooltip.bind(this)}if(t instanceof i){return this._createGroupTooltip.bind(this)}return null};A.prototype._cleanUpLineTooltip=function(){if(this._tooltipRect){jQuery(this._tooltipRect).remove()}};A.prototype._appendDescription=function(t,e){if(t.getDescription()){e=e||this._oPopover;e.addContent(new _({content:new f({textAlign:"Initial",text:t.getDescription()}).addStyleClass("sapSuiteUiCommonsNetworkTooltipDescription")}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"))}};A.prototype._appendAttributes=function(t,e){var o=new p,i=e||this._oPopover;if(t.length>0){t.forEach(function(t){o.addItem(new l({content:[new h({items:[new f({layoutData:[new v({baseSize:"50%"})],text:t.getLabel()}),new f({layoutData:[new v({baseSize:"50%"})],text:t.getValue(),width:"100%",textAlign:w.TextAlign.End})]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipLine")]}));i.addContent(o)})}};A.prototype._appendNodesList=function(t,e){var o=new p;t.aNodes.forEach(function(t){var e=t.getTitle();var i=e?e:t.getAltText();if(t.getTitle()){o.addItem(new m({title:i,icon:t.getIcon()}))}});e.addContent(o)};A.prototype._appendFooter=function(){var t=this;this.oCloseButton=new a({text:S.getText("NETWORK_GRAPH_CLOSE"),press:function(){t._oPopover.close()}});this._oPopover.setEndButton(this.oCloseButton);this._oPopover.setInitialFocus(this.oCloseButton)};A.prototype._appendHeader=function(t,e){e=e||this._oPopover;if(t){var o=new f({width:"100%",textAlign:w.TextAlign.Center,text:t});e.insertContent(new _({width:"100%",content:[o]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"),0);e.addAriaLabelledBy(o)}};A.prototype._createGroupTooltip=function(t){var e=function(){return t.getAttributes().length>0||t.getDescription()};var o,i;this._appendHeader(t.getTitle());if(e()){i=new u({text:S.getText("NETWORK_GRAPH_TOOLTIP_LIST_OF_NODES")});o=new u({text:S.getText("NETWORK_GRAPH_TOOLTIP_INFORMATION")});this._oPopover.addContent(new c({items:[o,i]}));this._oPopover.addStyleClass("sapSuiteUiCommonsNetworkGroupTooltipTabBar");this._appendDescription(t,o);this._appendAttributes(t.getAttributes(),o);this._appendNodesList(t,i)}else{this._appendNodesList(t,this._oPopover)}};A.prototype._createNodeTooltip=function(t){this._appendDescription(t);this._appendAttributes(t.getAttributes());var e=t.getTitle();var o=e?e:t.getAltText();this._appendHeader(o)};A.prototype._createLineTooltip=function(t,e){var o=function(){var e=t.getFromNode().getTitle();var o=t.getToNode().getTitle();var i=new f({width:"50%",text:e?e:t.getFromNode().getAltText()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),n=new g({src:"sap-icon://arrow-right"}).addStyleClass("sapUiTinyMarginEnd sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),s=new g({src:"sap-icon://arrow-left"}).addStyleClass("sapUiTinyMarginBegin sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),p=new f({textAlign:w.TextAlign.End,width:"50%",text:o?o:t.getToNode().getAltText()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),r=new d({renderType:"Bare",width:"100%",justifyContent:"Center",items:[i]}).addStyleClass("sapSuiteUiCommonsNetworkLineTooltipFromTo");t._isBothArrow()?r.addItem(s):n.addStyleClass("sapUiTinyMarginBegin");r.addItem(n);r.addItem(p);return r},i=function(){var e=t.getTitle();this._oPopover.addContent(o());if(e){this._appendHeader(e)}this._appendDescription(t);this._appendAttributes(t.getAttributes())}.bind(this);i(t)};return A});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/Utils", [],function(){"use strict";var n={};n.find=function(n,r,t){var e;if(typeof n.find==="function"){return n.find(r,t)}else{for(e=0;e<n.length;e++){if(r.call(t,n[e],e,n)){return n[e]}}return undefined}};n.trimText=function(n,r){if(n&&n.length>r){return n.substring(0,r)+" ... "}return n};return n},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/D3ForceWrapper", [],function(){"use strict";var n;var r={};r._d3Path=sap.ui.require.toUrl("sap/ui/thirdparty")+"/d3.js";r.run=function(n,t){r.getD3().then(function(r){var i=n.graph;var e=r.layout.force().nodes(i.nodes).links(i.links).alpha(n.alpha).friction(n.friction).charge(n.charge).start();setTimeout(e.stop,n.maximumDuration);e.on("end",function(){t(i)})})};r.layout=function(n){return new Promise(function(t,i){r.run(n,t)})};r.getD3=function(){if(n){return Promise.resolve(n)}else{return new Promise(function(r){sap.ui.require(["sap/ui/thirdparty/d3"],function(t){n=t;r(t)})})}};return r},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/ForceBasedLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./D3ForceWrapper","./LayoutTask","sap/ui/performance/Measurement"],function(e,t,a,r,o,i){"use strict";var n=e.networkgraph.LayoutRenderType,u=12;var s=t.extend("sap.suite.ui.commons.networkgraph.layout.ForceBasedLayout",{metadata:{properties:{alpha:{type:"float",group:"Behavior",defaultValue:.3},charge:{type:"float",group:"Behavior",defaultValue:-30},friction:{type:"float",group:"Behavior",defaultValue:.9},maximumDuration:{type:"int",group:"Behavior",defaultValue:1e3}}}});s.prototype.getLayoutRenderType=function(){return n.Forces};s.prototype.isLayered=function(){return false};s.prototype.layout=function(){return new o(function(e,t,o){var n={nodes:[],links:[]},s=this.getParent();if(!s){t("The algorithm must be associated with a graph.");return}i.start("NetworkGraph - ForceBasedLayout","Layouting of a graph "+s.getId());s.getNodes().forEach(function(e,t){n.nodes.push({id:e.getKey()});e.iIndex=t});s.getNodes().forEach(function(e){e.aChildren.forEach(function(t){n.links.push({source:e.iIndex,target:t.iIndex,value:1})})});r.layout({graph:n,alpha:this.getAlpha(),friction:this.getFriction(),charge:this.getCharge(),maximumDuration:this.getMaximumDuration()}).then(function(t){if(o.isTerminated()){e();return}var r=t.graph||t;var i=a.getBoundingBox(r.nodes),n=i.p1.x*-u+100,h=i.p1.y*-u+100;r.nodes.forEach(function(e){var t=s.getNodeByKey(e.id);t.setX(e.x*u+n);t.setY(e.y*u+h)});this._normalizeLines();this._alignCoordinatesWithView();e()}.bind(this),t)}.bind(this))};return s});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/ForceDirectedLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./LayoutTask","sap/ui/performance/Measurement"],function(t,e,i,o,n){"use strict";var r=e.extend("sap.suite.ui.commons.networkgraph.layout.ForceDirectedLayout",{metadata:{properties:{optimalDistanceConstant:{type:"float",defaultValue:.2},maxIterations:{type:"int",defaultValue:200},maxTime:{type:"int",defaultValue:2e3},initialTemperature:{type:"float",defaultValue:200},coolDownStep:{type:"float",defaultValue:1},staticNodes:{type:"string[]",defaultValue:[]}}}});var a=t.networkgraph.LayoutRenderType,s=200,h=2.3999632297286535;r.prototype.getLayoutRenderType=function(){return a.Forces};r.prototype.isLayered=function(){return false};r.prototype.layout=function(){return new o(function(t,e,i){var o=this.getParent();if(!o){e("The algorithm must be associated with a graph.");return}this.oGraph=o;n.start("NetworkGraph - ForceDirectedLayout","Layouting of a graph "+o.getId());this._initPhyllotaxisPattern();this._runSimulation();this._normalizeLines();this._alignCoordinatesWithView();t()}.bind(this))};r.prototype._initPhyllotaxisPattern=function(){var t=s*Math.sqrt(this.oGraph.getNodes().length),e=0,o={center:{x:0,y:0},apex:{x:0,y:0}};this.aCenters=[];this.oGraph.getNodes().forEach(function(n,r){if(this.getStaticNodes().indexOf(n.getKey())>-1){n.center={x:n.getCenterPosition().x,y:n.getCenterPosition().y}}else{o.apex.x=Math.sqrt(r+1)*s;o.apex.y=0;e+=h;o=i.getRotatedVector(o,e);n.center={x:o.apex.x+t,y:o.apex.y+t}}this.aCenters.push(n.center)}.bind(this))};r.prototype._runSimulation=function(){var t=this.getMaxIterations(),e=this.getInitialTemperature(),o=this.getCoolDownStep(),n=this.getMaxTime()>0?this.getMaxTime()+Date.now():0,r=0,a,s,h,p,u,y,c;var d=i.getBoundingBox(this.aCenters),g=(d.p2.x-d.p1.x)*(d.p2.y-d.p1.y),f=this.getOptimalDistanceConstant()*Math.sqrt(g/this.oGraph.getNodes().length);var l=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},x=function(t){return t*t/f},m=function(t){return f*f/t};while(e>0&&r<t&&(n===0||Date.now()<n)){this.oGraph.getNodes().forEach(function(t){t.disp={x:0,y:0}});this.oGraph.getNodes().forEach(function(t){this.oGraph.getNodes().forEach(function(e){if(t.getKey()===e.getKey()){return}a=i.getPointDif(t.center,e.center);s=Math.max(1,l(a)-(t._getCircleSize()/2+e._getCircleSize()/2));t.disp.x+=a.x/s*m(s);t.disp.y+=a.y/s*m(s)})}.bind(this));this.oGraph.getLines().forEach(function(t){p=t.getFromNode();u=t.getToNode();if(p.getKey()===u.getKey()){return}a=i.getPointDif(p.center,u.center);s=l(a);y=a.x/s*x(s);c=a.y/s*x(s);p.disp.x-=y;p.disp.y-=c;u.disp.x+=y;u.disp.y+=c});this.oGraph.getNodes().forEach(function(t){if(this.getStaticNodes().indexOf(t.getKey())>-1){return}s=l(t.disp);h=Math.min(s,e)/s;t.center.x+=t.disp.x*h;t.center.y+=t.disp.y*h}.bind(this));e-=o;r++}this.oGraph.getNodes().forEach(function(t){t.setX(t.center.x-t._iWidth/2);t.setY(t.center.y-t._iHeight/2)})};r.prototype.destroy=function(){this.aCenters=null;this.oGraph=null;e.prototype.destroy.apply(this)};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/Geometry", [],function(){"use strict";var e={};var t=1e-10;e.getPointsDistance=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};e.getLineEquation=function(e){var t=(e.p1.y-e.p2.y)/(e.p1.x-e.p2.x),n=e.p1.y-t*e.p1.x;return{slope:t,intercept:n,verticalX:e.p1.x}};e.isPointUnderLine=function(e,t){if(!isFinite(t.slope)){if(e.x===t.verticalX){return 0}else if(e.x>t.verticalX){return 1}else{return-1}}var n=e.y-t.slope*e.x;if(Math.abs(n-t.intercept)<Number.EPSILON*1e3){return 0}else if(n<t.intercept){return 1}else{return-1}};e.doLinesIntersect=function(t,n){var r=e.getLineEquation(t),i=e.getLineEquation(n);return e.isPointUnderLine(t.p1,i)!=e.isPointUnderLine(t.p2,i)&&e.isPointUnderLine(n.p1,r)!=e.isPointUnderLine(n.p2,r)};e.getLinesIntersection=function(t,n){var r=t.p1.x,i=t.p1.y,x=t.p2.x,p=t.p2.y,a=n.p1.x,o=n.p1.y,y=n.p2.x,u=n.p2.y,f=(r-x)*(o-u)-(i-p)*(a-y);if(f===0){var s=e.getLineEquation(t),c=e.getLineEquation(n);if(s.slope===c.slope&&s.intercept===c.intercept){return{x:Infinity,y:Infinity}}else{return undefined}}return{x:((r*p-i*x)*(a-y)-(r-x)*(a*u-o*y))/f,y:((r*p-i*x)*(o-u)-(i-p)*(a*u-o*y))/f}};e.doLineRectangleIntersect=function(t,n){return e.getLineRectangleIntersections(t,n).length>=2};e.getLineRectangleIntersections=function(n,r){var i=[];if(n.p1.x<r.p1.x&&n.p2.x<r.p1.x||n.p1.x>r.p2.x&&n.p2.x>r.p2.x||n.p1.y<r.p1.y&&n.p2.y<r.p1.y||n.p1.y>r.p2.y&&n.p2.y>r.p2.y){return i}var x,p=t;[{p1:r.p1,p2:{x:r.p1.x,y:r.p2.y}},{p1:{x:r.p1.x,y:r.p2.y},p2:r.p2},{p1:{x:r.p2.x,y:r.p1.y},p2:r.p2},{p1:r.p1,p2:{x:r.p2.x,y:r.p1.y}}].forEach(function(t){x=e.getLinesIntersection(n,t);if(x&&x.x>=t.p1.x-p&&x.x<=t.p2.x+p&&x.y>=t.p1.y-p&&x.y<=t.p2.y+p){i.push(x)}});return i};e.getPolygonCentroid=function(e){var t=0,n,r,i,x=0,p=0;if(e.points.length<3){throw new Error("Polygon must have three or more points.")}for(var a=0;a<e.points.length;a++){n=e.points[a];r=a<e.points.length-1?e.points[a+1]:e.points[0];t+=n.x*r.y-r.x*n.y}t=t/2;for(var o=0;o<e.points.length;o++){n=e.points[o];r=o<e.points.length-1?e.points[o+1]:e.points[0];i=n.x*r.y-r.x*n.y;x+=(n.x+r.x)*i;p+=(n.y+r.y)*i}x=x/(6*t);p=p/(6*t);return{x:x,y:p}};e.getAngleOfVector=function(e){var t=e.apex.x-e.center.x,n=e.apex.y-e.center.y,r=Math.atan(n/t);if(n>0){return t>=0?r:r+Math.PI}else{return t>=0?r+2*Math.PI:r+Math.PI}};e.getLengthOfVector=function(e){return Math.sqrt(Math.pow(e.apex.x-e.center.x,2)+Math.pow(e.apex.y-e.center.y,2))};e.getRotatedPoint=function(t,n){return e.getRotatedVector({center:{x:0,y:0},apex:t},n).apex};e.getPointSum=function(e,t){return{x:e.x+t.x,y:e.y+t.y}};e.getPointDif=function(e,t){return{x:e.x-t.x,y:e.y-t.y}};e.getRotatedVector=function(t,n){var r=e.getAngleOfVector(t),i=e.getLengthOfVector(t);r+=n;var x={x:Math.cos(r)*i+t.center.x,y:Math.sin(r)*i+t.center.y};return{center:t.center,apex:x}};e.getBoundingBox=function(e){var t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;e.forEach(function(e){if(e.x<t){t=e.x}if(e.x>r){r=e.x}if(e.y<n){n=e.y}if(e.y>i){i=e.y}});return{p1:{x:t,y:n},p2:{x:r,y:i}}};e.enlargeBox=function(e,t){e.p1.x=e.p1.x-t;e.p1.y=e.p1.y-t;e.p2.x+=t;e.p2.y+=t};e.getNormalizedVector=function(t,n){var r=n/e.getLengthOfVector(t),i=(t.apex.x-t.center.x)*r,x=(t.apex.y-t.center.y)*r;return{center:{x:0,y:0},apex:{x:i,y:x}}};e.hasRectangleRectangleIntersection=function(e,t){return!(t.p1.x>e.p2.x||t.p2.x<e.p1.x||t.p1.y>e.p2.y||t.p2.y<e.p1.y)};e.getSegmentsIntersection=function(e,t){var n=1e-7;var r=function(e,t,r){return e-n<=t&&t<=r+n};var i=e.p1.x,x=e.p1.y,p=e.p2.x,a=e.p2.y,o=t.p1.x,y=t.p1.y,u=t.p2.x,f=t.p2.y;var s=((i*a-x*p)*(o-u)-(i-p)*(o*f-y*u))/((i-p)*(y-f)-(x-a)*(o-u));var c=((i*a-x*p)*(y-f)-(x-a)*(o*f-y*u))/((i-p)*(y-f)-(x-a)*(o-u));if(isNaN(s)||isNaN(c)){return false}else{if(i>=p){if(!r(p,s,i)){return false}}else if(!r(i,s,p)){return false}if(x>=a){if(!r(a,c,x)){return false}}else if(!r(x,c,a)){return false}if(o>=u){if(!r(u,s,o)){return false}}else if(!r(o,s,u)){return false}if(y>=f){if(!r(f,c,y)){return false}}else if(!r(y,c,f)){return false}}return{x:s,y:c}};e.getBezierPathCorners=function(n,r,i){var x=[],p=[],a;var o=n.split(/[,\s]/).reduce(function(e,t){var n=t.match("([a-zA-Z])(.+)");if(n){e.push(n[1]);e.push(n[2])}else{e.push(t)}return e},[]);var y=o.reduce(function(e,t){if(parseFloat(t)==t&&e.length){e[e.length-1].push(t)}else{e.push([t])}return e},[]);function u(e,t,n){var r=t.x-e.x;var i=t.y-e.y;var x=Math.sqrt(r*r+i*i);return f(e,t,Math.min(1,n/x))}function f(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}}function s(e,t){if(e.length>2){e[e.length-2]=t.x;e[e.length-1]=t.y}}function c(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}function l(e){return{x:parseFloat(y[e][1]),y:parseFloat(y[e][2])}}function h(e,n){return Math.abs(e-n)<t}function g(e,n){return n-e>t}function v(e,n){return e-n>t}function d(t){var n,r,i,x,a=t>0?1:-1,o=[],u,f,s,c;if(t===0){return}t=Math.abs(t);r=l(0);i=l(1);x=e.getNormalizedVector({center:r,apex:i},t);x=e.getRotatedVector(x,-a*Math.PI/2).apex;r.x+=x.x;r.y+=x.y;o.push(r);for(u=1;u<y.length-1;u++){n=l(u-1);r=l(u);i=l(u+1);f=h(n.x,r.x)&&g(n.y,r.y)||h(r.x,i.x)&&g(r.y,i.y);s=h(n.y,r.y)&&v(n.x,r.x)||h(r.y,i.y)&&v(r.x,i.x);c=h(n.y,r.y)&&g(n.x,r.x)&&h(r.x,i.x)&&v(r.y,i.y)||h(n.y,r.y)&&v(n.x,r.x)&&h(r.x,i.x)&&g(r.y,i.y)||h(n.x,r.x)&&g(n.y,r.y)&&h(r.y,i.y)&&g(r.x,i.x)||h(n.x,r.x)&&v(n.y,r.y)&&h(r.y,i.y)&&v(r.x,i.x);if(a<0){c=!c}x.x=(f?t:-t)*a;x.y=(s?t:-t)*a;r.x+=x.x;r.y+=x.y;r.inner=c;o.push(r)}r=l(y.length-1);n=l(y.length-2);x=e.getNormalizedVector({center:r,apex:n},t);x=e.getRotatedVector(x,a*Math.PI/2).apex;r.x+=x.x;r.y+=x.y;o.push(r);for(u=0;u<y.length;u++){y[u][1]=o[u].x.toFixed(0).toString();y[u][2]=o[u].y.toFixed(0).toString();p[u]=o[u].inner}}if(i){d(i)}if(y.length>1){var M=c(y[0]),L=null;if(y[y.length-1][0]=="Z"&&y[0].length>2){L=["L",M.x,M.y];y[y.length-1]=L}x.push(y[0]);for(var I=1;I<y.length;I++){var P=x[x.length-1],m=y[I],V=m==L?y[1]:y[I+1],R;if(p[I]===true){R=r*.65}else if(p[I]===false){R=r*1.35}else{R=r}if(V&&P&&P.length>2&&m[0]=="L"&&V.length>2&&V[0]=="L"){var E=c(P),N=c(m),b=c(V),q,F,w=Math.abs(E.x-N.x)+Math.abs(E.y-N.y),O=Math.abs(b.x-N.x)+Math.abs(b.y-N.y),z=Math.max(Math.min(R,w,O/2),1);q=u(N,E,z);F=u(N,b,z);s(m,q);m.origPoint=N;x.push(m);var S=f(q,N,.5),U=f(N,F,.5),B=["C",S.x,S.y,U.x,U.y,F.x,F.y];B.origPoint=N;x.push(B)}else{x.push(m)}}if(L){var A=c(x[x.length-1]);x.push(["Z"]);s(x[0],A)}}else{x=y}a=x.reduce(function(e,t){return e+t.join(" ")+" "},"");return a};return e},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/KlayWrapper", ["sap/ui/base/ObjectPool","sap/ui/Device"],function(e,r){"use strict";var o="sap.ui.thirdparty";function t(){var e=sap.ui.require.toUrl(o.replace(/\./g,"/"))+"/klay.js";this._worker=new Worker(e)}t.prototype.getWorker=function(){return this._worker};t.prototype.init=function(){};t.prototype.reset=function(){this._worker.onmessage=null;this._worker.onerror=null};var n={},i=!r.browser.firefox;n._pool=new e(t);n.layout=function(e){if(typeof Worker!=="undefined"&&i){try{var r=n._pool.borrowObject(),o=r.getWorker();o.postMessage({graph:e.graph,options:e.options});o.onmessage=function(o){if(o.data.stacktrace){e.error(o.data)}else{e.success(o.data)}n._pool.returnObject(r)};o.onerror=function(){n._pool.returnObject(r);n.run(e)}}catch(r){n.run(e)}}else{n.run(e)}};n.run=function(e){n.getKlay().then(function(r){r.layout(e)})};n.getKlay=function(){if(typeof $klay==="undefined"){return new Promise(function(e){var r=o.replace(/\./g,"/")+"/klay";sap.ui.require([r],function(){e($klay)})})}else{return Promise.resolve($klay)}};return n},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/LayeredLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./KlayWrapper","./LayoutTask","sap/ui/performance/Measurement"],function(t,e,o,i,r,a){"use strict";var n=t.networkgraph.Orientation,s=t.networkgraph.NodePlacement,h=t.networkgraph.LayoutRenderType;var d=34,p=25,u=17,g=4,c="N_",l="G_",f=2;var y=function(){var t={};t[s.BrandesKoepf]="BRANDES_KOEPF";t[s.LinearSegments]="LINEAR_SEGMENTS";t[s.Simple]="SIMPLE";return Object.freeze(t)}();var _=e.extend("sap.suite.ui.commons.networkgraph.layout.LayeredLayout",{metadata:{library:"sap.suite.ui.commons",properties:{nodeSpacing:{type:"float",defaultValue:55},lineSpacingFactor:{type:"float",defaultValue:.25},nodePlacement:{type:"sap.suite.ui.commons.networkgraph.NodePlacement",defaultValue:s.BrandesKoepf},mergeEdges:{type:"boolean",defaultValue:false}}}});_.prototype.getLayoutRenderType=function(){return h.LayeredWithGroups};_.prototype.layout=function(){return new r(function(t,e,o){var r=this.getParent();if(!r){e("The algorithm must be associated with a graph.");return}if(this._hasHierarchicalGroups()){e("Layered layout algorithm doesn't support hierarchical groups.");return}this.oGraph=r;this.oKGraph={children:[],edges:[]};this.mLineMap={};a.start("NetworkGraph - LayeredLayout","Layouting of a graph "+r.getId());r.getGroups().forEach(this._addGroupToKlay,this);r.getNodes().forEach(this._addNodeToKlay,this);r.getLines().forEach(this._addLineToKlay,this);i.layout({graph:this.oKGraph,options:this._getOptions(),success:function(e){if(o.isTerminated()){t();return}this._copyStuffWithoutPrefixes(e);e.children.forEach(function(t){this._extractNodeFromKlay(t)},this);e.edges.forEach(function(t){this._extractLineFromKlay(t)},this);this._dealWithOrientation();this._makeExpandedGroupsBoxesAroundNodes();this._shrinkGroupsDownward();this._stretchLinesToCircleNodeAxes();this._alignCoordinatesWithView();a.end("NetworkGraph - LayeredLayout");t()}.bind(this),error:function(t){e(t)}})}.bind(this))};_.prototype._buildNodeForKlay=function(t){var e={},o=t._isCircle();if(o||t.getCoreNodeSize()&&t._isCustom()){var i=o?t._getCircleSize():t.getCoreNodeSize();if(this.oGraph.getOrientation()!==n.TopBottom&&this.oGraph.getOrientation()!==n.BottomTop){var r=t._iHeight-i+g;e={additionalPortSpace:"top="+g+", bottom="+r}}else{var a=(t._iWidth-i)/2+g;e={additionalPortSpace:"top="+a+", bottom="+a}}}return{id:c+t.getKey(),width:t._iWidth,height:t._iHeight,properties:e}};_.prototype._addGroupToKlay=function(t){if(t._isIgnored()){return}var e=2*t._getBorderSize(),o={id:l+t.getKey(),width:t._iWidth+e,height:t._iHeight+e};this.oKGraph.children.push(o);if(!t.getCollapsed()){t.aNodes.forEach(function(t){if(!t._isIgnored()){if(!o.children){o.children=[]}o.children.push(this._buildNodeForKlay(t))}},this)}};_.prototype._addNodeToKlay=function(t){if(!t._oGroup&&!t._isIgnored()){this.oKGraph.children.push(this._buildNodeForKlay(t))}};_.prototype._addLineToKlay=function(t){var e,o,i;if(!t._isIgnored()){e=t.getFromNode()._oGroup&&t.getFromNode()._oGroup.getCollapsed()?l+t.getFromNode()._oGroup.getKey():c+t.getFrom();o=t.getToNode()._oGroup&&t.getToNode()._oGroup.getCollapsed()?l+t.getToNode()._oGroup.getKey():c+t.getTo();i=e+"->"+o+"["+this.oKGraph.edges.length+"]";this.oKGraph.edges.push({id:i,source:e,target:o});this.mLineMap[i]=t}};_.prototype._getOptions=function(){var t=this.oGraph.getOrientation(),e;switch(t){case n.LeftRight:case n.RightLeft:e="RIGHT";break;case n.TopBottom:case n.BottomTop:e="DOWN";break;default:e="RIGHT"}return{direction:e,spacing:this.getNodeSpacing(),nodePlace:y[this.getNodePlacement()],edgeSpacingFactor:this.getLineSpacingFactor(),mergeEdges:this.getMergeEdges()}};_.prototype._extractNodeFromKlay=function(t){var e=t.id.substring(0,f)===c?this.oGraph.getNodeByKey(t.originalId):undefined,o;if(!e){e=this.oGraph.mGroups[t.originalId];if(e&&!e.getCollapsed()&&t.children){t.children.forEach(function(e){o=this.oGraph.getNodeByKey(e.originalId);if(o){o.setX(Math.round(e.x+t.x));o.setY(Math.round(e.y+t.y))}},this)}}if(e){e.setX(Math.round(t.x));e.setY(Math.round(t.y))}};_.prototype._extractLineFromKlay=function(t){var e=this.mLineMap[t.id];e.setSource({x:Math.round(t.sourcePoint.x),y:Math.round(t.sourcePoint.y)});e.setTarget({x:Math.round(t.targetPoint.x),y:Math.round(t.targetPoint.y)});e.clearBends();if(t.bendPoints){t.bendPoints.forEach(function(t){e.addBend({x:Math.round(t.x),y:Math.round(t.y)})})}if(e.getFromNode()._oGroup&&!e.getFromNode()._oGroup.getCollapsed()){e._shift({x:e.getFromNode()._oGroup.getX(),y:e.getFromNode()._oGroup.getY()})}};_.prototype._dealWithOrientation=function(){if(!this.oGraph._bIsRtl&&this.oGraph.getOrientation()===n.RightLeft||this.oGraph._bIsRtl&&this.oGraph.getOrientation()!==n.RightLeft){this._verticalMirror(true)}if(this.oGraph.getOrientation()===n.BottomTop){this._horizontalMirror(true)}};_.prototype._makeExpandedGroupsBoxesAroundNodes=function(){var t=[],e;this.oGraph.getGroups().forEach(function(i){if(i.getCollapsed()||i.aNodes.length===0){return}t=this._getNodesPoints(i.aNodes);e=o.getBoundingBox(t);o.enlargeBox(e,p);i.setX(Math.round(e.p1.x));i.setY(Math.round(e.p1.y-d));i._iWidth=e.p2.x-e.p1.x;i._iHeight=e.p2.y-e.p1.y+d},this)};_.prototype._shrinkGroupsDownward=function(){var t;this.oGraph.getGroups().forEach(function(e){if(e.getCollapsed()){return}e.aNodes.forEach(function(o){t=(e.getY()+e._iHeight-o.getY())/e._iHeight;o.setY(o.getY()+t)});e.setY(e.getY()+u);e._iHeight-=u})};_.prototype._copyStuffWithoutPrefixes=function(t){t.children.forEach(function(t){t.originalId=t.id.substring(f);if(t.children){t.children.forEach(function(t){t.originalId=t.id.substring(f)})}});t.edges.forEach(function(t){t.originalSource=t.source.substring(f);t.originalTarget=t.target.substring(f)})};return _});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/LayoutAlgorithm", ["sap/suite/ui/commons/library","sap/ui/core/Element","./Geometry"],function(t,e,o){"use strict";var i=e.extend("sap.suite.ui.commons.networkgraph.layout.LayoutAlgorithm",{metadata:{abstract:true,publicMethods:["getType","isLayered","layout"]}});var n=50,r=.2;var g=t.networkgraph.Orientation,s=t.networkgraph.NodeShape;i.prototype._normalizeLines=function(){var t=this.getParent(),e={},i,n,g,s,a,c,u,p,f;t.getLines().forEach(function(t){i=t.getFrom()<t.getTo()?t.getFrom()+"-"+t.getTo():t.getTo()+"-"+t.getFrom();if(!e[i]){e[i]={from:t.getFromNode(),to:t.getToNode(),lines:[]}}e[i].lines.push(t)});Object.keys(e).forEach(function(t){n=e[t];if(n.lines.length===1){n.lines[0]._normalizePath();return}a=Math.min(n.from._getCircleSize(),n.to._getCircleSize())/2;u=2*(1-r)/(n.lines.length-1);g=-1;n.lines.forEach(function(t){g++;s={center:t.getFromNode().getCenterPosition(),apex:t.getToNode().getCenterPosition()};c=o.getNormalizedVector(s,a);c=o.getRotatedVector(c,Math.PI/2);p=(r-1+g*u)*c.apex.x;f=(r-1+g*u)*c.apex.y;t.setSource({x:t.getFromNode().getCenterPosition().x+p,y:t.getFromNode().getCenterPosition().y+f});t.setTarget({x:t.getToNode().getCenterPosition().x+p,y:t.getToNode().getCenterPosition().y+f})})})};i.prototype._stretchLinesToCircleNodeAxes=function(){var t=this.getParent(),e=t.getOrientation()!=g.TopBottom&&t.getOrientation()!=g.BottomTop,o,i;t.getLines().forEach(function(t){if(t._isIgnored()){return}var n=t.getStretchToCenter();var r=function(t){return(n&&t._isCustom()||t._isCircle())&&!t._isIgnored()};o=t.getFromNode();i=t.getToNode();if(e){if(r(o)){t.getSource().setX(Math.round(o.getX()+o._iWidth/2))}if(r(i)){t.getTarget().setX(Math.round(i.getX()+i._iWidth/2))}}else{if(r(o)){t.getSource().setY(Math.round(o.getY()+o._getShapeSize(e)/2))}if(r(i)){t.getTarget().setY(Math.round(i.getY()+i._getShapeSize(e)/2))}}})};i.prototype._cutLinesAtBoxNodeBorders=function(){var t=this.getParent(),e,i,n,r,g,a;t.getLines().forEach(function(t){e=t.getCoordinates();if(t.getFromNode().getShape()===s.Box){i={x:e[0].getX(),y:e[0].getY()};n={x:e[1].getX(),y:e[1].getY()};r=this._getNodePoints(t.getFromNode());g=o.getLineRectangleIntersections({p1:i,p2:n},{p1:r[0],p2:r[1]});if(g.length>1){if(o.getPointsDistance(g[0],n)<o.getPointsDistance(g[1],n)){t.setSource(g[0])}else{t.setSource(g[1])}}}if(t.getToNode().getShape()===s.Box){a=e.length-1;i={x:e[a-1].getX(),y:e[a-1].getY()};n={x:e[a].getX(),y:e[a].getY()};r=this._getNodePoints(t.getToNode());g=o.getLineRectangleIntersections({p1:i,p2:n},{p1:r[0],p2:r[1]});if(g.length>1){if(o.getPointsDistance(g[0],i)<o.getPointsDistance(g[1],i)){t.setTarget(g[0])}else{t.setTarget(g[1])}}}}.bind(this))};i.prototype._getNodePoints=function(t){return[{x:t.getX(),y:t.getY()},{x:t.getX()+t._iWidth,y:t.getY()+t._iHeight}]};i.prototype._getNodesPoints=function(t){var e=[];t.forEach(function(t){if(t._isIgnored&&!t._isIgnored()&&(!t._isInCollapsedGroup||!t._isInCollapsedGroup())){e.push({x:t.getX(),y:t.getY()});e.push({x:t.getX()+t._iWidth,y:t.getY()+t._iHeight})}});return e};i.prototype._getLinesPoints=function(){var t=this.getParent(),e=[];t.getLines().forEach(function(t){if(t._isIgnored()){return}if(t.getSource()){e.push({x:t.getSource().getX(),y:t.getSource().getY()})}if(t.getTarget()){e.push({x:t.getTarget().getX(),y:t.getTarget().getY()})}t.getBends().forEach(function(t){e.push({x:t.getX(),y:t.getY()})})});return e};i.prototype._verticalMirror=function(t){var e=this.getParent(),o=this._getGraphBoundingBox(),i=o.p1.x+o.p2.x,n;e.getNodes().forEach(function(t){t.setX(i-(t.getX()+t._iWidth))});e.getGroups().forEach(function(e){n=t?2*e._getBorderSize():0;e.setX(i-(e.getX()+e._iWidth+n))});e.getLines().forEach(function(t){if(t._isIgnored()){return}if(t.getSource()){t.setSource({x:i-t.getSource().getX()})}if(t.getTarget()){t.setTarget({x:i-t.getTarget().getX()})}t.getBends().forEach(function(t){t.setX(i-t.getX())});if(t._aNipples){t._aNipples.forEach(function(t){t.x=i-t.x;if(t.orientation===g.LeftRight){t.orientation=g.RightLeft}else if(t.orientation===g.RightLeft){t.orientation=g.LeftRight}})}})};i.prototype._horizontalMirror=function(t){var e=this.getParent(),o=this._getGraphBoundingBox(),i=o.p1.y+o.p2.y,n;e.getNodes().forEach(function(t){t.setY(i-(t.getY()+t._iHeight))});e.getGroups().forEach(function(e){n=t?2*e._getBorderSize():0;e.setY(i-(e.getY()+e._iHeight+n))});e.getLines().forEach(function(t){if(t._isIgnored()){return}if(t.getSource()){t.setSource({y:i-t.getSource().getY()})}if(t.getTarget()){t.setTarget({y:i-t.getTarget().getY()})}t.getBends().forEach(function(t){t.setY(i-t.getY())});if(t._aNipples){t._aNipples.forEach(function(t){t.y=i-t.y;if(t.orientation===g.TopBottom){t.orientation=g.BottomTop}else if(t.orientation===g.BottomTop){t.orientation=g.TopBottom}})}})};i.prototype._shiftGraph=function(t,e,o){var i=this.getParent();if(!o){i.getGroups().forEach(function(o){o.setX(o.getX()+t);o.setY(o.getY()+e)})}i.getNodes().forEach(function(o){o.setX(o.getX()+t);o.setY(o.getY()+e);o.aLines.forEach(function(o){o._shift({x:t,y:e})})})};i.prototype._getGraphBoundingBox=function(){var t=this.getParent(),e=this._getNodesPoints(t.getNodes()).concat(this._getNodesPoints(t.getGroups())).concat(this._getLinesPoints());return o.getBoundingBox(e)};i.prototype._alignCoordinatesWithView=function(){var t=this._getGraphBoundingBox(),e=n-t.p1.x,o=n-t.p1.y;this._shiftGraph(e,o)};i.prototype._hasHierarchicalGroups=function(){return this.getParent().getGroups().some(function(t){return t.getParentGroupKey()})};i.prototype.getType=function(){throw new Error("To be overridden in implementing class.")};i.prototype.isLayered=function(){throw new Error("To be overridden in implementing class.")};i.prototype.layout=function(){throw new Error("To be overridden in implementing class.")};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/LayoutTask", ["sap/ui/base/Object"],function(t){"use strict";var i=t.extend("sap.suite.ui.commons.networkgraph.layout.LayoutTask",{constructor:function(i){t.apply(this,arguments);this._bTerminated=false;this._oPromise=new Promise(function(t,e){i(t,e,this)}.bind(this))}});i.prototype.then=function(t,i){this._oPromise=this._oPromise.then(t,i);return this};i.prototype.catch=function(t){this._oPromise=this._oPromise.catch(t);return this};i.prototype.terminate=function(){this._bTerminated=true;return this};i.prototype.isTerminated=function(){return this._bTerminated};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/NoopLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./LayoutTask"],function(t,e,r){"use strict";var o=t.networkgraph.LayoutRenderType;var i=e.extend("sap.suite.ui.commons.networkgraph.layout.NoopLayout");i.prototype.getLayoutRenderType=function(){return o.LayeredWithGroups};i.prototype.layout=function(){return new r(function(t,e,r){var o=this.getParent();if(r.isTerminated()){t();return}if(!o){e("The algorithm must be associated with a graph.");return}this._normalizeLines();t()}.bind(this))};return i});
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/SwimLaneChainLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./LayoutTask"],function(e,t,i,n){"use strict";var s=e.networkgraph.Orientation;var o=e.networkgraph.LayoutRenderType,a=32,r=50,h=75,d=75,f=75,g=32,p=10,c=25;var u=t.extend("sap.suite.ui.commons.networkgraph.layout.SwimlaneChainLayout",{metadata:{library:"sap.suite.ui.commons",properties:{}}});u.prototype.getLayoutRenderType=function(){return o.SwimLanes};u.prototype.layout=function(){return new n(function(e,t,i){var n=this.getParent(),o;if(!n){t("The algorithm must be associated with a graph.");return}this.oGraph=n;o=this._validateGraphDefinition();if(o){t(o)}this.bVertLane=n.getOrientation()===s.LeftRight||n.getOrientation()===s.RightLeft;this._calcLanesProperties();this._findRoots();this._initGrid();this._traceAndStackNodes();this._calcRowsProperties();this._calcNodesCoordinates();this.oGraph.getLines().forEach(function(e){this._traceSingleLine(e);this._calcLineCentroid(e);e._aNipples=[]}.bind(this));this._indexAllLineFragments();this._cutLinesAtBoxNodeBorders();this._removeLineOverlays(this.aHorizontalFragments,true);this._removeLineOverlays(this.aVerticalFragments,false);this._calcLanesWidthsAndPositions();this._collapseShiftNodesAndLines();this._alignCoordinatesWithView();this._beautify();this._findAllNipples();this._cullLineFragmentsInCollapsedGroups();if(!this.oGraph._bIsRtl&&n.getOrientation()===s.RightLeft||this.oGraph._bIsRtl&&n.getOrientation()===s.LeftRight){this._verticalMirror()}else if(n.getOrientation()===s.BottomTop){this._horizontalMirror()}e()}.bind(this))};u.prototype._validateGraphDefinition=function(){var e=[];this.oGraph.getNodes().forEach(function(t){if(!t.getGroup()){e.push(t.getKey())}});if(e.length>0){return"Some nodes are missing swim lanes: "+e.join()}if(this._hasHierarchicalGroups()){return"Swim lane layout algorithm doesn't support hierarchical groups."}return null};u.prototype._calcLanesProperties=function(){this.aLanes=[];this.oGraph.getGroups().forEach(function(e){if(this.bVertLane){e.setY(0)}else{e.setX(0)}this.aLanes.push(e.getKey())}.bind(this));this.aLanes.sort();this.oGraph.getNodes().forEach(function(e){e._iGroupIndex=this.aLanes.indexOf(e.getGroup())}.bind(this));var e;this.aLaneWidths={};this.aLaneOffsets={};this.oGraph.getNodes().forEach(function(t){e=this.bVertLane?t._iWidth:t._iHeight;if(!this.aLaneWidths[t._iGroupIndex]||this.aLaneWidths[t._iGroupIndex]<e){this.aLaneWidths[t._iGroupIndex]=e}}.bind(this));var t;this.aLaneGroups={};this.oGraph.getGroups().forEach(function(e){t=this.aLanes.indexOf(e.getKey());if(this.aLaneWidths[t]<e.getMinWidth()){this.aLaneWidths[t]=e.getMinWidth()}this.aLaneGroups[t]=e}.bind(this));var i=0;Object.keys(this.aLaneWidths).forEach(function(e){if(i>0){i+=d}this.aLaneOffsets[e]=i;i+=this.aLaneWidths[e]}.bind(this))};u.prototype._findRoots=function(){this.aRoots=[];this.oGraph.getNodes().forEach(function(e){if(e._iGroupIndex===0&&e.aParents.length===0){this.aRoots.push(e)}}.bind(this));this.oGraph.getNodes().forEach(function(e){if(e._iGroupIndex>0&&e.aParents.length===0){this.aRoots.push(e)}}.bind(this));this.oGraph.getNodes().forEach(function(e){this.aRoots.push(e)}.bind(this))};u.prototype._initGrid=function(){this.aGrid=[];this.oGraph.getNodes().forEach(function(e){if(!this.aGrid[e._iGroupIndex]){this.aGrid[e._iGroupIndex]=[]}e._bChainTraced=false}.bind(this))};u.prototype._traceAndStackNodes=function(){this.aRoots.forEach(function(e){if(!e._bChainTraced){this.aGrid[e._iGroupIndex].push(e);e._bChainTraced=true;this._traceNodeChainDepthFirst(e)}}.bind(this))};u.prototype._traceNodeChainDepthFirst=function(e){e.aChildren.forEach(function(e){if(!e._bChainTraced){e._bChainTraced=true;this.aGrid[e._iGroupIndex].push(e);this._traceNodeChainDepthFirst(e)}}.bind(this))};u.prototype._calcRowsProperties=function(){var e=0,t;this.aGrid.forEach(function(t){if(t.length>e){e=t.length}});this.aRowHeights=[];this.aRowOffsets=[];for(var i=0;i<e;i++){this.aGrid.forEach(function(e){if(!e[i]){return}t=this.bVertLane?e[i]._iHeight:e[i]._iWidth;if(!this.aRowHeights[i]||this.aRowHeights[i]<t){this.aRowHeights[i]=t}}.bind(this))}var n=-1,s=0;this.aRowHeights.forEach(function(e){n++;if(n>0){s+=d}this.aRowOffsets[n]=s;s+=e}.bind(this));this.fGridHeight=this.aRowOffsets[e-1]+this.aRowHeights[e-1];if(this.bVertLane){this.fGridHeight+=r}else{this.fGridHeight+=h}this.oGraph.getGroups().forEach(function(e){if(this.bVertLane){e._iHeight=this.fGridHeight}else{e._iWidth=this.fGridHeight}}.bind(this))};u.prototype._calcNodesCoordinates=function(){var e;this.aGrid.forEach(function(t){e=-1;t.forEach(function(t){e++;if(this.bVertLane){t.setX(this.aLaneOffsets[t._iGroupIndex]+this.aLaneWidths[t._iGroupIndex]/2-t._iWidth/2+d/2);t.setY(this.aRowOffsets[e]+this.aRowHeights[e]/2-t._iHeight/2+f/2)}else{t.setX(this.aRowOffsets[e]+this.aRowHeights[e]/2-t._iWidth/2+f/2);t.setY(this.aLaneOffsets[t._iGroupIndex]+this.aLaneWidths[t._iGroupIndex]/2-t._iHeight/2+d/2)}t.iRow=e}.bind(this))}.bind(this))};u.prototype._calcLineCentroid=function(e){var t=e.getBends().length+2,i=e.getSource().getX()+e.getTarget().getX(),n=e.getSource().getY()+e.getTarget().getY();e.getBends().forEach(function(e){i+=e.getX();n+=e.getY()});e._oCentroid={x:i/t,y:n/t}};u.prototype._indexAllLineFragments=function(){this.aVerticalFragments=[];this.aHorizontalFragments=[];this.oGraph.getLines().forEach(function(e){this._indexLineFragments(e)}.bind(this))};u.prototype._indexLineFragments=function(e){var t=this._getLinePointsList(e),i,n;for(var s=0;s<t.length-1;s++){i=t[s];n=t[s+1];if(i.x===n.x){if(i.y<n.y){this.aVerticalFragments.push({line:e,index:s,cc:i.x,c1:i.y,c2:n.y})}else{this.aVerticalFragments.push({line:e,index:s,cc:i.x,c1:n.y,c2:i.y,invert:true})}}else if(i.y===n.y){if(i.x<n.x){this.aHorizontalFragments.push({line:e,index:s,cc:i.y,c1:i.x,c2:n.x})}else{this.aHorizontalFragments.push({line:e,index:s,cc:i.y,c1:n.x,c2:i.x,invert:true})}}}};u.prototype._removeLineOverlays=function(e,t){var i,n,s,o,a;for(var r=0;r<e.length;r++){i=e[r];n=[i];for(var h=r+1;h<e.length;h++){if(this._doFragmentsIntersect(i,e[h])){n.push(e[h])}}if(n.length===1){continue}n.sort(function(e,i){if(t){return e.line._oCentroid.y-i.line._oCentroid.y}else{return e.line._oCentroid.x-i.line._oCentroid.x}});s=(n.length-1)*p;if(s>c){s=c}o=s/(n.length-1);a=i.cc-s/2;for(h=0;h<n.length;h++){this._shiftLineFragment(n[h],a,!t);a+=o}}};u.prototype._shiftLineFragment=function(e,t,i){var n=e.line.getCoordinates()[e.index],s=e.line.getCoordinates()[e.index+1];e.cc=t;if(i){n.setX(t);s.setX(t)}else{n.setY(t);s.setY(t)}};u.prototype._doFragmentsIntersect=function(e,t){return e.cc===t.cc&&!(e.c1<t.c1&&e.c1<t.c2&&e.c2<t.c1&&e.c2<t.c2||e.c1>t.c1&&e.c1>t.c2&&e.c2>t.c1&&e.c2>t.c2)};u.prototype._getLinePointsList=function(e){var t=[];t.push({x:e.getSource().getX(),y:e.getSource().getY()});e.getBends().forEach(function(e){t.push({x:e.getX(),y:e.getY()})});t.push({x:e.getTarget().getX(),y:e.getTarget().getY()});return t};u.prototype._calcLanesWidthsAndPositions=function(){var e,t=0;this.aLanes.forEach(function(i,n){e=this.oGraph.mGroups[i];e._fExpandedWidth=this.aLaneWidths[n]+d;e._fExpandedPosition=this.aLaneOffsets[n];if(this.bVertLane){e.setX(this.aLaneOffsets[n]+t)}else{e.setY(this.aLaneOffsets[n]+t)}if(e.getCollapsed()){if(this.bVertLane){e._iWidth=g}else{e._iHeight=g}if(e.getNodes().length>0){t+=g-(this.aLaneWidths[n]+d)}}else{if(this.bVertLane){e._iWidth=e._fExpandedWidth}else{e._iHeight=e._fExpandedWidth}}}.bind(this))};u.prototype._collapseShiftNodesAndLines=function(){var e,t,i;this.aLanes.forEach(function(n){i=this.oGraph.mGroups[n];t=g/i._fExpandedWidth;this.oGraph.getNodes().forEach(function(t){if(this.bVertLane){if(t.getCenterPosition().x>i._fExpandedPosition&&t.getCenterPosition().x<=i._fExpandedPosition+i._fExpandedWidth){e=i.getX()-i._fExpandedPosition;if(i.getCollapsed()){e+=(g-i._fExpandedWidth)/2}t.setX(t.getX()+e)}}else{if(t.getCenterPosition().y>i._fExpandedPosition&&t.getCenterPosition().y<=i._fExpandedPosition+i._fExpandedWidth){e=i.getY()-i._fExpandedPosition;if(i.getCollapsed()){e+=(g-i._fExpandedWidth)/2}t.setY(t.getY()+e)}}}.bind(this));this.oGraph.getLines().forEach(function(n){n.getCoordinates().forEach(function(n){if(this.bVertLane){if(n.getX()>i._fExpandedPosition&&n.getX()<=i._fExpandedPosition+i._fExpandedWidth){e=i.getX()-i._fExpandedPosition;if(i.getCollapsed()){e-=(n.getX()-i._fExpandedPosition)*(1-t)}n.setX(n.getX()+e)}}else{if(n.getY()>i._fExpandedPosition&&n.getY()<=i._fExpandedPosition+i._fExpandedWidth){e=i.getY()-i._fExpandedPosition;if(i.getCollapsed()){e-=(n.getY()-i._fExpandedPosition)*(1-t)}n.setY(n.getY()+e)}}}.bind(this))}.bind(this))}.bind(this))};u.prototype._traceSingleLine=function(e){var t,i,n,s;t=e.getFromNode();i=e.getToNode();n=t.getCenterPosition();s=i.getCenterPosition();e.setSource({x:n.x,y:n.y});e.setTarget({x:s.x,y:s.y});e.clearBends();var o=(this.aLaneWidths[t._iGroupIndex]+d)/2,a=(this.aLaneWidths[i._iGroupIndex]+d)/2,r=(this.aRowHeights[t.iRow]+f)/2,h=(this.aRowHeights[i.iRow]+f)/2;if(t._iGroupIndex===i._iGroupIndex&&Math.abs(t.iRow-i.iRow)===1||t.iRow===i.iRow&&Math.abs(t._iGroupIndex-i._iGroupIndex)===1){}else if(t._iGroupIndex===i._iGroupIndex){if(this.bVertLane){e.addBend({x:n.x+o,y:n.y});e.addBend({x:s.x+a,y:s.y})}else{e.addBend({x:n.x,y:n.y+o});e.addBend({x:s.x,y:s.y+a})}}else if(t.iRow===i.iRow){var g=true,p=Math.min(t._iGroupIndex,i._iGroupIndex),c=Math.max(t._iGroupIndex,i._iGroupIndex);for(var u=p+1;u<c;u++){if(this.aGrid[u]&&this.aGrid[u].length>t.iRow){g=false}}if(!g){if(this.bVertLane){e.addBend({x:n.x,y:n.y+r});e.addBend({x:s.x,y:s.y+h})}else{e.addBend({x:n.x+r,y:n.y});e.addBend({x:s.x+h,y:s.y})}}}else if(Math.abs(t.iRow-i.iRow)===1){if(this.bVertLane){if(t.iRow<i.iRow){e.addBend({x:n.x,y:n.y+r});e.addBend({x:s.x,y:s.y-h})}else{e.addBend({x:n.x,y:n.y-r});e.addBend({x:s.x,y:s.y+h})}}else{if(t.iRow<i.iRow){e.addBend({x:n.x+r,y:n.y});e.addBend({x:s.x-h,y:s.y})}else{e.addBend({x:n.x-r,y:n.y});e.addBend({x:s.x+h,y:s.y})}}}else if(Math.abs(t._iGroupIndex-i._iGroupIndex)===1){if(this.bVertLane){if(t._iGroupIndex<i._iGroupIndex){e.addBend({x:n.x+o,y:n.y});e.addBend({x:s.x-a,y:s.y})}else{e.addBend({x:n.x-o,y:n.y});e.addBend({x:s.x+a,y:s.y})}}else{if(t._iGroupIndex<i._iGroupIndex){e.addBend({x:n.x,y:n.y+o});e.addBend({x:s.x,y:s.y-a})}else{e.addBend({x:n.x,y:n.y-o});e.addBend({x:s.x,y:s.y+a})}}}else{var l,x;if(this.bVertLane){l=t._iGroupIndex<i._iGroupIndex?n.x+o:n.x-o;e.addBend({x:l,y:n.y});x=t.iRow<i.iRow?s.y-h:s.y+h;e.addBend({x:l,y:x});e.addBend({x:s.x,y:x})}else{x=t._iGroupIndex<i._iGroupIndex?n.y+o:n.y-o;e.addBend({x:n.x,y:x});l=t.iRow<i.iRow?s.x-h:s.x+h;e.addBend({x:l,y:x});e.addBend({x:l,y:s.y})}}var _,y;if(e.getBends().length>0){y=e.getBends()[e.getBends().length-1];_={x:y.getX(),y:y.getY()}}else{_=n}if(s.x===_.x){if(s.y<_.y){e.setTarget({x:s.x,y:s.y+i._iHeight/2})}else{e.setTarget({x:s.x,y:s.y-i._iHeight/2})}}else{if(s.x<_.x){e.setTarget({x:s.x+i._iWidth/2,y:s.y})}else{e.setTarget({x:s.x-i._iWidth/2,y:s.y})}}};u.prototype._beautify=function(){if(this.bVertLane){this.oGraph.getGroups().forEach(function(e){e._iHeight+=a;this._shiftGraph(0,4,true)}.bind(this))}else{this._shiftGraph(a/2,0,true)}};u.prototype._alignCoordinatesWithView=function(){var e=this._getGraphBoundingBox();this._shiftGraph(-e.p1.x,-e.p1.y)};u.prototype._findAllNipples=function(){var e,t,i,n,o,a,r,h,d,f,g,p;this._indexAllLineFragments();e=this.bVertLane?this.aHorizontalFragments:this.aVerticalFragments;e.forEach(function(e){t=Object.keys(this.aLaneOffsets).length-1;Object.keys(this.aLaneOffsets).forEach(function(c,u){if(u===t){return}i=this.aLaneGroups[c];n=this.aLaneGroups[Object.keys(this.aLaneOffsets)[u+1]];if(!i.getCollapsed()&&!n.getCollapsed()){return}o=e.line.getFromNode()._oGroup;a=e.line.getToNode()._oGroup;if(i.getCollapsed()&&n.getCollapsed()&&o===i&&a===n){return}r=i.getCollapsed()&&(i.getKey()===o.getKey()||i.getKey()===a.getKey());h=n.getCollapsed()&&(n.getKey()===o.getKey()||n.getKey()===a.getKey());g=undefined;d=i.getX()+i._iWidth;f=i.getY()+i._iHeight;if(this.bVertLane){if((r&&e.c1<=d&&e.c2>d||h&&e.c1<d&&e.c2>=d)&&e.cc>i.getY()&&e.cc<f){g={x:d,y:e.cc}}}else{if((r&&e.c1<=f&&e.c2>f||h&&e.c1<f&&e.c2>=f)&&e.cc>i.getX()&&e.cc<d){g={x:e.cc,y:f}}}if(g){if(r){if(this.bVertLane){p=s.LeftRight}else{p=s.TopBottom}}else if(h){if(this.bVertLane){p=s.RightLeft}else{p=s.BottomTop}}else{return}e.line._aNipples.push({x:g.x,y:g.y,orientation:p})}}.bind(this))}.bind(this))};u.prototype._cullLineFragmentsInCollapsedGroups=function(){var e,t,i=function(e,t){return e.getX()>=t.getX()&&e.getX()<=t.getX()+t._iWidth&&e.getY()>=t.getY()&&e.getY()<=t.getY()+t._iHeight},n=function(n,s){var o=s?n.getToNode():n.getFromNode(),a=function(){return s?n.getCoordinates().length-1:0},r;if(!o._isInCollapsedGroup()){return}r=o._oGroup;while(n.getCoordinates().length>0&&i(n.getCoordinates()[a()],r)){e=n.getCoordinates()[a()];t=n.getCoordinates()[a()+(s?-1:1)];if(t&&!i(t,r)){if(this.bVertLane){if(t.getX()<e.getX()){e.setX(r.getX())}else{e.setX(r.getX()+r._iWidth)}}else{if(t.getY()<e.getY()){e.setY(r.getY())}else{e.setY(r.getY()+r._iHeight)}}break}else{n.removeAggregation("coordinates",a(),true)}}}.bind(this);this.oGraph.getLines().forEach(function(e){n(e,false);n(e,true)})};return u});
sap.ui.predefine("sap/suite/ui/commons/networkgraph/layout/TwoColumnsLayout", ["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./LayoutTask"],function(e,o,t,i){"use strict";var r=e.networkgraph.LayoutRenderType;var n=15,s=75,a=32,u=42,h=160,p=100,d=50,l=25,f=10,_=.6,g=20;var G=o.extend("sap.suite.ui.commons.networkgraph.layout.TwoColumnsLayout");G.prototype.getLayoutRenderType=function(){return r.TwoColumns};G.prototype.layout=function(){return new i(function(e,o,t){var i=this.getParent(),r;if(!i){o("The algorithm must be associated with a graph.");return}this.oGraph=i;this.oLeftColumn=undefined;this.oRightColumn=undefined;r=this._validateGraphDefinition();if(r){o(r)}this._preprocessGroupsAndNodes();r=this._validateLines();if(r){o(r)}this._calcLanesProperties();this._createNodesGrid();this._calcNodeEndingAndStartingPoints();this._setNodesCoordinates();this._setGroupCoordinates();this._setLinesCoordinates();this._cutLinesAtBoxNodeBorders();if(this.oGraph._bIsRtl){this._verticalMirror()}e()}.bind(this))};G.prototype._validateGraphDefinition=function(){var e=[];this.oGraph.getNodes().forEach(function(o){if(!o.getGroup()){e.push(o.getKey())}});if(e.length>0){return"Some nodes are missing group: "+e.join()}return null};G.prototype._preprocessGroupsAndNodes=function(){if(this.oGraph.getGroups().some(function(e){e._oFirstNode=null;e._oLastNode=null;e._bNestedSet=false;if(!e._oParentGroup){if(!this.oLeftColumn){this.oLeftColumn=e}else if(!this.oRightColumn){this.oRightColumn=e}else{return true}}return false}.bind(this))){return"There are too many columns, ie. groups without a parent group. Expected exactly 2."}if(!this.oRightColumn||!this.oLeftColumn){return"There are too few columns, ie. groups without a parent group. Expected exactly 2."}this.oGraph.getNodes().forEach(function(e){e._iStartingGroupCount=0;e._iEndingGroupCount=0})};G.prototype._validateLines=function(){var e,o;if(this.oGraph.getLines().some(function(t){e=t.getFromNode()._oGroup._oTopParentGroup;o=t.getToNode()._oGroup._oTopParentGroup;return!(e===this.oLeftColumn&&o===this.oRightColumn||o===this.oLeftColumn&&e===this.oRightColumn)}.bind(this))){return"For Two columns layout all lines have to go from one column to the other."}else{return null}};G.prototype._calcLanesProperties=function(){var e;this.aLanes=[];this.oGraph.getGroups().forEach(function(e){if(!e.getParentGroupKey()){this.aLanes.push(e.getKey())}}.bind(this));this.aLanes.sort();var o=this.aLanes.map(Number.prototype.valueOf,0);this.oGraph.getNodes().forEach(function(t){var i=t._oGroup,r=i._oTopParentGroup&&i._oTopParentGroup.getKey()||t.getGroup();e=this.aLanes.indexOf(r);t._iGroupIndex=i._iLaneIndex=e;if(i._iNestedLevel>o[e]){o[e]=i._iNestedLevel}}.bind(this));this.oGraph.getGroups().forEach(function(e){var o=e._oTopParentGroup&&e._oTopParentGroup.getKey()||e.getKey();e._iLaneIndex=this.aLanes.indexOf(o)}.bind(this));this.aLaneWidths=[];this.oGraph.getNodes().forEach(function(e){if(!this.aLaneWidths[e._iGroupIndex]||this.aLaneWidths[e._iGroupIndex]<e._iWidth){this.aLaneWidths[e._iGroupIndex]=e._iWidth}}.bind(this));this.aLaneWidths=this.aLaneWidths.map(function(e,o){var t=this.oGraph.mGroups[this.aLanes[o]],i=t.getMinWidth()||h;return Math.max(i,e)}.bind(this));this.aLaneGroupWidths=this.aLaneWidths.map(function(e,t){return e+o[t]*n*2});var t=this.oGraph.$("innerscroller").width();t=Math.max(this.aLaneGroupWidths[0]+this.aLaneGroupWidths[1]+p+l*2,t);this.aLaneCenters=[l+this.aLaneGroupWidths[0]/2+(this.oGraph._bIsRtl?30:0),t-this.aLaneGroupWidths[1]/2-l*1.5]};G.prototype._createNodesGrid=function(){var e=this.oGraph.getGroups(),o=0;var t=e.filter(function(e){return e._iNestedLevel===0});this.aGrid=this.aLanes.map(function(e){return[]});var i=function(e){e.aNodes.forEach(function(t){var i=t._oGroup._oCollapsedByParent,r=i||e;if(!e.getCollapsed()&&!i){this.aGrid[o].push(t)}else if(r.getCollapsed()){while(r._oCollapsedByParent){r=r._oCollapsedByParent}if(!r._bNestedSet){r._bNestedSet=true;this.aGrid[o].push(t)}}}.bind(this));e.aChildGroups.forEach(function(e){i(e)})}.bind(this);t.forEach(function(e,t){e._iTopGroupIndex=t;i(e);o++})};G.prototype._calcNodeEndingAndStartingPoints=function(){var e=function(e,o,t,i,r){var n=e._oParentGroup;while(n&&n._iNestedLevel>0){if(!n[t]||r){n[t]=o;if(!n._oCollapsedByParent&&!n.getCollapsed()){o[i]++}}else{return}n=n._oParentGroup}};var o=function(o){if(!o._oGroup._oLastNode){o._oGroup._oLastNode=o;if(!o._oGroup._oCollapsedByParent&&!o._oGroup.getCollapsed()){o._iEndingGroupCount++}e(o._oGroup,o,"_oLastNode","_iEndingGroupCount",false)}};var t=function(o){if(!o._oGroup._oFirstNode){o._oGroup._oFirstNode=o;if(!o._oGroup._oCollapsedByParent&&!o._oGroup.getCollapsed()){o._iStartingGroupCount++}e(o._oGroup,o,"_oFirstNode","_iStartingGroupCount",false)}};for(var i=0;i<this.aGrid.length;i++){var r=null;for(var n=0;n<this.aGrid[i].length;n++){var s=this.aGrid[i][n];if(s._oGroup!==r){t(s);r=s._oGroup}}r=null;for(var n=this.aGrid[i].length-1;n>=0;n--){var s=this.aGrid[i][n];if(s._oGroup!==r){o(s);r=s._oGroup}}}};G.prototype._setGroupCoordinates=function(){var e=this.aLanes.map(Number.prototype.valueOf,0);var o=function(e,o){var t=o._oGroup._oCollapsedByParent||o._oGroup.getCollapsed()?0:1,i=o._oGroup._oParentGroup;if(e===o._oGroup){return t}while(i){if(!i._oCollapsedByParent&&!i.getCollapsed()){t++}if(e===i){break}i=i._oParentGroup}return t};var t=function(e,o){var t=0,i=o._oGroup._oParentGroup;if(e===o._oGroup){return t}while(i){if(!i._oCollapsedByParent&&!i.getCollapsed()){t++}if(e===i){break}i=i._oParentGroup}return t};this.oGraph.getGroups().forEach(function(o){e[o._iLaneIndex]=o._iNestedLevel>e[o._iLaneIndex]?o._iNestedLevel:e[o._iLaneIndex]});this.oGraph.getGroups().forEach(function(i){if(i._iNestedLevel===0){i.setX(this.aLaneCenters[i._iLaneIndex]-this.aLaneWidths[i._iLaneIndex]);i.setY(0)}else if(i._oLastNode&&i._oFirstNode){i._iWidth=this.aLaneWidths[i._iLaneIndex]+(e[i._iLaneIndex]-i._iNestedLevel)*n*2+n*2;i.setX(this.aLaneCenters[i._iLaneIndex]-i._iWidth/2);var r=t(i,i._oLastNode),s=r*(n/2)+n/2,h=o(i,i._oFirstNode),p=h*u;var d=i._oFirstNode.getY()-p,l=i._oLastNode._oGroup.getCollapsed()||i._oLastNode._oGroup._oCollapsedByParent?a:i._oLastNode._iHeight;i.setY(d);i._iHeight=i.getCollapsed()?a:i._oLastNode.getY()+l-d+s}}.bind(this))};G.prototype._setNodesCoordinates=function(){this.aGrid.forEach(function(e){var o=d;e.forEach(function(e){var t=e._oGroup._oCollapsedByParent||e._oGroup;e.setX(this.aLaneCenters[e._iGroupIndex]-e._iWidth/2);o+=e._iStartingGroupCount*u;e.setY(o);o+=s/2;o+=e._iEndingGroupCount*n/2;o+=t.getCollapsed()?a:e._iHeight}.bind(this))}.bind(this))};G.prototype._setLinesCoordinates=function(){var e,o,t,i,r=[],n=[],s=[],a=function(e){var o;if(!e._oGroup){return null}o=e._oGroup;while(o&&o._isCollapsed()){if(!o._oParentGroup||!o._oParentGroup._isCollapsed()){return o}o=o._oParentGroup}return null},u=function(e){var o;if(e._oTopParentGroup===this.oLeftColumn){o=e.getX()+e._iWidth+2*e._getBorderSize()}else{o=e.getX()}return{x:o,y:e.getY()+e._iHeight/2}},h=function(e){var o,t,i;if(e.groupDelegate){e.anchors.forEach(function(o){e.groupDelegate.anchors.push({node:e,line:o.line,oppositeY:o.oppositeY});if(e.isLeftie){s.push(o.line)}});return}o=(e._iHeight-2*f)/(e.anchors.length-1);t=e.anchors.length===1?e.getCenterPosition().y:e.getY()+f;i=t;e.anchors.sort(function(e,o){return e.oppositeY-o.oppositeY}).forEach(function(t){var r=t.line,n=e.getCenterPosition().x;if(e===r.getFromNode()){r.setSource({x:n,y:i})}else if(e===r.getToNode()){r.setTarget({x:n,y:i})}i+=o;if(e.isLeftie){s.push(r)}})},p=function(e){var o=u.bind(this)(e),t=(e._iHeight-2*f)/(e.anchors.length-1),i=e.anchors.length===1?u.bind(this)(e).y:e.getY()+f,r=i;e.anchors.sort(function(e,o){return e.oppositeY-o.oppositeY}).forEach(function(e){var i=e.line;if(e.node===i.getFromNode()){i.setSource({x:o.x,y:r})}else if(e.node===i.getToNode()){i.setTarget({x:o.x,y:r})}r+=t})},d=function(){var e=_*(this.oRightColumn.getX()-(this.oLeftColumn.getX()+this.oLeftColumn._iWidth)),o=this.oGraph.getLines().length-1,t=e/o,i=t<g?t:g,a=(r[0].getCenterPosition().x+n[0].getCenterPosition().x)/2,u=a-o*i/2,h=u,p=u;s.forEach(function(e){if(h>=n[0]._oGroup.getX()-i){h=p}else{h+=i}e.addBend({x:h,y:e.getSource().getY()});e.addBend({x:h,y:e.getTarget().getY()})})}.bind(this);this.oGraph.getNodes().forEach(function(e){if(e._oGroup){if(e._oGroup._oTopParentGroup===this.oLeftColumn){e.isLeftie=true;r.push(e)}else if(e._oGroup._oTopParentGroup===this.oRightColumn){e.isLeftie=false;n.push(e)}}e.groupDelegate=a(e);e.anchors=[]}.bind(this));this.oGraph.getLines().forEach(function(r){e=r.getFromNode();o=r.getToNode();t=e.getCenterPosition();i=o.getCenterPosition();e.anchors.push({line:r,oppositeY:i.y});o.anchors.push({line:r,oppositeY:t.y});r.setSource({x:0,y:0});r.clearBends()});this.oGraph.getGroups().forEach(function(e){e.anchors=[]});r.sort(function(e,o){return e.getY()-o.getY()}).forEach(h);n.sort(function(e,o){return e.getY()-o.getY()}).forEach(h);this.oGraph.getGroups().sort(function(e,o){return e.getY()-o.getY()}).forEach(p.bind(this));d()};return G});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/networkgraph/util/Dijkstra", [],function(){"use strict";function e(e,t,i){this.oGraph=e;this.oSourceNode=t;this.oSettings=Object.assign({fnLineValue:function(){return 1},bIgnoreDirections:false,bIgnoreCollapsed:false},i);this._compute()}e.prototype._compute=function(){var e,t,i,o=[this.oSourceNode],n={},r={},s={},g=this.oSettings.fnLineValue,h=this.oSettings.bIgnoreDirections,u=this.oSettings.bIgnoreCollapsed;function f(e,t){for(var i=0;i<o.length;i++){if(t>r[o[i].getKey()]){o.splice(i,0,e);return}}o.push(e)}function l(t,i){var o=i?t.getFromNode():t.getToNode(),n=o.getKey(),h=r[e.getKey()]+g(t);if(h<r[n]){r[n]=h;s[n]={line:t,reverse:i};f(o,h)}}this.oGraph.getNodes().forEach(function(e){r[e.getKey()]=Number.MAX_VALUE});r[this.oSourceNode.getKey()]=0;while(o.length>0){e=o.shift();if(n[e.getKey()]){continue}if(u&&(e.isHidden()||e.getVisible()===false||e._isIgnored())){continue}n[e.getKey()]=true;t=e.getChildLines();for(i=0;i<t.length;i++){l(t[i],false)}if(h){t=e.getParentLines();for(i=0;i<t.length;i++){l(t[i],true)}}}this.mDist=r;this.mPath=s};e.prototype.getShortestPathTo=function(e){var t=this.mPath[e.getKey()],i=[],o,n;if(t){o=t.reverse?t.line.getFromNode():t.line.getToNode()}while(t&&o!==this.oSourceNode){i.push(t.line);n=t.reverse?t.line.getToNode():t.line.getFromNode();t=this.mPath[n.getKey()];if(t){o=t.reverse?t.line.getFromNode():t.line.getToNode()}}return i};return e},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/Circle", ["sap/suite/ui/commons/statusindicator/Shape","sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/SimpleShape","sap/suite/ui/commons/statusindicator/SimpleShapeRenderer"],function(t,e,i,s){"use strict";var r=i.extend("sap.suite.ui.commons.statusindicator.Circle",{metadata:{library:"sap.suite.ui.commons",properties:{cx:{type:"float",defaultValue:0},cy:{type:"float",defaultValue:0},r:{type:"float",defaultValue:0}}},renderer:s});r.prototype._getSimpleShapeElement=function(t){var i=new e("circle");i.setId(this._buildIdString(t));i.setAttribute("cx",this.getCx());i.setAttribute("cy",this.getCy());i.setAttribute("r",this.getR());i.setAttribute("stroke-width",this.getStrokeWidth());i.setAttribute("stroke",this._getCssStrokeColor());return i};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/CustomShape", ["sap/ui/thirdparty/jquery","../library","sap/suite/ui/commons/statusindicator/ShapeGroup","sap/suite/ui/commons/statusindicator/Shape","sap/suite/ui/commons/statusindicator/Path","sap/suite/ui/commons/statusindicator/Circle","sap/suite/ui/commons/statusindicator/Rectangle","sap/suite/ui/commons/util/HtmlElement","sap/base/Log","./CustomShapeRenderer"],function(jQuery,e,t,i,r,a,o,s,n,p){"use strict";var l=e.statusindicator.FillingType;var u=i.extend("sap.suite.ui.commons.statusindicator.CustomShape",{metadata:{library:"sap.suite.ui.commons",properties:{x:{type:"int",defaultValue:0},y:{type:"int",defaultValue:0},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},strokeColor:{type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},strokeWidth:{type:"float",defaultValue:.25},definition:{type:"string",defaultValue:null}},defaultAggregation:"shapes",aggregations:{shapes:{type:"sap.suite.ui.commons.statusindicator.SimpleShape",multiple:true,defaultValue:null},fillingOptions:{type:"sap.suite.ui.commons.statusindicator.FillingOption",multiple:true,defaultValue:null}}}});u.prototype.init=function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._iDisplayedValue=0;this._initShapeState()};u.prototype.onBeforeRendering=function(){this._refreshInternalStructure()};u.prototype.onAfterRendering=function(){this._updateDom(this.getDisplayedValue())};u.prototype.addFillingOption=function(e){var t=typeof e.getOrder()==="undefined";if(t){n.fatal("The passed FillingOption has to have set its order property.");return this}var i=this.getFillingOptions().length>0&&this.getFillingOptions().filter(function(t){return t.getOrder()===e.getOrder()}).length>0;if(i){n.fatal("The property 'order' has to be unique within the FillingOptions aggregation, but option"+" with order: "+e.getOrder()+" is already inserted. No FillingOption added.");return this}return this.addAggregation("fillingOptions",e,true)};u.prototype._initShapeState=function(){this._aFillableSubShapes=[];this.oDefinition=[];this._sViewBox=null;this.destroyShapes()};u.prototype._refreshInternalStructure=function(){this._initShapeState();this._aFillableSubShapes.forEach(function(e){if(e.fillingOption){e.fillingOption.destroy()}e.shape.destroy()});if(!this.getDefinition()){if(!this.isA("sap.suite.ui.commons.statusindicator.LibraryShape")){n.fatal("Definition has to be specified.")}return}var e=jQuery(this.getDefinition());this._sViewBox=e[0].getAttribute("viewBox");jQuery.map(e.children(),this._preprocessNode.bind(this))};u.prototype._preprocessNode=function(e){var t=jQuery(e),i=t.prop("tagName"),r=this;switch(i){case"g":jQuery.map(t.children(),function(e){return r._preprocessLeafNode.call(r,jQuery(e))});break;default:this._preprocessLeafNode(t)}};u.prototype._preprocessLeafNode=function(e){var t=e.prop("tagName");switch(t){case"path":this._preprocessPathNode(e);break;case"circle":this._preprocessCircleNode(e);break;case"rect":this._preprocessRectangleNode(e);break;case"defs":this._preprocessDefinitionsNode(e[0]);break;default:n.fatal("Unsupported node tag name ('"+t+"')")}};u.prototype._preprocessPathNode=function(e){var t=new r({d:e.attr("d")});this._prepareShape(t,e)};u.prototype._preprocessCircleNode=function(e){var t=new a({cx:Number(e.attr("cx")),cy:Number(e.attr("cy")),r:Number(e.attr("r"))});this._prepareShape(t,e)};u.prototype._preprocessRectangleNode=function(e){var t=new o({x:Number(e.attr("x")),y:Number(e.attr("y")),width:Number(e.attr("width")),height:Number(e.attr("height"))});this._prepareShape(t,e)};u.prototype._preprocessDefinitionsNode=function(e){var t=new s("defs");t.addChild(e.innerHTML);return t};u.prototype._setInitialValue=function(e){this._iDisplayedValue=e};u.prototype.getDisplayedValue=function(){return this._iDisplayedValue};u.prototype._prepareShape=function(e,t){e.setFillingAngle(this.getFillingAngle());e.setStrokeWidth(this.getStrokeWidth());e.setStrokeColor(this.getStrokeColor());this.addShape(e);e._injectAnimationPropertiesResolver(this._oAnimationPropertiesResolver);var i=t.attr("style");if(!i){e.setFillingDirection(this.getFillingDirection());e.setFillColor(this.getFillColor());e.setFillingType(this.getFillingType());var r=t.data("shape-id");var a={shape:e,fillingOption:r?this._getFillingOptionById(r):null};this._aFillableSubShapes.push(a);if(a.fillingOption){this._aFillableSubShapes.sort(function(e,t){var i=e.fillingOption;var r=t.fillingOption;if(!i){return-1}if(!r){return 1}return i.getOrder()-r.getOrder()})}}else{e.setFillingType(l.None);e._setStyle(i)}};u.prototype._updateDom=function(e,t){function i(e){var t=e.fillingOption;return t&&t.getWeight()!==0?t.getWeight():1}n.debug("Updating to "+e,null,this);if(this._aFillableSubShapes.length===0){n.info("Update of DOM skipped. No shape for update found");return}var r=this._aFillableSubShapes.reduce(function(e,t){return e+i(t)},0);try{var a=this;var o=t?e:this._oAnimationPropertiesResolver.getValue(this,e);this._aFillableSubShapes.forEach(function(s){var p=i(s);var l=p/r;var u;if(o===0){u=0}else if(o>=100*l){u=100}else{u=o/l}o-=u*l;if(!t){var h=s.shape.getRenderer();var d=a.getDisplayedFillColor(e);n.debug("Updating color to '"+d+"'",null,s.shape);h._updateDomColor(s.shape,d)}s.shape._updateDom(u,true)})}catch(e){n.fatal("Update of DOM failed. Reason: "+e.message);return}if(!t){this._oAnimationPropertiesResolver.propagateValueChange(this,e);this._oAnimationPropertiesResolver.propagateColorChange(this,e)}this._iDisplayedValue=e};u.prototype._getFillingOptionById=function(e){var t=null;this.getFillingOptions().some(function(i){if(i.getShapeId()===e){t=i;return true}return false});return t};u.prototype._getInternalViewBox=function(){return this._sViewBox};return u});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/CustomShapeRenderer", ["../library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/Renderer"],function(t,e,r){"use strict";var i=r.extend("sap.suite.ui.commons.statusindicator.CustomShapeRenderer");i.apiVersion=2;i.render=function(t,e){var r=this._getHtmlModel(e);r.getRenderer().render(t)};i._getHtmlModel=function(t){var r=new e("svg");r.addControlData(t);r.setAttribute("version","1.1");r.setAttribute("xlmns","http://www.w3.org/2000/svg");var i=t._getInternalViewBox();if(i){r.setAttribute("viewBox",i)}r.setAttribute("preserveAspectRatio",t._buildPreserveAspectRatioAttribute());r.setAttribute("x",t.getX());r.setAttribute("y",t.getY());r.setAttribute("width",t.getWidth());r.setAttribute("height",t.getHeight());t.getShapes().forEach(r.addChild.bind(r));return r};i._updateDomColor=function(t,e){t._aFillableSubShapes.forEach(function(t){var r=t.shape;var i=r.getRenderer();i._updateDomColor(r,e)})};return i},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/DiscreteThreshold", ["sap/ui/core/Control"],function(e){"use strict";var t=e.extend("sap.suite.ui.commons.statusindicator.DiscreteThreshold",{metadata:{library:"sap.suite.ui.commons",properties:{value:{type:"int",defaultValue:0},ariaLabel:{type:"string",defaultValue:null}}},renderer:null});return t});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/FillingOption", ["sap/ui/core/Control","sap/base/Log"],function(t,e){"use strict";var i=t.extend("sap.suite.ui.commons.statusindicator.FillingOption",{metadata:{library:"sap.suite.ui.commons",properties:{shapeId:{type:"string",defaultValue:null},weight:{type:"int",defaultValue:1},order:{type:"int"}}}});i.prototype.setWeight=function(t){if(t<=0){e.fatal("An invalid weight is passed. Weight should be a positive integer. Given: "+t)}this.setProperty("weight",t)};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/LibraryShape", ["./CustomShape","./CustomShapeRenderer","./shapes/ShapeFactory"],function(e,t,a){"use strict";var r=e.extend("sap.suite.ui.commons.statusindicator.LibraryShape",{metadata:{properties:{shapeId:{type:"string",group:"Misc",defaultValue:null}},events:{afterShapeLoaded:{}}},renderer:t});r.prototype.setShapeId=function(e){e=this._getValidShapeId(e);this.setProperty("shapeId",e,true);(new a).getShapeById(e).then(function(e){this.setDefinition(e);this.fireAfterShapeLoaded()}.bind(this));return this};r.prototype._getValidShapeId=function(e){return e.replace(/[\\\.\/]/g,"")};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/Path", ["sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/SimpleShape","sap/suite/ui/commons/statusindicator/SimpleShapeRenderer"],function(t,e,s){"use strict";var i=e.extend("sap.suite.ui.commons.statusindicator.Path",{metadata:{library:"sap.suite.ui.commons",properties:{d:{type:"string",defaultValue:null}}},renderer:s});i.prototype._getSimpleShapeElement=function(e){var s=new t("path");s.setId(this._buildIdString(e));s.setAttribute("d",this.getD());s.setAttribute("stroke-width",this.getStrokeWidth());s.setAttribute("stroke",this._getCssStrokeColor());if(this.aCustomStyleClasses){this.aCustomStyleClasses.forEach(s.addClass.bind(s))}return s};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/PropertyThreshold", ["sap/ui/core/Control","sap/suite/ui/commons/statusindicator/util/ThemingUtil"],function(t,l){"use strict";var e=t.extend("sap.suite.ui.commons.statusindicator.PropertyThreshold",{metadata:{library:"sap.suite.ui.commons",properties:{fillColor:{type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},toValue:{type:"int",defaultValue:0},ariaLabel:{type:"string",defaultValue:null}}},renderer:null});e.prototype._getCssFillColor=function(){if(!this._cssFillColor){this._cssFillColor=l.resolveColor(this.getFillColor())}return this._cssFillColor};return e});
sap.ui.predefine("sap/suite/ui/commons/statusindicator/Rectangle", ["sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/SimpleShape","sap/suite/ui/commons/statusindicator/SimpleShapeRenderer"],function(t,e,i){"use strict";var s=e.extend("sap.suite.ui.commons.statusindicator.Rectangle",{metadata:{properties:{x:{type:"int",defaultValue:0},y:{type:"int",defaultValue:0},rx:{type:"int",defaultValue:0},ry:{type:"int",defaultValue:0},width:{type:"int",defaultValue:0},height:{type:"int",defaultValue:0}}},renderer:i});s.prototype._getSimpleShapeElement=function(e){var i=new t("rect");i.setId(this._buildIdString(e));i.setAttribute("x",this.getX());i.setAttribute("y",this.getY());i.setAttribute("width",this.getWidth());i.setAttribute("height",this.getHeight());i.setAttribute("rx",this.getRx());i.setAttribute("ry",this.getRy());i.setAttribute("stroke-width",this.getStrokeWidth());i.setAttribute("stroke",this._getCssStrokeColor());return i};return s});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/Shape", ["sap/ui/thirdparty/jquery","../library","sap/ui/core/Control","sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/util/ThemingUtil","sap/base/Log"],function(jQuery,t,i,e,n,r){"use strict";var o=t.statusindicator.FillingType;var l=t.statusindicator.FillingDirectionType;var a=t.statusindicator.VerticalAlignmentType;var s=t.statusindicator.HorizontalAlignmentType;var u=i.extend("sap.suite.ui.commons.statusindicator.Shape",{metadata:{abstract:true,library:"sap.suite.ui.commons",properties:{fullAnimationDuration:{type:"int",defaultValue:0},fillColor:{type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},animationOnStartup:{type:"boolean",defaultValue:false},animationOnChange:{type:"boolean",defaultValue:true},animationOnStartupDelay:{type:"int",defaultValue:0},fillingDirection:{type:"sap.suite.ui.commons.statusindicator.FillingDirectionType",defaultValue:l.Up},fillingType:{type:"sap.suite.ui.commons.statusindicator.FillingType",defaultValue:o.Linear},fillingAngle:{type:"int",defaultValue:undefined},verticalAlignment:{type:"sap.suite.ui.commons.statusindicator.VerticalAlignmentType",defaultValue:a.Middle},horizontalAlignment:{type:"sap.suite.ui.commons.statusindicator.HorizontalAlignmentType",defaultValue:s.Middle}}},renderer:null});u.prototype.GRADIENT_ID="gradient";u.prototype.STOP_ID="stop";u.prototype.getDisplayedValue=function(){r.fatal("Must be overridden!")};u.prototype._setInitialValue=function(t){r.fatal("Must be overridden!")};u.prototype._updateDom=function(t,i){r.fatal("Must be overridden!")};u.prototype.init=function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._oAnimationPropertiesResolver=null};u.prototype.onBeforeRendering=function(){if(i.prototype.onBeforeRendering){i.prototype.onBeforeRendering.apply(this,arguments)}this._clearBoundingBox()};u.prototype._getCssFillColor=function(){return n.resolveColor(this.getFillColor())};u.prototype._resolveFillColor=function(){return this._oAnimationPropertiesResolver.getColor(this,this.getDisplayedValue())};u.prototype._injectAnimationPropertiesResolver=function(t){this._oAnimationPropertiesResolver=t};u.prototype.getDisplayedFillColor=function(t){return this._oAnimationPropertiesResolver.getColor(this,t)};u.prototype.getFullAnimationDuration=function(){return 250};u.prototype._buildPreserveAspectRatioAttribute=function(){var t="x";switch(this.getHorizontalAlignment()){case s.Left:t+="Min";break;case s.Middle:t+="Mid";break;case s.Right:t+="Max";break}t+="Y";switch(this.getVerticalAlignment()){case a.Top:t+="Min";break;case a.Middle:t+="Mid";break;case a.Bottom:t+="Max";break}t+=" meet";return t};u.prototype._getGradientElement=function(t){var i=new e(this.getFillingType()===o.Linear?"linearGradient":"radialGradient");i.setId(this._buildIdString(this.getId(),this.GRADIENT_ID));if(this.getFillingType()===o.Linear){var n=this.computeLinearFillingAngle();i.setAttribute("x1",n===90?1:0);i.setAttribute("y1",n===0?1:0);i.setAttribute("x2",n===270?1:0);i.setAttribute("y2",n===180?1:0)}var r=this._getDisplayedGradientOffset(t);var l=new e(this.STOP_ID);l.setAttribute("offset",r);l.setAttribute("stop-color","white");i.addChild(l);var a=new e(this.STOP_ID);a.setAttribute("offset",r);a.setAttribute("stop-color","transparent");i.addChild(a);return i};u.prototype.getPolygonElement=function(t){var i=new e("polygon");i.setId(this._buildIdString(this.getId(),"polygon"));i.setAttribute("fill","white");return i};u.prototype.computeLinearFillingAngle=function(){if(this.getFillingAngle()!==undefined){return this._getNormalizedFillingAngle()}switch(this.getFillingDirection()){case l.Up:return 0;case l.Down:return 180;case l.Left:return 90;case l.Right:return 270;default:r.error("Unknown FillingDirection '"+this.getFillingDirection()+"'");return 0}};u.prototype._useGradientForAnimation=function(){var t=this._getNormalizedFillingAngle();var i=this.getFillingType();return i===o.Radial||i===o.Linear&&(t===undefined||[0,90,180,270].indexOf(t)>-1)};u.prototype._getPolygonPoints=function(t){var i;switch(this.getFillingType()){case o.Linear:i=this._getPolygonPointsForLinearFilling(t);break;case o.Circular:i=this._getPolygonPointsForCircularFilling(t);break;default:r.error("Unknown FillingType '"+this.getFillingType()+"' given.");i=this._getPolygonPointsForLinearFilling(t)}i=i.map(function(t){t.x=Number(t.x.toFixed(3));t.y=Number(t.y.toFixed(3));return t});return i};u.prototype._getPolygonPointsForLinearFilling=function(t){var i=180-this._getNormalizedFillingAngle();var e=Math.tan(i*Math.PI/180);var n=this._getBoundingPoints();var r=n.start;var o=n.end;var l=r.y-e*r.x;var a=o.y-e*o.x;var s=l+(a-l)/100*t;var u=r.x;var g=u*e+s;var p=r.y;var d=(p-s)/e;var h=[r,{x:u,y:g},{x:d,y:p}];return h};u.prototype._getPolygonPointsForCircularFilling=function(t){var i=this,e=3.6*t,n=this._getBoundingBox(),r=[];var o,a,s;var u=g(n.x+n.width/2,n.y);var p=g(n.x+n.width/2,n.y+n.height/2);function d(t){var e=Object.assign({},t);if(i.getFillingDirection()===l.CounterClockwise){var n=t.x-p.x;e.x=p.x-n}return e}function h(t,i,e){var n=Math.tan((i-t)*Math.PI/180);return n*e/2}r.push(u);if(0<e&&e<45){o=h(e,0,n.height);s=g(u.x-o,u.y);r.push(d(s))}if(45<=e){r.push(d(g(n.x+n.width,n.y)))}if(45<e&&e<135){a=h(e,90,n.width);s=g(n.x+n.width,n.y+n.height/2-a);r.push(d(s))}if(135<=e){r.push(d(g(n.x+n.width,n.y+n.height)))}if(135<e&&e<225){o=h(e,180,n.height);s=g(n.x+n.width/2+o,n.y+n.height);r.push(d(s))}if(225<=e){r.push(d(g(n.x,n.y+n.height)))}if(225<e&&e<315){a=h(e,270,n.width);s=g(n.x,n.y+n.height/2+a);r.push(d(s))}if(315<=e){r.push(d(g(n.x,n.y)))}if(315<e&&e<=360){o=h(e,360,n.height);s=g(n.x+n.width/2-o,n.y);r.push(d(s))}r.push(p);return r};u.prototype._isFillingAngleInFirstQuadrant=function(){var t=this._getNormalizedFillingAngle();return 0<t&&t<90};u.prototype._isFillingAngleInSecondQuadrant=function(){var t=this._getNormalizedFillingAngle();return 90<t&&t<180};u.prototype._isFillingAngleInThirdQuadrant=function(){var t=this._getNormalizedFillingAngle();return 180<t&&t<270};u.prototype._isFillingAngleInForthQuadrant=function(){var t=this._getNormalizedFillingAngle();return 270<t&&t<360};u.prototype._getBoundingPoints=function(){var t=this._getBoundingBox();var i=t.x+t.width;var e=t.y+t.height;var n=t.x;var o=t.y;if(this._isFillingAngleInFirstQuadrant()){}else if(this._isFillingAngleInSecondQuadrant()){i=t.x+t.width;e=t.y;n=t.x;o=t.y+t.height}else if(this._isFillingAngleInThirdQuadrant()){i=t.x;e=t.y;n=t.x+t.width;o=t.y+t.height}else if(this._isFillingAngleInForthQuadrant()){i=t.x;e=t.y+t.height;n=t.x+t.width;o=t.y}else{r.error("Invalid call of _getBoundingPoints. FillingAngle '"+this.getFillingAngle()+"' is not in any quadrant")}return{start:g(i,e),end:g(n,o)}};u.prototype._getBoundingBox=function(){if(!this._oBoundingBox){this._oBoundingBox=this.$()[0].getBBox()}return this._oBoundingBox};u.prototype._clearBoundingBox=function(){this._oBoundingBox=null};u.prototype._getNormalizedFillingAngle=function(){if(this.getFillingAngle()===undefined){return this.getFillingAngle()}var t=this.getFillingAngle()%360;if(t<0){t+=360}return t};u.prototype.isFillable=function(){return this.getFillingType()!==o.None};u.prototype._getDisplayedGradientOffset=function(t){if(this.isFillable()){var i=t/100;return i}else{return 1}};u.prototype._getMaskElement=function(t){var i=new e("mask");i.setId(t);if(this._useGradientForAnimation()){var n=this._getSimpleShapeElement(this._buildIdString(this.getId(),"mask-shape"));n.setAttribute("stroke-width",0);n.setAttribute("stroke","white");n.setAttribute("fill",this._buildSvgUrlString(this.getId(),this.GRADIENT_ID));i.addChild(n)}else{i.addChild(this.getPolygonElement(this._iDisplayedValue))}return i};u.prototype._buildSvgUrlString=function(){return"url(#"+this._buildIdString.apply(this,arguments)+")"};u.prototype._buildIdString=function(){var t=jQuery.makeArray(arguments).join("-");return t};function g(t,i){return{x:t,y:i}}return u});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/ShapeGroup", ["sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/Configuration","sap/suite/ui/commons/statusindicator/util/ProgressHandler","sap/base/Log"],function(e,t,i,r,a){"use strict";var o=e.extend("sap.suite.ui.commons.statusindicator.ShapeGroup",{metadata:{library:"sap.suite.ui.commons",properties:{weight:{type:"int",defaultValue:10}},defaultAggregation:"shapes",aggregations:{shapes:{type:"sap.suite.ui.commons.statusindicator.Shape",multiple:true}}},renderer:null});o.prototype.init=function(){this._iTargetValue=0;this._oAnimationPropertiesResolver=null;this._iLastDirectValueUpdate=0};o.prototype.discreteThresholdsChangeHandler=function(e){var t=this._oAnimationPropertiesResolver._getGroupValue(this,e);if(t!==this._iLastDirectValueUpdate){this.getShapes().forEach(function(e){e._updateDom(t,true)});this._iLastDirectValueUpdate=t}};o.prototype.propertyThresholdsChangeHandler=function(e){this.getShapes().forEach(function(t){if(t.getDisplayedValue()!==0){t.getRenderer()._updateDomColor(t,e)}})};o.prototype._injectAnimationPropertiesResolver=function(e){this._oAnimationPropertiesResolver=e;this._oAnimationPropertiesResolver.addDiscreteThresholdChange(this.discreteThresholdsChangeHandler.bind(this));this._oAnimationPropertiesResolver.addPropertyThresholdChange(this.propertyThresholdsChangeHandler.bind(this));this.getShapes().forEach(function(t){t._injectAnimationPropertiesResolver(e)})};o.prototype.addShape=function(e){this.addAggregation("shapes",e,true);e._injectAnimationPropertiesResolver(this._oAnimationPropertiesResolver);return this};o.prototype._setValue=function(e,t){var i=this;t=t||false;this._iTargetValue=e;if(!this._isAnimationAllowed()||t){this.getShapes().forEach(function(e){e._updateDom(i._iTargetValue)});return Promise.resolve()}this.getShapes().forEach(function(e){if(!e.getAnimationOnChange()){e._updateDom(i._iTargetValue)}});if(this.oCurrentProgressHandler&&this.oCurrentProgressHandler.isInProgress()){this.oCurrentProgressHandler.cancel()}this.oCurrentProgressHandler=new r(function(e){var t=performance.now();i._animationStep(t,e,t)});return this.oCurrentProgressHandler.start()};o.prototype._animationStep=function(e,t,i){a.debug("AnimationStep at time: "+i.toString(10),null,this);i=Math.max(i,e);if(t.isCanceled()){t.stop({cancelled:true});return}var r=true;var o=this._iTargetValue;this.getShapes().forEach(function(t){var a=t.getDisplayedValue();if(a===o){return}var n=e+t.getFullAnimationDuration()*Math.abs(o-a)/100;var s=o;if(i<n){var u=o-a;var h=n-e;var p=(i-e)/h;s=u*p+a;r=false}t._updateDom(s)});if(r){t.finish()}else{window.requestAnimationFrame(this._animationStep.bind(this,i,t))}};o.prototype._showsFullProgress=function(){return!this.getShapes().some(function(e){return e.getDisplayedValue()!==100})};o.prototype._setInitialValue=function(e){this._iTargetValue=e;this._iLastDirectValueUpdate=e;this.getShapes().forEach(function(t){t._setInitialValue(e)})};o.prototype._isAnimationAllowed=function(){var e=t.getConfiguration();var r=e.getAnimationMode();return r!==i.AnimationMode.none};return o});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/SimpleShape", ["../library","sap/ui/core/Control","sap/suite/ui/commons/statusindicator/Shape","sap/suite/ui/commons/statusindicator/util/ThemingUtil","sap/base/Log","./SimpleShapeRenderer"],function(e,t,i,o,r,s){"use strict";var a=i.extend("sap.suite.ui.commons.statusindicator.SimpleShape",{metadata:{abstract:true,library:"sap.suite.ui.commons",properties:{strokeWidth:{type:"float",defaultValue:.25},strokeColor:{type:"sap.m.ValueCSSColor",defaultValue:"Neutral"}}}});a.prototype._getSimpleShapeElement=function(){r.fatal("Must be overriden!")};a.prototype.init=function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._iDisplayedValue=0;this._sViewBox=null};a.prototype.onBeforeRendering=function(){if(i.prototype.onBeforeRendering){i.prototype.onBeforeRendering.apply(this,arguments)}this.getRenderer()._clearDomReferences(this)};a.prototype._updateDom=function(e,t){r.debug("Updating to "+e,null,this);var i=this.getRenderer();if(!t){var o=this.getDisplayedFillColor(e);i._updateDomColor(this,o);this._oAnimationPropertiesResolver.propagateColorChange(this,e)}var s=t?e:this._oAnimationPropertiesResolver.getValue(this,e);if(this._useGradientForAnimation()){i._updateDomGradient(this,s)}else{i._updateDomPolygon(this,s)}if(!t){this._oAnimationPropertiesResolver.propagateValueChange(this,e);this._iDisplayedValue=e}};a.prototype.getDisplayedValue=function(){return this._iDisplayedValue};a.prototype._setInitialValue=function(e){this._iDisplayedValue=e};a.prototype._setStyle=function(e){this._sStyleAttribute=e};a.prototype._setInternalViewBox=function(e){this._sViewBox=e};a.prototype._getInternalViewBox=function(){return this._sViewBox};a.prototype._getCssStrokeColor=function(){return o.resolveColor(this.getStrokeColor())};return a});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/SimpleShapeRenderer", ["../library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/Renderer"],function(t,e,i){"use strict";var r=t.statusindicator.FillingType;var n=i.extend("sap.suite.ui.commons.statusindicator.SimpleShapeRenderer");n.apiVersion=2;n.render=function(t,e){var i=this._getHtmlModel(e);i.getRenderer().render(t)};n._getHtmlModel=function(t){var i=t._buildIdString(t.getId(),"mask");var n=new e("svg");n.setAttribute("xlmns","http://www.w3.org/2000/svg");var o=t._getInternalViewBox();if(o){n.setAttribute("viewBox",o)}n.setAttribute("preserveAspectRatio",t._buildPreserveAspectRatioAttribute());n.setAttribute("overflow","visible");n.addControlData(t);var l=new e("defs");if(t.getFillingType()!==r.None){if(t._useGradientForAnimation()){l.addChild(t._getGradientElement(t._iDisplayedValue))}var s=t._getMaskElement(i);l.addChild(s);n.addChild(l)}var a=t._buildIdString(t.getId(),"shape");var d=t._getSimpleShapeElement(a);d.setAttribute("fill",t._resolveFillColor());d.setAttribute("mask",t._buildSvgUrlString(i));if(t._sStyleAttribute){d.setAttribute("style",t._sStyleAttribute)}d.setAttribute("stroke-width",0);n.addChild(d);var u=t._getSimpleShapeElement(t._buildIdString(a,"border"));u.setAttribute("fill","transparent");n.addChild(u);return n};n._updateDomColor=function(t,e){t.$("shape").attr("fill",e)};n._updateDomGradient=function(t,e){if(!t.$stopNodes){t.$stopNodes=t.$(t.GRADIENT_ID).find(t.STOP_ID)}t.$stopNodes.attr("offset",t._getDisplayedGradientOffset(e))};n._updateDomPolygon=function(t,e){if(!t.$polygon){t.$polygon=t.$("polygon")}var i=t._getPolygonPoints(e).reduce(function(t,e){return t+e.x+","+e.y+" "},"");t.$polygon.attr("points",i)};n._clearDomReferences=function(t){t.$polygon=null;t.$stopNodes=null};return n},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/StatusIndicator", ["../library","sap/m/library","sap/ui/core/Control","sap/ui/core/Core","sap/suite/ui/commons/statusindicator/util/AnimationPropertiesResolver","sap/suite/ui/commons/statusindicator/util/ThemingUtil","sap/m/Text","sap/base/Log","./StatusIndicatorRenderer"],function(e,t,r,o,s,i,a,u,n){"use strict";var l=e.statusindicator.SizeType;var h=e.statusindicator.LabelPositionType;var p=t.ValueColor;var d=r.extend("sap.suite.ui.commons.statusindicator.StatusIndicator",{metadata:{library:"sap.suite.ui.commons",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension"},height:{type:"sap.ui.core.CSSSize",group:"Dimension"},value:{type:"int",defaultValue:0},viewBox:{type:"string",defaultValue:null},ariaLabel:{type:"string",defaultValue:null},size:{type:"sap.suite.ui.commons.statusindicator.SizeType",defaultValue:l.None},labelPosition:{type:"sap.suite.ui.commons.statusindicator.LabelPositionType",defaultValue:h.Left},showLabel:{type:"boolean",defaultValue:false}},defaultAggregation:"groups",aggregations:{groups:{type:"sap.suite.ui.commons.statusindicator.ShapeGroup",multiple:true},propertyThresholds:{type:"sap.suite.ui.commons.statusindicator.PropertyThreshold",multiple:true},discreteThresholds:{type:"sap.suite.ui.commons.statusindicator.DiscreteThreshold",multiple:true},label:{type:"sap.m.Text",multiple:false}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}}});d.prototype.init=function(){if(r.prototype.init){r.prototype.init.apply(this,arguments)}this._sortedPropertyThresholds=[];this._sortedDiscreteThresholds=[];this._bStarted=false;this._oCurrentAnimationPromise=null;this._oAnimationPropertiesResolver=new s(this);this._oDefaultLabel=null;if(!sap.ui.getCore().isInitialized()){sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this))}else{this._handleCoreInitialized()}};d.prototype._handleCoreInitialized=function(){sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this)};d.prototype._handleThemeApplied=function(){this.invalidate()};d.prototype._internalIds=Object.freeze({svgNodeId:"svg"});d.prototype.getLabel=function(){var e=this.getAggregation("label");if(e!==null){return e}if(this._oDefaultLabel!==null){return this._oDefaultLabel}this._oDefaultLabel=new a(this.getId()+"-label");this.addDependent(this._oDefaultLabel);return this._oDefaultLabel};d.prototype.addPropertyThreshold=function(e){this.addAggregation("propertyThresholds",e,true);if(this._sortedPropertyThresholds.filter(function(t){return t.getToValue()===e.getToValue()}).length>0){u.fatal("There are two or more property thresholds with the same toValue in thresholds "+"aggregation. The last threshold from them has the highest priority")}this._sortedPropertyThresholds.push(e);this._sortedPropertyThresholds.sort(function(e,t){return e.getToValue()-t.getToValue()});return this};d.prototype.addDiscreteThreshold=function(e){this.addAggregation("discreteThresholds",e,true);if(this._sortedDiscreteThresholds.filter(function(t){return t.getValue()===e.getValue()}).length>0){u.fatal("There are two or more discrete thresholds with the same value in thresholds "+"aggregation. The last threshold from them has the highest priority")}this._sortedDiscreteThresholds.push(e);this._sortedDiscreteThresholds.sort(function(e,t){return e.getValue()-t.getValue()});return this};d.prototype._discreteThresholdsEnabled=function(){return this._sortedDiscreteThresholds.length>0};d.prototype._getDiscreteThresholdForValue=function(e){var t=null;this._sortedDiscreteThresholds.every(function(r){if(e>=r.getValue()){t=r;return true}return false});return t};d.prototype._propertyThresholdsEnabled=function(){return this._sortedPropertyThresholds.length>0};d.prototype._getPropertyThresholdForValue=function(e){var t=null;this._sortedPropertyThresholds.some(function(r){if(e<=r.getToValue()){t=r;return true}return false});return t};d.prototype._getFullId=function(e){return this.getId()+"-"+e};d.prototype.onBeforeRendering=function(){var e=this;this.getGroups().forEach(function(t){t._injectAnimationPropertiesResolver(e._oAnimationPropertiesResolver)})};d.prototype.onAfterRendering=function(){this._setValueToLabel(this.getValue());this._start()};d.prototype._start=function(){this._bStarted=true;this._propagateValueToGroups()};d.prototype._shouldInvertGroupUpdateOrder=function(e){var t;e.some(function(e,r){t=r;return e.newValue!==100});var r;this.getGroups().some(function(e,t){r=t;return!e._showsFullProgress()});return t<r};d.prototype._propagateValueToGroups=function(){var e=this.getSize()===l.Small;var t=this._computeGroupValueDistribution();var r=this._shouldInvertGroupUpdateOrder(t);if(r){t=t.reverse()}this._updateAccessibilityDOM();this._oCurrentAnimationPromise=t.reduce(function(t,r){return t.then(function(t){if(t&&t.cancelled){u.debug("Group animation cancelled.");return t}else{return r.group._setValue(r.newValue,e)}})},Promise.resolve());return this._oCurrentAnimationPromise};d.prototype._computeGroupValueDistribution=function(){var e=this.getValue();var t=this._getTotalWeight();return this.getGroups().map(function(r){var o=r.getWeight()/t;var s;if(e===0){s=0}else if(e>=100*o){s=100}else{s=e/o}e-=s*o;return{group:r,newValue:Number(s.toFixed(3))}})};d.prototype.setValue=function(e){e=Math.round(e);if(e>100){e=100}if(e<0){e=0}this.setProperty("value",e,true);this._setValueToLabel(e);if(this._bStarted){this._propagateValueToGroups()}return this};d.prototype._setValueToLabel=function(e){var t=this.getLabel();var r;t.setText(Math.floor(e)+"%");r=i.resolveColor(p.Neutral);if(this._propertyThresholdsEnabled()){var o=this._getPropertyThresholdForValue(e);if(o){r=o._getCssFillColor()}}var s=t.$();if(s){s.css("color",r)}};d.prototype._getTotalWeight=function(){return this.getGroups().reduce(function(e,t){return e+t.getWeight()},0)};d.prototype.ontap=d.prototype.firePress;d.prototype.onsapenter=d.prototype.firePress;d.prototype.onsapspace=d.prototype.firePress;d.prototype._getGroupShapes=function(){return this.getGroups().reduce(function(e,t){return e.concat(t.getShapes())},[])};d.prototype._updateAccessibilityDOM=function(){var e=this.getValue();this.$().attr("aria-valuenow",e);this.$().attr("aria-valuetext",this._createValueTextMessage(e))};d.prototype._createValueTextMessage=function(e){var t=null;var r=null;var o=null;var s=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");if(this._discreteThresholdsEnabled()){var i=this._getDiscreteThresholdForValue(e);if(i){t=i.getAriaLabel();r=true}else{t=this._sortedDiscreteThresholds[0].getAriaLabel();r=false}}if(this._propertyThresholdsEnabled()){var a=this._getPropertyThresholdForValue(e);if(a){o=a.getAriaLabel()}}var u;if(t){if(o){if(r){u=s.getText("STATUS_INDICATOR_VALUE_ABOVE_THRESHOLD_COLOR",[e,t,o])}else{u=s.getText("STATUS_INDICATOR_VALUE_BELOW_THRESHOLD_COLOR",[e,t,o])}}else{if(r){u=s.getText("STATUS_INDICATOR_VALUE_ABOVE_THRESHOLD",[e,t])}else{u=s.getText("STATUS_INDICATOR_VALUE_BELOW_THRESHOLD",[e,t])}}}else if(o){u=s.getText("STATUS_INDICATOR_VALUE_COLOR",[e,o])}else{u=s.getText("STATUS_INDICATOR_VALUE",[e])}return u};return d});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/StatusIndicatorRenderer", ["../library","sap/ui/core/library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/Renderer","sap/base/Log"],function(e,t,a,i,s){"use strict";var r=e.statusindicator.SizeType;var o=e.statusindicator.LabelPositionType;var n=t.TextAlign;var d=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");function u(e,t){var a="";t=typeof t==="string"?t:"";switch(e.getSize()){case r.Small:a="sapSuiteUiCommonsStatusIndicatorSmall";break;case r.Medium:a="sapSuiteUiCommonsStatusIndicatorMedium";break;case r.Large:a="sapSuiteUiCommonsStatusIndicatorLarge";break;case r.ExtraLarge:a="sapSuiteUiCommonsStatusIndicatorExtraLarge";break;case r.None:break;default:s.error("Unknown size. Expecting size defined in sap.suite.ui.commons.statusindicator.SizeType,"+" but '"+e.getSize()+"' given.");a="sapSuiteUiCommonsStatusIndicatorSmall"}if(a){return a+t}else{return""}}function l(e){var t=e.getLabelPosition();var a=e.getSize();return"sapSuiteUiCommonsStatusIndicator"+a+t+"Label"}var S=i.extend("sap.suite.ui.commons.StatusIndicatorRenderer");S.apiVersion=2;S.render=function(e,t){var a=this._getHtmlModel(t);a.getRenderer().render(e)};S._getHtmlModel=function(e){var t=e.getLabelPosition();var i=t===o.Left||t===o.Right,s=t===o.Left||t===o.Top;var r=new a("div");r.addControlData(e);r.addClass("sapSuiteUiCommonsStatusIndicator");r.setAttribute("role","progressbar");r.setAttribute("aria-roledescription",d.getText("STATUS_INDICATOR_ARIA_ROLE_DESCRIPTION"));var S=e.getAriaLabel();r.setAttribute("aria-label",S?S:d.getText("STATUS_INDICATOR_ARIA_LABEL"),true);var g=e.getAriaLabelledBy();if(g&&g.length>0){r.setAttribute("aria-labelledby",g.join(" "),true)}var m=e.getAriaDescribedBy();if(m&&m.length>0){r.setAttribute("aria-describedby",m.join(" "),true)}r.setAttribute("tabindex","0");r.setAttribute("aria-valuemin",0);r.setAttribute("aria-valuemax",100);if(i){r.addClass("sapSuiteUiCommonsStatusIndicatorHorizontal")}else{r.addClass("sapSuiteUiCommonsStatusIndicatorVertical")}if(e.getShowLabel()){var c=new a("div");if(s){c.addClass("sapSuiteUiCommonsStatusIndicatorLabelBeforeSvg")}else{c.addClass("sapSuiteUiCommonsStatusIndicatorLabelAfterSvg")}var b=e.getLabel();b.addStyleClass("sapSuiteUiCommonsStatusIndicatorLabel");b.addStyleClass(u(e,"Label"));b.addStyleClass(l(e));b.setTextAlign(i?n.Left:n.Center);c.addChild(b);r.addChild(c)}var v=new a("div");v.setAttribute("focusable",false);v.addClass("sapSuiteUiCommonsStatusIndicatorSvg");v.addClass(u(e,"Svg"));v.addStyle("width",e.getWidth());v.addStyle("height",e.getHeight());v.addChild(this._getSvgElement(e));r.addChild(v);return r};S._getSvgElement=function(e){var t=new a("svg");t.setId(e._getFullId(e._internalIds.svgNodeId));t.setAttribute("version","1.1");t.setAttribute("xlmns","http://www.w3.org/2000/svg");t.setAttribute("preserveAspectRatio","xMidYMid meet");t.addStyle("width","100%");t.addStyle("height","100%");t.setAttribute("focusable",false);if(e.getViewBox()){t.setAttribute("viewBox",e.getViewBox())}e._getGroupShapes().forEach(function(e){t.addChild(e)});return t};return S},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/statusindicator/shapes/ShapeFactory", ["sap/ui/base/Object","sap/ui/thirdparty/jquery"],function(e,jQuery){"use strict";var t={};var a=e.extend("sap.suite.ui.commons.statusindicator.shapes.ShapeFactory");a.prototype.getShapeById=function(e){var t=this._getLoadedShapes(),a=t[e]||null;if(!a){return new Promise(function(a,o){jQuery.ajax({url:sap.ui.require.toUrl("sap/suite/ui/commons/statusindicator")+"/shapes/"+e+".svg",dataType:"text"}).done(function(o){t[e]=o;a(o)}).fail(function(e){o(e)})})}return Promise.resolve(a)};a.prototype._getLoadedShapes=function(){return t};a.prototype._removeAllLoadedShapes=function(){t={}};return a});
sap.ui.predefine("sap/suite/ui/commons/statusindicator/util/AnimationPropertiesResolver", ["sap/suite/ui/commons/statusindicator/Shape","sap/suite/ui/commons/statusindicator/ShapeGroup","sap/suite/ui/commons/statusindicator/CustomShape","sap/base/Log"],function(t,e,r,a){"use strict";var o=function(t){this._oStatusIndicator=t;this.aOnDiscreteThresholdChange=[];this.aOnPropertyThresholdChange=[]};o.prototype.addDiscreteThresholdChange=function(t){this.aOnDiscreteThresholdChange.push(t)};o.prototype.addPropertyThresholdChange=function(t){this.aOnPropertyThresholdChange.push(t)};o.prototype.getValue=function(t,r){var o=t.getParent();if(!o instanceof e){a.fatal("Shape should be always direct child of ShapeGroup.");return r}if(!this._oStatusIndicator._discreteThresholdsEnabled()){return r}return this._getGroupValue(o,this._getCappedValue(o,r))};o.prototype._getCappedValue=function(t,e){var r=this._getStatusIndicatorValue(t,e);var a=this._oStatusIndicator._getDiscreteThresholdForValue(r);return a?a.getValue():0};o.prototype.propagateValueChange=function(t,e){if(!this._oStatusIndicator._discreteThresholdsEnabled()){return}var r=t.getParent();var a=this._getCappedValue(r,t.getDisplayedValue());var o=this._getCappedValue(r,e);if(a!==o){this.aOnDiscreteThresholdChange.forEach(function(t){t(o)})}};o.prototype.getColor=function(t,e){var a=t.getParent();if(a instanceof r){e=a.getDisplayedValue();a=a.getParent()}var o=this._getStatusIndicatorSliderValue();var i=t._getCssFillColor();if(this._oStatusIndicator._propertyThresholdsEnabled()){var s=this._oStatusIndicator._getPropertyThresholdForValue(o);if(s){i=s._getCssFillColor()}}return i};o.prototype.propagateColorChange=function(t,e){if(!this._oStatusIndicator._propertyThresholdsEnabled()){return}var r=t.getParent();var a=this._getPropertyThreshold(r,e);var o=this._getPropertyThreshold(r,t.getDisplayedValue());if(a!==o){this.aOnPropertyThresholdChange.forEach(function(t){t(a._getCssFillColor())})}};o.prototype._getPropertyThreshold=function(t,e){var r=this._getStatusIndicatorValue(t,e);return this._oStatusIndicator._getPropertyThresholdForValue(r)};o.prototype._getStatusIndicatorValue=function(t,e){var r=this;var a=this._oStatusIndicator.getGroups();var o=0;a.some(function(a){var i=a.getWeight()/r._getTotalWeight();if(a!==t){var s=100*i;o+=s;return false}var n=e*i;o+=n;return true});return Number(o.toPrecision(3))};o.prototype._getStatusIndicatorSliderValue=function(){var t=0;if(this._oStatusIndicator){t=this._oStatusIndicator.getValue()}return t};o.prototype._getGroupValue=function(t,e){var r=this._oStatusIndicator.getGroups();var a=this._getTotalWeight();var o=0;r.some(function(r){var i=r.getWeight()/a;var s;if(e===0){s=0}else if(e>=100*i){s=100}else{s=e/i}e-=s*i;if(t!==r){return false}o=s;return true});return o};o.prototype._getTotalWeight=function(){return this._oStatusIndicator.getGroups().reduce(function(t,e){return t+e.getWeight()},0)};return o});
sap.ui.predefine("sap/suite/ui/commons/statusindicator/util/ProgressHandler", [],function(){"use strict";var s=function(s){var e=this;this._fnResolveCallback=null;this._oPromise=null;this._bInProgress=false;this._fnProgress=s;this._oInnerProgressHandler={finish:function(){e.finish()},stop:function(s){e.stop(s)},isCanceled:function(){return e.isCanceled()}}};s.prototype.start=function(){var s=this;if(this._oPromise){return this._oPromise}this._oPromise=new Promise(function(e,n){s._fnResolveCallback=e;s._bInProgress=true;s._fnProgress(s._oInnerProgressHandler)});return this._oPromise};s.prototype.finish=function(){this._bInProgress=false;if(this._fnResolveCallback){this._fnResolveCallback();this._fnResolveCallback=null}};s.prototype.stop=function(s){this._bInProgress=false;if(this._fnResolveCallback){this._fnResolveCallback(s);this._fnResolveCallback=null}};s.prototype.cancel=function(){this._bCancelled=true};s.prototype.isCanceled=function(){return this._bCancelled};s.prototype.isInProgress=function(){return this._bInProgress};return s},true);
sap.ui.predefine("sap/suite/ui/commons/statusindicator/util/ThemingUtil", ["sap/ui/core/theming/Parameters","sap/m/library","sap/ui/core/library"],function(r,e,t){"use strict";var a=e.ValueColor;var o=t.CSSColor;var i=function(){throw new Error};i.resolveColor=function(e){if(o.isValid(e)){return e}switch(e){case a.Good:return r.get("sapPositiveColor");case a.Error:return r.get("sapNegativeColor");case a.Critical:return r.get("sapCriticalColor");case a.Neutral:return r.get("sapNeutralColor");default:return r.get(e)}};return i},true);
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccount", ["sap/suite/ui/commons/library","sap/ui/Device","sap/ui/core/Control","sap/ui/core/delegate/ItemNavigation","./TAccountGroup","./TAccountPanel","sap/ui/core/IconPool","sap/ui/core/Icon","sap/ui/core/InvisibleText","sap/base/security/encodeXML","./TAccountUtils","sap/suite/ui/commons/Utils","sap/ui/thirdparty/bignumber","sap/ui/core/date/UI5Date","sap/ui/thirdparty/jqueryui/jquery-ui-core","sap/ui/thirdparty/jqueryui/jquery-ui-widget","sap/ui/thirdparty/jqueryui/jquery-ui-mouse","sap/ui/thirdparty/jqueryui/jquery-ui-draggable","sap/ui/thirdparty/jqueryui/jquery-ui-droppable","sap/ui/thirdparty/jqueryui/jquery-ui-selectable"],function(t,e,i,o,n,s,a,r,p,u,c,d,l,g){"use strict";var m=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var h=Object.freeze({UP:"UP",DOWN:"DOWN",PREVIOUS:"PREVIOUS",NEXT:"NEXT"});var f=e.os.macintosh?"metaKey":"ctrlKey";var C=i.extend("sap.suite.ui.commons.taccount.TAccount",{metadata:{library:"sap.suite.ui.commons",properties:{measureOfUnit:{type:"string",group:"Misc",defaultValue:""},collapsed:{type:"boolean",group:"Misc",defaultValue:false},title:{type:"string",group:"Misc",defaultValue:null},subtitle:{type:"string",group:"Misc",defaultValue:null},orderBy:{type:"string",group:"Misc",defaultValue:""},opening:{type:"boolean",group:"Misc",defaultValue:false},openingDebit:{type:"any",group:"Misc",defaultValue:0},openingCredit:{type:"any",group:"Misc",defaultValue:0}},aggregations:{debit:{type:"sap.suite.ui.commons.taccount.TAccountItem",multiple:true,singularName:"debit"},credit:{type:"sap.suite.ui.commons.taccount.TAccountItem",multiple:true,singularName:"credit"}}},renderer:{apiVersion:2,render:function(t,e){var i=function(e,i){e.forEach(function(o,n){o._bIsDebit=i;o._index=n+1;o._indexSize=e.length;t.renderControl(o)})};var o=function(i){var o=e.getOrderBy();i.forEach(function(t){var e=t.getProperties();t._sOrderBy="";for(var i=0;i<e.length;i++){if(e[i].getKey().toLowerCase()===o.toLowerCase()){t._sOrderBy=e[i].getValue();break}}});i.sort(function(t,e){return g.getInstance(t._sOrderBy)>=g.getInstance(e._sOrderBy)?1:-1});e._setItemsAttrs(i);i.forEach(function(e){t.renderControl(e.addStyleClass(e._bIsDebit?"sapSuiteUiCommonsAccountItemLeft":"sapSuiteUiCommonsAccountItemRight"))})};var n=e._getPanel();var s=function(t){var i=t?e.getDebit():e.getCredit(),o=new l(t?e.getOpeningDebit():e.getOpeningCredit());i.forEach(function(t){o=o.plus(new l(t.getValue()))});return c.formatCurrency(o,e.getMeasureOfUnit(),n?n.getMaxFractionDigits():0)};var a=e.getMeasureOfUnit(),r=c.formatCurrency(e.getOpeningDebit(),a,n?n.getMaxFractionDigits():0),p=c.formatCurrency(e.getOpeningCredit(),a,n?n.getMaxFractionDigits():0),d=e.getDebit().length>0||e.getCredit().length>0;t.openStart("div",e);if(e.getCollapsed()){t.class("sapSuiteUiCommonsAccountCollapsed")}t.class("sapSuiteUiCommonsAccount");if(!d){t.class("sapSuiteUiCommonsAccountEmpty")}t.attr("role","region");t.attr("aria-describedby",e.getId());t.attr("aria-label",e._getAriaLabelText());t.attr("tabindex","0");t.openEnd();t.openStart("div").class("sapSuiteUiCommonsTAccountDropZoneTop").openEnd().close("div");t.openStart("div").class("sapSuiteUiCommonsTAccountDropZoneBottom").openEnd().close("div");t.openStart("div").class("sapSuiteUiCommonsTAccountInfoIconWrapper").class("sapSuiteUiCommonsTAccountBaseInfoIconWrapper").attr("aria-labelledby",e.getId()+"-mark-text").attr("title",m.getText("TACCOUNT_SELECTED")).openEnd();t.renderControl(e._getAriaMarkText());t.openStart("div").class("sapSuiteUiCommonsInfoIcon").openEnd();t.text("!");t.close("div");t.close("div");t.openStart("div").class("sapSuiteUiCommonsAccountHeader").openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountHeaderFirst").openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountHeaderExpandWrapper").openEnd();t.renderControl(e._getDownArrow());t.close("div");var h=u(e.getTitle()).replace(/&#xa;|\n/g,"<br>");if(e.getSubtitle()){var f=u(e.getSubtitle()).replace(/&#xa;|\n/g,"<br>");t.openStart("div").class("sapSuiteUiCommonsAccountHeaderTitleWrapper").openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountHeaderTitleWithSubtitle").attr("id",e.getId()+"-title").openEnd().unsafeHtml(h).close("div");t.openStart("div").class("sapSuiteUiCommonsAccountHeaderSubtitle").openEnd().unsafeHtml(f).close("div");t.close("div")}else{t.openStart("span").attr("id",e.getId()+"-title").class("sapSuiteUiCommonsAccountHeaderTitle").openEnd().unsafeHtml(h).close("span")}t.close("div");t.openStart("div").class("sapSuiteUiCommonsAccountHeaderSecond").openEnd();t.openStart("span").attr("id",e.getId()+"-sum").class("sapSuiteUiCommonsAccountHeaderSUM").openEnd().text(e._getSumText()).close("span");t.close("div");t.close("div");t.openStart("div").attr("id",e.getId()+"-content").class("sapSuiteUiCommonsAccountTWrapper");if(e.getCollapsed()){t.style("display","none")}t.openEnd();if(d||e.getOpening()){t.openStart("div");t.class("sapSuiteUiCommonsAccountTHeader");if(e.getOpening()){t.class("sapSuiteUiCommonsAccountTHeaderOpening")}t.openEnd();t.openStart("span").attr("id",e.getId()+"-debit-text").class("sapSuiteUiCommonsAccountTHeaderTitle").openEnd().text(m.getText("TACCOUNT_DEBIT")).close("span");t.openStart("span").attr("id",e.getId()+"-credit-text").class("sapSuiteUiCommonsAccountTHeaderTitle").openEnd().text(m.getText("TACCOUNT_CREDIT")).close("span");t.close("div");if(d){if(e.getOpening()){t.openStart("div").class("sapSuiteUiCommonsAccountOpeningHeader").openEnd();t.openStart("span").attr("id",e.getId()+"-opening-debit-text").class("sapSuiteUiCommonsAccountTHeaderOpeningDebitTitle").openEnd().text(r+" "+a).close("span");t.openStart("span").attr("id",e.getId()+"-opening-credit-text").class("sapSuiteUiCommonsAccountTHeaderOpeningCreditTitle").openEnd().text(p+" "+a).close("span");t.close("div")}t.openStart("div").class("sapSuiteUiCommonsAccountTBody").attr("role","listbox").openEnd();if(e._isOrdered()){t.openStart("div").class("sapSuiteUiCommonsAccountDebitCredit").attr("role","listbox").attr("aria-labelledby",e.getId()+"-debit-text "+e.getId()+"-credit-text").openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountMiddleBorder").openEnd().close("div");o(e.getDebit().concat(e.getCredit()))}else{t.openStart("div").class("sapSuiteUiCommonsAccountDebit").attr("role","listbox").attr("aria-labelledby",e.getId()+"-debit-text").openEnd();i(e.getDebit(),true)}t.close("div");if(!e._isOrdered()){t.openStart("div").class("sapSuiteUiCommonsAccountCredit").attr("role","listbox").attr("aria-labelledby",e.getId()+"-credit-text").openEnd();i(e.getCredit(),false);t.close("div")}t.close("div")}}else{t.openStart("div").class("sapSuiteUiCommonsAccountNoData").openEnd();t.text(m.getText("TACCOUNT_NO_DATA"));t.close("div")}if(e.getOpening()){t.openStart("div").class("sapSuiteUiCommonsAccountClosingHeaderLine").openEnd().close("div");t.openStart("div").class("sapSuiteUiCommonsAccountClosingHeader").openEnd();t.openStart("span").attr("id",e.getId()+"-closing-debit-text").class("sapSuiteUiCommonsAccountTHeaderOpeningDebitTitle").openEnd().text(s(true)+" "+a).close("span");t.openStart("span").attr("id",e.getId()+"-closing-credit-text").class("sapSuiteUiCommonsAccountTHeaderOpeningCreditTitle").openEnd().text(s(false)+" "+a).close("span");t.close("div")}t.close("div");t.close("div")}}});C.prototype.onBeforeRendering=function(){this._bRendered=false;this._iOldSum=this._iSum;this._iSum=null};C.prototype.onAfterRendering=function(){var t=this.getParent();this._bRendered=true;this._setupDraggable();this._setupKeyboard();if(t&&this._hasGroupParent(t)){if(!t._bRendered){t.addEventDelegate({onAfterRendering:this._setupTooltips.bind(this)})}if(t._bRendered&&this._iOldSum!=null){var e=this._iSum-this._iOldSum;t._valueChanged(e)}}else{this._setupTooltips()}this.$().find(".sapSuiteUiCommonsAccountGroupCollapseIcon").attr("aria-pressed",!this.getCollapsed())};C.prototype.onsapdownmodifiers=function(t){if(t[f]){this._handleArrowMoveEvent(t,h.DOWN)}};C.prototype.onsapupmodifiers=function(t){if(t[f]){this._handleArrowMoveEvent(t,h.UP)}};C.prototype.onsappreviousmodifiers=function(t){if(t[f]){this._handleArrowMoveEvent(t,h.PREVIOUS)}};C.prototype.onsapnextmodifiers=function(t){if(t[f]){this._handleArrowMoveEvent(t,h.NEXT)}};C.prototype.reset=function(){this._oSum=null};C.prototype._isOrdered=function(){return!!this.getOrderBy()};C.prototype._setupKeyboard=function(){if(!this._oItemNavigation){this._oItemNavigation=new o;this.addDelegate(this._oItemNavigation)}this._oItemNavigation.setRootDomRef(this.$().find(".sapSuiteUiCommonsAccountTBody")[0]);this._oItemNavigation.setItemDomRefs(this.$().find(".sapSuiteUiCommonsAccountItem"));this._oItemNavigation.setCycling(true)};C.prototype._isInGroup=function(){return this.getParent()instanceof n};C.prototype._getPanel=function(){if(this._isInGroup()){var t=this.getParent().getParent();if(t instanceof s){return t}}return null};C.prototype._setupDraggable=function(){if(this._isInGroup()){var t=this.$(),e=this.getParent();t.draggable({revert:"invalid",delay:100,helper:function(){return t.clone().width(t.width()).css("z-index",500)},opacity:.6,scope:e.getId()+"-content",handle:".sapSuiteUiCommonsAccountHeader",start:function(){t.addClass("sapSuiteUiCommonsAccountItemDragging");e.$().find(".sapSuiteUiCommonsAccountGroupDroppingArea").addClass("sapSuiteUiCommonsAccountGroupDroppingAreaHighlight");e.$().find(".sapSuiteUiCommonsAccountHeader").css("cursor","grabbing")},stop:function(){t.removeClass("sapSuiteUiCommonsAccountItemDragging");e.$().find(".sapSuiteUiCommonsAccountGroupDroppingArea").removeClass("sapSuiteUiCommonsAccountGroupDroppingAreaHighlight");e.$().find(".sapSuiteUiCommonsAccountHeader").css("cursor","grab")}});d._setupMobileDraggable(t)}};C.prototype._setItemsAttrs=function(t){t.forEach(function(e,i){e._index=i+1;e._indexSize=t.length});this.getDebit().forEach(function(t){t._bIsDebit=true})};C.prototype._getExpandAltText=function(t){return(t?m.getText("TACCOUNT_COLLAPSE"):m.getText("TACCOUNT_EXPAND"))+(" "+m.getText("TACCOUNT_TITLE"))};C.prototype._getDownArrow=function(){var t=this.getCollapsed();if(!this._oArrowDown){this._oArrowDown=new r({alt:this._getExpandAltText(!t),tooltip:this._getExpandAltText(!t),decorative:false,src:t?"sap-icon://navigation-right-arrow":"sap-icon://navigation-down-arrow",press:function(){this.setCollapsed(!this.getCollapsed())}.bind(this)}).addStyleClass("sapSuiteUiCommonsAccountGroupCollapseIcon")}this._oArrowDown.$().attr("aria-pressed",!this.getCollapsed());return this._oArrowDown};C.prototype._getAriaMarkText=function(){if(!this._oMarkText){this._oMarkText=new p({id:this.getId()+"-mark-text",text:m.getText("TACCOUNT_SELECTED")});this.addDependent(this._oMarkText)}return this._oMarkText};C.prototype._getSum=function(){if(this._iSum==null){var t=new l("0");this.getCredit().forEach(function(e){t=t.plus(new l(e.getValue()))});this.getDebit().forEach(function(e){t=t.minus(new l(e.getValue()))});if(this.getOpening()){t=t.plus(new l(this.getOpeningCredit()));t=t.minus(new l(this.getOpeningDebit()))}this._iSum=t}return this._iSum};C.prototype._getAriaLabelText=function(){return this.getTitle()+" "+this.getSubtitle()+" "+this._getSumText()+" "+m.getText("TACCOUNT_NAVIGATION")};C.prototype._getSumText=function(){var t=this.getMeasureOfUnit();var e=this._getSum();e=e.isLessThan(0)?e.times(-1):e;var i=this._getPanel();var o=c.formatCurrency(e,t,i?i.getMaxFractionDigits():0);return(this._getSum().isGreaterThan(0)?m.getText("TACCOUNT_CREDIT"):m.getText("TACCOUNT_DEBIT"))+": "+o+" "+u(t)};C.prototype._valueChanged=function(t,e){if(this._bRendered){if(e){this._iSum=this._getSum().minus(t)}else{this._iSum=this._getSum().plus(t)}this.$("sum").text(this._getSumText());var i=this.getParent();if(this._hasGroupParent(i)){i._valueChanged(t,e)}}};C.prototype._hasGroupParent=function(t){return(t||this.getParent())instanceof n};C.prototype._handleArrowMoveEvent=function(t,e){this._moveTAccount(e);t.preventDefault();t.stopImmediatePropagation()};C.prototype._moveTAccount=function(t){var e,i,o,n,s=t===h.UP,a=true,r=this.$();var p=function(t){if(o.length===0){a=false;return}r.detach();e.detach();o[t](r);o[t](e)};if(s||t===h.DOWN){n=s?["next","prev","insertBefore","append"]:["prev","next","insertAfter","prepend"];e=r[n[0]](".sapSuiteUiCommonsAccountGroupDroppingArea");i=r[n[1]]()[n[1]](".sapSuiteUiCommonsAccount");if(i.length!==0){r.detach()[n[2]](i);e.detach()[n[2]](i)}else{o=r.parent()[n[1]](".sapSuiteUiCommonsAccountGroupColumn");p(n[3])}}else{e=r.prev(".sapSuiteUiCommonsAccountGroupDroppingArea");o=r.parent()[t===h.NEXT?"next":"prev"](".sapSuiteUiCommonsAccountGroupColumn");p("append")}if(a){r.focus()}};C.prototype._setControlKeyName=function(t){f=t};C.prototype._setupTooltips=function(){var t=function(t){var e=this.$().find(t);if(e[0]&&e[0].clientHeight<e[0].scrollHeight){e.attr("title",e.html())}}.bind(this);if(this.getSubtitle()){t(".sapSuiteUiCommonsAccountHeaderTitleWithSubtitle");t(".sapSuiteUiCommonsAccountHeaderSubtitle")}else{t(".sapSuiteUiCommonsAccountHeaderTitle")}};C.prototype.updateBindingContext=function(){this.reset();return i.prototype.updateBindingContext.apply(this,arguments)};C.prototype.setMeasureOfUnit=function(t){this.setProperty("measureOfUnit",t,true);if(this._bRendered){this.$("sum").text(this._getSumText());var e=this.getParent();if(this._hasGroupParent(e)){e._measureChanged(t)}}this.invalidate();return this};C.prototype.invalidate=function(){this._bRendered=false;i.prototype.invalidate.apply(this,arguments)};C.prototype.setCollapsed=function(t){this.setProperty("collapsed",t);var e=this._getExpandAltText(!t);this._getDownArrow().setTooltip(e);this._getDownArrow().setAlt(e);this._getDownArrow().setSrc(!t?"sap-icon://navigation-down-arrow":"sap-icon://navigation-right-arrow");this.$()[t?"addClass":"removeClass"]("sapSuiteUiCommonsAccountCollapsed");this.$().find(".sapSuiteUiCommonsAccountGroupCollapseIcon").attr("aria-pressed",!t);if(this.getDomRef()){this.$("content")[t?"hide":"show"]("medium")}return this};return C});
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountGroup", ["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","sap/ui/core/Control","sap/ui/core/theming/Parameters","./TAccountPanel","sap/ui/core/IconPool","sap/ui/core/Icon","sap/m/Button","sap/base/security/encodeXML","sap/ui/core/Configuration","sap/ui/core/delegate/ItemNavigation","./TAccountUtils","sap/ui/core/ResizeHandler","sap/ui/thirdparty/bignumber","sap/ui/core/InvisibleText"],function(jQuery,t,e,o,i,s,n,a,r,p,u,c,l,d,h){"use strict";var m=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var _=e.extend("sap.suite.ui.commons.taccount.TAccountGroup",{metadata:{library:"sap.suite.ui.commons",properties:{title:{type:"string",group:"Misc",defaultValue:null},collapsed:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{accounts:{type:"sap.suite.ui.commons.taccount.TAccount",multiple:true,singularName:"account"}},events:{}},renderer:{apiVersion:2,render:function(t,e){if(!e._bThemeApplied){return}t.openStart("div",e);t.class("sapSuiteUiCommonsAccountGroup");if(e.getCollapsed()){t.class("sapSuiteUiCommonsAccountGroupCollapsed")}t.attr("tabindex",0);t.attr("aria-label",e._getAriaText());t.openEnd();t.openStart("div").class("sapSuiteUiCommonsGroupHeader").openEnd();t.openStart("div").class("sapSuiteUiCommonsGroupHeaderExpandWrapper").openEnd();t.renderControl(e._getExpandCollapse());t.close("div");t.openStart("div").class("sapSuiteUiCommonsGroupHeaderFirst").openEnd();t.openStart("span").class("sapSuiteUiCommonsGroupHeaderTitle").openEnd().unsafeHtml(r(e.getTitle())).close("span");t.openStart("span").attr("id",e.getId()+"-sum").class("sapSuiteUiCommonsGrouptHeaderSUM").openEnd().text(e._getSumText()).close("span");t.openStart("div").attr("id"," ").class("sapSuiteUiCommonsGroupInfoIconWrapper").class("sapSuiteUiCommonsTAccountBaseInfoIconWrapper").attr("title",m.getText("TACCOUNT_SELECTED")).openEnd();t.openStart("span").class("sapSuiteUiCommonsInfoIcon").openEnd();t.text("!");t.close("span");t.close("div");t.close("div");t.openStart("div").class("sapSuiteUiCommonsGroupHeaderSecond").openEnd();t.renderControl(e._getExpandAllAccounts());t.renderControl(e._getCollapseAllAccounts());t.close("div");t.close("div");t.openStart("div").attr("id",e.getId()+"-content").class("sapSuiteUiCommonsAccountGroupContent").openEnd();e.getAccounts().forEach(function(e){t.renderControl(e)});t.close("div");t.close("div")}}});_.prototype.init=function(){sap.ui.getCore().attachThemeChanged(function(){this._bThemeApplied=true;this.invalidate()},this);this._bThemeApplied=sap.ui.getCore().isThemeApplied();if(!this._sResizeHandlerId){this._sResizeHandlerId=l.register(this,this._adjustUI.bind(this))}this._oInvisibleText=new h;this._oInvisibleText.toStatic()};_.prototype.exit=function(){if(this._oIconExpand){this._oIconExpand.destroy()}if(this._oIconCollapse){this._oIconCollapse.destroy()}if(this._sResizeHandlerId){l.deregister(this._sResizeHandlerId);this._sResizeHandlerId=""}this._bAttachEventListener=false};_.prototype.onBeforeRendering=function(){this._bRendered=false;this._oSum=null;this._iColumnCount=-1};_.prototype.onAfterRendering=function(){this._adjustUI();this._bRendered=true;var t=this.getParent();if(t&&this._hasPanelParent(t)&&t._bRendered){t._recalculate()}if(this.getCollapsed()){this.$("content").hide()}};_.prototype.reset=function(){this._oSum=null};_.prototype.updateBindingContext=function(){this.reset();return e.prototype.updateBindingContext.apply(this,arguments)};_.prototype._hasPanelParent=function(t){return(t||this.getParent())instanceof i};_.prototype._getExpandCollapse=function(){var t=this.getCollapsed(),e=this._getExpandAltText(!t);if(!this._oArrowDown){this._oArrowDown=new n({src:t?"sap-icon://navigation-right-arrow":"sap-icon://navigation-down-arrow",alt:e,tooltip:e,press:function(){this._expandCollapse()}.bind(this)})}return this._oArrowDown};_.prototype._getExpandAltText=function(t){return(t?m.getText("TACCOUNT_COLLAPSE"):m.getText("TACCOUNT_EXPAND"))+" "+(this.getTitle()?this.getTitle():m.getText("TACCOUNT_GROUP_TITLE"))};_.prototype._expandCollapse=function(){var t=this.getCollapsed(),e=this._getExpandAltText(t);this._getExpandCollapse().setTooltip(e);this._getExpandCollapse().setAlt(e);this._getExpandCollapse().setSrc(t?"sap-icon://navigation-down-arrow":"sap-icon://navigation-right-arrow");this.setProperty("collapsed",!t);this._bIsExpanding=true;this.$("content")[t?"show":"hide"]("medium",function(){this._bIsExpanding=false}.bind(this));this.$()[!t?"addClass":"removeClass"]("sapSuiteUiCommonsAccountGroupCollapsed")};_.prototype._expandCollapseAllAccounts=function(t){this.getAccounts().forEach(function(e){e.setCollapsed(!!t)});if(t==true){this._oInvisibleText.setText(m.getText("TACCOUNT_COLLAPSE_ALL"))}else{this._oInvisibleText.setText(m.getText("TACCOUNT_EXPAND_ALL"))}};_.prototype._getExpandAllAccounts=function(){if(!this._oIconExpand){this._oIconExpand=new a({icon:"sap-icon://expand-all",type:"Transparent",tooltip:m.getText("TACCOUNT_EXPAND")+" "+m.getText("TACCOUNT_ALL")+" "+m.getText("TACCOUNT_TITLE"),ariaDescribedBy:this._oInvisibleText.getId(),press:function(){this._expandCollapseAllAccounts(false);if(!this._bAttachEventListener){this._focusOutOnExpandCollapse();this._bAttachEventListener=true}}.bind(this)}).addStyleClass("sapSuiteUiCommonsGroupHeaderIcon")}return this._oIconExpand};_.prototype._getCollapseAllAccounts=function(){if(!this._oIconCollapse){this._oIconCollapse=new a({icon:"sap-icon://collapse-all",type:"Transparent",tooltip:m.getText("TACCOUNT_COLLAPSE")+" "+m.getText("TACCOUNT_ALL")+" "+m.getText("TACCOUNT_TITLE"),ariaDescribedBy:this._oInvisibleText.getId(),press:function(){this._expandCollapseAllAccounts(true);if(!this._bAttachEventListener){this._focusOutOnExpandCollapse();this._bAttachEventListener=true}}.bind(this)}).addStyleClass("sapSuiteUiCommonsGroupHeaderIcon")}return this._oIconCollapse};_.prototype._focusOutOnExpandCollapse=function(){this._oIconCollapse.getDomRef().addEventListener("focusout",function(){this._oInvisibleText.setText()}.bind(this));this._oIconExpand.getDomRef().addEventListener("focusout",function(){this._oInvisibleText.setText()}.bind(this))};_.prototype._getSum=function(t){var e=this.getAccounts(),o=new d("0"),i="",s=true;if(!this._oSum||t){for(var n=0;n<e.length;n++){var a=e[n];if(i&&i!==a.getMeasureOfUnit()){s=false;break}i=a.getMeasureOfUnit();o=o.plus(a._getSum())}this._oSum={sum:o,measure:i,correct:s}}return this._oSum};_.prototype._getSumText=function(){var t=this._getSum();var e=this.getParent();if(t&&t.correct){var o=c.formatCurrency(t.sum,t.measure,e instanceof i?e.getMaxFractionDigits():0);return(t.sum>0?m.getText("TACCOUNT_CREDIT"):m.getText("TACCOUNT_DEBIT"))+": "+o+" "+r(t.measure)}return"-"};_.prototype._getAriaText=function(){return m.getText("TACCOUNT_GROUP_TITLE")+" "+(this.getTitle()?this.getTitle()+" ":"")+this._getSumText()};_.prototype._adjustUI=function(){var t=320,e=16,o=t+e;var i=this.$("content"),s=i.width(),n=Math.max(Math.ceil(s/o)-1,1);if(n===this._iColumnCount){return}if(this._bIsExpanding||this._bRendered&&this.getCollapsed()){return}var a=jQuery('<div id="'+this.getId()+'-content" class="sapSuiteUiCommonsAccountGroupContent"></div>'),r=Array.apply(null,Array(n)).map(Number.prototype.valueOf,0);var p=this.$().find(".sapSuiteUiCommonsAccount"),u=0;this._iColumnCount=n;this._iDivs=[];var c='<div class="sapSuiteUiCommonsAccountGroupDroppingArea"><div class="sapSuiteUiCommonsAccountGroupDroppingAreaInner">'+'</div><div class="sapSuiteUiCommonsAccountGroupDroppingAreaInnerBall"></div><div class="sapSuiteUiCommonsAccountGroupDroppingAreaInnerText">'+m.getText("TACCOUNT_DROP_HERE")+"</div></div>";for(var l=0;l<n;l++){var d='<div class="sapSuiteUiCommonsAccountGroupColumn">'+c+"</div>",h=jQuery(d);a.append(h);this._iDivs.push(h)}for(var l=0;l<p.length;l++){var _=jQuery(p[l]),C=_.height(),g=this._iDivs[u];var f=Number.MAX_VALUE,T=0;for(var A=0;A<n;A++){var v=r[A];if(v<f){f=v;T=A}}var g=this._iDivs[T];_.detach().appendTo(g);jQuery(c).appendTo(g);r[T]+=C}i.detach();this.$().append(a);this._setupDroppable()};_.prototype._setupDroppable=function(){var t=function(t){var e=jQuery(t);return e.hasClass("sapSuiteUiCommonsTAccountDropZoneTop")?e.parent().prev():e.parent().next()};var e=function(t,e){var o=e.draggable,i=o.next();if(i[0]!==t[0]){i.detach().insertAfter(t);o.detach().insertAfter(t)}else{o.detach().insertBefore(t)}t.removeClass("sapSuiteUiCommonsAccountGroupDroppingAreaActiveSide");o.css("left","0px");o.css("top","0px")};var o=this.$().find(".sapSuiteUiCommonsAccountGroupDroppingArea");o.droppable({scope:this.getId()+"-content",tolerance:"pointer",activeClass:"sapSuiteUiCommonsAccountGroupDroppingAreaActive",hoverClass:"sapSuiteUiCommonsAccountGroupDroppingAreaActive",drop:function(t,o){var i=jQuery(this);e(i,o)}});var i=this.$().find(".sapSuiteUiCommonsTAccountDropZoneBottom, .sapSuiteUiCommonsTAccountDropZoneTop");i.droppable({scope:this.getId()+"-content",tolerance:"pointer",drop:function(t,o){var i=jQuery(this);i=i.hasClass("sapSuiteUiCommonsTAccountDropZoneTop")?i.parent().prev():i.parent().next();e(i,o)},over:function(e,o){t(this).addClass("sapSuiteUiCommonsAccountGroupDroppingAreaActiveSide")},out:function(e,o){t(this).removeClass("sapSuiteUiCommonsAccountGroupDroppingAreaActiveSide")}})};_.prototype._valueChanged=function(t,e){if(this._oSum){if(e){this._oSum.sum=this._oSum.sum.minus(t)}else{this._oSum.sum=this._oSum.sum.plus(t)}this.$("sum").text(this._getSumText());var o=this.getParent();if(this._hasPanelParent(o)){o._valueChanged(t,e)}}};_.prototype._measureChanged=function(t){if(this._oSum){if(this._oSum.measure===t&&!this._oSum.correct){this._recalculate();return}if(this._oSum.measure!==t&&this._oSum.correct){var e=this.getParent();this._oSum.correct=false;if(this._hasPanelParent(e)){e._setInvalid()}}this.$("sum").text(this._getSumText())}};_.prototype._recalculate=function(){this._oSum=this._getSum(true);this.$("sum").text(this._getSumText());var t=this.getParent();if(this._hasPanelParent(t)){t._recalculate()}};_.prototype._hasPanelParent=function(t){return(t||this.getParent())instanceof i};_.prototype.invalidate=function(){this._bRendered=false;e.prototype.invalidate.apply(this,arguments)};return _});
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountItem", ["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","sap/ui/core/Control","sap/ui/core/theming/Parameters","sap/suite/ui/commons/taccount/TAccountPanel","sap/suite/ui/commons/taccount/TAccountGroup","sap/ui/core/format/NumberFormat","sap/ui/core/Core","sap/ui/core/library","./TAccountUtils","sap/ui/thirdparty/bignumber"],function(jQuery,t,e,i,r,o,a,s,n,u,c){"use strict";var p=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var l=e.extend("sap.suite.ui.commons.taccount.TAccountItem",{metadata:{library:"sap.suite.ui.commons",properties:{value:{type:"any",group:"Misc",defaultValue:0},color:{type:"sap.m.ValueCSSColor",group:"Misc",defaultValue:null},group:{type:"string",group:"Misc",defaultValue:""},ariaLabel:{type:"string",group:"Misc",defaultValue:""}},aggregations:{properties:{type:"sap.suite.ui.commons.taccount.TAccountItemProperty",multiple:true,singularName:"property"}},events:{press:{}}},renderer:{apiVersion:2,render:function(t,e){var r=e.getColor(),o=e.getParent()&&e.getParent().getMeasureOfUnit(),a=e._getPanel(),s=u.formatCurrency(new c(e.getValue()),o,a?a.getMaxFractionDigits():0),p=s+" "+o;t.openStart("div",e).attr("tabindex","0");t.class("sapSuiteUiCommonsAccountItem");if(e.getGroup()){t.attr("group",e.getGroup())}t.attr("aria-selected","false");t.attr("aria-setsize",e._indexSize);t.attr("aria-posinset",e._index);t.attr("role","option");t.attr("aria-label",e._getAriaLabel(p));t.openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountColorBar");if(r&&n.CSSColor.isValid(r)){t.style("background-color",r)}else if(n.CSSColor.isValid(i.get(r))){t.style("background-color",i.get(r))}t.openEnd();t.close("div");t.openStart("div").attr("id",e.getId()+"-content").class("sapSuiteUiCommonsAccountContent").openEnd();t.openStart("div").class("sapSuiteUiCommonsAccountItemTitleWrapper").openEnd();t.openStart("span").class("sapSuiteUiCommonsAccountItemTitle").openEnd();t.text(p);t.close("span");t.close("div");t.openStart("div").class("sapSuiteUiCommonsAccountItemProperties").openEnd();e.getProperties().forEach(function(e){t.renderControl(e)});t.close("div");t.close("div");t.close("div")}}});l.prototype.onBeforeRendering=function(){this._prepareProperties()};l.prototype.onAfterRendering=function(){this.$().on("click",this._click.bind(this))};l.prototype._refreshAriaLabel=function(t){this.$().attr("aria-label",this._getAriaLabel())};l.prototype._getAriaLabel=function(t){var e=this.getAriaLabel();if(e){return e}if(!t){var i=this.getParent()&&this.getParent().getMeasureOfUnit(),r=this._getPanel(),o=u.formatCurrency(this.getValue(),i,r?r.getMaxFractionDigits():0),t=o+" "+i}var a=(this._bIsDebit?p.getText("TACCOUNT_DEBIT"):p.getText("TACCOUNT_CREDIT"))+" "+p.getText("TACCOUNT_ITEM");a+=" "+t+" ";this.getProperties().forEach(function(t){if(t.getVisible()){a+=t.getLabel()+":"+t.getValue()+" "}});return a};l.prototype._click=function(){var t=this.fireEvent("press",{},true);if(t){this._highlightItems()}};l.prototype._highlightItems=function(){var t=this.$(),e=this.getGroup(),i=!t.is(".sapSuiteUiCommonsAccountItemSelected, .sapSuiteUiCommonsAccountItemSelectedByGroup"),r=jQuery(".sapSuiteUiCommonsAccountItemSelected");this._setAriaHighlighted(r,false);this._setAriaHighlighted(t,i);r.removeClass("sapSuiteUiCommonsAccountItemSelected");i?t.addClass("sapSuiteUiCommonsAccountItemSelected"):t.removeClass("sapSuiteUiCommonsAccountItemSelected");var a=this._findHighlightParent();if(a){var s=jQuery(".sapSuiteUiCommonsAccountItemSelectedByGroup");s.removeClass("sapSuiteUiCommonsAccountItemSelectedByGroup");this._setAriaHighlighted(s,false);if(e&&i){var n=jQuery(".sapSuiteUiCommonsAccountItem[group="+e+"]");n.addClass("sapSuiteUiCommonsAccountItemSelectedByGroup");var u=this;n.each(function(t,e){var i=sap.ui.getCore().byId(e.id);if(i){u._setAriaHighlighted(i.$(),true);var r=i.getParent();if(r){r.$().addClass("sapSuiteUiCommonsAccountItemSelectedByGroup");var a=r.getParent();if(a instanceof o){a.$().addClass("sapSuiteUiCommonsAccountItemSelectedByGroup")}}}})}}};l.prototype.onsapenter=function(){this._highlightItems()};l.prototype.onsapspace=function(){this._highlightItems()};l.prototype._setAriaHighlighted=function(t,e){t.attr("aria-selected",e);t.attr("aria-label",e?p.getText("COLORED_ITEM_FROM")+" "+this.getGroup():this._getAriaLabel())};l.prototype._findHighlightParent=function(){var t=this.getParent();t=t&&t.getParent();if(t instanceof o){var e=t.getParent();return e instanceof r||t}return null};l.prototype._getPanel=function(){var t=this.getParent();t=t&&t.getParent();if(t instanceof o){var e=t.getParent();if(e instanceof r){return e}}return null};l.prototype._prepareProperties=function(){this._mProperties={};this.getProperties().forEach(function(t){var e=t.getKey();if(e){this._mProperties[e]=t}}.bind(this))};l.prototype.setValue=function(t){var e=new c(t);var i=new c(this.getValue());var r=this._bIsDebit?-1:1;var o=new c(r).times(e.minus(i));var a=o.isGreaterThan(0);this.setProperty("value",t);this.getParent()&&this.getParent()._valueChanged(o,this._bIsDebit&&!a)};return l});
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountItemProperty", ["sap/suite/ui/commons/library","sap/ui/core/Control","sap/ui/core/theming/Parameters"],function(e,t,a){"use strict";var i=t.extend("sap.suite.ui.commons.taccount.TAccountItemProperty",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},value:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},displayLabel:{type:"boolean",group:"Misc",defaultValue:true},visible:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:{apiVersion:2,render:function(e,t){var a=t.getValue(),i=t.getLabel(),o=t.getVisible();e.openStart("div",t).class("sapSuiteUiCommonsAccountPropertyWrapper").attr("key",t.getKey());if(!o){e.style("display","none")}e.openEnd();if(i&&t.getDisplayLabel()){e.openStart("div").class("sapSuiteUiCommonsAccountItemLabel").openEnd().text(i+":").close("div")}e.openStart("div").class("sapSuiteUiCommonsAccountItemProperty").openEnd().text(a).close("div");e.close("div")}}});i.prototype._getLabel=function(){return this.getValue()||this.getKey()};return i});
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountPanel", ["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","sap/ui/core/Control","sap/ui/core/theming/Parameters","sap/m/Panel","sap/ui/model/json/JSONModel","sap/m/Dialog","sap/m/Button","sap/m/FlexBox","sap/m/Label","sap/ui/model/Filter","sap/m/SearchField","sap/m/List","sap/m/StandardListItem","sap/m/CheckBox","sap/m/Title","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Text","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/ui/model/FilterOperator","sap/base/security/encodeXML","sap/ui/base/Object","sap/ui/core/format/NumberFormat","sap/ui/core/Core","sap/ui/core/Configuration","./TAccountUtils","./TAccountPanelRenderer","sap/m/library","sap/ui/thirdparty/bignumber"],function(jQuery,e,t,o,i,s,a,r,n,l,p,u,c,h,m,d,g,T,_,y,f,S,b,C,v,A,P,w,x,B,I){"use strict";var L=B.ButtonType;var U=A.getLibraryResourceBundle("sap.suite.ui.commons");var O=e.taccount.TAccountPanelState;var D=i.extend("sap.suite.ui.commons.taccount.TAccountPanel",{metadata:{library:"sap.suite.ui.commons",properties:{title:{type:"string",group:"Misc",defaultValue:null},state:{type:"sap.suite.ui.commons.taccount.TAccountPanelState",group:"Misc",defaultValue:"Default"},showOverlay:{type:"boolean",group:"Misc",defaultValue:false},maxFractionDigits:{type:"int",group:"Misc",defaultValue:2}},aggregations:{properties:{type:"sap.suite.ui.commons.taccount.TAccountItemProperty",multiple:true,singularName:"property"},table:{type:"sap.ui.core.Control",multiple:false}},events:{stateChanged:{parameters:{state:"sap.suite.ui.commons.taccount.TAccountPanelState"}},settingsApplied:{parameters:{properties:"object"}}}}});D.prototype.init=function(){this._bDisplayLabels=true};D.prototype.onBeforeRendering=function(){this._oSum=null;this._bRendered=false;this._prepareProperties();this._createToolbar()};D.prototype.onAfterRendering=function(){var e=this.$();this._switchContent(this.getState()===O.Table);this._bRendered=true;e.attr("aria-label",this._getAriaLabelText());e.addClass("sapSuiteUiCommonsAccountPanel");this._setTotalBalanceTitle()};D.prototype.getSum=function(){var e=new I("0"),t="",o=true,i=this.getContent();if(!this._oSum){for(var s=0;s<i.length;s++){var a=i[s];if(C.isA(a,"sap.suite.ui.commons.taccount.TAccountGroup")){var r=a._getSum();if(t&&t!==r.measure||!r.correct){o=false;break}t=r.measure;e=e.plus(r.sum)}}this._oSum={measure:t,sum:e||0,correct:o}}return this._oSum};D.prototype.switchContent=function(e){var t=e?O.Table:O.Default;this._switchContent(e);this.setProperty("state",t,true)};D.prototype.getSettingsDialog=function(){return this._getPopover()};D.prototype.getToolbar=function(){return this._getToolbar()};D.prototype.openSettings=function(){this._oSelectAllCheckBox&&this._oSelectAllCheckBox.setText(this._getSelectAllText());this._getPopover().open()};D.prototype.reset=function(){this._oSum=null;if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};D.prototype.setState=function(e){var t=e===O.Table;this._switchContent(t);this.setProperty("state",e,true);return this};D.prototype.updateBindingContext=function(){this.reset();return t.prototype.updateBindingContext.apply(this,arguments)};D.prototype._switchContent=function(e){var t=e?O.Table:O.Default;this.$("table")[e?"show":"hide"]();this.$("datacontent")[e?"hide":"show"]();if(this._oDisplaySwitcher){this._oDisplaySwitcher.setSelectedKey(t)}};D.prototype._prepareProperties=function(){this._mProperties={};this.getProperties().forEach(function(e){var t=e.getKey();if(t){this._mProperties[t]=e}}.bind(this))};D.prototype._setPropertiesVisibility=function(e){var t=this.$();Object.keys(e).forEach(function(o){var i=e[o],s=t.find(".sapSuiteUiCommonsAccountPropertyWrapper[key="+o+"]");s.each(function(e,t){var o=i.getVisible(),s=A.byId(t.id);if(s){s.setProperty("visible",o,true);s.getParent()._refreshAriaLabel()}jQuery(t)[o?"show":"hide"]()})});t.find(".sapSuiteUiCommonsAccountItemLabel")[this._bDisplayLabels?"show":"hide"]()};D.prototype._getPopover=function(){if(!this._oPopover){this._createPopover()}return this._oPopover};D.prototype._getSelectAllText=function(e){var t=this.getProperties();if(!e&&e!==0){e=t.reduce(function(e,t){return e+(t.getVisible()?1:0)},0)}this._iSelectedCount=e;return U.getText("TACCOUNT_SELECTALL")+" ("+e+"/"+t.length+")"};D.prototype._createPopover=function(){var e=this,t=false;if(!this._oPopover){this._oPopover=new a({contentWidth:"450px",title:U.getText("TACCOUNT_DISPLAYOPTIONS"),afterOpen:function(){if(!t){var o=e._oPopover.$().height();e._oPopover.setProperty("contentHeight",o+"px",true);t=true}}})}this._oPopover.setEndButton(new r({text:U.getText("TACCOUNT_CANCEL"),press:function(t){e._oPopover.close()}}));this._oPopover.setBeginButton(new r({text:U.getText("TACCOUNT_OK"),type:L.Emphasized,press:function(t){var o=_.getSelectedContexts(true),s=_.getModel();var a={},r={};o.forEach(function(t){var o=s.getProperty(t.sPath);if(o){var i=e._mProperties[o.key];a[o.key]=1;if(i&&!i.getVisible()){i.setProperty("visible",true,true);r[o.key]=i}}});Object.keys(e._mProperties).forEach(function(t){var o=e._mProperties[t];if(o.getVisible()&&!a[t]){o.setProperty("visible",false,true);r[t]=o}});e._bDisplayLabels=i.getSelected();if(e.fireEvent("settingsApplied",{properties:r},true)){e._setPropertiesVisibility(r)}e._oPopover.close()}}));this._oPopover.removeAllContent();var o=new n({width:"100%",renderType:"Bare",direction:"Column"});this._oPopover.addContent(o);var i=new m({selected:this._bDisplayLabels}).addStyleClass("sapUiTinyMarginBegin");var d=new n({renderType:"Bare",alignItems:"Center",items:[i,new l({text:"Show labels"}).addStyleClass("sapUiTinyMarginBegin")]}).addStyleClass("sapUiTinyMarginBottom sapUiTinyMarginTop");o.addItem(d);var g=function(e){var t=[],o=e.getSource().getValue();if(o&&o.length>0){t.push(new p("title",S.Contains,o))}var i=_.getBinding("items");i.filter(t,"Application")};var T=new u({width:"100%",liveChange:g}).addStyleClass("sapSuiteUiCommonsAccountsPopupSearch");o.addItem(T);var _=new c({width:"100%",mode:"MultiSelect",includeItemInSelection:true,selectionChange:function(t){var o=t.getParameter("listItem").getSelected();e._oSelectAllCheckBox.setText(e._getSelectAllText(e._iSelectedCount+(o?1:-1)));e._oSelectAllCheckBox.setSelected(y.length===e._iSelectedCount)}}).addStyleClass("sapSuiteUiCommonsAccountsPopupList");_.bindAggregation("items",{path:"/items",template:new h({title:"{title}",selected:"{selected}"})});var y=this.getProperties(),f=this._getSelectAllText();this._oSelectAllCheckBox=new m({selected:y.length===e._iSelectedCount,text:f,select:function(t){var o=t.getSource().getSelected();e._oSelectAllCheckBox.setText(e._getSelectAllText(o?y.length:0));_.getItems().forEach(function(e){e.setSelected(o)})}}).addStyleClass("sapUiTinyMarginBegin sapUiTinyMarginEnd sapSuiteUiCommonsAccountsPopupSelectAll");var b=new n({renderType:"Bare",alignItems:"Center"}).addStyleClass("sapSuiteUiCommonsAccountsPopupSelectAllWrapper");b.addItem(this._oSelectAllCheckBox);o.addItem(b);o.addItem(_);var C=[];y.forEach(function(e){C.push({title:e._getLabel(),key:e.getKey(),selected:e.getVisible()})});_.setModel(new s({items:C}));return this._oPopover};D.prototype._getToolbar=function(){if(!this._oToolbar){this._createToolbar()}return this._oToolbar};D.prototype._createToolbar=function(){var e=this;if(this._oToolbar){return}this._oToolbar=new g;this._oToolbar.addContent(new d(this.getId()+"-toolbartitle",{text:this.getTitle()}));this._oToolbar.addContent(new T(this.getId()+"-toolbarspacer"));this._oToolbar.addContent(new _(this.getId()+"-toolbarbalancelabel",{wrapping:false,text:U.getText("TACCOUNT_TOTALBALANCE")+":"}).addStyleClass("sapSuiteUiCommonsAccountPanelLabel"));this._oToolbar.addContent(new _(this.getId()+"-toolbarsumtitle",{wrapping:false}).addStyleClass("sapSuiteUiCommonsAccountPanelSum"));this._oDisplaySwitcher=new y(this.getId()+"-toolbarswitcher",{selectionChange:function(t){var o=A.byId(e._oDisplaySwitcher.getSelectedItem());if(o){e.switchContent(o.getKey()===O.Table);e.fireStateChanged({state:o.getKey()})}},items:[new f({key:O.Default,tooltip:U.getText("TACCOUNT_DEFAULT"),icon:"sap-icon://screen-split-two"}),new f({key:O.Table,tooltip:U.getText("TACCOUNT_TABLE"),icon:"sap-icon://table-chart"})]});this._oToolbar.addContent(this._oDisplaySwitcher);this._oToolbar.addContent(new r(this.getId()+"-toolbarsettings",{icon:"sap-icon://action-settings",press:this.openSettings.bind(this)}));this.setHeaderToolbar(this._oToolbar)};D.prototype._getSumText=function(){var e=this.getSum();if(!e.correct){return" - "}return w.formatCurrency(Math.abs(e.sum),e.measure,this.getMaxFractionDigits())+" "+b(e.measure)};D.prototype._setTotalBalanceTitle=function(){var e=this.getSum(),t="";if(!e.correct||e.sum.isEqualTo(0)){t=U.getText("TACCOUNT_TOTALBALANCE")}else{t=e.sum.isGreaterThan(0)?U.getText("TACCOUNT_TOTALCREDIT"):U.getText("TACCOUNT_TOTALDEBIT")}this.$("toolbarbalancelabel").text(t+":");this.$("toolbarsumtitle").text(this._getSumText())};D.prototype._getAriaLabelText=function(){return"T account panel "+this.getTitle()+" "+this._getSumText()};D.prototype._recalculate=function(){this._oSum=null;this._oSum=this.getSum();this._setTotalBalanceTitle()};D.prototype._valueChanged=function(e,t){var o=this.getSum();if(o.correct){if(t){this._oSum.sum=this._oSum.sum.minus(e)}else{this._oSum.sum=this._oSum.sum.plus(e)}}this._setTotalBalanceTitle()};D.prototype.setShowOverlay=function(e){this.setProperty("showOverlay",e,true);this.$("overlay")[e?"addClass":"removeClass"]("sapSuiteUiCommonsAccountPanelOverlayVisible")};D.prototype._setInvalid=function(){if(this._oSum){this._oSum.correct=false;this._setTotalBalanceTitle()}};D.prototype.invalidate=function(){this._bRendered=false;t.prototype.invalidate.apply(this,arguments)};return D});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountPanelRenderer", ["sap/ui/core/Renderer","sap/m/PanelRenderer"],function(e,n){"use strict";var t=e.extend(n),a;t.renderContent=function(e,t){a=t;n.renderContent.apply(this,[e,t])};t.apiVersion=2;t.renderChildren=function(e,n){var t=a&&a.getId();if(a){var r=a.getTable();if(r){e.openStart("div").attr("id",t+"-table").class("sapSuiteUiCommonsAccountPanelTable").openEnd();e.renderControl(r);e.close("div")}}e.openStart("div").attr("id",t+"-datacontent").class("sapSuiteUiCommonsAccountPanelContent").openEnd();n.forEach(e.renderControl);e.close("div");var o=a&&a.getShowOverlay()?"sapSuiteUiCommonsAccountPanelOverlayVisible":"";e.openStart("div").attr("id",t+"-overlay").class("sapSuiteUiCommonsAccountPanelOverlay").class(o).openEnd();e.close("div")};return t},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/taccount/TAccountUtils", ["sap/ui/core/format/NumberFormat","sap/ui/core/Core"],function(r,e){"use strict";var t={};t._oCurrencyFormatter=null;t.formatCurrency=function(r,e,n){return t._getCurrencyFormatter(n).format(r,e)||""};t._getCurrencyFormatter=function(n){t._oCurrencyFormatter=r.getCurrencyInstance({showMeasure:false,maxFractionDigits:n},e.getConfiguration().getLocale());return t._oCurrencyFormatter};return t},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/DateUtils", ["sap/base/Log","sap/ui/core/date/UI5Date"],function(e,t){"use strict";var a=function(){throw new Error};a.resetDateToStartOfDay=function(e){if(a.isValidDate(e)){e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0)}};a.resetDateToEndOfDay=function(e){if(a.isValidDate(e)){e.setHours(23);e.setMinutes(59);e.setSeconds(59);e.setMilliseconds(999)}};a.resetDateToStartOfMonth=function(e){if(a.isValidDate(e)){e.setDate(1);a.resetDateToStartOfDay(e)}};a.resetDateToEndOfMonth=function(e){if(a.isValidDate(e)){e.setDate(1);e.setMonth(e.getMonth()+1);e.setDate(0);a.resetDateToEndOfDay(e)}};a.resetDateToStartOfYear=function(e){if(a.isValidDate(e)){e.setMonth(0);a.resetDateToStartOfMonth(e)}};a.resetDateToEndOfYear=function(e){if(a.isValidDate(e)){e.setMonth(11);a.resetDateToEndOfMonth(e)}};a.resetDateToStartOfWeek=function(t,n){if(a.isValidDate(t)){if(n===undefined){n=1}else if(isNaN(n)||!isFinite(n)){e.error("DateUtils iFirstDayOfWeek value ='"+n+"' is invalid.");return}t.setDate(t.getDate()-(t.getDay()-n+7)%7);a.resetDateToStartOfDay(t)}};a.resetDateToEndOfWeek=function(t,n){if(a.isValidDate(t)){var i;if(n&&!(n instanceof Object)){e.error("DateUtils oSettings is not an object.");return}if(!n){n={}}if(n.iDuration===undefined){i=7}else{i=n.iDuration;if(isNaN(i)||!isFinite(i)){e.error("DateUtils duration value ='"+i+"' is invalid.");return}}a.resetDateToStartOfWeek(t,n.iFirstDayOfWeek);t.setDate(t.getDate()+i-1);a.resetDateToEndOfDay(t)}};a.isValidDate=function(t){if(Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime())){e.error("DateUtils invalid date="+t);return false}return true};a.dateDaysEqual=function(e,t){if(a.isValidDate(e)&&a.isValidDate(t)){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}return false};a.dateMonthsEqual=function(e,t){if(a.isValidDate(e)&&a.isValidDate(t)){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()}return false};a.incrementDateByIndex=function(e,n){var i=null;if(a.isValidDate(e)&&isFinite(n)){i=t.getInstance(e);i.setDate(e.getDate()+parseInt(n,10))}return i};a.incrementMonthByIndex=function(e,n){var i=null;if(a.isValidDate(e)&&isFinite(n)){i=t.getInstance(e);a.resetDateToStartOfMonth(i);i.setMonth(e.getMonth()+parseInt(n,10))}return i};a.numberOfMonthsApart=function(e,n){e=t.getInstance(e);n=t.getInstance(n);a.resetDateToStartOfMonth(e);a.resetDateToStartOfMonth(n);var i=e.getTime()<=n.getTime();var r=0,s=0,o=0;for(r=0,s=0;!(e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear());r++,s--){if(i){e.setMonth(e.getMonth()+1)}else{e.setMonth(e.getMonth()-1)}}if(i){o=r}else{o=s}return o};a.numberOfDaysApart=function(e,n){e=t.getInstance(e);n=t.getInstance(n);a.resetDateToStartOfDay(e);a.resetDateToStartOfDay(n);var i=24*60*60*1e3;var r=Math.round(Math.abs((e.getTime()-n.getTime())/i));if(e.getTime()>n.getTime()){return-r}else{return r}};a.parseDate=function(e,a){if(e instanceof Date||!e){return e}a=a!==false;if(typeof e==="string"){var n=/Date\((-*\d+)\)/.exec(e);if(n===null){if(a){var i=Date.parse(e);if(!isNaN(i)){e=t.getInstance(i)}else if(!isNaN(e)){e=t.getInstance(parseInt(e,10))}}}else{e=t.getInstance(parseInt(n[1],10))}}else{e=t.getInstance(parseInt(e,10))}return e};return a},true);
sap.ui.predefine("sap/suite/ui/commons/util/FullScreenUtil", ["sap/m/Dialog","sap/ui/core/HTML"],function(e,l){"use strict";var o={toggleFullScreen:function(o,r,t,f){var n;if(r){n=o.getDomRef();if(n){if(!o._oHTML){o._oHTML=new l({preferDOM:false,afterRendering:function(){if(o&&o._oHTML){var e=o._oHTML.getDomRef();if(e){e.style.height="100%";e.append(o.getDomRef());o._prevOverflowX=o.getDomRef().style.overflowX;o._prevOverflowY=o.getDomRef().style.overflowY;o.getDomRef().style.overflowX="";o.getDomRef().style.overflowY=""}}}})}if(!o._oFullScreenDialog){o._oFullScreenDialog=new e({showHeader:false,stretch:true,beforeClose:function(){if(o&&o._placeHolder&&f){f.call(o,false)}},content:[o._oHTML]});if(t){o._oFullScreenDialog.attachAfterOpen(function(){t.focus()});o._oFullScreenDialog.attachAfterClose(function(){t.focus()})}}o._placeHolder=document.createElement("div");n.parentNode.insertBefore(o._placeHolder,n);o._oHTML.setContent("<div></div>")}o._oFullScreenDialog.open()}else if(o._placeHolder&&o._oHTML){var i=o.getHeight&&o.getHeight();var a=o.getDomRef();if(i&&i!==a.style.height){a.style.height=i}n=o._oHTML.getDomRef();o._placeHolder.parentNode.replaceChild(n.children[0],o._placeHolder);o._placeHolder=null;n=null;o.getDomRef().style.overflowX=o._prevOverflowX;o.getDomRef().style.overflowY=o._prevOverflowY;if(o._oFullScreenDialog){o._oFullScreenDialog.close()}}},cleanUpFullScreen:function(e){if(e._oFullScreenDialog){e._oFullScreenDialog.destroy();e._oFullScreenDialog=null}e._placeHolder=null;e._oHTML=null}};return o},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/HtmlElement", ["sap/ui/base/Object","sap/ui/core/Control","./HtmlElementRenderer","sap/base/assert","sap/base/security/encodeXML","sap/base/Log"],function(t,s,e,i,r,a){"use strict";var n=t.extend("sap.suite.ui.commons.util.HtmlElement",{constructor:function(s){t.apply(this,arguments);i(typeof s==="string","Element name must be a string.");this._sName=s;this._mAttributes={};this._aChildren=[]}});n.prototype.getRenderer=function(){return new e(this)};n.prototype.setId=function(t,s){i(typeof t==="string","Id must by a string.");this.setAttribute("id",t);if(s){this.setAttribute("data-sap-ui",t)}};n.prototype.setAttribute=function(t,s,e){i(typeof t==="string","Key must by a string.");i(typeof s==="string"||typeof s==="number"||typeof s==="boolean","Value must be a string, number or boolean");var n=String(s);if(e){n=r(n)}if(t in this._mAttributes){a.warning("Replacing an already existing attribute.","Attribute key = "+t+", old value = "+this._mAttributes[t]+", new value = "+n,this)}if(t==="style"){var o=n.split(";");if(!this._mAttributes.style){this._mAttributes.style={}}for(var u=0;u<o.length;u++){var l=o[u].split(/:(.+)/),m=l.splice(0,1)[0].trim(),p=l.join("").trim();this._mAttributes.style[m]=p}}else{this._mAttributes[t]=n}};n.prototype.addClass=function(t){i(typeof t==="string","Class must be a string.");if(!this._mAttributes.class){this._mAttributes.class=[]}else{i(Array.isArray(this._mAttributes.class),"Cannot add class to customly added classes.")}this._mAttributes.class.push(t)};n.prototype.addStyle=function(t,s){i(typeof t==="string","Name must be a string.");i(typeof s==="string"||typeof s==="number","Value must be a string or a number.");if(!this._mAttributes.style){this._mAttributes.style={}}this._mAttributes.style[t]=s};n.prototype.addControlData=function(t){i(t instanceof s,"Control must be a sapui5 control.");this.setId(t.getId(),true);var e=this;t.getCustomData().forEach(function(s){var i=s._checkWriteToDom(t);if(i){e.setAttribute(i.key,i.value,true)}});if(t.aCustomStyleClasses&&t.aCustomStyleClasses.length>0){t.aCustomStyleClasses.forEach(function(t){e.addClass(r(t))})}};n.prototype.addChild=function(t){i(typeof t==="string"||t instanceof n||t instanceof s,"Child must be a string, HtmlElement or a Control.");this._aChildren.push(t)};n.prototype.addChildEscaped=function(t,s){i(typeof t==="string","sText must be a string");t=r(t);if(s){t=t.replace(/&#xa;/g,"<br>")}this._aChildren.push(t)};return n});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/HtmlElementRenderer", ["sap/ui/base/Object","sap/ui/core/Control","sap/base/Log"],function(e,t,r){"use strict";var n;var i=e.extend("sap.suite.ui.commons.util.HtmlElementRenderer",{constructor:function(t){e.apply(this,arguments);this._oHtmlElement=t}});i.apiVersion=2;i.prototype.render=function(e){e.openStart(this._oHtmlElement._sName);this._renderAttributes(e);e.openEnd();if(this._oHtmlElement._aChildren.length>0){this._renderChildren(e)}e.close(this._oHtmlElement._sName)};i.prototype._renderAttributes=function(e){var t=this._oHtmlElement._mAttributes;for(var r in t){if(!t.hasOwnProperty(r)){continue}var n=t[r];switch(r){case"class":if(Array.isArray(n)){for(var i in n){e.class(n[i])}}else{e.class(n)}break;case"style":if(typeof n==="object"&&!!n){for(var s in n){e.style(s,n[s])}}break;default:if(Array.isArray(n)){n=n.join("")}e.attr(r,n)}}};i.prototype._renderChildren=function(e){if(typeof n==="undefined"){n=sap.ui.require("sap/suite/ui/commons/util/HtmlElement")}this._oHtmlElement._aChildren.forEach(function(i){if(typeof i==="string"){e.unsafeHtml(i)}else if(n&&i instanceof n){i.getRenderer().render(e)}else if(i instanceof t){e.renderControl(i)}else{r.error(typeof i+" cannot be a child of a HTML element. Skipping rendering for this child.")}})};return i});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/ManagedObjectRegister", ["sap/ui/base/Object","sap/ui/base/ManagedObject","sap/base/assert","sap/base/Log"],function(e,t,i,s){"use strict";var r=e.extend("sap.suite.ui.commons.util.ManagedObjectRegister",{constructor:function(){e.apply(this,arguments);this._mRegister={}}});r.prototype.register=function(e,r){i(typeof e==="string","Key must be a string.");e=e[0].toUpperCase()+e.substr(1);var o="get"+e;if(typeof this._mRegister[e]!=="undefined"){this.destroyObject(e)}if(typeof r==="function"){this._mRegister[e]={fFactory:r,oValue:undefined}}else if(r instanceof t){this._mRegister[e]={fFactory:undefined,oValue:r}}else{s.error("oFactoryFunction must be either a factory function or a managed object.");return}if(o!=="getObject"){this[o]=function(){return this.getObject(e)}}};r.prototype.getObject=function(e){var s;e=e||"Object";s=this._mRegister[e];if(s){if(typeof s.oValue==="undefined"){s.oValue=s.fFactory(e);i(s.oValue instanceof t,"Factory class must return a managed object.")}return s.oValue}return null};r.prototype.isObjectInitialized=function(e){var t;t=this._mRegister[e];return t&&typeof t.oValue!=="undefined"};r.prototype.destroyObject=function(e){var t;i(typeof e==="string","Key must be a string.");t=this._mRegister[e];if(t){if(t.oValue){t.oValue.destroy()}if(e!=="Object"){delete this["get"+e]}delete this._mRegister[e]}};r.prototype.destroyAll=function(){var e,t;for(e in this._mRegister){t=this._mRegister[e];if(t.oValue){t.oValue.destroy()}if(e!=="Object"){delete this["get"+e]}}this._mRegister={}};return r});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/RenderUtils", ["sap/ui/base/Object","sap/base/security/encodeXML"],function(e,t){"use strict";var r=function(e){this._rm=e};r.prototype=Object.create(e.prototype||null);r.prototype._getRenderManager=function(){if(!this._rm){throw new Error("Render manager not defined")}return this._rm};r.prototype.writeOpeningTag=function(e,r){r=r||{};var i=this._getRenderManager();var s;i.write("<");i.writeEscaped(e);if(r.classes){for(var a=0;a<r.classes.length;a++){i.addClass(t(r.classes[a]))}i.writeClasses()}if(r.attributes){for(s in r.attributes){i.writeAttribute(s,r.attributes[s])}}if(r.escapedAttributes){for(s in r.escapedAttributes){i.writeAttributeEscaped(s,r.escapedAttributes[s])}}i.write(">")};r.prototype.writeClosingTag=function(e){var t=this._getRenderManager();t.write("</");t.writeEscaped(e);t.write(">")};return r},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/suite/ui/commons/util/StringSliderTooltip", ["sap/m/SliderTooltipBase"],function(t){"use strict";var e=t.extend("sap.suite.ui.commons.util.StringSliderTooltip",{metadata:{library:"sap.suite.ui.commons.util",properties:{mapFunction:{type:"any",group:"Misc"},fetchValue2:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:{apiVersion:2,render:function(t,e){var i=e.getStringValue();if(!i){return}t.openStart("div",e);t.class("sapMSliderTooltip").class("sapSuiteUiCommonsStringSliderTooltip");t.openEnd();t.text(i);t.close("div")}}});e.prototype.getStringValue=function(){var t=this.getParent();if(!t){return null}var e=this.getFetchValue2()?t.getValue2():t.getValue();var i=this.getMapFunction()||String;return i(e)};e.prototype.sliderValueChanged=function(t){var e=this.getMapFunction()||String,i=e(t);this.$().text(i)};return e});
sap.ui.predefine("sap/suite/ui/commons/windowmessages/CollaborationMessageBroker", ["sap/base/Log"],function(e){"use strict";var n;var o=e.getLogger("sap.suite.ui.commons.windowmessages.CollaborationMessageBroker");function s(e){o.info("CollaborationMessageBroker instance is created");var n="sap-suite-ui-commons-collaboration-message-broker";var s="collaboration-channel";var i="get-provider-config";var t=[{channelId:s,version:"1.0"}];var a=function(t,a,r){o.info("Message Received from CLIENT_ID: "+t+" on CHANNEL_ID: "+a);if(r===i){sap.ushell.Container.getServiceAsync("MessageBroker").then(function(a){var r=JSON.stringify(e);a.publish(s,n,Date.now().toString(),i,[t],r).then(function(){o.info("Configuration published successfully to CLIENT_ID: "+t+" on CHANNEL_ID: "+s+" DATA: "+r)})})}else{o.info("Message: '"+r+"' is not supported")}};if(sap.ushell&&sap.ushell.Container){sap.ushell.Container.getServiceAsync("MessageBroker").then(function(e){e.connect(n).then(function(){o.info("Client ID: "+n+" is connected successfully");e.subscribe(n,t,a,Function.prototype)})})}}return{startInstance:function(e){o.info("CollaborationMessageBroker=>startInstance method is being called");if(!n){n=new s(e)}}}});
sap.ui.require.preload({
	"sap/suite/ui/commons/collaboration/ContactHelper.js":function(){
sap.ui.loader.config({shim:{"sap/suite/ui/commons/thirdparty/msal-browser":{amd:true,exports:"msal-browser"}}});sap.ui.define(["sap/ui/core/mvc/Controller","sap/suite/ui/commons/collaboration/GraphApiConfig","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/m/library","sap/ui/core/Core","sap/ui/model/resource/ResourceModel","sap/suite/ui/commons/thirdparty/msal-browser"],function(e,t,n,o,i,s,r){"use strict";var a=s.getLibraryResourceBundle("sap.suite.ui.commons");var c=new r({bundle:a});return e.extend("sap.suite.ui.commons.collaboration.ContactHelper",{constructor:function(e){this.oGraphApiConfig=t.getConfig(e);this.myMSALObj=new msal.PublicClientApplication(this.oGraphApiConfig.msalConfig)},handleMultipleAccounts:function(){var e=myMSALObj.getAllAccounts();if(e.length===0){console.warn("No account detected.")}else if(e.length>1){console.warn("Multiple accounts detected.")}else if(e.length===1){this.sUserName=e[0].username}},callApi:function(e,t){var n=new Headers;var o="Bearer "+t;n.append("Authorization",o);return fetch(e,{method:"GET",headers:n})},signIn:function(){return this.myMSALObj.loginPopup(this.oGraphApiConfig.loginRequest).then(function(e){if(e!==null){this.sUserName=e.account.username}else{this.handleMultipleAccounts()}return Promise.resolve(this.myMSALObj.getAccountByUsername(this.sUserName))}.bind(this)).catch(function(e){return Promise.reject(e)})},getAccount:function(){if(this.sUserName){return Promise.resolve(this.myMSALObj.getAccountByUsername(this.sUserName))}else{return this.signIn()}},getToken:function(e){return new Promise(function(t,n){this.getAccount().then(function(t){e.account=t;return this.myMSALObj.acquireTokenSilent(e)}.bind(this)).then(function(e){this.loginResponse=e;t(e)}.bind(this)).catch(function(o){if(o instanceof msal.InteractionRequiredAuthError){this.myMSALObj.acquireTokenPopup(e).then(function(e){this.loginResponse=e;t(e)}).catch(function(){console.error(o);n(o)})}else{console.error(o);n(o)}})}.bind(this))},getFullProfileByEmail:function(e){return this.getToken(this.oGraphApiConfig.loginRequest).then(function(t){var n=this.callApi(this.oGraphApiConfig.graphApiEndpoints.graphUserEndpoint+"/"+e+"?$select=displayName,jobTitle,mail,mobilePhone,officeLocation,businessPhones,department,employeeOrgData",t.accessToken).then(function(e){return e.json()});var o=this.callApi(this.oGraphApiConfig.graphApiEndpoints.graphUserEndpoint+"/"+e+"/presence",t.accessToken).then(function(e){return e.json()});var i=this.getPhotoByEmail(e);return Promise.all([n,o,i]).then(function(e){var t=Object.assign(e[0],e[1]);t.photo=e[2];return t})}.bind(this))},getPhotoByEmail:function(e){if(!e||e.length===0){return Promise.resolve()}return this.checkExistingToken().then(function(t){return this.callApi(this.oGraphApiConfig.graphApiEndpoints.graphUserEndpoint+"/"+e+"/photo/$value",t.accessToken)}.bind(this)).then(function(e){return e.blob()}).then(function(e){return URL.createObjectURL(e)})},checkExistingToken:function(){if(this.loginResponse){return Promise.resolve(this.loginResponse)}else{return this.getToken(this.oGraphApiConfig.loginRequest)}},sendChatMessage:function(){var e=sap.ui.getCore().byId("msTeamsQuickChat").getValue();this.checkExistingToken().then(function(e){this.oHeaders=new Headers;var t="Bearer "+e.accessToken;this.endpoint="https://graph.microsoft.com/v1.0/chats";var n="{\n"+'    "chatType": "oneOnOne",\n'+'    "members": [\n'+"        {\n"+'            "@odata.type": "#microsoft.graph.aadUserConversationMember",\n'+'            "roles": [\n'+'                "owner"\n'+"            ],\n"+'            "user@odata.bind": "https://graph.microsoft.com/v1.0/users(\''+e.account.username+"')\"\n"+"        },\n"+"        {\n"+'            "@odata.type": "#microsoft.graph.aadUserConversationMember",\n'+'            "roles": [\n'+'                "owner"\n'+"            ],\n"+'            "user@odata.bind": "https://graph.microsoft.com/v1.0/users(\''+this.sEmail+"')\"\n"+"        }\n"+"    ]\n"+"}";this.oHeaders.append("Authorization",t);this.oHeaders.append("Content-Type","application/json");return fetch(this.endpoint,{method:"POST",headers:this.oHeaders,body:n})}.bind(this)).then(function(e){return e.text()}).then(function(t){var n=JSON.parse(t);var o="{\n"+'  "body": {\n'+'     "content": "'+e+'" \n '+"  }\n"+"}";return fetch(this.endpoint+"/"+encodeURIComponent(n.id)+"/messages",{method:"POST",headers:this.oHeaders,body:o})}.bind(this)).then(function(e){console.log(e)})},handleMSTeamsPress:function(e){var t=e.getSource().data("email");var n=e.getSource().data("type");var o="";switch(n){case"chat":o="https://teams.microsoft.com/l/chat/0/0?users="+t;break;case"videoCall":o="https://teams.microsoft.com/l/call/0/0?users="+t+"&withVideo=true";break;case"call":o="https://teams.microsoft.com/l/call/0/0?users="+t;break;default:break}i.URLHelper.redirect(o,true)},formatUri:function(e){var t=/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/;if(t.test(e)){return"mailto:"+e}else{return"tel:"+e}},loadContactPopover:function(e){this.sEmail=e;return this.getFullProfileByEmail(e).then(function(e){if(e&&e.error){return Promise.reject(e)}var t=new o(e);t.setData(e);return n.load({name:"sap.suite.ui.commons.collaboration.ContactPopover",controller:this,type:"XML"}).then(function(e){this._oContactPopover=e;e.setModel(t,"userData");e.setModel(c,"i18n");return e}.bind(this))}.bind(this))},afterClose:function(){this._oContactPopover.destroy()}})});
},
	"sap/suite/ui/commons/collaboration/ContactPopover.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n    xmlns:macrodata="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"><Popover\n\t\tid="ContactPopover"\n\t\tclass="sapUiContentPadding"\n\t\tplacement="Left"\n\t\tinitialFocus="action"\n        showHeader="false"\n        contentWidth="25rem"\n        afterClose="afterClose"><VBox><HBox><Avatar\n                    src="{= ${userData>/photo} ? ${userData>/photo} : \'sap-icon://person-placeholder\' }"\n                    displaySize="S"\n                    class="sapUiTinyMarginEnd"\n                /><VBox><Title text="{userData>/displayName}" level="H3" /><Text text="{userData>/department}"/></VBox></HBox><HBox><Button\n                    press="handleMSTeamsPress"\n                    macrodata:email="{userData>/mail}"\n                    macrodata:type="chat"\n                    icon="sap-icon://discussion"\n                    type="Transparent"\n                    class="sapUiSmallMarginEnd"\n                /><Button\n                    press="handleMSTeamsPress"\n                    macrodata:email="{userData>/mail}"\n                    macrodata:type="videoCall"\n                    icon="sap-icon://video"\n                    type="Transparent"\n                    class="sapUiSmallMarginEnd"\n                /><Button\n                    press="handleMSTeamsPress"\n                    macrodata:email="{userData>/mail}"\n                    macrodata:type="call"\n                    icon="sap-icon://call"\n                    type="Transparent"\n                /></HBox><FlexBox alignItems="Start"><Input placeholder="{i18n>POPOVER_CONTACT_SEND_MESSAGE}" id="msTeamsQuickChat" width="100%"><layoutData><FlexItemData growFactor="1" /></layoutData></Input><Button\n                    press="sendChatMessage"\n                    type="Transparent"\n                    icon="sap-icon://paper-plane"><layoutData><FlexItemData growFactor="0" /></layoutData></Button></FlexBox><Title text="{i18n>POPOVER_CONTACT_INFORMATION}" level="H5" class="sapUiTinyMarginBottom sapUiTinyMarginTop" /><Label text="{i18n>POPOVER_CONTACT_SECTION_EMAIL}:" /><Link text="{userData>/mail}" href="{path: \'userData>/mail\', formatter: \'.formatUri\'}" class="sapUiTinyMarginBottom" /><Label text="{i18n>POPOVER_CONTACT_SECTION_PHONE}:" /><Link text="{userData>/businessPhones/0}" href="{path: \'userData>/businessPhones/0\', formatter: \'.formatUri\'}" class="sapUiTinyMarginBottom" /><Label text="{i18n>POPOVER_CONTACT_SECTION_MOBILE}:" /><Link text="{userData>/mobilePhone}" href="{path: \'userData>/mobilePhone\', formatter: \'.formatUri\'}" class="sapUiTinyMarginBottom" /><Title text="{i18n>POPOVER_CONTACT_SECTION_COMPANY}" level="H5" class="sapUiTinyMarginBottom" /><Label text="{i18n>POPOVER_CONTACT_SECTION_JOBTITLE}:" /><Text text="{userData>/jobTitle}" class="sapUiTinyMarginBottom" /><Label text="{i18n>POPOVER_CONTACT_SECTION_OFFICE_LOCATION}:" /><Text text="{userData>/officeLocation}" /></VBox></Popover></core:FragmentDefinition>',
	"sap/suite/ui/commons/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.suite.ui.commons","type":"library","embeds":[],"applicationVersion":{"version":"1.115.0"},"title":"SAP UI library: sap.suite.ui.commons","description":"SAP UI library: sap.suite.ui.commons","ach":"CA-UI5-SC","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"@azure/msal-browser","packagedWithMySelf":true,"version":"2.22.0"}]},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.115","libs":{"sap.ui.core":{"minVersion":"1.115.0"},"sap.m":{"minVersion":"1.115.0"},"sap.suite.ui.microchart":{"minVersion":"1.115.0","lazy":true},"sap.ui.ux3":{"minVersion":"1.115.0","lazy":true},"sap.ui.comp":{"minVersion":"1.115.0","lazy":true},"sap.viz":{"minVersion":"1.115.0","lazy":true},"sap.ui.commons":{"minVersion":"1.115.0","lazy":true}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":[],"interfaces":[]}}}}',
	"sap/suite/ui/commons/thirdparty/msal-browser.js":function(){
"use strict";(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports):typeof define==="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.msal={}))})(this,function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return t(e,r)};function r(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){n=Object.assign||function e(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i))t[i]=r[i]}return t};return n.apply(this,arguments)};function o(e,t,r,n){function o(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n["throw"](e))}catch(e){i(e)}}function c(e){e.done?r(e.value):o(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())})}function i(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return c([e,t])}}function c(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,o&&(i=a[0]&2?o["return"]:a[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;if(o=0,i)a=[a[0]&2,i.value];switch(a[0]){case 0:case 1:i=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;o=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1];i=a;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(a);break}if(i[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e];o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}function a(e,t){var r=typeof Symbol==="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{while((t===void 0||t-- >0)&&!(o=n.next()).done)i.push(o.value)}catch(e){a={error:e}}finally{try{if(o&&!o.done&&(r=n["return"]))r.call(n)}finally{if(a)throw a.error}}return i}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var c=function(e,t){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return c(e,t)};function u(e,t){c(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){d=Object.assign||function e(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i))t[i]=r[i]}return t};return d.apply(this,arguments)};function l(e,t,r,n){function o(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n["throw"](e))}catch(e){i(e)}}function c(e){e.done?r(e.value):o(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())})}function h(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return c([e,t])}}function c(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,o&&(i=a[0]&2?o["return"]:a[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;if(o=0,i)a=[a[0]&2,i.value];switch(a[0]){case 0:case 1:i=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;o=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1];i=a;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(a);break}if(i[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e];o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}function p(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var f={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]};var g=[f.OPENID_SCOPE,f.PROFILE_SCOPE,f.OFFLINE_ACCESS_SCOPE];var v=p(g,[f.EMAIL_SCOPE]);var y;(function(e){e["CONTENT_TYPE"]="Content-Type";e["RETRY_AFTER"]="Retry-After";e["CCS_HEADER"]="X-AnchorMailbox";e["WWWAuthenticate"]="WWW-Authenticate";e["AuthenticationInfo"]="Authentication-Info"})(y||(y={}));var m;(function(e){e["ID_TOKEN"]="idtoken";e["CLIENT_INFO"]="client.info";e["ADAL_ID_TOKEN"]="adal.idtoken";e["ERROR"]="error";e["ERROR_DESC"]="error.description";e["ACTIVE_ACCOUNT"]="active-account"})(m||(m={}));var E;(function(e){e["COMMON"]="common";e["ORGANIZATIONS"]="organizations";e["CONSUMERS"]="consumers"})(E||(E={}));var C;(function(e){e["CLIENT_ID"]="client_id";e["REDIRECT_URI"]="redirect_uri";e["RESPONSE_TYPE"]="response_type";e["RESPONSE_MODE"]="response_mode";e["GRANT_TYPE"]="grant_type";e["CLAIMS"]="claims";e["SCOPE"]="scope";e["ERROR"]="error";e["ERROR_DESCRIPTION"]="error_description";e["ACCESS_TOKEN"]="access_token";e["ID_TOKEN"]="id_token";e["REFRESH_TOKEN"]="refresh_token";e["EXPIRES_IN"]="expires_in";e["STATE"]="state";e["NONCE"]="nonce";e["PROMPT"]="prompt";e["SESSION_STATE"]="session_state";e["CLIENT_INFO"]="client_info";e["CODE"]="code";e["CODE_CHALLENGE"]="code_challenge";e["CODE_CHALLENGE_METHOD"]="code_challenge_method";e["CODE_VERIFIER"]="code_verifier";e["CLIENT_REQUEST_ID"]="client-request-id";e["X_CLIENT_SKU"]="x-client-SKU";e["X_CLIENT_VER"]="x-client-VER";e["X_CLIENT_OS"]="x-client-OS";e["X_CLIENT_CPU"]="x-client-CPU";e["X_CLIENT_CURR_TELEM"]="x-client-current-telemetry";e["X_CLIENT_LAST_TELEM"]="x-client-last-telemetry";e["X_MS_LIB_CAPABILITY"]="x-ms-lib-capability";e["POST_LOGOUT_URI"]="post_logout_redirect_uri";e["ID_TOKEN_HINT"]="id_token_hint";e["DEVICE_CODE"]="device_code";e["CLIENT_SECRET"]="client_secret";e["CLIENT_ASSERTION"]="client_assertion";e["CLIENT_ASSERTION_TYPE"]="client_assertion_type";e["TOKEN_TYPE"]="token_type";e["REQ_CNF"]="req_cnf";e["OBO_ASSERTION"]="assertion";e["REQUESTED_TOKEN_USE"]="requested_token_use";e["ON_BEHALF_OF"]="on_behalf_of";e["FOCI"]="foci";e["CCS_HEADER"]="X-AnchorMailbox";e["RETURN_SPA_CODE"]="return_spa_code";e["LOGOUT_HINT"]="logout_hint"})(C||(C={}));var T;(function(e){e["ACCESS_TOKEN"]="access_token";e["XMS_CC"]="xms_cc"})(T||(T={}));var S={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};var I;(function(e){e["ACCOUNT"]="account";e["SID"]="sid";e["LOGIN_HINT"]="login_hint";e["ID_TOKEN"]="id_token";e["DOMAIN_HINT"]="domain_hint";e["ORGANIZATIONS"]="organizations";e["CONSUMERS"]="consumers";e["ACCOUNT_ID"]="accountIdentifier";e["HOMEACCOUNT_ID"]="homeAccountIdentifier"})(I||(I={}));var w={PLAIN:"plain",S256:"S256"};var A;(function(e){e["QUERY"]="query";e["FRAGMENT"]="fragment";e["FORM_POST"]="form_post"})(A||(A={}));var _;(function(e){e["IMPLICIT_GRANT"]="implicit";e["AUTHORIZATION_CODE_GRANT"]="authorization_code";e["CLIENT_CREDENTIALS_GRANT"]="client_credentials";e["RESOURCE_OWNER_PASSWORD_GRANT"]="password";e["REFRESH_TOKEN_GRANT"]="refresh_token";e["DEVICE_CODE_GRANT"]="device_code";e["JWT_BEARER"]="urn:ietf:params:oauth:grant-type:jwt-bearer"})(_||(_={}));var R;(function(e){e["MSSTS_ACCOUNT_TYPE"]="MSSTS";e["ADFS_ACCOUNT_TYPE"]="ADFS";e["MSAV1_ACCOUNT_TYPE"]="MSA";e["GENERIC_ACCOUNT_TYPE"]="Generic"})(R||(R={}));var b;(function(e){e["CACHE_KEY_SEPARATOR"]="-";e["CLIENT_INFO_SEPARATOR"]="."})(b||(b={}));var O;(function(e){e["ID_TOKEN"]="IdToken";e["ACCESS_TOKEN"]="AccessToken";e["ACCESS_TOKEN_WITH_AUTH_SCHEME"]="AccessToken_With_AuthScheme";e["REFRESH_TOKEN"]="RefreshToken"})(O||(O={}));var k;(function(e){e["ACCOUNT"]="Account";e["CREDENTIAL"]="Credential";e["ID_TOKEN"]="IdToken";e["ACCESS_TOKEN"]="AccessToken";e["REFRESH_TOKEN"]="RefreshToken";e["APP_METADATA"]="AppMetadata";e["TEMPORARY"]="TempCache";e["TELEMETRY"]="Telemetry";e["UNDEFINED"]="Undefined";e["THROTTLING"]="Throttling"})(k||(k={}));var N;(function(e){e[e["ADFS"]=1001]="ADFS";e[e["MSA"]=1002]="MSA";e[e["MSSTS"]=1003]="MSSTS";e[e["GENERIC"]=1004]="GENERIC";e[e["ACCESS_TOKEN"]=2001]="ACCESS_TOKEN";e[e["REFRESH_TOKEN"]=2002]="REFRESH_TOKEN";e[e["ID_TOKEN"]=2003]="ID_TOKEN";e[e["APP_METADATA"]=3001]="APP_METADATA";e[e["UNDEFINED"]=9999]="UNDEFINED"})(N||(N={}));var P="appmetadata";var U="client_info";var M="1";var L={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24};var H;(function(e){e["CONFIG"]="config";e["CACHE"]="cache";e["NETWORK"]="network"})(H||(H={}));var q={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};e.AuthenticationScheme=void 0;(function(e){e["BEARER"]="Bearer";e["POP"]="pop";e["SSH"]="ssh-cert"})(e.AuthenticationScheme||(e.AuthenticationScheme={}));var D={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"};var K={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"};var F;(function(e){e["username"]="username";e["password"]="password"})(F||(F={}));var x;(function(e){e[e["httpSuccess"]=200]="httpSuccess";e[e["httpBadRequest"]=400]="httpBadRequest"})(x||(x={}));var B;(function(e){e["FAILED_AUTO_DETECTION"]="1";e["INTERNAL_CACHE"]="2";e["ENVIRONMENT_VARIABLE"]="3";e["IMDS"]="4"})(B||(B={}));var G;(function(e){e["CONFIGURED_MATCHES_DETECTED"]="1";e["CONFIGURED_NO_AUTO_DETECTION"]="2";e["CONFIGURED_NOT_DETECTED"]="3";e["AUTO_DETECTION_REQUESTED_SUCCESSFUL"]="4";e["AUTO_DETECTION_REQUESTED_FAILED"]="5"})(G||(G={}));var j;(function(e){e["NO_CACHE_HIT"]="0";e["FORCE_REFRESH"]="1";e["NO_CACHED_ACCESS_TOKEN"]="2";e["CACHED_ACCESS_TOKEN_EXPIRED"]="3";e["REFRESH_CACHED_ACCESS_TOKEN"]="4"})(j||(j={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var z={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}};var W=function(e){u(t,e);function t(r,n,o){var i=this;var a=n?r+": "+n:r;i=e.call(this,a)||this;Object.setPrototypeOf(i,t.prototype);i.errorCode=r||f.EMPTY_STRING;i.errorMessage=n||"";i.subError=o||"";i.name="AuthError";return i}t.prototype.setCorrelationId=function(e){this.correlationId=e};t.createUnexpectedError=function(e){return new t(z.unexpectedError.code,z.unexpectedError.desc+": "+e)};return t}(Error);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Y={createNewGuid:function(){var e="Crypto interface - createNewGuid() has not been implemented";throw W.createUnexpectedError(e)},base64Decode:function(){var e="Crypto interface - base64Decode() has not been implemented";throw W.createUnexpectedError(e)},base64Encode:function(){var e="Crypto interface - base64Encode() has not been implemented";throw W.createUnexpectedError(e)},generatePkceCodes:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - generatePkceCodes() has not been implemented";throw W.createUnexpectedError(e)})})},getPublicKeyThumbprint:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - getPublicKeyThumbprint() has not been implemented";throw W.createUnexpectedError(e)})})},removeTokenBindingKey:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - removeTokenBindingKey() has not been implemented";throw W.createUnexpectedError(e)})})},clearKeystore:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - clearKeystore() has not been implemented";throw W.createUnexpectedError(e)})})},signJwt:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - signJwt() has not been implemented";throw W.createUnexpectedError(e)})})},hashString:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Crypto interface - hashString() has not been implemented";throw W.createUnexpectedError(e)})})}};
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Q={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. "+"Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."}};var V=function(e){u(t,e);function t(r,n){var o=e.call(this,r,n)||this;o.name="ClientAuthError";Object.setPrototypeOf(o,t.prototype);return o}t.createClientInfoDecodingError=function(e){return new t(Q.clientInfoDecodingError.code,Q.clientInfoDecodingError.desc+" Failed with error: "+e)};t.createClientInfoEmptyError=function(){return new t(Q.clientInfoEmptyError.code,""+Q.clientInfoEmptyError.desc)};t.createTokenParsingError=function(e){return new t(Q.tokenParsingError.code,Q.tokenParsingError.desc+" Failed with error: "+e)};t.createTokenNullOrEmptyError=function(e){return new t(Q.nullOrEmptyToken.code,Q.nullOrEmptyToken.desc+" Raw Token Value: "+e)};t.createEndpointDiscoveryIncompleteError=function(e){return new t(Q.endpointResolutionError.code,Q.endpointResolutionError.desc+" Detail: "+e)};t.createNetworkError=function(e,r){return new t(Q.networkError.code,Q.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])};t.createUnableToGetOpenidConfigError=function(e){return new t(Q.unableToGetOpenidConfigError.code,Q.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)};t.createHashNotDeserializedError=function(e){return new t(Q.hashNotDeserialized.code,Q.hashNotDeserialized.desc+" Given Object: "+e)};t.createInvalidStateError=function(e,r){return new t(Q.invalidStateError.code,Q.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)};t.createStateMismatchError=function(){return new t(Q.stateMismatchError.code,Q.stateMismatchError.desc)};t.createStateNotFoundError=function(e){return new t(Q.stateNotFoundError.code,Q.stateNotFoundError.desc+":  "+e)};t.createNonceMismatchError=function(){return new t(Q.nonceMismatchError.code,Q.nonceMismatchError.desc)};t.createNonceNotFoundError=function(e){return new t(Q.nonceNotFoundError.code,Q.nonceNotFoundError.desc+":  "+e)};t.createMultipleMatchingTokensInCacheError=function(){return new t(Q.multipleMatchingTokens.code,Q.multipleMatchingTokens.desc+".")};t.createMultipleMatchingAccountsInCacheError=function(){return new t(Q.multipleMatchingAccounts.code,Q.multipleMatchingAccounts.desc)};t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Q.multipleMatchingAppMetadata.code,Q.multipleMatchingAppMetadata.desc)};t.createTokenRequestCannotBeMadeError=function(){return new t(Q.tokenRequestCannotBeMade.code,Q.tokenRequestCannotBeMade.desc)};t.createAppendEmptyScopeToSetError=function(e){return new t(Q.appendEmptyScopeError.code,Q.appendEmptyScopeError.desc+" Given Scope: "+e)};t.createRemoveEmptyScopeFromSetError=function(e){return new t(Q.removeEmptyScopeError.code,Q.removeEmptyScopeError.desc+" Given Scope: "+e)};t.createAppendScopeSetError=function(e){return new t(Q.appendScopeSetError.code,Q.appendScopeSetError.desc+" Detail Error: "+e)};t.createEmptyInputScopeSetError=function(){return new t(Q.emptyInputScopeSetError.code,""+Q.emptyInputScopeSetError.desc)};t.createDeviceCodeCancelledError=function(){return new t(Q.DeviceCodePollingCancelled.code,""+Q.DeviceCodePollingCancelled.desc)};t.createDeviceCodeExpiredError=function(){return new t(Q.DeviceCodeExpired.code,""+Q.DeviceCodeExpired.desc)};t.createDeviceCodeUnknownError=function(){return new t(Q.DeviceCodeUnknownError.code,""+Q.DeviceCodeUnknownError.desc)};t.createNoAccountInSilentRequestError=function(){return new t(Q.NoAccountInSilentRequest.code,""+Q.NoAccountInSilentRequest.desc)};t.createNullOrUndefinedCacheRecord=function(){return new t(Q.invalidCacheRecord.code,Q.invalidCacheRecord.desc)};t.createInvalidCacheEnvironmentError=function(){return new t(Q.invalidCacheEnvironment.code,Q.invalidCacheEnvironment.desc)};t.createNoAccountFoundError=function(){return new t(Q.noAccountFound.code,Q.noAccountFound.desc)};t.createCachePluginError=function(){return new t(Q.CachePluginError.code,""+Q.CachePluginError.desc)};t.createNoCryptoObjectError=function(e){return new t(Q.noCryptoObj.code,""+Q.noCryptoObj.desc+e)};t.createInvalidCacheTypeError=function(){return new t(Q.invalidCacheType.code,""+Q.invalidCacheType.desc)};t.createUnexpectedAccountTypeError=function(){return new t(Q.unexpectedAccountType.code,""+Q.unexpectedAccountType.desc)};t.createUnexpectedCredentialTypeError=function(){return new t(Q.unexpectedCredentialType.code,""+Q.unexpectedCredentialType.desc)};t.createInvalidAssertionError=function(){return new t(Q.invalidAssertion.code,""+Q.invalidAssertion.desc)};t.createInvalidCredentialError=function(){return new t(Q.invalidClientCredential.code,""+Q.invalidClientCredential.desc)};t.createRefreshRequiredError=function(){return new t(Q.tokenRefreshRequired.code,Q.tokenRefreshRequired.desc)};t.createUserTimeoutReachedError=function(){return new t(Q.userTimeoutReached.code,Q.userTimeoutReached.desc)};t.createTokenClaimsRequiredError=function(){return new t(Q.tokenClaimsRequired.code,Q.tokenClaimsRequired.desc)};t.createNoAuthCodeInServerResponseError=function(){return new t(Q.noAuthorizationCodeFromServer.code,Q.noAuthorizationCodeFromServer.desc)};t.createBindingKeyNotRemovedError=function(){return new t(Q.bindingKeyNotRemovedError.code,Q.bindingKeyNotRemovedError.desc)};t.createLogoutNotSupportedError=function(){return new t(Q.logoutNotSupported.code,Q.logoutNotSupported.desc)};return t}(W);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var J=function(){function e(){}e.decodeAuthToken=function(t){if(e.isEmpty(t)){throw V.createTokenNullOrEmptyError(t)}var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;var n=r.exec(t);if(!n||n.length<4){throw V.createTokenParsingError("Given token is malformed: "+JSON.stringify(t))}var o={header:n[1],JWSPayload:n[2],JWSSig:n[3]};return o};e.isEmpty=function(e){return typeof e==="undefined"||!e||0===e.length};e.isEmptyObj=function(t){if(t&&!e.isEmpty(t)){try{var r=JSON.parse(t);return Object.keys(r).length===0}catch(e){}}return true};e.startsWith=function(e,t){return e.indexOf(t)===0};e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length};e.queryStringToObject=function(e){var t={};var r=e.split("&");var n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};r.forEach(function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];if(o&&i){t[n(o)]=n(i)}}});return t};e.trimArrayEntries=function(e){return e.map(function(e){return e.trim()})};e.removeEmptyStringsFromArray=function(t){return t.filter(function(t){return!e.isEmpty(t)})};e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}};e.matchPattern=function(e,t){var r=new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return r.test(t)};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */e.LogLevel=void 0;(function(e){e[e["Error"]=0]="Error";e[e["Warning"]=1]="Warning";e[e["Info"]=2]="Info";e[e["Verbose"]=3]="Verbose";e[e["Trace"]=4]="Trace"})(e.LogLevel||(e.LogLevel={}));var X=function(){function t(t,r,n){this.level=e.LogLevel.Info;var o=function(){return};this.localCallback=t.loggerCallback||o;this.piiLoggingEnabled=t.piiLoggingEnabled||false;this.level=typeof t.logLevel==="number"?t.logLevel:e.LogLevel.Info;this.correlationId=t.correlationId||"";this.packageName=r||f.EMPTY_STRING;this.packageVersion=n||f.EMPTY_STRING}t.prototype.clone=function(e,r,n){return new t({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,r)};t.prototype.logMessage=function(t,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii){return}var n=(new Date).toUTCString();var o;if(!J.isEmpty(r.correlationId)){o="["+n+"] : ["+r.correlationId+"]"}else if(!J.isEmpty(this.correlationId)){o="["+n+"] : ["+this.correlationId+"]"}else{o="["+n+"]"}var i=o+" : "+this.packageName+"@"+this.packageVersion+" : "+e.LogLevel[r.logLevel]+" - "+t;this.executeCallback(r.logLevel,i,r.containsPii||false)};t.prototype.executeCallback=function(e,t,r){if(this.localCallback){this.localCallback(e,t,r)}};t.prototype.error=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Error,containsPii:false,correlationId:r||""})};t.prototype.errorPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Error,containsPii:true,correlationId:r||""})};t.prototype.warning=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Warning,containsPii:false,correlationId:r||""})};t.prototype.warningPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Warning,containsPii:true,correlationId:r||""})};t.prototype.info=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Info,containsPii:false,correlationId:r||""})};t.prototype.infoPii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Info,containsPii:true,correlationId:r||""})};t.prototype.verbose=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Verbose,containsPii:false,correlationId:r||""})};t.prototype.verbosePii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Verbose,containsPii:true,correlationId:r||""})};t.prototype.trace=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Trace,containsPii:false,correlationId:r||""})};t.prototype.tracePii=function(t,r){this.logMessage(t,{logLevel:e.LogLevel.Trace,containsPii:true,correlationId:r||""})};t.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||false};return t}();var Z="@azure/msal-common";var $="6.1.0";
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */e.AzureCloudInstance=void 0;(function(e){e[e["None"]=0]="None";e["AzurePublic"]="https://login.microsoftonline.com";e["AzureChina"]="https://login.chinacloudapi.cn";e["AzureGermany"]="https://login.microsoftonline.de";e["AzureUsGovernment"]="https://login.microsoftonline.us"})(e.AzureCloudInstance||(e.AzureCloudInstance={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ee=function(){function t(){}t.prototype.generateAccountId=function(){return t.generateAccountIdForCacheKey(this.homeAccountId,this.environment)};t.prototype.generateCredentialId=function(){return t.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)};t.prototype.generateTarget=function(){return t.generateTargetForCacheKey(this.target)};t.prototype.generateCredentialKey=function(){return t.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)};t.prototype.generateType=function(){switch(this.credentialType){case O.ID_TOKEN:return N.ID_TOKEN;case O.ACCESS_TOKEN:case O.ACCESS_TOKEN_WITH_AUTH_SCHEME:return N.ACCESS_TOKEN;case O.REFRESH_TOKEN:return N.REFRESH_TOKEN;default:{throw V.createUnexpectedCredentialTypeError()}}};t.getCredentialType=function(e){if(e.indexOf(O.ACCESS_TOKEN.toLowerCase())!==-1){if(e.indexOf(O.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())!==-1){return O.ACCESS_TOKEN_WITH_AUTH_SCHEME}return O.ACCESS_TOKEN}else if(e.indexOf(O.ID_TOKEN.toLowerCase())!==-1){return O.ID_TOKEN}else if(e.indexOf(O.REFRESH_TOKEN.toLowerCase())!==-1){return O.REFRESH_TOKEN}return f.NOT_DEFINED};t.generateCredentialCacheKey=function(e,t,r,n,o,i,a,s,c){var u=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(s)];return u.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};t.generateAccountIdForCacheKey=function(e,t){var r=[e,t];return r.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};t.generateCredentialIdForCacheKey=function(e,t,r,n){var o=e===O.REFRESH_TOKEN?n||t:t;var i=[e,o,r||""];return i.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};t.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()};t.generateClaimsHashForCacheKey=function(e){return(e||"").toLowerCase()};t.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==e.AuthenticationScheme.BEARER.toLowerCase()?t.toLowerCase():""};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var te={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}};var re=function(e){u(t,e);function t(r,n){var o=e.call(this,r,n)||this;o.name="ClientConfigurationError";Object.setPrototypeOf(o,t.prototype);return o}t.createRedirectUriEmptyError=function(){return new t(te.redirectUriNotSet.code,te.redirectUriNotSet.desc)};t.createPostLogoutRedirectUriEmptyError=function(){return new t(te.postLogoutUriNotSet.code,te.postLogoutUriNotSet.desc)};t.createClaimsRequestParsingError=function(e){return new t(te.claimsRequestParsingError.code,te.claimsRequestParsingError.desc+" Given value: "+e)};t.createInsecureAuthorityUriError=function(e){return new t(te.authorityUriInsecure.code,te.authorityUriInsecure.desc+" Given URI: "+e)};t.createUrlParseError=function(e){return new t(te.urlParseError.code,te.urlParseError.desc+" Given Error: "+e)};t.createUrlEmptyError=function(){return new t(te.urlEmptyError.code,te.urlEmptyError.desc)};t.createEmptyScopesArrayError=function(){return new t(te.emptyScopesError.code,""+te.emptyScopesError.desc)};t.createClientIdSingleScopeError=function(e){return new t(te.clientIdSingleScopeError.code,te.clientIdSingleScopeError.desc+" Given Scopes: "+e)};t.createInvalidPromptError=function(e){return new t(te.invalidPrompt.code,te.invalidPrompt.desc+" Given value: "+e)};t.createInvalidClaimsRequestError=function(){return new t(te.invalidClaimsRequest.code,te.invalidClaimsRequest.desc)};t.createEmptyLogoutRequestError=function(){return new t(te.logoutRequestEmptyError.code,te.logoutRequestEmptyError.desc)};t.createEmptyTokenRequestError=function(){return new t(te.tokenRequestEmptyError.code,te.tokenRequestEmptyError.desc)};t.createInvalidCodeChallengeMethodError=function(){return new t(te.invalidCodeChallengeMethod.code,te.invalidCodeChallengeMethod.desc)};t.createInvalidCodeChallengeParamsError=function(){return new t(te.invalidCodeChallengeParams.code,te.invalidCodeChallengeParams.desc)};t.createInvalidCloudDiscoveryMetadataError=function(){return new t(te.invalidCloudDiscoveryMetadata.code,te.invalidCloudDiscoveryMetadata.desc)};t.createInvalidAuthorityMetadataError=function(){return new t(te.invalidAuthorityMetadata.code,te.invalidAuthorityMetadata.desc)};t.createUntrustedAuthorityError=function(){return new t(te.untrustedAuthority.code,te.untrustedAuthority.desc)};t.createInvalidAzureCloudInstanceError=function(){return new t(te.invalidAzureCloudInstance.code,te.invalidAzureCloudInstance.desc)};t.createMissingSshJwkError=function(){return new t(te.missingSshJwk.code,te.missingSshJwk.desc)};t.createMissingSshKidError=function(){return new t(te.missingSshKid.code,te.missingSshKid.desc)};t.createMissingNonceAuthenticationHeadersError=function(){return new t(te.missingNonceAuthenticationHeader.code,te.missingNonceAuthenticationHeader.desc)};t.createInvalidAuthenticationHeaderError=function(e,r){return new t(te.invalidAuthenticationHeader.code,te.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)};return t}(V);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ne=function(){function e(e){var t=this;var r=e?J.trimArrayEntries(p(e)):[];var n=r?J.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n);this.scopes=new Set;n.forEach(function(e){return t.scopes.add(e)})}e.fromString=function(t){var r=t||"";var n=r.split(" ");return new e(n)};e.prototype.validateInputScopes=function(e){if(!e||e.length<1){throw re.createEmptyScopesArrayError()}};e.prototype.containsScope=function(t){var r=this.printScopesLowerCase().split(" ");var n=new e(r);return!J.isEmpty(t)?n.scopes.has(t.toLowerCase()):false};e.prototype.containsScopeSet=function(e){var t=this;if(!e||e.scopes.size<=0){return false}return this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})};e.prototype.containsOnlyOIDCScopes=function(){var e=this;var t=0;v.forEach(function(r){if(e.containsScope(r)){t+=1}});return this.scopes.size===t};e.prototype.appendScope=function(e){if(!J.isEmpty(e)){this.scopes.add(e.trim())}};e.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw V.createAppendScopeSetError(e)}};e.prototype.removeScope=function(e){if(J.isEmpty(e)){throw V.createRemoveEmptyScopeFromSetError(e)}this.scopes.delete(e.trim())};e.prototype.removeOIDCScopes=function(){var e=this;v.forEach(function(t){e.scopes.delete(t)})};e.prototype.unionScopeSets=function(e){if(!e){throw V.createEmptyInputScopeSetError()}var t=new Set;e.scopes.forEach(function(e){return t.add(e.toLowerCase())});this.scopes.forEach(function(e){return t.add(e.toLowerCase())});return t};e.prototype.intersectingScopeSets=function(e){if(!e){throw V.createEmptyInputScopeSetError()}if(!e.containsOnlyOIDCScopes()){e.removeOIDCScopes()}var t=this.unionScopeSets(e);var r=e.getScopeCount();var n=this.getScopeCount();var o=t.size;return o<n+r};e.prototype.getScopeCount=function(){return this.scopes.size};e.prototype.asArray=function(){var e=[];this.scopes.forEach(function(t){return e.push(t)});return e};e.prototype.printScopes=function(){if(this.scopes){var e=this.asArray();return e.join(" ")}return""};e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */function oe(e,t){if(J.isEmpty(e)){throw V.createClientInfoEmptyError()}try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw V.createClientInfoDecodingError(e)}}function ie(e){if(J.isEmpty(e)){throw V.createClientInfoDecodingError("Home account ID was empty.")}var t=e.split(b.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?f.EMPTY_STRING:t[1]}}
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ae;(function(e){e[e["Default"]=0]="Default";e[e["Adfs"]=1]="Adfs"})(ae||(ae={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var se=function(){function e(){}e.prototype.generateAccountId=function(){var e=[this.homeAccountId,this.environment];return e.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})};e.prototype.generateType=function(){switch(this.authorityType){case R.ADFS_ACCOUNT_TYPE:return N.ADFS;case R.MSAV1_ACCOUNT_TYPE:return N.MSA;case R.MSSTS_ACCOUNT_TYPE:return N.MSSTS;case R.GENERIC_ACCOUNT_TYPE:return N.GENERIC;default:{throw V.createUnexpectedAccountTypeError()}}};e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}};e.generateAccountCacheKey=function(e){var t=[e.homeAccountId,e.environment||"",e.tenantId||""];return t.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};e.createAccount=function(t,r,n,o,i,a,s,c){var u,d,l,h,p,f;var g=new e;g.authorityType=R.MSSTS_ACCOUNT_TYPE;g.clientInfo=t;g.homeAccountId=r;var v=c||o&&o.getPreferredCache();if(!v){throw V.createInvalidCacheEnvironmentError()}g.environment=v;g.realm=((u=n===null||n===void 0?void 0:n.claims)===null||u===void 0?void 0:u.tid)||"";g.oboAssertion=i;if(n){g.idTokenClaims=n.claims;g.localAccountId=((d=n===null||n===void 0?void 0:n.claims)===null||d===void 0?void 0:d.oid)||((l=n===null||n===void 0?void 0:n.claims)===null||l===void 0?void 0:l.sub)||"";g.username=((h=n===null||n===void 0?void 0:n.claims)===null||h===void 0?void 0:h.preferred_username)||(((p=n===null||n===void 0?void 0:n.claims)===null||p===void 0?void 0:p.emails)?n.claims.emails[0]:"");g.name=(f=n===null||n===void 0?void 0:n.claims)===null||f===void 0?void 0:f.name}g.cloudGraphHostName=a;g.msGraphHost=s;return g};e.createGenericAccount=function(t,r,n,o,i,a,s){var c,u,d,l;var h=new e;h.authorityType=n&&n.authorityType===ae.Adfs?R.ADFS_ACCOUNT_TYPE:R.GENERIC_ACCOUNT_TYPE;h.homeAccountId=t;h.realm="";h.oboAssertion=o;var p=s||n&&n.getPreferredCache();if(!p){throw V.createInvalidCacheEnvironmentError()}if(r){h.localAccountId=((c=r===null||r===void 0?void 0:r.claims)===null||c===void 0?void 0:c.oid)||((u=r===null||r===void 0?void 0:r.claims)===null||u===void 0?void 0:u.sub)||"";h.username=((d=r===null||r===void 0?void 0:r.claims)===null||d===void 0?void 0:d.upn)||"";h.name=((l=r===null||r===void 0?void 0:r.claims)===null||l===void 0?void 0:l.name)||"";h.idTokenClaims=r===null||r===void 0?void 0:r.claims}h.environment=p;h.cloudGraphHostName=i;h.msGraphHost=a;return h};e.generateHomeAccountId=function(e,t,r,n,o){var i;var a=((i=o===null||o===void 0?void 0:o.claims)===null||i===void 0?void 0:i.sub)?o.claims.sub:f.EMPTY_STRING;if(t===ae.Adfs){return a}if(e){try{var s=oe(e,n);if(!J.isEmpty(s.uid)&&!J.isEmpty(s.utid)){return""+s.uid+b.CLIENT_INFO_SEPARATOR+s.utid}}catch(e){}}r.verbose("No client info in response");return a};e.isAccountEntity=function(e){if(!e){return false}return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")};e.accountInfoIsEqual=function(e,t,r){if(!e||!t){return false}var n=true;if(r){var o=e.idTokenClaims||{};var i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&n};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ce=function(){function e(t,r){if(J.isEmpty(t)){throw V.createTokenNullOrEmptyError(t)}this.rawToken=t;this.claims=e.extractTokenClaims(t,r)}e.extractTokenClaims=function(e,t){var r=J.decodeAuthToken(e);try{var n=r.JWSPayload;var o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw V.createTokenParsingError(e)}};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ue=function(){function t(e,t){this.clientId=e;this.cryptoImpl=t}t.prototype.getAllAccounts=function(){var e=this;var r=this.getAccountsFilteredBy();var n=Object.keys(r).map(function(e){return r[e]});var o=n.length;if(o<1){return[]}else{var i=n.map(function(r){var n=t.toObject(new se,r);var o=n.getAccountInfo();var i=e.readIdTokenFromCache(e.clientId,o);if(i&&!o.idTokenClaims){o.idTokenClaims=new ce(i.secret,e.cryptoImpl).claims}return o});return i}};t.prototype.saveCacheRecord=function(e){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:if(!e){throw V.createNullOrUndefinedCacheRecord()}if(!!e.account){this.setAccount(e.account)}if(!!e.idToken){this.setIdTokenCredential(e.idToken)}if(!!!e.accessToken)return[3,2];return[4,this.saveAccessToken(e.accessToken)];case 1:t.sent();t.label=2;case 2:if(!!e.refreshToken){this.setRefreshTokenCredential(e.refreshToken)}if(!!e.appMetadata){this.setAppMetadata(e.appMetadata)}return[2]}})})};t.prototype.saveAccessToken=function(e){return l(this,void 0,void 0,function(){var t,r,n,o;var i=this;return h(this,function(a){switch(a.label){case 0:t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash});r=ne.fromString(e.target);n=Object.keys(t.accessTokens).map(function(e){return t.accessTokens[e]});if(!n)return[3,2];o=[];n.forEach(function(e){var t=ne.fromString(e.target);if(t.intersectingScopeSets(r)){o.push(i.removeCredential(e))}});return[4,Promise.all(o)];case 1:a.sent();a.label=2;case 2:this.setAccessTokenCredential(e);return[2]}})})};t.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")};t.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this;var o=this.getKeys();var i={};o.forEach(function(o){var a=n.getAccount(o);if(!a){return}if(!!e&&!n.matchHomeAccountId(a,e)){return}if(!!t&&!n.matchEnvironment(a,t)){return}if(!!r&&!n.matchRealm(a,r)){return}i[o]=a});return i};t.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId,e.requestedClaimsHash)};t.prototype.getCredentialsFilteredByInternal=function(t,r,n,o,i,a,s,c,u,d,l){var h=this;var p=this.getKeys();var g={idTokens:{},accessTokens:{},refreshTokens:{}};p.forEach(function(p){var v=ee.getCredentialType(p);if(v===f.NOT_DEFINED){return}var y=h.getSpecificCredential(p,v);if(!y){return}if(!!c&&!h.matchOboAssertion(y,c)){return}if(!!t&&!h.matchHomeAccountId(y,t)){return}if(!!r&&!h.matchEnvironment(y,r)){return}if(!!a&&!h.matchRealm(y,a)){return}if(!!n&&!h.matchCredentialType(y,n)){return}if(!!o&&!h.matchClientId(y,o)){return}if(!!i&&!h.matchFamilyId(y,i)){return}if(!!s&&!h.matchTarget(y,s)){return}if(l||y.requestedClaimsHash){if(y.requestedClaimsHash!==l){return}}if(n===O.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(!!u&&!h.matchTokenType(y,u)){return}if(u===e.AuthenticationScheme.SSH){if(d&&!h.matchKeyId(y,d)){return}}}var m=h.updateCredentialCacheKey(p,y);switch(v){case O.ID_TOKEN:g.idTokens[m]=y;break;case O.ACCESS_TOKEN:case O.ACCESS_TOKEN_WITH_AUTH_SCHEME:g.accessTokens[m]=y;break;case O.REFRESH_TOKEN:g.refreshTokens[m]=y;break}});return g};t.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)};t.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this;var n=this.getKeys();var o={};n.forEach(function(n){if(!r.isAppMetadata(n)){return}var i=r.getAppMetadata(n);if(!i){return}if(!!e&&!r.matchEnvironment(i,e)){return}if(!!t&&!r.matchClientId(i,t)){return}o[n]=i});return o};t.prototype.getAuthorityMetadataByAlias=function(e){var t=this;var r=this.getAuthorityMetadataKeys();var n=null;r.forEach(function(r){if(!t.isAuthorityMetadata(r)||r.indexOf(t.clientId)===-1){return}var o=t.getAuthorityMetadata(r);if(!o){return}if(o.aliases.indexOf(e)===-1){return}n=o});return n};t.prototype.removeAllAccounts=function(){return l(this,void 0,void 0,function(){var e,t;var r=this;return h(this,function(n){switch(n.label){case 0:e=this.getKeys();t=[];e.forEach(function(e){var n=r.getAccount(e);if(!n){return}t.push(r.removeAccount(e))});return[4,Promise.all(t)];case 1:n.sent();return[2,true]}})})};t.prototype.removeAccount=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:t=this.getAccount(e);if(!t){throw V.createNoAccountFoundError()}return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,k.ACCOUNT)]}})})};t.prototype.removeAccountContext=function(e){return l(this,void 0,void 0,function(){var t,r,n;var o=this;return h(this,function(i){switch(i.label){case 0:t=this.getKeys();r=e.generateAccountId();n=[];t.forEach(function(e){var t=ee.getCredentialType(e);if(t===f.NOT_DEFINED){return}var i=o.getSpecificCredential(e,t);if(!!i&&r===i.generateAccountId()){n.push(o.removeCredential(i))}});return[4,Promise.all(n)];case 1:i.sent();return[2,true]}})})};t.prototype.removeCredential=function(t){return l(this,void 0,void 0,function(){var r,n,o;return h(this,function(i){switch(i.label){case 0:r=t.generateCredentialKey();if(!(t.credentialType.toLowerCase()===O.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()))return[3,4];if(!(t.tokenType===e.AuthenticationScheme.POP))return[3,4];n=t;o=n.keyId;if(!o)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this.cryptoImpl.removeTokenBindingKey(o)];case 2:i.sent();return[3,4];case 3:i.sent();throw V.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(r,k.CREDENTIAL)]}})})};t.prototype.removeAppMetadata=function(){var e=this;var t=this.getKeys();t.forEach(function(t){if(e.isAppMetadata(t)){e.removeItem(t,k.APP_METADATA)}});return true};t.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e);var i=this.readIdTokenFromCache(t,e);var a=this.readAccessTokenFromCache(t,e,r);var s=this.readRefreshTokenFromCache(t,e,false);var c=this.readAppMetadataFromCache(n,t);if(o&&i){o.idTokenClaims=new ce(i.secret,this.cryptoImpl).claims}return{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}};t.prototype.readAccountFromCache=function(e){var t=se.generateAccountCacheKey(e);return this.getAccount(t)};t.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:O.ID_TOKEN,clientId:e,realm:t.tenantId};var n=this.getCredentialsFilteredBy(r);var o=Object.keys(n.idTokens).map(function(e){return n.idTokens[e]});var i=o.length;if(i<1){return null}else if(i>1){throw V.createMultipleMatchingTokensInCacheError()}return o[0]};t.prototype.readAccessTokenFromCache=function(t,r,n){var o=new ne(n.scopes||[]);var i=n.authenticationScheme||e.AuthenticationScheme.BEARER;var a=i&&i.toLowerCase()!==e.AuthenticationScheme.BEARER.toLowerCase()?O.ACCESS_TOKEN_WITH_AUTH_SCHEME:O.ACCESS_TOKEN;var s={homeAccountId:r.homeAccountId,environment:r.environment,credentialType:a,clientId:t,realm:r.tenantId,target:o.printScopesLowerCase(),tokenType:i,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash};var c=this.getCredentialsFilteredBy(s);var u=Object.keys(c.accessTokens).map(function(e){return c.accessTokens[e]});var d=u.length;if(d<1){return null}else if(d>1){throw V.createMultipleMatchingTokensInCacheError()}return u[0]};t.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?M:undefined;var o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:O.REFRESH_TOKEN,clientId:e,familyId:n};var i=this.getCredentialsFilteredBy(o);var a=Object.keys(i.refreshTokens).map(function(e){return i.refreshTokens[e]});var s=a.length;if(s<1){return null}return a[0]};t.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t};var n=this.getAppMetadataFilteredBy(r);var o=Object.keys(n).map(function(e){return n[e]});var i=o.length;if(i<1){return null}else if(i>1){throw V.createMultipleMatchingAppMetadataInCacheError()}return o[0]};t.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!!(r&&r.familyId===M)};t.prototype.matchHomeAccountId=function(e,t){return!!(e.homeAccountId&&t===e.homeAccountId)};t.prototype.matchOboAssertion=function(e,t){return!!(e.oboAssertion&&t===e.oboAssertion)};t.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);if(r&&r.aliases.indexOf(e.environment)>-1){return true}return false};t.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()};t.prototype.matchClientId=function(e,t){return!!(e.clientId&&t===e.clientId)};t.prototype.matchFamilyId=function(e,t){return!!(e.familyId&&t===e.familyId)};t.prototype.matchRealm=function(e,t){return!!(e.realm&&t===e.realm)};t.prototype.matchTarget=function(e,t){var r=e.credentialType!==O.ACCESS_TOKEN&&e.credentialType!==O.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(r||!e.target){return false}var n=ne.fromString(e.target);var o=ne.fromString(t);if(!o.containsOnlyOIDCScopes()){o.removeOIDCScopes()}else{o.removeScope(f.OFFLINE_ACCESS_SCOPE)}return n.containsScopeSet(o)};t.prototype.matchTokenType=function(e,t){return!!(e.tokenType&&e.tokenType===t)};t.prototype.matchKeyId=function(e,t){return!!(e.keyId&&e.keyId===t)};t.prototype.isAppMetadata=function(e){return e.indexOf(P)!==-1};t.prototype.isAuthorityMetadata=function(e){return e.indexOf(L.CACHE_KEY)!==-1};t.prototype.generateAuthorityMetadataCacheKey=function(e){return L.CACHE_KEY+"-"+this.clientId+"-"+e};t.prototype.getSpecificCredential=function(e,t){switch(t){case O.ID_TOKEN:{return this.getIdTokenCredential(e)}case O.ACCESS_TOKEN:case O.ACCESS_TOKEN_WITH_AUTH_SCHEME:{return this.getAccessTokenCredential(e)}case O.REFRESH_TOKEN:{return this.getRefreshTokenCredential(e)}default:return null}};t.toObject=function(e,t){for(var r in t){e[r]=t[r]}return e};return t}();var de=function(e){u(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAccount=function(){var e="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getAccount=function(){var e="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setIdTokenCredential=function(){var e="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getIdTokenCredential=function(){var e="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setAccessTokenCredential=function(){var e="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getAccessTokenCredential=function(){var e="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setRefreshTokenCredential=function(){var e="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getRefreshTokenCredential=function(){var e="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setAppMetadata=function(){var e="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getAppMetadata=function(){var e="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setServerTelemetry=function(){var e="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getServerTelemetry=function(){var e="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setAuthorityMetadata=function(){var e="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getAuthorityMetadata=function(){var e="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getAuthorityMetadataKeys=function(){var e="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.setThrottlingCache=function(){var e="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getThrottlingCache=function(){var e="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.removeItem=function(){var e="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.containsKey=function(){var e="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.getKeys=function(){var e="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};t.prototype.clear=function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Storage interface - clear() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)})})};t.prototype.updateCredentialCacheKey=function(){var e="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw W.createUnexpectedError(e)};return t}(ue);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var le=300;var he={tokenRenewalOffsetSeconds:le,preventCorsPreflight:false,proxyUrl:""};var pe={loggerCallback:function(){},piiLoggingEnabled:false,logLevel:e.LogLevel.Info,correlationId:""};var fe={sendGetRequestAsync:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Network interface - sendGetRequestAsync() has not been implemented";throw W.createUnexpectedError(e)})})},sendPostRequestAsync:function(){return l(this,void 0,void 0,function(){var e;return h(this,function(t){e="Network interface - sendPostRequestAsync() has not been implemented";throw W.createUnexpectedError(e)})})}};var ge={sku:f.SKU,version:$,cpu:"",os:""};var ve={clientSecret:"",clientAssertion:undefined};var ye={azureCloudInstance:e.AzureCloudInstance.None,tenant:""+f.DEFAULT_COMMON_TENANT};function me(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,s=e.clientCredentials,c=e.libraryInfo,u=e.serverTelemetryManager,l=e.persistencePlugin,h=e.serializableCache;var p=d(d({},pe),n);return{authOptions:Ee(t),systemOptions:d(d({},he),r),loggerOptions:p,storageInterface:o||new de(t.clientId,Y),networkInterface:i||fe,cryptoInterface:a||Y,clientCredentials:s||ve,libraryInfo:d(d({},ge),c),serverTelemetryManager:u||null,persistencePlugin:l||null,serializableCache:h||null}}function Ee(e){return d({clientCapabilities:[],azureCloudOptions:ye},e)}
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ce=function(e){u(t,e);function t(r,n,o){var i=e.call(this,r,n,o)||this;i.name="ServerError";Object.setPrototypeOf(i,t.prototype);return i}return t}(W);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Te=function(){function e(){}e.generateThrottlingStorageKey=function(e){return D.THROTTLING_PREFIX+"."+JSON.stringify(e)};e.preProcess=function(t,r){var n;var o=e.generateThrottlingStorageKey(r);var i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now()){t.removeItem(o,k.THROTTLING);return}throw new Ce(((n=i.errorCodes)===null||n===void 0?void 0:n.join(" "))||f.EMPTY_STRING,i.errorMessage,i.subError)}};e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[y.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}};e.checkResponseStatus=function(e){return e.status===429||e.status>=500&&e.status<600};e.checkResponseForRetryAfter=function(e){if(e.headers){return e.headers.hasOwnProperty(y.RETRY_AFTER)&&(e.status<200||e.status>=300)}return false};e.calculateThrottleTime=function(e){var t=e<=0?0:e;var r=Date.now()/1e3;return Math.floor(Math.min(r+(t||D.DEFAULT_THROTTLE_TIME_SECONDS),r+D.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)};e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid};var i=this.generateThrottlingStorageKey(o);return e.removeItem(i,k.THROTTLING)};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Se=function(){function e(e,t){this.networkClient=e;this.cacheManager=t}e.prototype.sendPostRequest=function(e,t,r){return l(this,void 0,void 0,function(){var n,o;return h(this,function(i){switch(i.label){case 0:Te.preProcess(this.cacheManager,e);i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:n=i.sent();return[3,4];case 3:o=i.sent();if(o instanceof W){throw o}else{throw V.createNetworkError(t,o)}case 4:Te.postProcess(this.cacheManager,e,n);return[2,n]}})})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ie;(function(e){e["HOME_ACCOUNT_ID"]="home_account_id";e["UPN"]="UPN"})(Ie||(Ie={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var we=function(){function e(e){this.config=me(e);this.logger=new X(this.config.loggerOptions,Z,$);this.cryptoUtils=this.config.cryptoInterface;this.cacheManager=this.config.storageInterface;this.networkClient=this.config.networkInterface;this.networkManager=new Se(this.networkClient,this.cacheManager);this.serverTelemetryManager=this.config.serverTelemetryManager;this.authority=this.config.authOptions.authority}e.prototype.createTokenRequestHeaders=function(e){var t={};t[y.CONTENT_TYPE]=f.URL_FORM_CONTENT_TYPE;if(!this.config.systemOptions.preventCorsPreflight&&e){switch(e.type){case Ie.HOME_ACCOUNT_ID:try{var r=ie(e.credential);t[y.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ie.UPN:t[y.CCS_HEADER]="UPN: "+e.credential;break}}return t};e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return l(this,void 0,void 0,function(){var o;return h(this,function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:o=i.sent();if(this.config.serverTelemetryManager&&o.status<500&&o.status!==429){this.config.serverTelemetryManager.clearTelemetryCache()}return[2,o]}})})};e.prototype.updateAuthority=function(e){if(!e.discoveryComplete()){throw V.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.")}this.authority=e};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ae=function(){function e(){}e.validateRedirectUri=function(e){if(J.isEmpty(e)){throw re.createRedirectUriEmptyError()}};e.validatePrompt=function(e){var t=[];for(var r in S){t.push(S[r])}if(t.indexOf(e)<0){throw re.createInvalidPromptError(e)}};e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw re.createInvalidClaimsRequestError()}};e.validateCodeChallengeParams=function(e,t){if(J.isEmpty(e)||J.isEmpty(t)){throw re.createInvalidCodeChallengeParamsError()}else{this.validateCodeChallengeMethod(t)}};e.validateCodeChallengeMethod=function(e){if([w.PLAIN,w.S256].indexOf(e)<0){throw re.createInvalidCodeChallengeMethodError()}};e.sanitizeEQParams=function(e,t){if(!e){return{}}t.forEach(function(t,r){if(e[r]){delete e[r]}});return e};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var _e=function(){function t(){this.parameters=new Map}t.prototype.addResponseTypeCode=function(){this.parameters.set(C.RESPONSE_TYPE,encodeURIComponent(f.CODE_RESPONSE_TYPE))};t.prototype.addResponseMode=function(e){this.parameters.set(C.RESPONSE_MODE,encodeURIComponent(e?e:A.QUERY))};t.prototype.addScopes=function(e,t){if(t===void 0){t=true}var r=t?p(e||[],g):e||[];var n=new ne(r);this.parameters.set(C.SCOPE,encodeURIComponent(n.printScopes()))};t.prototype.addClientId=function(e){this.parameters.set(C.CLIENT_ID,encodeURIComponent(e))};t.prototype.addRedirectUri=function(e){Ae.validateRedirectUri(e);this.parameters.set(C.REDIRECT_URI,encodeURIComponent(e))};t.prototype.addPostLogoutRedirectUri=function(e){Ae.validateRedirectUri(e);this.parameters.set(C.POST_LOGOUT_URI,encodeURIComponent(e))};t.prototype.addIdTokenHint=function(e){this.parameters.set(C.ID_TOKEN_HINT,encodeURIComponent(e))};t.prototype.addDomainHint=function(e){this.parameters.set(I.DOMAIN_HINT,encodeURIComponent(e))};t.prototype.addLoginHint=function(e){this.parameters.set(I.LOGIN_HINT,encodeURIComponent(e))};t.prototype.addCcsUpn=function(e){this.parameters.set(y.CCS_HEADER,encodeURIComponent("UPN:"+e))};t.prototype.addCcsOid=function(e){this.parameters.set(y.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))};t.prototype.addSid=function(e){this.parameters.set(I.SID,encodeURIComponent(e))};t.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Ae.validateClaims(r);this.parameters.set(C.CLAIMS,encodeURIComponent(r))};t.prototype.addCorrelationId=function(e){this.parameters.set(C.CLIENT_REQUEST_ID,encodeURIComponent(e))};t.prototype.addLibraryInfo=function(e){this.parameters.set(C.X_CLIENT_SKU,e.sku);this.parameters.set(C.X_CLIENT_VER,e.version);this.parameters.set(C.X_CLIENT_OS,e.os);this.parameters.set(C.X_CLIENT_CPU,e.cpu)};t.prototype.addPrompt=function(e){Ae.validatePrompt(e);this.parameters.set(""+C.PROMPT,encodeURIComponent(e))};t.prototype.addState=function(e){if(!J.isEmpty(e)){this.parameters.set(C.STATE,encodeURIComponent(e))}};t.prototype.addNonce=function(e){this.parameters.set(C.NONCE,encodeURIComponent(e))};t.prototype.addCodeChallengeParams=function(e,t){Ae.validateCodeChallengeParams(e,t);if(e&&t){this.parameters.set(C.CODE_CHALLENGE,encodeURIComponent(e));this.parameters.set(C.CODE_CHALLENGE_METHOD,encodeURIComponent(t))}else{throw re.createInvalidCodeChallengeParamsError()}};t.prototype.addAuthorizationCode=function(e){this.parameters.set(C.CODE,encodeURIComponent(e))};t.prototype.addDeviceCode=function(e){this.parameters.set(C.DEVICE_CODE,encodeURIComponent(e))};t.prototype.addRefreshToken=function(e){this.parameters.set(C.REFRESH_TOKEN,encodeURIComponent(e))};t.prototype.addCodeVerifier=function(e){this.parameters.set(C.CODE_VERIFIER,encodeURIComponent(e))};t.prototype.addClientSecret=function(e){this.parameters.set(C.CLIENT_SECRET,encodeURIComponent(e))};t.prototype.addClientAssertion=function(e){this.parameters.set(C.CLIENT_ASSERTION,encodeURIComponent(e))};t.prototype.addClientAssertionType=function(e){this.parameters.set(C.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))};t.prototype.addOboAssertion=function(e){this.parameters.set(C.OBO_ASSERTION,encodeURIComponent(e))};t.prototype.addRequestTokenUse=function(e){this.parameters.set(C.REQUESTED_TOKEN_USE,encodeURIComponent(e))};t.prototype.addGrantType=function(e){this.parameters.set(C.GRANT_TYPE,encodeURIComponent(e))};t.prototype.addClientInfo=function(){this.parameters.set(U,"1")};t.prototype.addExtraQueryParameters=function(e){var t=this;Ae.sanitizeEQParams(e,this.parameters);Object.keys(e).forEach(function(r){t.parameters.set(r,e[r])})};t.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(!e){r={}}else{try{r=JSON.parse(e)}catch(e){throw re.createInvalidClaimsRequestError()}}if(t&&t.length>0){if(!r.hasOwnProperty(T.ACCESS_TOKEN)){r[T.ACCESS_TOKEN]={}}r[T.ACCESS_TOKEN][T.XMS_CC]={values:t}}return JSON.stringify(r)};t.prototype.addUsername=function(e){this.parameters.set(F.username,e)};t.prototype.addPassword=function(e){this.parameters.set(F.password,e)};t.prototype.addPopToken=function(t){if(!J.isEmpty(t)){this.parameters.set(C.TOKEN_TYPE,e.AuthenticationScheme.POP);this.parameters.set(C.REQ_CNF,encodeURIComponent(t))}};t.prototype.addSshJwk=function(t){if(!J.isEmpty(t)){this.parameters.set(C.TOKEN_TYPE,e.AuthenticationScheme.SSH);this.parameters.set(C.REQ_CNF,encodeURIComponent(t))}};t.prototype.addServerTelemetry=function(e){this.parameters.set(C.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue());this.parameters.set(C.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())};t.prototype.addThrottling=function(){this.parameters.set(C.X_MS_LIB_CAPABILITY,D.X_MS_LIB_CAPABILITY_VALUE)};t.prototype.addLogoutHint=function(e){this.parameters.set(C.LOGOUT_HINT,encodeURIComponent(e))};t.prototype.createQueryString=function(){var e=new Array;this.parameters.forEach(function(t,r){e.push(r+"="+t)});return e.join("&")};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Re=function(e){u(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.createIdTokenEntity=function(e,r,n,o,i,a){var s=new t;s.credentialType=O.ID_TOKEN;s.homeAccountId=e;s.environment=r;s.clientId=o;s.secret=n;s.realm=i;s.oboAssertion=a;return s};t.isIdTokenEntity=function(e){if(!e){return false}return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e["credentialType"]===O.ID_TOKEN};return t}(ee);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var be=function(){function e(){}e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)};e.isTokenExpired=function(t,r){var n=Number(t)||0;var o=e.nowSeconds()+r;return o>n};e.wasClockTurnedBack=function(t){var r=Number(t);return r>e.nowSeconds()};e.delay=function(e,t){return new Promise(function(r){return setTimeout(function(){return r(t)},e)})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Oe=function(t){u(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}r.createAccessTokenEntity=function(t,n,o,i,a,s,c,u,d,l,h,p,f,g,v){var y,m;var E=new r;E.homeAccountId=t;E.credentialType=O.ACCESS_TOKEN;E.secret=o;var C=be.nowSeconds();E.cachedAt=C.toString();E.expiresOn=c.toString();E.extendedExpiresOn=u.toString();if(l){E.refreshOn=l.toString()}E.environment=n;E.clientId=i;E.realm=a;E.target=s;E.oboAssertion=p;E.tokenType=J.isEmpty(h)?e.AuthenticationScheme.BEARER:h;if(g){E.requestedClaims=g;E.requestedClaimsHash=v}if(((y=E.tokenType)===null||y===void 0?void 0:y.toLowerCase())!==e.AuthenticationScheme.BEARER.toLowerCase()){E.credentialType=O.ACCESS_TOKEN_WITH_AUTH_SCHEME;switch(E.tokenType){case e.AuthenticationScheme.POP:var T=ce.extractTokenClaims(o,d);if(!((m=T===null||T===void 0?void 0:T.cnf)===null||m===void 0?void 0:m.kid)){throw V.createTokenClaimsRequiredError()}E.keyId=T.cnf.kid;break;case e.AuthenticationScheme.SSH:E.keyId=f}}return E};r.isAccessTokenEntity=function(e){if(!e){return false}return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e["credentialType"]===O.ACCESS_TOKEN||e["credentialType"]===O.ACCESS_TOKEN_WITH_AUTH_SCHEME)};return r}(ee);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ke=function(e){u(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;s.clientId=o;s.credentialType=O.REFRESH_TOKEN;s.environment=r;s.homeAccountId=e;s.secret=n;s.oboAssertion=a;if(i)s.familyId=i;return s};t.isRefreshTokenEntity=function(e){if(!e){return false}return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e["credentialType"]===O.REFRESH_TOKEN};return t}(ee);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ne=["interaction_required","consent_required","login_required"];var Pe=["message_only","additional_action","basic_action","user_password_expired","consent_required"];var Ue={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."}};var Me=function(e){u(t,e);function t(r,n,o){var i=e.call(this,r,n,o)||this;i.name="InteractionRequiredAuthError";Object.setPrototypeOf(i,t.prototype);return i}t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Ne.indexOf(e)>-1;var o=!!r&&Pe.indexOf(r)>-1;var i=!!t&&Ne.some(function(e){return t.indexOf(e)>-1});return n||i||o};t.createNoTokensFoundError=function(){return new t(Ue.noTokensFoundError.code,Ue.noTokensFoundError.desc)};return t}(W);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Le=function(){function e(e,t,r,n,o){this.account=e||null;this.idToken=t||null;this.accessToken=r||null;this.refreshToken=n||null;this.appMetadata=o||null}return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var He=function(){function e(){}e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return!J.isEmpty(r)?""+o+f.RESOURCE_DELIM+r:o};e.generateLibraryState=function(e,t){if(!e){throw V.createNoCryptoObjectError("generateLibraryState")}var r={id:e.createNewGuid()};if(t){r.meta=t}var n=JSON.stringify(r);return e.base64Encode(n)};e.parseRequestState=function(e,t){if(!e){throw V.createNoCryptoObjectError("parseRequestState")}if(J.isEmpty(t)){throw V.createInvalidStateError(t,"Null, undefined or empty state")}try{var r=t.split(f.RESOURCE_DELIM);var n=r[0];var o=r.length>1?r.slice(1).join(f.RESOURCE_DELIM):"";var i=e.base64Decode(n);var a=JSON.parse(i);return{userRequestState:!J.isEmpty(o)?o:"",libraryState:a}}catch(e){throw V.createInvalidStateError(t,e)}};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var qe=function(){function e(t){this._urlString=t;if(J.isEmpty(this._urlString)){throw re.createUrlEmptyError()}if(J.isEmpty(this.getHash())){this._urlString=e.canonicalizeUri(t)}}Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:false,configurable:true});e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();if(J.endsWith(t,"?")){t=t.slice(0,-1)}else if(J.endsWith(t,"?/")){t=t.slice(0,-2)}if(!J.endsWith(t,"/")){t+="/"}return t}return e};e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw re.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments){throw re.createUrlParseError("Given url string: "+this.urlString)}if(!e.Protocol||e.Protocol.toLowerCase()!=="https:"){throw re.createInsecureAuthorityUriError(this.urlString)}};e.appendQueryString=function(e,t){if(J.isEmpty(t)){return e}return e.indexOf("?")<0?e+"?"+t:e+"&"+t};e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])};e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents();var n=r.PathSegments;if(t&&(n.length!==0&&(n[0]===E.COMMON||n[0]===E.ORGANIZATIONS))){n[0]=t}return e.constructAuthorityUriFromObject(r)};e.prototype.getHash=function(){return e.parseHash(this.urlString)};e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");var t=this.urlString.match(e);if(!t){throw re.createUrlParseError("Given url string: "+this.urlString)}var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};var n=r.AbsolutePath.split("/");n=n.filter(function(e){return e&&e.length>0});r.PathSegments=n;if(!J.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")){r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)}return r};e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)");var r=e.match(t);if(!r){throw re.createUrlParseError("Given url string: "+e)}return r[2]};e.getAbsoluteUrl=function(t,r){if(t[0]===f.FORWARD_SLASH){var n=new e(r);var o=n.getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+t}return t};e.parseHash=function(e){var t=e.indexOf("#");var r=e.indexOf("#/");if(r>-1){return e.substring(r+2)}else if(t>-1){return e.substring(t+1)}return""};e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))};e.getDeserializedHash=function(t){if(J.isEmpty(t)){return{}}var r=e.parseHash(t);var n=J.queryStringToObject(J.isEmpty(r)?t:r);if(!n){throw V.createHashNotDeserializedError(JSON.stringify(n))}return n};e.hashContainsKnownProperties=function(t){if(J.isEmpty(t)||t.indexOf("=")<0){return false}var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var De;(function(e){e["SW"]="sw";e["UHW"]="uhw"})(De||(De={}));var Ke=function(){function e(e){this.cryptoUtils=e}e.prototype.generateCnf=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:return[4,this.generateKid(e)];case 1:t=r.sent();return[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}})})};e.prototype.generateKid=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:t=r.sent();return[2,{kid:t,xms_ksl:De.SW}]}})})};e.prototype.signPopToken=function(e,t){var r;return l(this,void 0,void 0,function(){var n;return h(this,function(o){n=ce.extractTokenClaims(e,this.cryptoUtils);if(!((r=n===null||n===void 0?void 0:n.cnf)===null||r===void 0?void 0:r.kid)){throw V.createTokenClaimsRequiredError()}return[2,this.signPayload(e,n.cnf.kid,t)]})})};e.prototype.signPayload=function(e,t,r,n){return l(this,void 0,void 0,function(){var o,i,a,s,c,u;return h(this,function(l){switch(l.label){case 0:o=r.resourceRequestMethod,i=r.resourceRequestUri,a=r.shrClaims,s=r.shrNonce;c=i?new qe(i):undefined;u=c===null||c===void 0?void 0:c.getUrlComponents();return[4,this.cryptoUtils.signJwt(d({at:e,ts:be.nowSeconds(),m:o===null||o===void 0?void 0:o.toUpperCase(),u:u===null||u===void 0?void 0:u.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u===null||u===void 0?void 0:u.AbsolutePath,q:(u===null||u===void 0?void 0:u.QueryString)?[[],u.QueryString]:undefined,client_claims:a||undefined},n),t)];case 1:return[2,l.sent()]}})})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Fe=function(){function e(){}e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)};e.generateAppMetadataCacheKey=function(e,t){var r=[P,e,t];return r.join(b.CACHE_KEY_SEPARATOR).toLowerCase()};e.createAppMetadataEntity=function(t,r,n){var o=new e;o.clientId=t;o.environment=r;if(n){o.familyId=n}return o};e.isAppMetadataEntity=function(e,t){if(!t){return false}return e.indexOf(P)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var xe=function(){function e(e,t){this.cache=e;this.hasChanged=t}Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:false,configurable:true});return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Be=function(){function t(e,t,r,n,o,i){this.clientId=e;this.cacheStorage=t;this.cryptoObj=r;this.logger=n;this.serializableCache=o;this.persistencePlugin=i}t.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t){throw!e.state?V.createStateNotFoundError("Server State"):V.createStateNotFoundError("Cached State")}if(decodeURIComponent(e.state)!==decodeURIComponent(t)){throw V.createStateMismatchError()}if(e.error||e.error_description||e.suberror){if(Me.isInteractionRequiredError(e.error,e.error_description,e.suberror)){throw new Me(e.error||f.EMPTY_STRING,e.error_description,e.suberror)}throw new Ce(e.error||f.EMPTY_STRING,e.error_description,e.suberror)}if(e.client_info){oe(e.client_info,r)}};t.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Me.isInteractionRequiredError(e.error,e.error_description,e.suberror)){throw new Me(e.error,e.error_description,e.suberror)}var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Ce(e.error,t,e.suberror)}};t.prototype.handleServerTokenResponse=function(e,r,n,o,i,a,s){return l(this,void 0,void 0,function(){var c,u,d,l,p,g;return h(this,function(h){switch(h.label){case 0:if(e.id_token){c=new ce(e.id_token||f.EMPTY_STRING,this.cryptoObj);if(i&&!J.isEmpty(i.nonce)){if(c.claims.nonce!==i.nonce){throw V.createNonceMismatchError()}}}this.homeAccountIdentifier=se.generateHomeAccountId(e.client_info||f.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c);if(!!i&&!!i.state){u=He.parseRequestState(this.cryptoObj,i.state)}e.key_id=e.key_id||o.sshKid||undefined;d=this.generateCacheRecord(e,r,n,o,c,a,i);h.label=1;case 1:h.trys.push([1,,5,8]);if(!(this.persistencePlugin&&this.serializableCache))return[3,3];this.logger.verbose("Persistence enabled, calling beforeCacheAccess");l=new xe(this.serializableCache,true);return[4,this.persistencePlugin.beforeCacheAccess(l)];case 2:h.sent();h.label=3;case 3:if(s&&d.account){p=d.account.generateAccountKey();g=this.cacheStorage.getAccount(p);if(!g){this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache");return[2,t.generateAuthenticationResult(this.cryptoObj,r,d,false,o,c,u)]}}return[4,this.cacheStorage.saveCacheRecord(d)];case 4:h.sent();return[3,8];case 5:if(!(this.persistencePlugin&&this.serializableCache&&l))return[3,7];this.logger.verbose("Persistence enabled, calling afterCacheAccess");return[4,this.persistencePlugin.afterCacheAccess(l)];case 6:h.sent();h.label=7;case 7:return[7];case 8:return[2,t.generateAuthenticationResult(this.cryptoObj,r,d,false,o,c,u,e.spa_code)]}})})};t.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s=t.getPreferredCache();if(J.isEmpty(s)){throw V.createInvalidCacheEnvironmentError()}var c;var u;if(!J.isEmpty(e.id_token)&&!!o){c=Re.createIdTokenEntity(this.homeAccountIdentifier,s,e.id_token||f.EMPTY_STRING,this.clientId,o.claims.tid||f.EMPTY_STRING,i);u=this.generateAccountEntity(e,o,t,i,a)}var d=null;if(!J.isEmpty(e.access_token)){var l=e.scope?ne.fromString(e.scope):new ne(n.scopes||[]);var h=(typeof e.expires_in==="string"?parseInt(e.expires_in,10):e.expires_in)||0;var p=(typeof e.ext_expires_in==="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0;var g=(typeof e.refresh_in==="string"?parseInt(e.refresh_in,10):e.refresh_in)||undefined;var v=r+h;var y=v+p;var m=g&&g>0?r+g:undefined;d=Oe.createAccessTokenEntity(this.homeAccountIdentifier,s,e.access_token||f.EMPTY_STRING,this.clientId,o?o.claims.tid||f.EMPTY_STRING:t.tenant,l.printScopes(),v,y,this.cryptoObj,m,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var E=null;if(!J.isEmpty(e.refresh_token)){E=ke.createRefreshTokenEntity(this.homeAccountIdentifier,s,e.refresh_token||f.EMPTY_STRING,this.clientId,e.foci,i)}var C=null;if(!J.isEmpty(e.foci)){C=Fe.createAppMetadataEntity(this.clientId,s,e.foci)}return new Le(u,c,d,E,C)};t.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType;var a=o?o.cloud_graph_host_name:"";var s=o?o.msgraph_host:"";if(i===ae.Adfs){this.logger.verbose("Authority type is ADFS, creating ADFS account");return se.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s)}if(J.isEmpty(e.client_info)&&r.protocolMode==="AAD"){throw V.createClientInfoEmptyError()}return e.client_info?se.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,a,s):se.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s)};t.generateAuthenticationResult=function(t,r,n,o,i,a,s,c){var u,d,p;return l(this,void 0,void 0,function(){var l,g,v,y,m,E,C,T;return h(this,function(h){switch(h.label){case 0:l="";g=[];v=null;m=f.EMPTY_STRING;if(!n.accessToken)return[3,4];if(!(n.accessToken.tokenType===e.AuthenticationScheme.POP))return[3,2];E=new Ke(t);return[4,E.signPopToken(n.accessToken.secret,i)];case 1:l=h.sent();return[3,3];case 2:l=n.accessToken.secret;h.label=3;case 3:g=ne.fromString(n.accessToken.target).asArray();v=new Date(Number(n.accessToken.expiresOn)*1e3);y=new Date(Number(n.accessToken.extendedExpiresOn)*1e3);h.label=4;case 4:if(n.appMetadata){m=n.appMetadata.familyId===M?M:f.EMPTY_STRING}C=(a===null||a===void 0?void 0:a.claims.oid)||(a===null||a===void 0?void 0:a.claims.sub)||f.EMPTY_STRING;T=(a===null||a===void 0?void 0:a.claims.tid)||f.EMPTY_STRING;return[2,{authority:r.canonicalAuthority,uniqueId:C,tenantId:T,scopes:g,account:n.account?n.account.getAccountInfo():null,idToken:a?a.rawToken:f.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:l,fromCache:o,expiresOn:v,correlationId:i.correlationId,extExpiresOn:y,familyId:m,tokenType:((u=n.accessToken)===null||u===void 0?void 0:u.tokenType)||f.EMPTY_STRING,state:s?s.userRequestState:f.EMPTY_STRING,cloudGraphHostName:((d=n.account)===null||d===void 0?void 0:d.cloudGraphHostName)||f.EMPTY_STRING,msGraphHost:((p=n.account)===null||p===void 0?void 0:p.msGraphHost)||f.EMPTY_STRING,code:c}]}})})};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ge=function(t){u(r,t);function r(e){var r=t.call(this,e)||this;r.includeRedirectUri=true;return r}r.prototype.getAuthCodeUrl=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){t=this.createAuthCodeUrlQueryString(e);return[2,qe.appendQueryString(this.authority.authorizationEndpoint,t)]})})};r.prototype.acquireToken=function(e,t){return l(this,void 0,void 0,function(){var r,n,o;return h(this,function(i){switch(i.label){case 0:this.logger.info("in acquireToken call");if(!e||J.isEmpty(e.code)){throw V.createTokenRequestCannotBeMadeError()}r=be.nowSeconds();return[4,this.executeTokenRequest(this.authority,e)];case 1:n=i.sent();o=new Be(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);o.validateTokenResponse(n.body);return[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:return[2,i.sent()]}})})};r.prototype.handleFragmentResponse=function(e,t){var r=new Be(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null);var n=new qe(e);var o=qe.getDeserializedHash(n.getHash());r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils);if(!o.code){throw V.createNoAuthCodeInServerResponseError()}return d(d({},o),{code:o.code})};r.prototype.getLogoutUri=function(e){if(!e){throw re.createEmptyLogoutRequestError()}var t=this.createLogoutUrlQueryString(e);return qe.appendQueryString(this.authority.endSessionEndpoint,t)};r.prototype.executeTokenRequest=function(e,t){return l(this,void 0,void 0,function(){var r,n,o,i,a,s,c;return h(this,function(u){switch(u.label){case 0:r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return[4,this.createTokenRequestBody(t)];case 1:n=u.sent();o=this.createTokenQueryParameters(t);i=undefined;if(t.clientInfo){try{a=oe(t.clientInfo,this.cryptoUtils);i={credential:""+a.uid+b.CLIENT_INFO_SEPARATOR+a.utid,type:Ie.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}}s=this.createTokenRequestHeaders(i||t.ccsCredential);c=J.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o;return[2,this.executePostToTokenEndpoint(c,n,s,r)]}})})};r.prototype.createTokenQueryParameters=function(e){var t=new _e;if(e.tokenQueryParameters){t.addExtraQueryParameters(e.tokenQueryParameters)}return t.createQueryString()};r.prototype.createTokenRequestBody=function(t){return l(this,void 0,void 0,function(){var r,n,o,i,a,s,c,c;var u;return h(this,function(d){switch(d.label){case 0:r=new _e;r.addClientId(this.config.authOptions.clientId);if(!this.includeRedirectUri){Ae.validateRedirectUri(t.redirectUri)}else{r.addRedirectUri(t.redirectUri)}r.addScopes(t.scopes);r.addAuthorizationCode(t.code);r.addLibraryInfo(this.config.libraryInfo);r.addThrottling();if(this.serverTelemetryManager){r.addServerTelemetry(this.serverTelemetryManager)}if(t.codeVerifier){r.addCodeVerifier(t.codeVerifier)}if(this.config.clientCredentials.clientSecret){r.addClientSecret(this.config.clientCredentials.clientSecret)}if(this.config.clientCredentials.clientAssertion){n=this.config.clientCredentials.clientAssertion;r.addClientAssertion(n.assertion);r.addClientAssertionType(n.assertionType)}r.addGrantType(_.AUTHORIZATION_CODE_GRANT);r.addClientInfo();if(!(t.authenticationScheme===e.AuthenticationScheme.POP))return[3,2];o=new Ke(this.cryptoUtils);return[4,o.generateCnf(t)];case 1:i=d.sent();r.addPopToken(i);return[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(t.sshJwk){r.addSshJwk(t.sshJwk)}else{throw re.createMissingSshJwkError()}}d.label=3;case 3:a=t.correlationId||this.config.cryptoInterface.createNewGuid();r.addCorrelationId(a);if(!J.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0){r.addClaims(t.claims,this.config.authOptions.clientCapabilities)}s=undefined;if(t.clientInfo){try{c=oe(t.clientInfo,this.cryptoUtils);s={credential:""+c.uid+b.CLIENT_INFO_SEPARATOR+c.utid,type:Ie.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}}else{s=t.ccsCredential}if(this.config.systemOptions.preventCorsPreflight&&s){switch(s.type){case Ie.HOME_ACCOUNT_ID:try{c=ie(s.credential);r.addCcsOid(c)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ie.UPN:r.addCcsUpn(s.credential);break}}if(t.tokenBodyParameters){r.addExtraQueryParameters(t.tokenBodyParameters)}if(t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[C.RETURN_SPA_CODE])){r.addExtraQueryParameters((u={},u[C.RETURN_SPA_CODE]="1",u))}return[2,r.createQueryString()]}})})};r.prototype.createAuthCodeUrlQueryString=function(e){var t=new _e;t.addClientId(this.config.authOptions.clientId);var r=p(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r);t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(n);t.addResponseMode(e.responseMode);t.addResponseTypeCode();t.addLibraryInfo(this.config.libraryInfo);t.addClientInfo();if(e.codeChallenge&&e.codeChallengeMethod){t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod)}if(e.prompt){t.addPrompt(e.prompt)}if(e.domainHint){t.addDomainHint(e.domainHint)}if(e.prompt!==S.SELECT_ACCOUNT){if(e.sid&&e.prompt===S.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request");t.addSid(e.sid)}else if(e.account){var o=this.extractAccountSid(e.account);if(o&&e.prompt===S.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account");t.addSid(o);try{var i=ie(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request");t.addLoginHint(e.loginHint);t.addCcsUpn(e.loginHint)}else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account");t.addLoginHint(e.account.username);try{var i=ie(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else if(e.loginHint){this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request");t.addLoginHint(e.loginHint);t.addCcsUpn(e.loginHint)}}else{this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints")}if(e.nonce){t.addNonce(e.nonce)}if(e.state){t.addState(e.state)}if(!J.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0){t.addClaims(e.claims,this.config.authOptions.clientCapabilities)}if(e.extraQueryParameters){t.addExtraQueryParameters(e.extraQueryParameters)}return t.createQueryString()};r.prototype.createLogoutUrlQueryString=function(e){var t=new _e;if(e.postLogoutRedirectUri){t.addPostLogoutRedirectUri(e.postLogoutRedirectUri)}if(e.correlationId){t.addCorrelationId(e.correlationId)}if(e.idTokenHint){t.addIdTokenHint(e.idTokenHint)}if(e.state){t.addState(e.state)}if(e.logoutHint){t.addLogoutHint(e.logoutHint)}if(e.extraQueryParameters){t.addExtraQueryParameters(e.extraQueryParameters)}return t.createQueryString()};r.prototype.extractAccountSid=function(e){if(e.idTokenClaims){var t=e.idTokenClaims;return t.sid||null}return null};return r}(we);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var je=function(t){u(r,t);function r(e){return t.call(this,e)||this}r.prototype.acquireToken=function(e){return l(this,void 0,void 0,function(){var t,r,n;return h(this,function(o){switch(o.label){case 0:t=be.nowSeconds();return[4,this.executeTokenRequest(e,this.authority)];case 1:r=o.sent();n=new Be(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);n.validateTokenResponse(r.body);return[2,n.handleServerTokenResponse(r.body,this.authority,t,e,undefined,undefined,true)]}})})};r.prototype.acquireTokenByRefreshToken=function(e){return l(this,void 0,void 0,function(){var t,r,n;return h(this,function(o){if(!e){throw re.createEmptyTokenRequestError()}if(!e.account){throw V.createNoAccountInSilentRequestError()}t=this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId);if(t){try{return[2,this.acquireTokenWithCachedRefreshToken(e,true)]}catch(t){r=t instanceof Me&&t.errorCode===Ue.noTokensFoundError.code;n=t instanceof Ce&&t.errorCode===K.INVALID_GRANT_ERROR&&t.subError===K.CLIENT_MISMATCH_ERROR;if(r||n){return[2,this.acquireTokenWithCachedRefreshToken(e,false)]}else{throw t}}}return[2,this.acquireTokenWithCachedRefreshToken(e,false)]})})};r.prototype.acquireTokenWithCachedRefreshToken=function(t,r){return l(this,void 0,void 0,function(){var n,o;return h(this,function(i){n=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,t.account,r);if(!n){throw Me.createNoTokensFoundError()}o=d(d({},t),{refreshToken:n.secret,authenticationScheme:t.authenticationScheme||e.AuthenticationScheme.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Ie.HOME_ACCOUNT_ID}});return[2,this.acquireToken(o)]})})};r.prototype.executeTokenRequest=function(e,t){return l(this,void 0,void 0,function(){var r,n,o,i,a;return h(this,function(s){switch(s.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:r=s.sent();n=this.createTokenQueryParameters(e);o=this.createTokenRequestHeaders(e.ccsCredential);i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};a=qe.appendQueryString(t.tokenEndpoint,n);return[2,this.executePostToTokenEndpoint(a,r,o,i)]}})})};r.prototype.createTokenQueryParameters=function(e){var t=new _e;if(e.tokenQueryParameters){t.addExtraQueryParameters(e.tokenQueryParameters)}return t.createQueryString()};r.prototype.createTokenRequestBody=function(t){return l(this,void 0,void 0,function(){var r,n,o,i,a,s;return h(this,function(c){switch(c.label){case 0:r=new _e;r.addClientId(this.config.authOptions.clientId);r.addScopes(t.scopes);r.addGrantType(_.REFRESH_TOKEN_GRANT);r.addClientInfo();r.addLibraryInfo(this.config.libraryInfo);r.addThrottling();if(this.serverTelemetryManager){r.addServerTelemetry(this.serverTelemetryManager)}n=t.correlationId||this.config.cryptoInterface.createNewGuid();r.addCorrelationId(n);r.addRefreshToken(t.refreshToken);if(this.config.clientCredentials.clientSecret){r.addClientSecret(this.config.clientCredentials.clientSecret)}if(this.config.clientCredentials.clientAssertion){o=this.config.clientCredentials.clientAssertion;r.addClientAssertion(o.assertion);r.addClientAssertionType(o.assertionType)}if(!(t.authenticationScheme===e.AuthenticationScheme.POP))return[3,2];i=new Ke(this.cryptoUtils);return[4,i.generateCnf(t)];case 1:a=c.sent();r.addPopToken(a);return[3,3];case 2:if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(t.sshJwk){r.addSshJwk(t.sshJwk)}else{throw re.createMissingSshJwkError()}}c.label=3;case 3:if(!J.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0){r.addClaims(t.claims,this.config.authOptions.clientCapabilities)}if(this.config.systemOptions.preventCorsPreflight&&t.ccsCredential){switch(t.ccsCredential.type){case Ie.HOME_ACCOUNT_ID:try{s=ie(t.ccsCredential.credential);r.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ie.UPN:r.addCcsUpn(t.ccsCredential.credential);break}}return[2,r.createQueryString()]}})})};return r}(we);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ze=function(e){u(t,e);function t(t){return e.call(this,t)||this}t.prototype.acquireToken=function(e){return l(this,void 0,void 0,function(){var t,r;return h(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.acquireCachedToken(e)];case 1:return[2,n.sent()];case 2:t=n.sent();if(t instanceof V&&t.errorCode===Q.tokenRefreshRequired.code){r=new je(this.config);return[2,r.acquireTokenByRefreshToken(e)]}else{throw t}case 3:return[2]}})})};t.prototype.acquireCachedToken=function(e){var t,r,n,o;return l(this,void 0,void 0,function(){var i,a;return h(this,function(s){switch(s.label){case 0:if(!e){throw re.createEmptyTokenRequestError()}if(e.forceRefresh){(t=this.serverTelemetryManager)===null||t===void 0?void 0:t.setCacheOutcome(j.FORCE_REFRESH);this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true.");throw V.createRefreshRequiredError()}if(!e.account){throw V.createNoAccountInSilentRequestError()}i=e.authority||this.authority.getPreferredCache();a=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,e,i);if(!a.accessToken){(r=this.serverTelemetryManager)===null||r===void 0?void 0:r.setCacheOutcome(j.NO_CACHED_ACCESS_TOKEN);this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties.");throw V.createRefreshRequiredError()}else if(be.wasClockTurnedBack(a.accessToken.cachedAt)||be.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)){(n=this.serverTelemetryManager)===null||n===void 0?void 0:n.setCacheOutcome(j.CACHED_ACCESS_TOKEN_EXPIRED);this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds.");throw V.createRefreshRequiredError()}else if(a.accessToken.refreshOn&&be.isTokenExpired(a.accessToken.refreshOn,0)){(o=this.serverTelemetryManager)===null||o===void 0?void 0:o.setCacheOutcome(j.REFRESH_CACHED_ACCESS_TOKEN);this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'.");throw V.createRefreshRequiredError()}if(this.config.serverTelemetryManager){this.config.serverTelemetryManager.incrementCacheHits()}return[4,this.generateResultFromCacheRecord(a,e)];case 1:return[2,s.sent()]}})})};t.prototype.generateResultFromCacheRecord=function(e,t){return l(this,void 0,void 0,function(){var r;return h(this,function(n){switch(n.label){case 0:if(e.idToken){r=new ce(e.idToken.secret,this.config.cryptoInterface)}return[4,Be.generateAuthenticationResult(this.cryptoUtils,this.authority,e,true,t,r)];case 1:return[2,n.sent()]}})})};return t}(we);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */function We(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")}
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */e.ProtocolMode=void 0;(function(e){e["AAD"]="AAD";e["OIDC"]="OIDC"})(e.ProtocolMode||(e.ProtocolMode={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ye=function(){function e(){this.expiresAt=be.nowSeconds()+L.REFRESH_TIME_SECONDS}e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases;this.preferred_cache=e.preferred_cache;this.preferred_network=e.preferred_network;this.aliasesFromNetwork=t};e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint;this.token_endpoint=e.token_endpoint;this.end_session_endpoint=e.end_session_endpoint;this.issuer=e.issuer;this.endpointsFromNetwork=t};e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e};e.prototype.resetExpiresAt=function(){this.expiresAt=be.nowSeconds()+L.REFRESH_TIME_SECONDS};e.prototype.isExpired=function(){return this.expiresAt<=be.nowSeconds()};e.isAuthorityMetadataEntity=function(e,t){if(!t){return false}return e.indexOf(L.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */function Qe(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ve=function(){function e(e){this.networkInterface=e}e.prototype.detectRegion=function(t,r,n){return l(this,void 0,void 0,function(){var o,i,a,s,c;return h(this,function(u){switch(u.label){case 0:o=t;if(!!o)return[3,8];i=e.IMDS_OPTIONS;if(n){i.proxyUrl=n}u.label=1;case 1:u.trys.push([1,6,,7]);return[4,this.getRegionFromIMDS(f.IMDS_VERSION,i)];case 2:a=u.sent();if(a.status===x.httpSuccess){o=a.body;r.region_source=B.IMDS}if(!(a.status===x.httpBadRequest))return[3,5];return[4,this.getCurrentVersion(i)];case 3:s=u.sent();if(!s){r.region_source=B.FAILED_AUTO_DETECTION;return[2,null]}return[4,this.getRegionFromIMDS(s,i)];case 4:c=u.sent();if(c.status===x.httpSuccess){o=c.body;r.region_source=B.IMDS}u.label=5;case 5:return[3,7];case 6:u.sent();r.region_source=B.FAILED_AUTO_DETECTION;return[2,null];case 7:return[3,9];case 8:r.region_source=B.ENVIRONMENT_VARIABLE;u.label=9;case 9:if(!o){r.region_source=B.FAILED_AUTO_DETECTION}return[2,o||null]}})})};e.prototype.getRegionFromIMDS=function(e,t){return l(this,void 0,void 0,function(){return h(this,function(r){return[2,this.networkInterface.sendGetRequestAsync(f.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,f.IMDS_TIMEOUT)]})})};e.prototype.getCurrentVersion=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,this.networkInterface.sendGetRequestAsync(f.IMDS_ENDPOINT+"?format=json",e)];case 1:t=r.sent();if(t.status===x.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0){return[2,t.body["newest-versions"][0]]}return[2,null];case 2:r.sent();return[2,null];case 3:return[2]}})})};e.IMDS_OPTIONS={headers:{Metadata:"true"}};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Je=function(){function t(e,t,r,n,o){this.canonicalAuthority=e;this._canonicalAuthority.validateAsUri();this.networkInterface=t;this.cacheManager=r;this.authorityOptions=n;this.regionDiscovery=new Ve(t);this.regionDiscoveryMetadata={region_used:undefined,region_source:undefined,region_outcome:undefined};this.proxyUrl=o||f.EMPTY_STRING}Object.defineProperty(t.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length&&e[0].toLowerCase()===f.ADFS){return ae.Adfs}return ae.Default},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"options",{get:function(){return this.authorityOptions},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new qe(e);this._canonicalAuthority.validateAsUri();this._canonicalAuthorityUrlComponents=null},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"canonicalAuthorityUrlComponents",{get:function(){if(!this._canonicalAuthorityUrlComponents){this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()}return this._canonicalAuthorityUrlComponents},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint){throw V.createLogoutNotSupportedError()}var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}},enumerable:false,configurable:true});t.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)};t.prototype.replacePath=function(e){var t=e;var r=new qe(this.metadata.canonical_authority);var n=r.getUrlComponents().PathSegments;var o=this.canonicalAuthorityUrlComponents.PathSegments;o.forEach(function(e,r){var o=n[r];if(e!==o){t=t.replace("/"+o+"/","/"+e+"/")}});return t};Object.defineProperty(t.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){if(this.authorityType===ae.Adfs||this.protocolMode===e.ProtocolMode.OIDC){return this.canonicalAuthority+".well-known/openid-configuration"}return this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:false,configurable:true});t.prototype.discoveryComplete=function(){return!!this.metadata};t.prototype.resolveEndpointsAsync=function(){return l(this,void 0,void 0,function(){var e,t,r,n;return h(this,function(o){switch(o.label){case 0:e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);if(!e){e=new Ye;e.updateCanonicalAuthority(this.canonicalAuthority)}return[4,this.updateCloudDiscoveryMetadata(e)];case 1:t=o.sent();this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);return[4,this.updateEndpointMetadata(e)];case 2:r=o.sent();if(t!==H.CACHE&&r!==H.CACHE){e.resetExpiresAt();e.updateCanonicalAuthority(this.canonicalAuthority)}n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e);this.metadata=e;return[2]}})})};t.prototype.updateEndpointMetadata=function(e){var r;return l(this,void 0,void 0,function(){var n,o,i;return h(this,function(a){switch(a.label){case 0:n=this.getEndpointMetadataFromConfig();if(n){e.updateEndpointMetadata(n,false);return[2,H.CONFIG]}if(this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()){return[2,H.CACHE]}return[4,this.getEndpointMetadataFromNetwork()];case 1:n=a.sent();if(!n)return[3,4];if(!((r=this.authorityOptions.azureRegionConfiguration)===null||r===void 0?void 0:r.azureRegion))return[3,3];return[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)];case 2:o=a.sent();i=this.authorityOptions.azureRegionConfiguration.azureRegion===f.AZURE_REGION_AUTO_DISCOVER_FLAG?o:this.authorityOptions.azureRegionConfiguration.azureRegion;if(this.authorityOptions.azureRegionConfiguration.azureRegion===f.AZURE_REGION_AUTO_DISCOVER_FLAG){this.regionDiscoveryMetadata.region_outcome=o?G.AUTO_DETECTION_REQUESTED_SUCCESSFUL:G.AUTO_DETECTION_REQUESTED_FAILED}else{if(o){this.regionDiscoveryMetadata.region_outcome=this.authorityOptions.azureRegionConfiguration.azureRegion===o?G.CONFIGURED_MATCHES_DETECTED:G.CONFIGURED_NOT_DETECTED}else{this.regionDiscoveryMetadata.region_outcome=G.CONFIGURED_NO_AUTO_DETECTION}}if(i){this.regionDiscoveryMetadata.region_used=i;n=t.replaceWithRegionalInformation(n,i)}a.label=3;case 3:e.updateEndpointMetadata(n,true);return[2,H.NETWORK];case 4:throw V.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})};t.prototype.isAuthoritySameType=function(e){var t=new qe(e.canonical_authority);var r=t.getUrlComponents().PathSegments;return r.length===this.canonicalAuthorityUrlComponents.PathSegments.length};t.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata){try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw re.createInvalidAuthorityMetadataError()}}return null};t.prototype.getEndpointMetadataFromNetwork=function(){return l(this,void 0,void 0,function(){var e,t;return h(this,function(r){switch(r.label){case 0:e={};if(this.proxyUrl){e.proxyUrl=this.proxyUrl}r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:t=r.sent();return[2,We(t.body)?t.body:null];case 3:r.sent();return[2,null];case 4:return[2]}})})};t.prototype.updateCloudDiscoveryMetadata=function(e){return l(this,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:t=this.getCloudDiscoveryMetadataFromConfig();if(t){e.updateCloudDiscoveryMetadata(t,false);return[2,H.CONFIG]}if(this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()){return[2,H.CACHE]}return[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:t=r.sent();if(t){e.updateCloudDiscoveryMetadata(t,true);return[2,H.NETWORK]}else{throw re.createUntrustedAuthorityError()}}})})};t.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata){try{var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata);var r=t.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(r){return r}}catch(e){throw re.createInvalidCloudDiscoveryMetadataError()}}if(this.isInKnownAuthorities()){return t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)}return null};t.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return l(this,void 0,void 0,function(){var e,r,n,o,i;return h(this,function(a){switch(a.label){case 0:e=""+f.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize";r={};if(this.proxyUrl){r.proxyUrl=this.proxyUrl}n=null;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,this.networkInterface.sendGetRequestAsync(e,r)];case 2:o=a.sent();i=Qe(o.body)?o.body.metadata:[];if(i.length===0){return[2,null]}n=t.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort);return[3,4];case 3:a.sent();return[2,null];case 4:if(!n){n=t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)}return[2,n]}})})};t.prototype.isInKnownAuthorities=function(){var e=this;var t=this.authorityOptions.knownAuthorities.filter(function(t){return qe.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort});return t.length>0};t.generateAuthority=function(t,r){var n;if(r&&r.azureCloudInstance!==e.AzureCloudInstance.None){var o=r.tenant?r.tenant:f.DEFAULT_COMMON_TENANT;n=r.azureCloudInstance+"/"+o+"/"}return n?n:t};t.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}};t.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1){return n}}return null};t.prototype.getPreferredCache=function(){if(this.discoveryComplete()){return this.metadata.preferred_cache}else{throw V.createEndpointDiscoveryIncompleteError("Discovery incomplete.")}};t.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1};t.isPublicCloudAuthority=function(e){return f.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0};t.buildRegionalAuthorityString=function(e,t,r){var n=new qe(e);n.validateAsUri();var o=n.getUrlComponents();var i=t+"."+o.HostNameAndPort;if(this.isPublicCloudAuthority(o.HostNameAndPort)){i=t+"."+f.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}var a=qe.constructAuthorityUriFromObject(d(d({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;if(r)return a+"?"+r;return a};t.replaceWithRegionalInformation=function(e,r){e.authorization_endpoint=t.buildRegionalAuthorityString(e.authorization_endpoint,r);e.token_endpoint=t.buildRegionalAuthorityString(e.token_endpoint,r,"allowestsrnonmsi=true");if(e.end_session_endpoint){e.end_session_endpoint=t.buildRegionalAuthorityString(e.end_session_endpoint,r)}return e};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Xe=function(){function e(){}e.createDiscoveredInstance=function(t,r,n,o,i){return l(this,void 0,void 0,function(){var a,s;return h(this,function(c){switch(c.label){case 0:a=e.createInstance(t,r,n,o,i);c.label=1;case 1:c.trys.push([1,3,,4]);return[4,a.resolveEndpointsAsync()];case 2:c.sent();return[2,a];case 3:s=c.sent();throw V.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}})})};e.createInstance=function(e,t,r,n,o){if(J.isEmpty(e)){throw re.createUrlEmptyError()}return new Je(e,t,r,n,o)};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ze=function(){function e(){this.failedRequests=[];this.errors=[];this.cacheHits=0}e.isServerTelemetryEntity=function(e,t){var r=e.indexOf(q.CACHE_KEY)===0;var n=true;if(t){n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")}return r&&n};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var $e=function(){function e(){}e.isThrottlingEntity=function(e,t){var r=false;if(e){r=e.indexOf(D.THROTTLING_PREFIX)===0}var n=true;if(t){n=t.hasOwnProperty("throttleTime")}return r&&n};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var et={sendGetRequestAsync:function(){var e="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(W.createUnexpectedError(e))},sendPostRequestAsync:function(){var e="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(W.createUnexpectedError(e))}};
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var tt=function(){function e(e){this.headers=e}e.prototype.getShrNonce=function(){var e=this.headers[y.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce){return t.nextnonce}throw re.createInvalidAuthenticationHeaderError(y.AuthenticationInfo,"nextnonce challenge is missing.")}var r=this.headers[y.WWWAuthenticate];if(r){var n=this.parseChallenges(r);if(n.nonce){return n.nonce}throw re.createInvalidAuthenticationHeaderError(y.WWWAuthenticate,"nonce challenge is missing.")}throw re.createMissingNonceAuthenticationHeadersError()};e.prototype.parseChallenges=function(e){var t=e.indexOf(" ");var r=e.substr(t+1).split(",");var n={};r.forEach(function(e){var t=e.split("="),r=t[0],o=t[1];n[r]=unescape(o.replace(/['"]+/g,""))});return n};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var rt=function(){function e(e,t){this.cacheOutcome=j.NO_CACHE_HIT;this.cacheManager=t;this.apiId=e.apiId;this.correlationId=e.correlationId;this.wrapperSKU=e.wrapperSKU||f.EMPTY_STRING;this.wrapperVer=e.wrapperVer||f.EMPTY_STRING;this.telemetryCacheKey=q.CACHE_KEY+b.CACHE_KEY_SEPARATOR+e.clientId}e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+q.VALUE_SEPARATOR+this.cacheOutcome;var t=[this.wrapperSKU,this.wrapperVer].join(q.VALUE_SEPARATOR);var r=this.getRegionDiscoveryFields();var n=[e,r].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,n,t].join(q.CATEGORY_SEPARATOR)};e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests();var r=e.maxErrorsToSend(t);var n=t.failedRequests.slice(0,2*r).join(q.VALUE_SEPARATOR);var o=t.errors.slice(0,r).join(q.VALUE_SEPARATOR);var i=t.errors.length;var a=r<i?q.OVERFLOW_TRUE:q.OVERFLOW_FALSE;var s=[i,a].join(q.VALUE_SEPARATOR);return[q.SCHEMA_VERSION,t.cacheHits,n,o,s].join(q.CATEGORY_SEPARATOR)};e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();if(t.errors.length>=q.MAX_CACHED_ERRORS){t.failedRequests.shift();t.failedRequests.shift();t.errors.shift()}t.failedRequests.push(this.apiId,this.correlationId);if(!J.isEmpty(e.subError)){t.errors.push(e.subError)}else if(!J.isEmpty(e.errorCode)){t.errors.push(e.errorCode)}else if(!!e&&e.toString()){t.errors.push(e.toString())}else{t.errors.push(q.UNKNOWN_ERROR)}this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t);return};e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();e.cacheHits+=1;this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e);return e.cacheHits};e.prototype.getLastRequests=function(){var e=new Ze;var t=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return t||e};e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests();var r=e.maxErrorsToSend(t);var n=t.errors.length;if(r===n){this.cacheManager.removeItem(this.telemetryCacheKey)}else{var o=new Ze;o.failedRequests=t.failedRequests.slice(r*2);o.errors=t.errors.slice(r);this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}};e.maxErrorsToSend=function(e){var t;var r=0;var n=0;var o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||f.EMPTY_STRING;var a=e.failedRequests[2*t+1]||f.EMPTY_STRING;var s=e.errors[t]||f.EMPTY_STRING;n+=i.toString().length+a.toString().length+s.length+3;if(n<q.MAX_LAST_HEADER_BYTES){r+=1}else{break}}return r};e.prototype.getRegionDiscoveryFields=function(){var e=[];e.push(this.regionUsed||"");e.push(this.regionSource||"");e.push(this.regionOutcome||"");return e.join(",")};e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used;this.regionSource=e.region_source;this.regionOutcome=e.region_outcome};e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var nt={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",POLL_INTERVAL_MS:50,MSAL_SKU:"msal.js.browser"};e.BrowserCacheLocation=void 0;(function(e){e["LocalStorage"]="localStorage";e["SessionStorage"]="sessionStorage";e["MemoryStorage"]="memoryStorage"})(e.BrowserCacheLocation||(e.BrowserCacheLocation={}));var ot;(function(e){e["GET"]="GET";e["POST"]="POST"})(ot||(ot={}));e.TemporaryCacheKeys=void 0;(function(e){e["AUTHORITY"]="authority";e["ACQUIRE_TOKEN_ACCOUNT"]="acquireToken.account";e["SESSION_STATE"]="session.state";e["REQUEST_STATE"]="request.state";e["NONCE_IDTOKEN"]="nonce.id_token";e["ORIGIN_URI"]="request.origin";e["RENEW_STATUS"]="token.renew.status";e["URL_HASH"]="urlHash";e["REQUEST_PARAMS"]="request.params";e["SCOPES"]="scopes";e["INTERACTION_STATUS_KEY"]="interaction.status";e["CCS_CREDENTIAL"]="ccs.credential";e["CORRELATION_ID"]="request.correlationId"})(e.TemporaryCacheKeys||(e.TemporaryCacheKeys={}));var it;(function(e){e["WRAPPER_SKU"]="wrapper.sku";e["WRAPPER_VER"]="wrapper.version"})(it||(it={}));e.ApiId=void 0;(function(e){e[e["acquireTokenRedirect"]=861]="acquireTokenRedirect";e[e["acquireTokenPopup"]=862]="acquireTokenPopup";e[e["ssoSilent"]=863]="ssoSilent";e[e["acquireTokenSilent_authCode"]=864]="acquireTokenSilent_authCode";e[e["handleRedirectPromise"]=865]="handleRedirectPromise";e[e["acquireTokenByCode"]=866]="acquireTokenByCode";e[e["acquireTokenSilent_silentFlow"]=61]="acquireTokenSilent_silentFlow";e[e["logout"]=961]="logout";e[e["logoutPopup"]=962]="logoutPopup"})(e.ApiId||(e.ApiId={}));e.InteractionType=void 0;(function(e){e["Redirect"]="redirect";e["Popup"]="popup";e["Silent"]="silent";e["None"]="none"})(e.InteractionType||(e.InteractionType={}));e.InteractionStatus=void 0;(function(e){e["Startup"]="startup";e["Login"]="login";e["Logout"]="logout";e["AcquireToken"]="acquireToken";e["SsoSilent"]="ssoSilent";e["HandleRedirect"]="handleRedirect";e["None"]="none"})(e.InteractionStatus||(e.InteractionStatus={}));var at={scopes:g};var st="jwk";e.WrapperSKU=void 0;(function(e){e["React"]="@azure/msal-react";e["Angular"]="@azure/msal-angular"})(e.WrapperSKU||(e.WrapperSKU={}));var ct="msal.db";var ut=1;var dt=ct+".keys";
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var lt=function(){function e(){}e.decimalToHex=function(e){var t=e.toString(16);while(t.length<2){t="0"+t}return t};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ht=function(){function e(e){this.cryptoObj=e}e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);this.cryptoObj.getRandomValues(e);e[6]|=64;e[6]&=79;e[8]|=128;e[8]&=191;return lt.decimalToHex(e[0])+lt.decimalToHex(e[1])+lt.decimalToHex(e[2])+lt.decimalToHex(e[3])+"-"+lt.decimalToHex(e[4])+lt.decimalToHex(e[5])+"-"+lt.decimalToHex(e[6])+lt.decimalToHex(e[7])+"-"+lt.decimalToHex(e[8])+lt.decimalToHex(e[9])+"-"+lt.decimalToHex(e[10])+lt.decimalToHex(e[11])+lt.decimalToHex(e[12])+lt.decimalToHex(e[13])+lt.decimalToHex(e[14])+lt.decimalToHex(e[15])}catch(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";var r="0123456789abcdef";var n=0;var o="";for(var i=0;i<36;i++){if(t[i]!=="-"&&t[i]!=="4"){n=Math.random()*16|0}if(t[i]==="x"){o+=r[n]}else if(t[i]==="y"){n&=3;n|=8;o+=r[n]}else{o+=t[i]}}return o}};e.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var pt=function(){function e(){}e.stringToUtf8Arr=function(e){var t;var r=0;var n=e.length;for(var o=0;o<n;o++){t=e.charCodeAt(o);r+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6}var i=new Uint8Array(r);for(var a=0,s=0;a<r;s++){t=e.charCodeAt(s);if(t<128){i[a++]=t}else if(t<2048){i[a++]=192+(t>>>6);i[a++]=128+(t&63)}else if(t<65536){i[a++]=224+(t>>>12);i[a++]=128+(t>>>6&63);i[a++]=128+(t&63)}else if(t<2097152){i[a++]=240+(t>>>18);i[a++]=128+(t>>>12&63);i[a++]=128+(t>>>6&63);i[a++]=128+(t&63)}else if(t<67108864){i[a++]=248+(t>>>24);i[a++]=128+(t>>>18&63);i[a++]=128+(t>>>12&63);i[a++]=128+(t>>>6&63);i[a++]=128+(t&63)}else{i[a++]=252+(t>>>30);i[a++]=128+(t>>>24&63);i[a++]=128+(t>>>18&63);i[a++]=128+(t>>>12&63);i[a++]=128+(t>>>6&63);i[a++]=128+(t&63)}}return i};e.stringToArrayBuffer=function(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var n=0;n<e.length;n++){r[n]=e.charCodeAt(n)}return t};e.utf8ArrToString=function(e){var t="";for(var r=void 0,n=e.length,o=0;o<n;o++){r=e[o];t+=String.fromCharCode(r>251&&r<254&&o+5<n?(r-252)*1073741824+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r)}return t};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ft=function(){function e(){}e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))};e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")};e.prototype.encode=function(e){var t=pt.stringToUtf8Arr(e);return this.base64EncArr(t)};e.prototype.base64EncArr=function(e){var t=(3-e.length%3)%3;var r="";for(var n=void 0,o=e.length,i=0,a=0;a<o;a++){n=a%3;i|=e[a]<<(16>>>n&24);if(n===2||e.length-a===1){r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(i&63));i=0}}return t===0?r:r.substring(0,r.length-t)+(t===1?"=":"==")};e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var gt=function(){function e(){}e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return pt.utf8ArrToString(r)};e.prototype.base64DecToArr=function(e,t){var r=e.replace(/[^A-Za-z0-9\+\/]/g,"");var n=r.length;var o=t?Math.ceil((n*3+1>>>2)/t)*t:n*3+1>>>2;var i=new Uint8Array(o);for(var a=void 0,s=void 0,c=0,u=0,d=0;d<n;d++){s=d&3;c|=this.b64ToUint6(r.charCodeAt(d))<<18-6*s;if(s===3||n-d===1){for(a=0;a<3&&u<o;a++,u++){i[u]=c>>>(16>>>a&24)&255}c=0}}return i};e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:e===43?62:e===47?63:0};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var vt={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."}};var yt=function(e){r(t,e);function t(r,n){var o=e.call(this,r,n)||this;Object.setPrototypeOf(o,t.prototype);o.name="BrowserAuthError";return o}t.createPkceNotGeneratedError=function(e){return new t(vt.pkceNotGenerated.code,vt.pkceNotGenerated.desc+" Detail:"+e)};t.createCryptoNotAvailableError=function(e){return new t(vt.cryptoDoesNotExist.code,vt.cryptoDoesNotExist.desc+" Detail:"+e)};t.createHttpMethodNotImplementedError=function(e){return new t(vt.httpMethodNotImplementedError.code,vt.httpMethodNotImplementedError.desc+" Given Method: "+e)};t.createEmptyNavigationUriError=function(){return new t(vt.emptyNavigateUriError.code,vt.emptyNavigateUriError.desc)};t.createEmptyHashError=function(e){return new t(vt.hashEmptyError.code,vt.hashEmptyError.desc+" Given Url: "+e)};t.createHashDoesNotContainStateError=function(){return new t(vt.hashDoesNotContainStateError.code,vt.hashDoesNotContainStateError.desc)};t.createHashDoesNotContainKnownPropertiesError=function(){return new t(vt.hashDoesNotContainKnownPropertiesError.code,vt.hashDoesNotContainKnownPropertiesError.desc)};t.createUnableToParseStateError=function(){return new t(vt.unableToParseStateError.code,vt.unableToParseStateError.desc)};t.createStateInteractionTypeMismatchError=function(){return new t(vt.stateInteractionTypeMismatchError.code,vt.stateInteractionTypeMismatchError.desc)};t.createInteractionInProgressError=function(){return new t(vt.interactionInProgress.code,vt.interactionInProgress.desc)};t.createPopupWindowError=function(e){var r=vt.popupWindowError.desc;r=!J.isEmpty(e)?r+" Details: "+e:r;return new t(vt.popupWindowError.code,r)};t.createEmptyWindowCreatedError=function(){return new t(vt.emptyWindowError.code,vt.emptyWindowError.desc)};t.createUserCancelledError=function(){return new t(vt.userCancelledError.code,vt.userCancelledError.desc)};t.createMonitorPopupTimeoutError=function(){return new t(vt.monitorPopupTimeoutError.code,vt.monitorPopupTimeoutError.desc)};t.createMonitorIframeTimeoutError=function(){return new t(vt.monitorIframeTimeoutError.code,vt.monitorIframeTimeoutError.desc)};t.createRedirectInIframeError=function(e){return new t(vt.redirectInIframeError.code,vt.redirectInIframeError.desc+" (window.parent !== window) => "+e)};t.createBlockReloadInHiddenIframeError=function(){return new t(vt.blockTokenRequestsInHiddenIframeError.code,vt.blockTokenRequestsInHiddenIframeError.desc)};t.createBlockAcquireTokenInPopupsError=function(){return new t(vt.blockAcquireTokenInPopupsError.code,vt.blockAcquireTokenInPopupsError.desc)};t.createIframeClosedPrematurelyError=function(){return new t(vt.iframeClosedPrematurelyError.code,vt.iframeClosedPrematurelyError.desc)};t.createSilentLogoutUnsupportedError=function(){return new t(vt.silentLogoutUnsupportedError.code,vt.silentLogoutUnsupportedError.desc)};t.createNoAccountError=function(){return new t(vt.noAccountError.code,vt.noAccountError.desc)};t.createSilentPromptValueError=function(e){return new t(vt.silentPromptValueError.code,vt.silentPromptValueError.desc+" Given value: "+e)};t.createUnableToParseTokenRequestCacheError=function(){return new t(vt.unableToParseTokenRequestCacheError.code,vt.unableToParseTokenRequestCacheError.desc)};t.createNoTokenRequestCacheError=function(){return new t(vt.noTokenRequestCacheError.code,vt.noTokenRequestCacheError.desc)};t.createAuthRequestNotSetError=function(){return new t(vt.authRequestNotSet.code,vt.authRequestNotSet.desc)};t.createNoCachedAuthorityError=function(){return new t(vt.noCachedAuthorityError.code,vt.noCachedAuthorityError.desc)};t.createInvalidCacheTypeError=function(){return new t(vt.invalidCacheType.code,""+vt.invalidCacheType.desc)};t.createNonBrowserEnvironmentError=function(){return new t(vt.notInBrowserEnvironment.code,vt.notInBrowserEnvironment.desc)};t.createDatabaseNotOpenError=function(){return new t(vt.databaseNotOpen.code,vt.databaseNotOpen.desc)};t.createNoNetworkConnectivityError=function(){return new t(vt.noNetworkConnectivity.code,vt.noNetworkConnectivity.desc)};t.createPostRequestFailedError=function(e,r){return new t(vt.postRequestFailed.code,vt.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])};t.createGetRequestFailedError=function(e,r){return new t(vt.getRequestFailed.code,vt.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])};t.createFailedToParseNetworkResponseError=function(e){return new t(vt.failedToParseNetworkResponse.code,vt.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])};t.createUnableToLoadTokenError=function(e){return new t(vt.unableToLoadTokenError.code,vt.unableToLoadTokenError.desc+" | "+e)};t.createSigningKeyNotFoundInStorageError=function(e){return new t(vt.signingKeyNotFoundInStorage.code,vt.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)};t.createAuthCodeRequiredError=function(){return new t(vt.authCodeRequired.code,vt.authCodeRequired.desc)};t.createDatabaseUnavailableError=function(){return new t(vt.databaseUnavailable.code,vt.databaseUnavailable.desc)};return t}(W);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var mt=32;var Et=function(){function e(e){this.base64Encode=new ft;this.cryptoObj=e}e.prototype.generateCodes=function(){return o(this,void 0,void 0,function(){var e,t;return i(this,function(r){switch(r.label){case 0:e=this.generateCodeVerifier();return[4,this.generateCodeChallengeFromVerifier(e)];case 1:t=r.sent();return[2,{verifier:e,challenge:t}]}})})};e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(mt);this.cryptoObj.getRandomValues(e);var t=this.base64Encode.urlEncodeArr(e);return t}catch(e){throw yt.createPkceNotGeneratedError(e)}};e.prototype.generateCodeChallengeFromVerifier=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.cryptoObj.sha256Digest(e)];case 1:t=n.sent();return[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:r=n.sent();throw yt.createPkceNotGeneratedError(r);case 3:return[2]}})})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ct="RSASSA-PKCS1-v1_5";var Tt="SHA-256";var St=2048;var It=new Uint8Array([1,0,1]);var wt=function(){function e(e){this.logger=e;if(!this.hasCryptoAPI()){throw yt.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}this._keygenAlgorithmOptions={name:Ct,hash:Tt,modulusLength:St,publicExponent:It}}e.prototype.sha256Digest=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){t=pt.stringToUtf8Arr(e);return[2,this.hasIECrypto()?this.getMSCryptoDigest(Tt,t):this.getSubtleCryptoDigest(Tt,t)]})})};e.prototype.getRandomValues=function(e){var t=window["msCrypto"]||window.crypto;if(!t.getRandomValues){throw yt.createCryptoNotAvailableError("getRandomValues does not exist.")}t.getRandomValues(e)};e.prototype.generateKeyPair=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]})})};e.prototype.exportJwk=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(st,e)]})})};e.prototype.importJwk=function(t,r,n){return o(this,void 0,void 0,function(){var o,a;return i(this,function(i){o=e.getJwkString(t);a=pt.stringToArrayBuffer(o);return[2,this.hasIECrypto()?this.msCryptoImportKey(a,r,n):window.crypto.subtle.importKey(st,t,this._keygenAlgorithmOptions,r,n)]})})};e.prototype.sign=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]})})};e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()};e.prototype.hasIECrypto=function(){return"msCrypto"in window};e.prototype.hasBrowserCrypto=function(){return"crypto"in window};e.prototype.getSubtleCryptoDigest=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,window.crypto.subtle.digest(e,t)]})})};e.prototype.getMSCryptoDigest=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,new Promise(function(r,n){var o=window["msCrypto"].subtle.digest(e,t.buffer);o.addEventListener("complete",function(e){r(e.target.result)});o.addEventListener("error",function(e){n(e)})})]})})};e.prototype.msCryptoGenerateKey=function(e,t){return o(this,void 0,void 0,function(){var r=this;return i(this,function(n){return[2,new Promise(function(n,o){var i=window["msCrypto"].subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(e){n(e.target.result)});i.addEventListener("error",function(e){o(e)})})]})})};e.prototype.msCryptoExportJwk=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return[2,new Promise(function(t,r){var n=window["msCrypto"].subtle.exportKey(st,e);n.addEventListener("complete",function(e){var n=e.target.result;var o=pt.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}});n.addEventListener("error",function(e){r(e)})})]})})};e.prototype.msCryptoImportKey=function(e,t,r){return o(this,void 0,void 0,function(){var n=this;return i(this,function(o){return[2,new Promise(function(o,i){var a=window["msCrypto"].subtle.importKey(st,e,n._keygenAlgorithmOptions,t,r);a.addEventListener("complete",function(e){o(e.target.result)});a.addEventListener("error",function(e){i(e)})})]})})};e.prototype.msCryptoSign=function(e,t){return o(this,void 0,void 0,function(){var r=this;return i(this,function(n){return[2,new Promise(function(n,o){var i=window["msCrypto"].subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",function(e){n(e.target.result)});i.addEventListener("error",function(e){o(e)})})]})})};e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var At=function(){function e(){this.dbName=ct;this.version=ut;this.tableName=dt;this.dbOpen=false}e.prototype.open=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(t){return[2,new Promise(function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",function(t){var r=t;r.target.result.createObjectStore(e.tableName)});n.addEventListener("success",function(r){var n=r;e.db=n.target.result;e.dbOpen=true;t()});n.addEventListener("error",function(){return r(yt.createDatabaseUnavailableError())})})]})})};e.prototype.validateDbIsOpen=function(){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:if(!!this.dbOpen)return[3,2];return[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})};e.prototype.getItem=function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:r.sent();return[2,new Promise(function(r,n){if(!t.db){return n(yt.createDatabaseNotOpenError())}var o=t.db.transaction([t.tableName],"readonly");var i=o.objectStore(t.tableName);var a=i.get(e);a.addEventListener("success",function(e){var t=e;r(t.target.result)});a.addEventListener("error",function(e){return n(e)})})]}})})};e.prototype.setItem=function(e,t){return o(this,void 0,void 0,function(){var r=this;return i(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:n.sent();return[2,new Promise(function(n,o){if(!r.db){return o(yt.createDatabaseNotOpenError())}var i=r.db.transaction([r.tableName],"readwrite");var a=i.objectStore(r.tableName);var s=a.put(t,e);s.addEventListener("success",function(){return n()});s.addEventListener("error",function(e){return o(e)})})]}})})};e.prototype.removeItem=function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:r.sent();return[2,new Promise(function(r,n){if(!t.db){return n(yt.createDatabaseNotOpenError())}var o=t.db.transaction([t.tableName],"readwrite");var i=o.objectStore(t.tableName);var a=i.delete(e);a.addEventListener("success",function(){return r()});a.addEventListener("error",function(e){return n(e)})})]}})})};e.prototype.getKeys=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:t.sent();return[2,new Promise(function(t,r){if(!e.db){return r(yt.createDatabaseNotOpenError())}var n=e.db.transaction([e.tableName],"readonly");var o=n.objectStore(e.tableName);var i=o.getAllKeys();i.addEventListener("success",function(e){var r=e;t(r.target.result)});i.addEventListener("error",function(e){return r(e)})})]}})})};e.prototype.containsKey=function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:r.sent();return[2,new Promise(function(r,n){if(!t.db){return n(yt.createDatabaseNotOpenError())}var o=t.db.transaction([t.tableName],"readonly");var i=o.objectStore(t.tableName);var a=i.count(e);a.addEventListener("success",function(e){var t=e;r(t.target.result===1)});a.addEventListener("error",function(e){return n(e)})})]}})})};e.prototype.deleteDatabase=function(){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,new Promise(function(e,t){var r=window.indexedDB.deleteDatabase(ct);r.addEventListener("success",function(){return e(true)});r.addEventListener("error",function(){return t(false)})})]})})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var _t=function(){function e(){this.cache=new Map}e.prototype.getItem=function(e){return this.cache.get(e)||null};e.prototype.setItem=function(e,t){this.cache.set(e,t)};e.prototype.removeItem=function(e){this.cache.delete(e)};e.prototype.getKeys=function(){var e=[];this.cache.forEach(function(t,r){e.push(r)});return e};e.prototype.containsKey=function(e){return this.cache.has(e)};e.prototype.clear=function(){this.cache.clear()};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Rt=function(){function e(e){this.inMemoryCache=new _t;this.indexedDBCache=new At;this.logger=e}e.prototype.handleDatabaseAccessError=function(e){if(e instanceof yt&&e.errorCode===vt.databaseUnavailable.code){this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}};e.prototype.getItem=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:t=this.inMemoryCache.getItem(e);if(!!t)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage.");return[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:r=n.sent();this.handleDatabaseAccessError(r);return[3,4];case 4:return[2,t]}})})};e.prototype.setItem=function(e,t){return o(this,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t);n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this.indexedDBCache.setItem(e,t)];case 2:n.sent();return[3,4];case 3:r=n.sent();this.handleDatabaseAccessError(r);return[3,4];case 4:return[2]}})})};e.prototype.removeItem=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e);r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this.indexedDBCache.removeItem(e)];case 2:r.sent();return[3,4];case 3:t=r.sent();this.handleDatabaseAccessError(t);return[3,4];case 4:return[2]}})})};e.prototype.getKeys=function(){return o(this,void 0,void 0,function(){var e,t;return i(this,function(r){switch(r.label){case 0:e=this.inMemoryCache.getKeys();if(!(e.length===0))return[3,4];r.label=1;case 1:r.trys.push([1,3,,4]);this.logger.verbose("In-memory cache is empty, now querying persistent storage.");return[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:t=r.sent();this.handleDatabaseAccessError(t);return[3,4];case 4:return[2,e]}})})};e.prototype.containsKey=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:t=this.inMemoryCache.containsKey(e);if(!!t)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);this.logger.verbose("Key not found in in-memory cache, now querying persistent storage.");return[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:r=n.sent();this.handleDatabaseAccessError(r);return[3,4];case 4:return[2,t]}})})};e.prototype.clear=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:this.inMemoryCache.clear();t.label=1;case 1:t.trys.push([1,3,,4]);return[4,this.indexedDBCache.deleteDatabase()];case 2:t.sent();return[3,4];case 3:e=t.sent();this.handleDatabaseAccessError(e);return[3,4];case 4:return[2]}})})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var bt=function(){function e(e){this.logger=e;this.browserCrypto=new wt(this.logger);this.b64Encode=new ft;this.b64Decode=new gt;this.guidGenerator=new ht(this.browserCrypto);this.pkceGenerator=new Et(this.browserCrypto);this.cache={asymmetricKeys:new Rt(this.logger),symmetricKeys:new Rt(this.logger)}}e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()};e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)};e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)};e.prototype.generatePkceCodes=function(){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})};e.prototype.getPublicKeyThumbprint=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s,c,u;return i(this,function(i){switch(i.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:r=i.sent();return[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:n=i.sent();o={e:n.e,kty:n.kty,n:n.n};a=wt.getJwkString(o);return[4,this.hashString(a)];case 3:s=i.sent();return[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:c=i.sent();return[4,this.browserCrypto.importJwk(c,false,["sign"])];case 5:u=i.sent();return[4,this.cache.asymmetricKeys.setItem(s,{privateKey:u,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:i.sent();return[2,s]}})})};e.prototype.removeTokenBindingKey=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:r.sent();return[4,this.cache.asymmetricKeys.containsKey(e)];case 2:t=r.sent();return[2,!t]}})})};e.prototype.clearKeystore=function(){return o(this,void 0,void 0,function(){var e,t,r;return i(this,function(n){switch(n.label){case 0:e=Object.keys(this.cache);t=this.cache[e[0]];if(!t)return[3,2];return[4,t.deleteDatabase()];case 1:r=n.sent();return[3,3];case 2:r=false;n.label=3;case 3:return[2,r]}})})};e.prototype.signJwt=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,a,s,c,u,d,l,h;return i(this,function(i){switch(i.label){case 0:return[4,this.cache.asymmetricKeys.getItem(t)];case 1:r=i.sent();if(!r){throw yt.createSigningKeyNotFoundInStorageError(t)}return[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:n=i.sent();o=wt.getJwkString(n);a={alg:n.alg,type:st};s=this.b64Encode.urlEncode(JSON.stringify(a));e.cnf={jwk:JSON.parse(o)};c=this.b64Encode.urlEncode(JSON.stringify(e));u=s+"."+c;d=pt.stringToArrayBuffer(u);return[4,this.browserCrypto.sign(r.privateKey,d)];case 3:l=i.sent();h=this.b64Encode.urlEncodeArr(new Uint8Array(l));return[2,u+"."+h]}})})};e.prototype.hashString=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:t=n.sent();r=new Uint8Array(t);return[2,this.b64Encode.urlEncodeArr(r)]}})})};e.POP_KEY_USAGES=["sign","verify"];e.EXTRACTABLE=true;return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ot={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. "+"More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. "+"More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}};var kt=function(e){r(t,e);function t(r,n){var o=e.call(this,r,n)||this;o.name="BrowserConfigurationAuthError";Object.setPrototypeOf(o,t.prototype);return o}t.createRedirectUriEmptyError=function(){return new t(Ot.redirectUriNotSet.code,Ot.redirectUriNotSet.desc)};t.createPostLogoutRedirectUriEmptyError=function(){return new t(Ot.postLogoutUriNotSet.code,Ot.postLogoutUriNotSet.desc)};t.createStorageNotSupportedError=function(e){return new t(Ot.storageNotSupportedError.code,Ot.storageNotSupportedError.desc+" Given Location: "+e)};t.createRedirectCallbacksNotSetError=function(){return new t(Ot.noRedirectCallbacksSet.code,Ot.noRedirectCallbacksSet.desc)};t.createStubPcaInstanceCalledError=function(){return new t(Ot.stubPcaInstanceCalled.code,Ot.stubPcaInstanceCalled.desc)};t.createInMemoryRedirectUnavailableError=function(){return new t(Ot.inMemRedirectUnavailable.code,Ot.inMemRedirectUnavailable.desc)};return t}(W);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Nt=function(){function t(e){this.validateWindowStorage(e);this.windowStorage=window[e]}t.prototype.validateWindowStorage=function(t){if(t!==e.BrowserCacheLocation.LocalStorage&&t!==e.BrowserCacheLocation.SessionStorage){throw kt.createStorageNotSupportedError(t)}var r=!!window[t];if(!r){throw kt.createStorageNotSupportedError(t)}};t.prototype.getItem=function(e){return this.windowStorage.getItem(e)};t.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)};t.prototype.removeItem=function(e){this.windowStorage.removeItem(e)};t.prototype.getKeys=function(){return Object.keys(this.windowStorage)};t.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Pt=function(){function e(){}e.extractBrowserRequestState=function(e,t){if(J.isEmpty(t)){return null}try{var r=He.parseRequestState(e,t);return r.libraryState.meta}catch(e){throw V.createInvalidStateError(t,e)}};e.parseServerResponseFromHash=function(e){if(!e){return{}}var t=new qe(e);return qe.getDeserializedHash(t.getHash())};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ut=function(t){r(n,t);function n(e,r,n,o){var i=t.call(this,e,n)||this;i.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3;i.cacheConfig=r;i.logger=o;i.internalStorage=new _t;i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation);i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation);i.migrateCacheEntries();return i}n.prototype.setupBrowserStorage=function(t){switch(t){case e.BrowserCacheLocation.LocalStorage:case e.BrowserCacheLocation.SessionStorage:try{return new Nt(t)}catch(e){this.logger.verbose(e);break}case e.BrowserCacheLocation.MemoryStorage:}this.cacheConfig.cacheLocation=e.BrowserCacheLocation.MemoryStorage;return new _t};n.prototype.setupTemporaryCacheStorage=function(t){switch(t){case e.BrowserCacheLocation.LocalStorage:case e.BrowserCacheLocation.SessionStorage:try{return new Nt(e.BrowserCacheLocation.SessionStorage)}catch(e){this.logger.verbose(e);return this.internalStorage}case e.BrowserCacheLocation.MemoryStorage:default:return this.internalStorage}};n.prototype.migrateCacheEntries=function(){var e=this;var t=f.CACHE_PREFIX+"."+m.ID_TOKEN;var r=f.CACHE_PREFIX+"."+m.CLIENT_INFO;var n=f.CACHE_PREFIX+"."+m.ERROR;var o=f.CACHE_PREFIX+"."+m.ERROR_DESC;var i=this.browserStorage.getItem(t);var a=this.browserStorage.getItem(r);var s=this.browserStorage.getItem(n);var c=this.browserStorage.getItem(o);var u=[i,a,s,c];var d=[m.ID_TOKEN,m.CLIENT_INFO,m.ERROR,m.ERROR_DESC];d.forEach(function(t,r){return e.migrateCacheEntry(t,u[r])})};n.prototype.migrateCacheEntry=function(e,t){if(t){this.setTemporaryCache(e,t,true)}};n.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&typeof t==="object"?t:null}catch(e){return null}};n.prototype.getItem=function(e){return this.browserStorage.getItem(e)};n.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)};n.prototype.getAccount=function(e){var t=this.getItem(e);if(!t){return null}var r=this.validateAndParseJson(t);if(!r||!se.isAccountEntity(r)){return null}return ue.toObject(new se,r)};n.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))};n.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!Re.isIdTokenEntity(r)){this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit");return ue.toObject(new Re,r)};n.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))};n.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!Oe.isAccessTokenEntity(r)){this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit");return ue.toObject(new Oe,r)};n.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))};n.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!ke.isRefreshTokenEntity(r)){this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit");return ue.toObject(new ke,r)};n.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))};n.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!Fe.isAppMetadataEntity(e,r)){this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit");return ue.toObject(new Fe,r)};n.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))};n.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!Ze.isServerTelemetryEntity(e,r)){this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit");return ue.toObject(new Ze,r)};n.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called");this.setItem(e,JSON.stringify(t))};n.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(r&&Ye.isAuthorityMetadataEntity(e,r)){this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit");return ue.toObject(new Ye,r)}return null};n.prototype.getAuthorityMetadataKeys=function(){var e=this;var t=this.internalStorage.getKeys();return t.filter(function(t){return e.isAuthorityMetadata(t)})};n.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(it.WRAPPER_SKU,e);this.internalStorage.setItem(it.WRAPPER_VER,t)};n.prototype.getWrapperMetadata=function(){var e=this.internalStorage.getItem(it.WRAPPER_SKU)||"";var t=this.internalStorage.getItem(it.WRAPPER_VER)||"";return[e,t]};n.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called");this.internalStorage.setItem(e,JSON.stringify(t))};n.prototype.getActiveAccount=function(){var e=this.generateCacheKey(m.ACTIVE_ACCOUNT);var t=this.browserStorage.getItem(e);if(!t){return null}return this.getAccountInfoByFilter({localAccountId:t})[0]||null};n.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(m.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");this.browserStorage.setItem(t,e.localAccountId)}else{this.logger.verbose("setActiveAccount: No account passed, active account not set");this.browserStorage.removeItem(t)}};n.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return t.filter(function(t){if(e.username&&e.username.toLowerCase()!==t.username.toLowerCase()){return false}if(e.homeAccountId&&e.homeAccountId!==t.homeAccountId){return false}if(e.localAccountId&&e.localAccountId!==t.localAccountId){return false}if(e.tenantId&&e.tenantId!==t.tenantId){return false}if(e.environment&&e.environment!==t.environment){return false}return true})};n.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit");return null}var r=this.validateAndParseJson(t);if(!r||!$e.isThrottlingEntity(e,r)){this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit");return null}this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit");return ue.toObject(new $e,r)};n.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called");this.setItem(e,JSON.stringify(t))};n.prototype.getTemporaryCache=function(t,r){var n=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var o=this.getItemCookie(n);if(o){this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies");return o}}var i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===e.BrowserCacheLocation.LocalStorage){var a=this.browserStorage.getItem(n);if(a){this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage");return a}}this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage");return null}this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned");return i};n.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t);if(this.cacheConfig.storeAuthStateInCookie){this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie");this.setItemCookie(n,t)}};n.prototype.removeItem=function(e){this.browserStorage.removeItem(e);this.temporaryCacheStorage.removeItem(e);if(this.cacheConfig.storeAuthStateInCookie){this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie");this.clearItemCookie(e)}return true};n.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)};n.prototype.getKeys=function(){return s(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())};n.prototype.clear=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:t.sent();this.removeAppMetadata();this.getKeys().forEach(function(t){if((e.browserStorage.containsKey(t)||e.temporaryCacheStorage.containsKey(t))&&(t.indexOf(f.CACHE_PREFIX)!==-1||t.indexOf(e.clientId)!==-1)){e.removeItem(t)}});this.internalStorage.clear();return[2]}})})};n.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";if(r){var o=this.getCookieExpirationTime(r);n+="expires="+o+";"}if(this.cacheConfig.secureCookies){n+="Secure;"}document.cookie=n};n.prototype.getItemCookie=function(e){var t=encodeURIComponent(e)+"=";var r=document.cookie.split(";");for(var n=0;n<r.length;n++){var o=r[n];while(o.charAt(0)===" "){o=o.substring(1)}if(o.indexOf(t)===0){return decodeURIComponent(o.substring(t.length,o.length))}}return""};n.prototype.clearMsalCookies=function(){var e=this;var t=f.CACHE_PREFIX+"."+this.clientId;var r=document.cookie.split(";");r.forEach(function(r){while(r.charAt(0)===" "){r=r.substring(1)}if(r.indexOf(t)===0){var n=r.split("=")[0];e.clearItemCookie(n)}})};n.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)};n.prototype.getCookieExpirationTime=function(e){var t=new Date;var r=new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER);return r.toUTCString()};n.prototype.getCache=function(){return this.browserStorage};n.prototype.setCache=function(){};n.prototype.generateCacheKey=function(e){var t=this.validateAndParseJson(e);if(!t){if(J.startsWith(e,f.CACHE_PREFIX)||J.startsWith(e,m.ADAL_ID_TOKEN)){return e}return f.CACHE_PREFIX+"."+this.clientId+"."+e}return JSON.stringify(e)};n.prototype.generateAuthorityKey=function(t){var r=He.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(e.TemporaryCacheKeys.AUTHORITY+"."+r)};n.prototype.generateNonceKey=function(t){var r=He.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(e.TemporaryCacheKeys.NONCE_IDTOKEN+"."+r)};n.prototype.generateStateKey=function(t){var r=He.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(e.TemporaryCacheKeys.REQUEST_STATE+"."+r)};n.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e);var r=this.getTemporaryCache(t);if(!r){return null}var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)};n.prototype.updateCacheEntries=function(t,r,n,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var a=this.generateStateKey(t);this.setTemporaryCache(a,t,false);var s=this.generateNonceKey(t);this.setTemporaryCache(s,r,false);var c=this.generateAuthorityKey(t);this.setTemporaryCache(c,n,false);if(i){var u={credential:i.homeAccountId,type:Ie.HOME_ACCOUNT_ID};this.setTemporaryCache(e.TemporaryCacheKeys.CCS_CREDENTIAL,JSON.stringify(u),true)}else if(!J.isEmpty(o)){var u={credential:o,type:Ie.UPN};this.setTemporaryCache(e.TemporaryCacheKeys.CCS_CREDENTIAL,JSON.stringify(u),true)}};n.prototype.resetRequestCache=function(t){var r=this;this.logger.trace("BrowserCacheManager.resetRequestCache called");if(!J.isEmpty(t)){this.getKeys().forEach(function(e){if(e.indexOf(t)!==-1){r.removeItem(e)}})}if(t){this.removeItem(this.generateStateKey(t));this.removeItem(this.generateNonceKey(t));this.removeItem(this.generateAuthorityKey(t))}this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.REQUEST_PARAMS));this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.ORIGIN_URI));this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.URL_HASH));this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.CORRELATION_ID));this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.CCS_CREDENTIAL));this.setInteractionInProgress(false)};n.prototype.cleanRequestByState=function(e){this.logger.trace("BrowserCacheManager.cleanRequestByState called");if(e){var t=this.generateStateKey(e);var r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r);this.resetRequestCache(r||"")}this.clearMsalCookies()};n.prototype.cleanRequestByInteractionType=function(t){var r=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called");this.getKeys().forEach(function(n){if(n.indexOf(e.TemporaryCacheKeys.REQUEST_STATE)===-1){return}var o=r.temporaryCacheStorage.getItem(n);if(!o){return}var i=Pt.extractBrowserRequestState(r.cryptoImpl,o);if(i&&i.interactionType===t){r.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+o);r.resetRequestCache(o)}});this.clearMsalCookies();this.setInteractionInProgress(false)};n.prototype.cacheCodeRequest=function(t,r){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var n=r.base64Encode(JSON.stringify(t));this.setTemporaryCache(e.TemporaryCacheKeys.REQUEST_PARAMS,n,true)};n.prototype.getCachedRequest=function(t,r){this.logger.trace("BrowserCacheManager.getCachedRequest called");var n=this.getTemporaryCache(e.TemporaryCacheKeys.REQUEST_PARAMS,true);if(!n){throw yt.createNoTokenRequestCacheError()}var o=this.validateAndParseJson(r.base64Decode(n));if(!o){throw yt.createUnableToParseTokenRequestCacheError()}this.removeItem(this.generateCacheKey(e.TemporaryCacheKeys.REQUEST_PARAMS));if(J.isEmpty(o.authority)){var i=this.generateAuthorityKey(t);var a=this.getTemporaryCache(i);if(!a){throw yt.createNoCachedAuthorityError()}o.authority=a}return o};n.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();if(e){return t===this.clientId}else{return!!t}};n.prototype.getInteractionInProgress=function(){var t=f.CACHE_PREFIX+"."+e.TemporaryCacheKeys.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,false)};n.prototype.setInteractionInProgress=function(t){var r=f.CACHE_PREFIX+"."+e.TemporaryCacheKeys.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress()){throw yt.createInteractionInProgressError()}else{this.setTemporaryCache(r,this.clientId,false)}}else if(!t&&this.getInteractionInProgress()===this.clientId){this.removeItem(r)}};n.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(m.ADAL_ID_TOKEN);if(e){this.browserStorage.removeItem(m.ADAL_ID_TOKEN);this.logger.verbose("Cached ADAL id token retrieved.")}var t=this.getTemporaryCache(m.ID_TOKEN,true);if(t){this.removeItem(this.generateCacheKey(m.ID_TOKEN));this.logger.verbose("Cached MSAL.js v1 id token retrieved")}var r=t||e;if(r){var n=new ce(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username){this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint");return n.claims.preferred_username}else if(n.claims&&n.claims.upn){this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint");return n.claims.upn}else{this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}}return null};n.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n){this.removeItem(e);this.setItem(r,n);this.logger.verbose("Updated an outdated "+t.credentialType+" cache key");return r}else{this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}}return e};return n}(ue);var Mt=function(t,r){var n={cacheLocation:e.BrowserCacheLocation.MemoryStorage,storeAuthStateInCookie:false,secureCookies:false};return new Ut(t,n,Y,r)};
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Lt=function(){function e(){}e.prototype.sendGetRequestAsync=function(e,t){return o(this,void 0,void 0,function(){var r,n,o;return i(this,function(i){switch(i.label){case 0:i.trys.push([0,2,,3]);return[4,fetch(e,{method:ot.GET,headers:this.getFetchHeaders(t)})];case 1:r=i.sent();return[3,3];case 2:n=i.sent();if(window.navigator.onLine){throw yt.createGetRequestFailedError(n,e)}else{throw yt.createNoNetworkConnectivityError()}case 3:i.trys.push([3,5,,6]);o={headers:this.getHeaderDict(r.headers)};return[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:i.sent();throw yt.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})};e.prototype.sendPostRequestAsync=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,a;return i(this,function(i){switch(i.label){case 0:r=t&&t.body||"";i.label=1;case 1:i.trys.push([1,3,,4]);return[4,fetch(e,{method:ot.POST,headers:this.getFetchHeaders(t),body:r})];case 2:n=i.sent();return[3,4];case 3:o=i.sent();if(window.navigator.onLine){throw yt.createPostRequestFailedError(o,e)}else{throw yt.createNoNetworkConnectivityError()}case 4:i.trys.push([4,6,,7]);a={headers:this.getHeaderDict(n.headers)};return[4,n.json()];case 5:return[2,(a.body=i.sent(),a.status=n.status,a)];case 6:i.sent();throw yt.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})};e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!(e&&e.headers)){return t}var r=e.headers;Object.keys(r).forEach(function(e){t.append(e,r[e])});return t};e.prototype.getHeaderDict=function(e){var t={};e.forEach(function(e,r){t[r]=e});return t};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Ht=function(){function e(){}e.prototype.sendGetRequestAsync=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.sendRequestAsync(e,ot.GET,t)]})})};e.prototype.sendPostRequestAsync=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){return[2,this.sendRequestAsync(e,ot.POST,t)]})})};e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(o,i){var a=new XMLHttpRequest;a.open(t,e,true);n.setXhrHeaders(a,r);a.onload=function(){if(a.status<200||a.status>=300){if(t===ot.POST){i(yt.createPostRequestFailedError("Failed with status "+a.status,e))}else{i(yt.createGetRequestFailedError("Failed with status "+a.status,e))}}try{var r=JSON.parse(a.responseText);var s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(t){i(yt.createFailedToParseNetworkResponseError(e))}};a.onerror=function(){if(window.navigator.onLine){if(t===ot.POST){i(yt.createPostRequestFailedError("Failed with status "+a.status,e))}else{i(yt.createGetRequestFailedError("Failed with status "+a.status,e))}}else{i(yt.createNoNetworkConnectivityError())}};if(t===ot.POST&&r&&r.body){a.send(r.body)}else if(t===ot.GET){a.send()}else{throw yt.createHttpMethodNotImplementedError(t)}})};e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach(function(t){e.setRequestHeader(t,r[t])})}};e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders();var r=t.trim().split(/[\r\n]+/);var n={};r.forEach(function(e){var t=e.split(": ");var r=t.shift();var o=t.join(": ");if(r&&o){n[r]=o}});return n};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var qt=function(){function t(){}t.clearHash=function(e){e.location.hash=f.EMPTY_STRING;if(typeof e.history.replaceState==="function"){e.history.replaceState(null,f.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)}};t.replaceHash=function(e){var t=e.split("#");t.shift();window.location.hash=t.length>0?t.join("#"):""};t.isInIframe=function(){return window.parent!==window};t.isInPopup=function(){return typeof window!=="undefined"&&!!window.opener&&window.opener!==window&&typeof window.name==="string"&&window.name.indexOf(nt.POPUP_NAME_PREFIX+".")===0};t.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]};t.getHomepage=function(){var e=new qe(window.location.href);var t=e.getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"};t.getBrowserNetworkClient=function(){if(window.fetch&&window.Headers){return new Lt}else{return new Ht}};t.blockReloadInHiddenIframes=function(){var e=qe.hashContainsKnownProperties(window.location.hash);if(e&&t.isInIframe()){throw yt.createBlockReloadInHiddenIframeError()}};t.blockRedirectInIframe=function(r,n){var o=t.isInIframe();if(r===e.InteractionType.Redirect&&o&&!n){throw yt.createRedirectInIframeError(o)}};t.blockAcquireTokenInPopups=function(){if(t.isInPopup()){throw yt.createBlockAcquireTokenInPopupsError()}};t.blockNonBrowserEnvironment=function(e){if(!e){throw yt.createNonBrowserEnvironmentError()}};t.detectIEOrEdge=function(){var e=window.navigator.userAgent;var t=e.indexOf("MSIE ");var r=e.indexOf("Trident/");var n=e.indexOf("Edge/");var o=t>0||r>0;var i=n>0;return o||i};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Dt=function(){function e(){}e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)};e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)};e.defaultNavigateWindow=function(e,t){if(t.noHistory){window.location.replace(e)}else{window.location.assign(e)}return new Promise(function(e){setTimeout(function(){e(true)},t.timeout)})};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Kt=6e4;var Ft=6e3;var xt=3e4;function Bt(t,r){var o=t.auth,i=t.cache,a=t.system;var s={clientId:"",authority:""+f.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:true,clientCapabilities:[],protocolMode:e.ProtocolMode.AAD,azureCloudOptions:{azureCloudInstance:e.AzureCloudInstance.None,tenant:""}};var c={cacheLocation:e.BrowserCacheLocation.SessionStorage,storeAuthStateInCookie:false,secureCookies:false};var u={loggerCallback:function(){},logLevel:e.LogLevel.Info,piiLoggingEnabled:false};var d=n(n({},he),{loggerOptions:u,networkClient:r?qt.getBrowserNetworkClient():et,navigationClient:new Dt,loadFrameTimeout:0,windowHashTimeout:a&&a.loadFrameTimeout||Kt,iframeHashTimeout:a&&a.loadFrameTimeout||Ft,navigateFrameWait:r&&qt.detectIEOrEdge()?500:0,redirectNavigationTimeout:xt,asyncPopups:false,allowRedirectInIframe:false});var l={auth:n(n({},s),o),cache:n(n({},c),i),system:n(n({},d),a)};return l}var Gt="@azure/msal-browser";var jt="2.22.0";
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */e.EventType=void 0;(function(e){e["ACCOUNT_ADDED"]="msal:accountAdded";e["ACCOUNT_REMOVED"]="msal:accountRemoved";e["LOGIN_START"]="msal:loginStart";e["LOGIN_SUCCESS"]="msal:loginSuccess";e["LOGIN_FAILURE"]="msal:loginFailure";e["ACQUIRE_TOKEN_START"]="msal:acquireTokenStart";e["ACQUIRE_TOKEN_SUCCESS"]="msal:acquireTokenSuccess";e["ACQUIRE_TOKEN_FAILURE"]="msal:acquireTokenFailure";e["ACQUIRE_TOKEN_NETWORK_START"]="msal:acquireTokenFromNetworkStart";e["SSO_SILENT_START"]="msal:ssoSilentStart";e["SSO_SILENT_SUCCESS"]="msal:ssoSilentSuccess";e["SSO_SILENT_FAILURE"]="msal:ssoSilentFailure";e["ACQUIRE_TOKEN_BY_CODE_START"]="msal:acquireTokenByCodeStart";e["ACQUIRE_TOKEN_BY_CODE_SUCCESS"]="msal:acquireTokenByCodeSuccess";e["ACQUIRE_TOKEN_BY_CODE_FAILURE"]="msal:acquireTokenByCodeFailure";e["HANDLE_REDIRECT_START"]="msal:handleRedirectStart";e["HANDLE_REDIRECT_END"]="msal:handleRedirectEnd";e["POPUP_OPENED"]="msal:popupOpened";e["LOGOUT_START"]="msal:logoutStart";e["LOGOUT_SUCCESS"]="msal:logoutSuccess";e["LOGOUT_FAILURE"]="msal:logoutFailure";e["LOGOUT_END"]="msal:logoutEnd"})(e.EventType||(e.EventType={}));
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var zt=function(){function t(e,t){this.eventCallbacks=new Map;this.logger=e;this.browserCrypto=t;this.listeningToStorageEvents=false;this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}t.prototype.addEventCallback=function(e){if(typeof window!=="undefined"){var t=this.browserCrypto.createNewGuid();this.eventCallbacks.set(t,e);this.logger.verbose("Event callback registered with id: "+t);return t}return null};t.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e);this.logger.verbose("Event callback "+e+" removed.")};t.prototype.enableAccountStorageEvents=function(){if(typeof window==="undefined"){return}if(!this.listeningToStorageEvents){this.logger.verbose("Adding account storage listener.");this.listeningToStorageEvents=true;window.addEventListener("storage",this.handleAccountCacheChange)}else{this.logger.verbose("Account storage listener already registered.")}};t.prototype.disableAccountStorageEvents=function(){if(typeof window==="undefined"){return}if(this.listeningToStorageEvents){this.logger.verbose("Removing account storage listener.");window.removeEventListener("storage",this.handleAccountCacheChange);this.listeningToStorageEvents=false}else{this.logger.verbose("No account storage listener registered.")}};t.prototype.emitEvent=function(e,t,r,n){var o=this;if(typeof window!=="undefined"){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e);this.eventCallbacks.forEach(function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e);t.apply(null,[i])})}};t.prototype.handleAccountCacheChange=function(t){try{var r=t.newValue||t.oldValue;if(!r){return}var n=JSON.parse(r);if(typeof n!=="object"||!se.isAccountEntity(n)){return}var o=ue.toObject(new se,n);var i=o.getAccountInfo();if(!t.oldValue&&t.newValue){this.logger.info("Account was added to cache in a different window");this.emitEvent(e.EventType.ACCOUNT_ADDED,undefined,i)}else if(!t.newValue&&t.oldValue){this.logger.info("Account was removed from cache in a different window");this.emitEvent(e.EventType.ACCOUNT_REMOVED,undefined,i)}}catch(t){return}};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Wt=function(){function t(e,t,r,n,o,i){this.config=e;this.browserStorage=t;this.browserCrypto=r;this.networkClient=this.config.system.networkClient;this.eventHandler=o;this.correlationId=i||this.browserCrypto.createNewGuid();this.logger=n.clone(nt.MSAL_SKU,jt,this.correlationId)}t.prototype.clearCacheOnLogout=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:if(!e)return[3,5];if(se.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),false)){this.logger.verbose("Setting active account to null");this.browserStorage.setActiveAccount(null)}t.label=1;case 1:t.trys.push([1,3,,4]);return[4,this.browserStorage.removeAccount(se.generateAccountCacheKey(e))];case 2:t.sent();this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.");return[3,4];case 3:t.sent();this.logger.error("Account provided in logout request was not found. Local cache unchanged.");return[3,4];case 4:return[3,9];case 5:t.trys.push([5,8,,9]);return[4,this.browserStorage.clear()];case 6:t.sent();return[4,this.browserCrypto.clearKeystore()];case 7:t.sent();this.logger.verbose("No account provided in logout request, clearing all cache items.");return[3,9];case 8:t.sent();this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.");return[3,9];case 9:return[2]}})})};t.prototype.initializeBaseRequest=function(t){return o(this,void 0,void 0,function(){var r,o,a,c;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("Initializing BaseAuthRequest");r=t.authority||this.config.auth.authority;o=s(t&&t.scopes||[]);if(!t.authenticationScheme){t.authenticationScheme=e.AuthenticationScheme.BEARER;this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request')}else{if(t.authenticationScheme===e.AuthenticationScheme.SSH){if(!t.sshJwk){throw re.createMissingSshJwkError()}if(!t.sshKid){throw re.createMissingSshKidError()}}this.logger.verbose('Authentication Scheme set to "'+t.authenticationScheme+'" as configured in Auth request')}if(!(t.claims&&!J.isEmpty(t.claims)))return[3,2];a=t;return[4,this.browserCrypto.hashString(t.claims)];case 1:a.requestedClaimsHash=i.sent();i.label=2;case 2:c=n(n({},t),{correlationId:this.correlationId,authority:r,scopes:o});return[2,c]}})})};t.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||qt.getCurrentUri();return qe.getAbsoluteUrl(t,qt.getCurrentUri())};t.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||false,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new rt(r,this.browserStorage)};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Yt=function(e){r(t,e);function t(t,r,n,o,i,a,s){var c=e.call(this,t,r,n,o,i,s)||this;c.navigationClient=a;return c}t.prototype.initializeAuthorizationCodeRequest=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(o){switch(o.label){case 0:this.logger.verbose("initializeAuthorizationRequest called",e.correlationId);return[4,this.browserCrypto.generatePkceCodes()];case 1:t=o.sent();r=n(n({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier});e.codeChallenge=t.challenge;e.codeChallengeMethod=f.S256_CODE_CHALLENGE_METHOD;return[2,r]}})})};t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",e===null||e===void 0?void 0:e.correlationId);var t=n({correlationId:this.browserCrypto.createNewGuid()},e);if(e){if(!e.logoutHint){if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);if(r){this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided");t.logoutHint=r}}else{this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set")}}else{this.logger.verbose("logoutHint has already been set in logoutRequest")}}else{this.logger.verbose("logoutHint will not be set since no logout request was configured")}if(!e||e.postLogoutRedirectUri!==null){if(e&&e.postLogoutRedirectUri){this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId);t.postLogoutRedirectUri=qe.getAbsoluteUrl(e.postLogoutRedirectUri,qt.getCurrentUri())}else if(this.config.auth.postLogoutRedirectUri===null){this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId)}else if(this.config.auth.postLogoutRedirectUri){this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId);t.postLogoutRedirectUri=qe.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,qt.getCurrentUri())}else{this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId);t.postLogoutRedirectUri=qe.getAbsoluteUrl(qt.getCurrentUri(),qt.getCurrentUri())}}else{this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId)}return t};t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint){return t.login_hint}else{this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}}else{this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request")}return null};t.prototype.createAuthCodeClient=function(e,t,r){return o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:n=o.sent();return[2,new Ge(n)]}})})};t.prototype.getClientConfiguration=function(e,t,r){return o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:this.logger.verbose("getClientConfiguration called");return[4,this.getDiscoveredAuthority(t,r)];case 1:n=o.sent();return[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:true},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:nt.MSAL_SKU,version:jt,cpu:"",os:""}}]}})})};t.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var n=qe.getDeserializedHash(e);if(!n.state){throw yt.createHashDoesNotContainStateError()}var o=Pt.extractBrowserRequestState(this.browserCrypto,n.state);if(!o){throw yt.createUnableToParseStateError()}if(o.interactionType!==t){throw yt.createStateInteractionTypeMismatchError()}this.logger.verbose("Returning state from hash",r);return n.state};t.prototype.getDiscoveredAuthority=function(e,t){return o(this,void 0,void 0,function(){var r,n,o;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("getDiscoveredAuthority called");r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata};n=e?e:this.config.auth.authority;o=Je.generateAuthority(n,t||this.config.auth.azureCloudOptions);this.logger.verbose("Creating discovered authority with configured authority");return[4,Xe.createDiscoveredInstance(o,this.config.system.networkClient,this.browserStorage,r)];case 1:return[2,i.sent()]}})})};t.prototype.initializeAuthorizationRequest=function(e,t){return o(this,void 0,void 0,function(){var r,o,a,s,c,u,d;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("initializeAuthorizationRequest called");r=this.getRedirectUri(e.redirectUri);o={interactionType:t};a=He.setRequestState(this.browserCrypto,e&&e.state||f.EMPTY_STRING,o);c=[{}];return[4,this.initializeBaseRequest(e)];case 1:s=n.apply(void 0,[n.apply(void 0,c.concat([i.sent()])),{redirectUri:r,state:a,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:A.FRAGMENT}]);u=e.account||this.browserStorage.getActiveAccount();if(u){this.logger.verbose("Setting validated request account");this.logger.verbosePii("Setting validated request account: "+u);s.account=u}if(J.isEmpty(s.loginHint)&&!u){d=this.browserStorage.getLegacyLoginHint();if(d){s.loginHint=d}}return[2,s]}})})};return t}(Wt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Qt=function(){function t(e,t){this.browserStorage=e;this.logger=t;this.unloadWindow=this.unloadWindow.bind(this)}t.prototype.openPopup=function(e,r){try{var n=void 0;if(r.popup){n=r.popup;this.logger.verbosePii("Navigating popup window to: "+e);n.location.assign(e)}else if(typeof r.popup==="undefined"){this.logger.verbosePii("Opening popup window to: "+e);n=t.openSizedPopup(e,r.popupName,r.popupWindowAttributes,this.logger)}if(!n){throw yt.createEmptyWindowCreatedError()}if(n.focus){n.focus()}this.currentWindow=n;window.addEventListener("beforeunload",this.unloadWindow);return n}catch(e){this.logger.error("error opening popup "+e.message);this.browserStorage.setInteractionInProgress(false);throw yt.createPopupWindowError(e.toString())}};t.openSizedPopup=function(e,t,r,n){var o,i,a,s;var c=window.screenLeft?window.screenLeft:window.screenX;var u=window.screenTop?window.screenTop:window.screenY;var d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var h=(o=r.popupSize)===null||o===void 0?void 0:o.width;var p=(i=r.popupSize)===null||i===void 0?void 0:i.height;var f=(a=r.popupPosition)===null||a===void 0?void 0:a.top;var g=(s=r.popupPosition)===null||s===void 0?void 0:s.left;if(!h||h<0||h>d){n.verbose("Default popup window width used. Window width not configured or invalid.");h=nt.POPUP_WIDTH}if(!p||p<0||p>l){n.verbose("Default popup window height used. Window height not configured or invalid.");p=nt.POPUP_HEIGHT}if(!f||f<0||f>l){n.verbose("Default popup window top position used. Window top not configured or invalid.");f=Math.max(0,l/2-nt.POPUP_HEIGHT/2+u)}if(!g||g<0||g>d){n.verbose("Default popup window left position used. Window left not configured or invalid.");g=Math.max(0,d/2-nt.POPUP_WIDTH/2+c)}return window.open(e,t,"width="+h+", height="+p+", top="+f+", left="+g+", scrollbars=yes")};t.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Popup);if(this.currentWindow){this.currentWindow.close()}t.preventDefault()};t.prototype.cleanPopup=function(e){if(e){e.close()}window.removeEventListener("beforeunload",this.unloadWindow);this.browserStorage.setInteractionInProgress(false)};t.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise(function(r,n){var o=setInterval(function(){if(e.closed){t.cleanPopup();clearInterval(o);n(yt.createUserCancelledError());return}var i=f.EMPTY_STRING;try{i=e.location.href}catch(e){}if(J.isEmpty(i)||i==="about:blank"){return}clearInterval(o);r()},nt.POLL_INTERVAL_MS)})};t.generatePopupName=function(e,t,r,n){return nt.POPUP_NAME_PREFIX+"."+e+"."+t.join("-")+"."+r+"."+n};t.generateLogoutPopupName=function(e,t){var r=t.account&&t.account.homeAccountId;return nt.POPUP_NAME_PREFIX+"."+e+"."+r+"."+t.correlationId};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Vt=function(){function t(e,t,r,n){this.authModule=e;this.browserStorage=t;this.authCodeRequest=r;this.browserRequestLogger=n}t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return o(this,void 0,void 0,function(){var o,a,s;return i(this,function(i){this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called");if(J.isEmpty(e)){throw yt.createEmptyHashError(e)}o=this.browserStorage.generateStateKey(t);a=this.browserStorage.getTemporaryCache(o);if(!a){throw V.createStateNotFoundError("Cached State")}s=this.authModule.handleFragmentResponse(e,a);return[2,this.handleCodeResponseFromServer(s,t,r,n)]})})};t.prototype.handleCodeResponseFromServer=function(e,t,r,n,a){if(a===void 0){a=true}return o(this,void 0,void 0,function(){var o,s,c,u,d,l;return i(this,function(i){switch(i.label){case 0:this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called");o=this.browserStorage.generateStateKey(t);s=this.browserStorage.getTemporaryCache(o);if(!s){throw V.createStateNotFoundError("Cached State")}c=this.browserStorage.generateNonceKey(s);u=this.browserStorage.getTemporaryCache(c);this.authCodeRequest.code=e.code;if(!e.cloud_instance_host_name)return[3,2];return[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)];case 1:i.sent();i.label=2;case 2:if(a){e.nonce=u||undefined}e.state=s;if(e.client_info){this.authCodeRequest.clientInfo=e.client_info}else{d=this.checkCcsCredentials();if(d){this.authCodeRequest.ccsCredential=d}}return[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:l=i.sent();this.browserStorage.cleanRequestByState(t);return[2,l]}})})};t.prototype.updateTokenEndpointAuthority=function(e,t,r){return o(this,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:n="https://"+e+"/"+t.tenant+"/";return[4,Xe.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:o=i.sent();this.authModule.updateAuthority(o);return[2]}})})};t.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(e.TemporaryCacheKeys.CCS_CREDENTIAL,true);if(t){try{return JSON.parse(t)}catch(e){this.authModule.logger.error("Cache credential could not be parsed");this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}}return null};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Jt=function(e){r(t,e);function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;i.popupUtils=new Qt(r,o);return i}t.prototype.initiateAuthRequest=function(e,t){if(!J.isEmpty(e)){this.browserRequestLogger.infoPii("Navigate to: "+e);return this.popupUtils.openPopup(e,t)}else{this.browserRequestLogger.error("Navigate url is empty");throw yt.createEmptyNavigationUriError()}};t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then(function(){var r=e.location.hash;qt.clearHash(e);t.popupUtils.cleanPopup(e);if(!r){throw yt.createEmptyHashError(e.location.href)}if(qe.hashContainsKnownProperties(r)){return r}else{throw yt.createHashDoesNotContainKnownPropertiesError()}})};return t}(Vt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Xt=function(t){r(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}n.prototype.acquireToken=function(e){try{var t=Qt.generatePopupName(this.config.auth.clientId,e.scopes||g,e.authority||this.config.auth.authority,this.correlationId);var r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups){this.logger.verbose("asyncPopups set to true, acquiring token");return this.acquireTokenPopupAsync(e,t,r)}else{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=Qt.openSizedPopup("about:blank",t,r,this.logger);return this.acquireTokenPopupAsync(e,t,r,n)}}catch(e){return Promise.reject(e)}};n.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e);var r=Qt.generateLogoutPopupName(this.config.auth.clientId,t);var n=e&&e.authority;var o=e&&e.mainWindowRedirectUri;var i=(e===null||e===void 0?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups){this.logger.verbose("asyncPopups set to true");return this.logoutPopupAsync(t,r,i,n,undefined,o)}else{this.logger.verbose("asyncPopup set to false, opening popup");var a=Qt.openSizedPopup("about:blank",r,i,this.logger);return this.logoutPopupAsync(t,r,i,n,a,o)}}catch(e){return Promise.reject(e)}};n.prototype.acquireTokenPopupAsync=function(t,r,n,a){return o(this,void 0,void 0,function(){var o,s,c,u,d,l,h,p,f,g,v,y;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("acquireTokenPopupAsync called");o=this.initializeServerTelemetryManager(e.ApiId.acquireTokenPopup);return[4,this.initializeAuthorizationRequest(t,e.InteractionType.Popup)];case 1:s=i.sent();this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority,s.loginHint||"",s.account||null);i.label=2;case 2:i.trys.push([2,8,,9]);return[4,this.initializeAuthorizationCodeRequest(s)];case 3:c=i.sent();return[4,this.createAuthCodeClient(o,s.authority,s.azureCloudOptions)];case 4:u=i.sent();this.logger.verbose("Auth code client created");return[4,u.getAuthCodeUrl(s)];case 5:d=i.sent();l=new Jt(u,this.browserStorage,c,this.logger);h={popup:a,popupName:r,popupWindowAttributes:n};p=l.initiateAuthRequest(d,h);this.eventHandler.emitEvent(e.EventType.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:p},null);return[4,l.monitorPopupForHash(p)];case 6:f=i.sent();g=this.validateAndExtractStateFromHash(f,e.InteractionType.Popup,s.correlationId);Te.removeThrottle(this.browserStorage,this.config.auth.clientId,c);return[4,l.handleCodeResponseFromHash(f,g,u.authority,this.networkClient)];case 7:v=i.sent();return[2,v];case 8:y=i.sent();if(a){a.close()}if(y instanceof W){y.setCorrelationId(this.correlationId)}o.cacheFailedRequest(y);this.browserStorage.cleanRequestByState(s.state);throw y;case 9:return[2]}})})};n.prototype.logoutPopupAsync=function(t,r,n,a,s,c){return o(this,void 0,void 0,function(){var o,u,d,l,h,p,f,g,v;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("logoutPopupAsync called");this.eventHandler.emitEvent(e.EventType.LOGOUT_START,e.InteractionType.Popup,t);o=this.initializeServerTelemetryManager(e.ApiId.logoutPopup);i.label=1;case 1:i.trys.push([1,8,,9]);return[4,this.clearCacheOnLogout(t.account)];case 2:i.sent();return[4,this.createAuthCodeClient(o,a)];case 3:u=i.sent();this.logger.verbose("Auth code client created");d=u.getLogoutUri(t);this.eventHandler.emitEvent(e.EventType.LOGOUT_SUCCESS,e.InteractionType.Popup,t);l=new Qt(this.browserStorage,this.logger);h=l.openPopup(d,{popupName:r,popupWindowAttributes:n,popup:s});this.eventHandler.emitEvent(e.EventType.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:h},null);i.label=4;case 4:i.trys.push([4,6,,7]);return[4,l.monitorPopupForSameOrigin(h)];case 5:i.sent();this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri");return[3,7];case 6:p=i.sent();this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+p);return[3,7];case 7:l.cleanPopup(h);if(c){f={apiId:e.ApiId.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:false};g=qe.getAbsoluteUrl(c,qt.getCurrentUri());this.logger.verbose("Redirecting main window to url specified in the request");this.logger.verbosePii("Redirecting main window to: "+g);this.navigationClient.navigateInternal(g,f)}else{this.logger.verbose("No main window navigation requested")}return[3,9];case 8:v=i.sent();if(s){s.close()}if(v instanceof W){v.setCorrelationId(this.correlationId)}this.browserStorage.setInteractionInProgress(false);this.eventHandler.emitEvent(e.EventType.LOGOUT_FAILURE,e.InteractionType.Popup,null,v);this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Popup);o.cacheFailedRequest(v);throw v;case 9:this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Popup);return[2]}})})};return n}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var Zt=function(t){r(n,t);function n(e,r,n,o,i){var a=t.call(this,e,r,n,o)||this;a.browserCrypto=i;return a}n.prototype.initiateAuthRequest=function(t,r){return o(this,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called");if(!!J.isEmpty(t))return[3,7];if(r.redirectStartPage){this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page");this.browserStorage.setTemporaryCache(e.TemporaryCacheKeys.ORIGIN_URI,r.redirectStartPage,true)}this.browserStorage.setTemporaryCache(e.TemporaryCacheKeys.CORRELATION_ID,this.authCodeRequest.correlationId,true);this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto);this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t);n={apiId:e.ApiId.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:false};if(!(typeof r.onRedirectNavigate==="function"))return[3,4];this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");o=r.onRedirectNavigate(t);if(!(o!==false))return[3,2];this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating");return[4,r.navigationClient.navigateExternal(t,n)];case 1:i.sent();return[2];case 2:this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return[2];case 3:return[3,6];case 4:this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url");return[4,r.navigationClient.navigateExternal(t,n)];case 5:i.sent();return[2];case 6:return[3,8];case 7:this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty");throw yt.createEmptyNavigationUriError();case 8:return[2]}})})};n.prototype.handleCodeResponseFromHash=function(e,t,r,n,a){return o(this,void 0,void 0,function(){var o,s,c,u,d,l,h;return i(this,function(i){switch(i.label){case 0:this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called");if(J.isEmpty(e)){throw yt.createEmptyHashError(e)}this.browserStorage.setInteractionInProgress(false);o=this.browserStorage.generateStateKey(t);s=this.browserStorage.getTemporaryCache(o);if(!s){throw V.createStateNotFoundError("Cached State")}c=this.authModule.handleFragmentResponse(e,s);u=this.browserStorage.generateNonceKey(s);d=this.browserStorage.getTemporaryCache(u);this.authCodeRequest.code=c.code;if(!c.cloud_instance_host_name)return[3,2];return[4,this.updateTokenEndpointAuthority(c.cloud_instance_host_name,r,n)];case 1:i.sent();i.label=2;case 2:c.nonce=d||undefined;c.state=s;if(c.client_info){this.authCodeRequest.clientInfo=c.client_info}else{l=this.checkCcsCredentials();if(l){this.authCodeRequest.ccsCredential=l}}if(a){Te.removeThrottle(this.browserStorage,a,this.authCodeRequest)}return[4,this.authModule.acquireToken(this.authCodeRequest,c)];case 3:h=i.sent();this.browserStorage.cleanRequestByState(t);return[2,h]}})})};return n}(Vt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var $t=function(t){r(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}n.prototype.acquireToken=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s,c,u,d;return i(this,function(i){switch(i.label){case 0:return[4,this.initializeAuthorizationRequest(t,e.InteractionType.Redirect)];case 1:r=i.sent();this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null);n=this.initializeServerTelemetryManager(e.ApiId.acquireTokenRedirect);i.label=2;case 2:i.trys.push([2,7,,8]);return[4,this.initializeAuthorizationCodeRequest(r)];case 3:o=i.sent();return[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 4:a=i.sent();this.logger.verbose("Auth code client created");s=new Zt(a,this.browserStorage,o,this.logger,this.browserCrypto);return[4,a.getAuthCodeUrl(r)];case 5:c=i.sent();u=this.getRedirectStartPage(t.redirectStartPage);this.logger.verbosePii("Redirect start page: "+u);return[4,s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,i.sent()];case 7:d=i.sent();if(d instanceof W){d.setCorrelationId(this.correlationId)}n.cacheFailedRequest(d);this.browserStorage.cleanRequestByState(r.state);throw d;case 8:return[2]}})})};n.prototype.handleRedirectPromise=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s,c,u,d,l,h,p;return i(this,function(i){switch(i.label){case 0:r=this.initializeServerTelemetryManager(e.ApiId.handleRedirectPromise);i.label=1;case 1:i.trys.push([1,10,,11]);if(!this.browserStorage.isInteractionInProgress(true)){this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null.");return[2,null]}n=this.getRedirectResponseHash(t||window.location.hash);if(!n){this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache.");this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect);return[2,null]}o=void 0;try{o=this.validateAndExtractStateFromHash(n,e.InteractionType.Redirect);this.logger.verbose("State extracted from hash")}catch(t){this.logger.info("handleRedirectPromise was unable to extract state due to: "+t);this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect);return[2,null]}a=this.browserStorage.getTemporaryCache(e.TemporaryCacheKeys.ORIGIN_URI,true)||"";s=qe.removeHashFromUrl(a);c=qe.removeHashFromUrl(window.location.href);if(!(s===c&&this.config.auth.navigateToLoginRequestUrl))return[3,3];this.logger.verbose("Current page is loginRequestUrl, handling hash");return[4,this.handleHash(n,o,r)];case 2:u=i.sent();if(a.indexOf("#")>-1){qt.replaceHash(a)}return[2,u];case 3:if(!!this.config.auth.navigateToLoginRequestUrl)return[3,4];this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash");return[2,this.handleHash(n,o,r)];case 4:if(!(!qt.isInIframe()||this.config.system.allowRedirectInIframe))return[3,9];this.browserStorage.setTemporaryCache(e.TemporaryCacheKeys.URL_HASH,n,true);d={apiId:e.ApiId.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:true};l=true;if(!(!a||a==="null"))return[3,6];h=qt.getHomepage();this.browserStorage.setTemporaryCache(e.TemporaryCacheKeys.ORIGIN_URI,h,true);this.logger.warning("Unable to get valid login request url from cache, redirecting to home page");return[4,this.navigationClient.navigateInternal(h,d)];case 5:l=i.sent();return[3,8];case 6:this.logger.verbose("Navigating to loginRequestUrl: "+a);return[4,this.navigationClient.navigateInternal(a,d)];case 7:l=i.sent();i.label=8;case 8:if(!l){return[2,this.handleHash(n,o,r)]}i.label=9;case 9:return[2,null];case 10:p=i.sent();if(p instanceof W){p.setCorrelationId(this.correlationId)}r.cacheFailedRequest(p);this.browserStorage.cleanRequestByInteractionType(e.InteractionType.Redirect);throw p;case 11:return[2]}})})};n.prototype.getRedirectResponseHash=function(t){this.logger.verbose("getRedirectResponseHash called");var r=qe.hashContainsKnownProperties(t);if(r){qt.clearHash(window);this.logger.verbose("Hash contains known properties, returning response hash");return t}var n=this.browserStorage.getTemporaryCache(e.TemporaryCacheKeys.URL_HASH,true);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(e.TemporaryCacheKeys.URL_HASH));this.logger.verbose("Hash does not contain known properties, returning cached hash");return n};n.prototype.handleHash=function(e,t,r){return o(this,void 0,void 0,function(){var n,o,a,s;return i(this,function(i){switch(i.label){case 0:n=this.browserStorage.getCachedRequest(t,this.browserCrypto);this.logger.verbose("handleHash called, retrieved cached request");o=this.browserStorage.getCachedAuthority(t);if(!o){throw yt.createNoCachedAuthorityError()}return[4,this.createAuthCodeClient(r,o)];case 1:a=i.sent();this.logger.verbose("Auth code client created");s=new Zt(a,this.browserStorage,n,this.logger,this.browserCrypto);return[4,s.handleCodeResponseFromHash(e,t,a.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,i.sent()]}})})};n.prototype.logout=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s,c,u;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("logoutRedirect called");r=this.initializeLogoutRequest(t);n=this.initializeServerTelemetryManager(e.ApiId.logout);i.label=1;case 1:i.trys.push([1,10,,11]);this.eventHandler.emitEvent(e.EventType.LOGOUT_START,e.InteractionType.Redirect,t);return[4,this.clearCacheOnLogout(r.account)];case 2:i.sent();o={apiId:e.ApiId.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:false};return[4,this.createAuthCodeClient(n,t&&t.authority)];case 3:a=i.sent();this.logger.verbose("Auth code client created");s=a.getLogoutUri(r);this.eventHandler.emitEvent(e.EventType.LOGOUT_SUCCESS,e.InteractionType.Redirect,r);if(!(t&&typeof t.onRedirectNavigate==="function"))return[3,7];c=t.onRedirectNavigate(s);if(!(c!==false))return[3,5];this.logger.verbose("Logout onRedirectNavigate did not return false, navigating");return[4,this.navigationClient.navigateExternal(s,o)];case 4:i.sent();return[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");i.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(s,o)];case 8:i.sent();return[2];case 9:return[3,11];case 10:u=i.sent();if(u instanceof W){u.setCorrelationId(this.correlationId)}n.cacheFailedRequest(u);this.eventHandler.emitEvent(e.EventType.LOGOUT_FAILURE,e.InteractionType.Redirect,null,u);this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Redirect);throw u;case 11:this.eventHandler.emitEvent(e.EventType.LOGOUT_END,e.InteractionType.Redirect);return[2]}})})};n.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return qe.getAbsoluteUrl(t,qt.getCurrentUri())};return n}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var er=function(e){r(t,e);function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;a.navigateFrameWait=i;return a}t.prototype.initiateAuthRequest=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:if(J.isEmpty(e)){this.browserRequestLogger.info("Navigate url is empty");throw yt.createEmptyNavigationUriError()}if(!this.navigateFrameWait)return[3,2];return[4,this.loadFrame(e)];case 1:t=r.sent();return[3,3];case 2:t=this.loadFrameSync(e);r.label=3;case 3:return[2,t]}})})};t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise(function(n,o){if(t<Ft){r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Ft+"ms). This may result in timeouts.")}var i=window.performance.now();var a=i+t;var s=setInterval(function(){if(window.performance.now()>a){r.removeHiddenIframe(e);clearInterval(s);o(yt.createMonitorIframeTimeoutError());return}var t=f.EMPTY_STRING;var i=e.contentWindow;try{t=i?i.location.href:f.EMPTY_STRING}catch(e){}if(J.isEmpty(t)){return}var c=i?i.location.hash:f.EMPTY_STRING;if(qe.hashContainsKnownProperties(c)){r.removeHiddenIframe(e);clearInterval(s);n(c);return}},nt.POLL_INTERVAL_MS)})};t.prototype.loadFrame=function(e){var t=this;return new Promise(function(r,n){var o=t.createHiddenIframe();setTimeout(function(){if(!o){n("Unable to load iframe");return}o.src=e;r(o)},t.navigateFrameWait)})};t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();t.src=e;return t};t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");e.style.visibility="hidden";e.style.position="absolute";e.style.width=e.style.height="0";e.style.border="0";e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");document.getElementsByTagName("body")[0].appendChild(e);return e};t.prototype.removeHiddenIframe=function(e){if(document.body===e.parentNode){document.body.removeChild(e)}};return t}(Vt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var tr=function(t){r(a,t);function a(e,r,n,o,i,a,s,c){var u=t.call(this,e,r,n,o,i,a,c)||this;u.apiId=s;return u}a.prototype.acquireToken=function(t){return o(this,void 0,void 0,function(){var r,o,a,s,c,u;return i(this,function(i){switch(i.label){case 0:this.logger.verbose("acquireTokenByIframe called");if(J.isEmpty(t.loginHint)&&J.isEmpty(t.sid)&&(!t.account||J.isEmpty(t.account.username))){this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.")}if(t.prompt&&t.prompt!==S.NONE){throw yt.createSilentPromptValueError(t.prompt)}return[4,this.initializeAuthorizationRequest(n(n({},t),{prompt:S.NONE}),e.InteractionType.Silent)];case 1:r=i.sent();this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null);o=this.initializeServerTelemetryManager(this.apiId);i.label=2;case 2:i.trys.push([2,7,,8]);return[4,this.initializeAuthorizationCodeRequest(r)];case 3:a=i.sent();return[4,this.createAuthCodeClient(o,r.authority,r.azureCloudOptions)];case 4:s=i.sent();this.logger.verbose("Auth code client created");return[4,s.getAuthCodeUrl(r)];case 5:c=i.sent();return[4,this.silentTokenHelper(c,a,s,this.logger)];case 6:return[2,i.sent()];case 7:u=i.sent();if(u instanceof W){u.setCorrelationId(this.correlationId)}o.cacheFailedRequest(u);this.browserStorage.cleanRequestByState(r.state);throw u;case 8:return[2]}})})};a.prototype.logout=function(){return Promise.reject(yt.createSilentLogoutUnsupportedError())};a.prototype.silentTokenHelper=function(t,r,n,a){return o(this,void 0,void 0,function(){var o,s,c,u;return i(this,function(i){switch(i.label){case 0:o=new er(n,this.browserStorage,r,a,this.config.system.navigateFrameWait);return[4,o.initiateAuthRequest(t)];case 1:s=i.sent();return[4,o.monitorIframeForHash(s,this.config.system.iframeHashTimeout)];case 2:c=i.sent();u=this.validateAndExtractStateFromHash(c,e.InteractionType.Silent,r.correlationId);return[2,o.handleCodeResponseFromHash(c,u,n.authority,this.networkClient)]}})})};return a}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var rr=function(t){r(a,t);function a(){return t!==null&&t.apply(this,arguments)||this}a.prototype.acquireToken=function(t){return o(this,void 0,void 0,function(){var r,o,a,s;var c=this;return i(this,function(i){switch(i.label){case 0:o=[n({},t)];return[4,this.initializeBaseRequest(t)];case 1:r=n.apply(void 0,o.concat([i.sent()]));a=this.initializeServerTelemetryManager(e.ApiId.acquireTokenSilent_silentFlow);return[4,this.createRefreshTokenClient(a,r.authority,r.azureCloudOptions)];case 2:s=i.sent();this.logger.verbose("Refresh token client created");return[2,s.acquireTokenByRefreshToken(r).catch(function(e){if(e instanceof W){e.setCorrelationId(c.correlationId)}a.cacheFailedRequest(e);throw e})]}})})};a.prototype.logout=function(){return Promise.reject(yt.createSilentLogoutUnsupportedError())};a.prototype.createRefreshTokenClient=function(e,t,r){return o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:n=o.sent();return[2,new je(n)]}})})};return a}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var nr=function(){function e(e,t,r,n){this.isBrowserEnvironment=typeof window!=="undefined";this.config=e;this.storage=t;this.logger=r;this.cryptoObj=n}e.prototype.loadExternalTokens=function(e,t,r){this.logger.info("TokenCache - loadExternalTokens called");if(!t.id_token){throw yt.createUnableToLoadTokenError("Please ensure server response includes id token.")}if(e.account){this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r)}else if(e.authority){var n=Je.generateAuthority(e.authority,e.azureCloudOptions);var o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata};var i=new Je(n,this.config.system.networkClient,this.storage,o);if(r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");this.loadIdToken(t.id_token,r.clientInfo,i.hostnameAndPort,i.tenant,r);this.loadAccessToken(e,t,r.clientInfo,i.hostnameAndPort,i.tenant,r)}else if(t.client_info){this.logger.trace("TokenCache - homeAccountId from response");this.loadIdToken(t.id_token,t.client_info,i.hostnameAndPort,i.tenant,r);this.loadAccessToken(e,t,t.client_info,i.hostnameAndPort,i.tenant,r)}else{throw yt.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}}else{throw yt.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.")}};e.prototype.loadIdToken=function(e,t,r,n,o){var i=Re.createIdTokenEntity(t,r,e,this.config.auth.clientId,n);var a=new ce(e,this.cryptoObj);var s=o.clientInfo?se.createAccount(o.clientInfo,t,a,undefined,undefined,undefined,undefined,r):se.createGenericAccount(t,a,undefined,undefined,undefined,undefined,r);if(this.isBrowserEnvironment){this.logger.verbose("TokenCache - loading id token");this.storage.setAccount(s);this.storage.setIdTokenCredential(i)}else{throw yt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")}};e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token){this.logger.verbose("TokenCache - No access token provided for caching");return}if(!t.expires_in){throw yt.createUnableToLoadTokenError("Please ensure server response includes expires_in value.")}if(!i.extendedExpiresOn){throw yt.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.")}var a=new ne(e.scopes).printScopes();var s=t.expires_in;var c=i.extendedExpiresOn;var u=Oe.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(this.isBrowserEnvironment){this.logger.verbose("TokenCache - loading access token");this.storage.setAccessTokenCredential(u)}else{throw yt.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")}};return e}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var or=function(e){r(t,e);function t(t){var r=e.call(this,t)||this;r.includeRedirectUri=false;return r}return t}(Ge);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ir=function(t){r(a,t);function a(e,r,n,o,i,a,s,c){var u=t.call(this,e,r,n,o,i,a,c)||this;u.apiId=s;return u}a.prototype.acquireToken=function(t){return o(this,void 0,void 0,function(){var r,o,a,s,c,u,d;return i(this,function(i){switch(i.label){case 0:this.logger.trace("SilentAuthCodeClient.acquireToken called");if(!t.code){throw yt.createAuthCodeRequiredError()}return[4,this.initializeAuthorizationRequest(t,e.InteractionType.Silent)];case 1:r=i.sent();this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null);o=this.initializeServerTelemetryManager(this.apiId);i.label=2;case 2:i.trys.push([2,4,,5]);a=n(n({},r),{code:t.code});return[4,this.getClientConfiguration(o,r.authority)];case 3:s=i.sent();c=new or(s);this.logger.verbose("Auth code client created");u=new er(c,this.browserStorage,a,this.logger,this.config.system.navigateFrameWait);return[2,u.handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r.state,c.authority,this.networkClient,false)];case 4:d=i.sent();if(d instanceof W){d.setCorrelationId(this.correlationId)}o.cacheFailedRequest(d);this.browserStorage.cleanRequestByState(r.state);throw d;case 5:return[2]}})})};a.prototype.logout=function(){return Promise.reject(yt.createSilentLogoutUnsupportedError())};return a}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ar=function(){function t(e){this.isBrowserEnvironment=typeof window!=="undefined";this.config=Bt(e,this.isBrowserEnvironment);this.logger=new X(this.config.system.loggerOptions,Gt,jt);this.networkClient=this.config.system.networkClient;this.navigationClient=this.config.system.navigationClient;this.redirectResponse=new Map;this.hybridAuthCodeResponses=new Map;this.browserCrypto=this.isBrowserEnvironment?new bt(this.logger):Y;this.eventHandler=new zt(this.logger,this.browserCrypto);this.browserStorage=this.isBrowserEnvironment?new Ut(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):Mt(this.config.auth.clientId,this.logger);this.tokenCache=new nr(this.config,this.browserStorage,this.logger,this.browserCrypto)}t.prototype.handleRedirectPromise=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s;var c=this;return i(this,function(i){this.logger.verbose("handleRedirectPromise called");r=this.getAllAccounts();if(this.isBrowserEnvironment){n=t||f.EMPTY_STRING;o=this.redirectResponse.get(n);if(typeof o==="undefined"){this.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_START,e.InteractionType.Redirect);this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise");a=this.browserStorage.getTemporaryCache(e.TemporaryCacheKeys.CORRELATION_ID,true)||"";s=new $t(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,a);o=s.handleRedirectPromise(t).then(function(t){if(t){var n=r.length<c.getAllAccounts().length;if(n){c.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Redirect,t);c.logger.verbose("handleRedirectResponse returned result, login success")}else{c.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t);c.logger.verbose("handleRedirectResponse returned result, acquire token success")}}c.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect);return t}).catch(function(t){if(r.length>0){c.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t)}else{c.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Redirect,null,t)}c.eventHandler.emitEvent(e.EventType.HANDLE_REDIRECT_END,e.InteractionType.Redirect);throw t});this.redirectResponse.set(n,o)}else{this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call")}return[2,o]}this.logger.verbose("handleRedirectPromise returns null, not browser environment");return[2,null]})})};t.prototype.acquireTokenRedirect=function(t){return o(this,void 0,void 0,function(){var r,n;var o=this;return i(this,function(i){this.logger.verbose("acquireTokenRedirect called");this.preflightBrowserEnvironmentCheck(e.InteractionType.Redirect);r=this.getAllAccounts().length>0;if(r){this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t)}else{this.eventHandler.emitEvent(e.EventType.LOGIN_START,e.InteractionType.Redirect,t)}n=new $t(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t.correlationId);return[2,n.acquireToken(t).catch(function(t){if(r){o.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t)}else{o.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Redirect,null,t)}throw t})]})})};t.prototype.acquireTokenPopup=function(t){var r=this;try{this.logger.verbose("acquireTokenPopup called",t.correlationId);this.preflightBrowserEnvironmentCheck(e.InteractionType.Popup)}catch(e){return Promise.reject(e)}var n=this.getAllAccounts();if(n.length>0){this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t)}else{this.eventHandler.emitEvent(e.EventType.LOGIN_START,e.InteractionType.Popup,t)}var o=new Xt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t.correlationId);return o.acquireToken(t).then(function(t){var o=n.length<r.getAllAccounts().length;if(o){r.eventHandler.emitEvent(e.EventType.LOGIN_SUCCESS,e.InteractionType.Popup,t)}else{r.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t)}return t}).catch(function(t){if(n.length>0){r.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t)}else{r.eventHandler.emitEvent(e.EventType.LOGIN_FAILURE,e.InteractionType.Popup,null,t)}return Promise.reject(t)})};t.prototype.ssoSilent=function(t){return o(this,void 0,void 0,function(){var r,n,o;return i(this,function(i){switch(i.label){case 0:this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent);this.logger.verbose("ssoSilent called",t.correlationId);this.eventHandler.emitEvent(e.EventType.SSO_SILENT_START,e.InteractionType.Silent,t);i.label=1;case 1:i.trys.push([1,3,,4]);r=new tr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.ssoSilent,t.correlationId);return[4,r.acquireToken(t)];case 2:n=i.sent();this.eventHandler.emitEvent(e.EventType.SSO_SILENT_SUCCESS,e.InteractionType.Silent,n);return[2,n];case 3:o=i.sent();this.eventHandler.emitEvent(e.EventType.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,o);throw o;case 4:return[2]}})})};t.prototype.acquireTokenByCode=function(t){return o(this,void 0,void 0,function(){var r;var n=this;return i(this,function(o){this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent);this.logger.trace("acquireTokenByCode called",t.correlationId);this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_START,e.InteractionType.Silent,t);try{if(!t.code){throw yt.createAuthCodeRequiredError()}r=this.hybridAuthCodeResponses.get(t.code);if(!r){this.logger.verbose("Initiating new acquireTokenByCode request",t.correlationId);r=this.acquireTokenByCodeAsync(t).then(function(r){n.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_SUCCESS,e.InteractionType.Silent,r);n.hybridAuthCodeResponses.delete(t.code);return r}).catch(function(e){n.hybridAuthCodeResponses.delete(t.code);throw e});this.hybridAuthCodeResponses.set(t.code,r)}else{this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId)}return[2,r]}catch(t){this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t);throw t}return[2]})})};t.prototype.acquireTokenByCodeAsync=function(t){return o(this,void 0,void 0,function(){var r,n;return i(this,function(o){switch(o.label){case 0:this.logger.trace("acquireTokenByCodeAsync called",t.correlationId);r=new ir(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.ApiId.acquireTokenByCode,t.correlationId);return[4,r.acquireToken(t)];case 1:n=o.sent();return[2,n]}})})};t.prototype.acquireTokenByRefreshToken=function(t){return o(this,void 0,void 0,function(){var r;var n=this;return i(this,function(o){this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_NETWORK_START,e.InteractionType.Silent,t);qt.blockReloadInHiddenIframes();r=new rr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t.correlationId);return[2,r.acquireToken(t).catch(function(r){var o=r instanceof Ce;var i=r instanceof Me;var a=r.errorCode===nt.INVALID_GRANT_ERROR;if(o&&a&&!i){n.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",t.correlationId);var s=new tr(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,e.ApiId.acquireTokenSilent_authCode,t.correlationId);return s.acquireToken(t)}throw r})]})})};t.prototype.logout=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.");return[2,this.logoutRedirect(e)]})})};t.prototype.logoutRedirect=function(t){return o(this,void 0,void 0,function(){var r;return i(this,function(n){this.preflightBrowserEnvironmentCheck(e.InteractionType.Redirect);r=new $t(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t===null||t===void 0?void 0:t.correlationId);return[2,r.logout(t)]})})};t.prototype.logoutPopup=function(t){try{this.preflightBrowserEnvironmentCheck(e.InteractionType.Popup);var r=new Xt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t===null||t===void 0?void 0:t.correlationId);return r.logout(t)}catch(e){return Promise.reject(e)}};t.prototype.getAllAccounts=function(){this.logger.verbose("getAllAccounts called");return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]};t.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();if(!J.isEmpty(e)&&t&&t.length){this.logger.verbose("Account matching username found, returning");this.logger.verbosePii("Returning signed-in accounts matching username: "+e);return t.filter(function(t){return t.username.toLowerCase()===e.toLowerCase()})[0]||null}else{this.logger.verbose("getAccountByUsername: No matching account found, returning null");return null}};t.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();if(!J.isEmpty(e)&&t&&t.length){this.logger.verbose("Account matching homeAccountId found, returning");this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e);return t.filter(function(t){return t.homeAccountId===e})[0]||null}else{this.logger.verbose("getAccountByHomeId: No matching account found, returning null");return null}};t.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();if(!J.isEmpty(e)&&t&&t.length){this.logger.verbose("Account matching localAccountId found, returning");this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e);return t.filter(function(t){return t.localAccountId===e})[0]||null}else{this.logger.verbose("getAccountByLocalId: No matching account found, returning null");return null}};t.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)};t.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()};t.prototype.preflightBrowserEnvironmentCheck=function(t){this.logger.verbose("preflightBrowserEnvironmentCheck started");qt.blockNonBrowserEnvironment(this.isBrowserEnvironment);qt.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe);qt.blockReloadInHiddenIframes();qt.blockAcquireTokenInPopups();if(t===e.InteractionType.Redirect&&this.config.cache.cacheLocation===e.BrowserCacheLocation.MemoryStorage&&!this.config.cache.storeAuthStateInCookie){throw kt.createInMemoryRedirectUnavailableError()}if(t===e.InteractionType.Redirect||t===e.InteractionType.Popup){this.preflightInteractiveRequest()}};t.prototype.preflightInteractiveRequest=function(){this.logger.verbose("preflightInteractiveRequest called, validating app environment");qt.blockReloadInHiddenIframes();this.browserStorage.setInteractionInProgress(true)};t.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)};t.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)};t.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()};t.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()};t.prototype.getTokenCache=function(){return this.tokenCache};t.prototype.getLogger=function(){return this.logger};t.prototype.setLogger=function(e){this.logger=e};t.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)};t.prototype.setNavigationClient=function(e){this.navigationClient=e};t.prototype.getConfiguration=function(){return this.config};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var sr=function(t){r(a,t);function a(){return t!==null&&t.apply(this,arguments)||this}a.prototype.acquireToken=function(t){return o(this,void 0,void 0,function(){var r,n,o,a;return i(this,function(i){switch(i.label){case 0:r=this.initializeServerTelemetryManager(e.ApiId.acquireTokenSilent_silentFlow);return[4,this.createSilentFlowClient(r,t.authority,t.azureCloudOptions)];case 1:n=i.sent();this.logger.verbose("Silent auth client created");i.label=2;case 2:i.trys.push([2,4,,5]);return[4,n.acquireCachedToken(t)];case 3:o=i.sent();this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,o);return[2,o];case 4:a=i.sent();if(a instanceof yt&&a.errorCode===vt.signingKeyNotFoundInStorage.code){this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair.")}throw a;case 5:return[2]}})})};a.prototype.logout=function(){return Promise.reject(yt.createSilentLogoutUnsupportedError())};a.prototype.createSilentFlowClient=function(e,t,r){return o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:n=o.sent();return[2,new ze(n)]}})})};a.prototype.initializeSilentRequest=function(e,t){return o(this,void 0,void 0,function(){var r;return i(this,function(o){switch(o.label){case 0:r=[n({},e)];return[4,this.initializeBaseRequest(e)];case 1:return[2,n.apply(void 0,[n.apply(void 0,r.concat([o.sent()])),{account:t,forceRefresh:e.forceRefresh||false}])]}})})};return a}(Yt);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var cr=function(t){r(n,t);function n(e){var r=t.call(this,e)||this;r.activeSilentTokenRequests=new Map;return r}n.prototype.loginRedirect=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){this.logger.verbose("loginRedirect called");return[2,this.acquireTokenRedirect(e||at)]})})};n.prototype.loginPopup=function(e){this.logger.verbose("loginPopup called");return this.acquireTokenPopup(e||at)};n.prototype.acquireTokenSilent=function(t){return o(this,void 0,void 0,function(){var r,n,o,a,s;var c=this;return i(this,function(i){this.preflightBrowserEnvironmentCheck(e.InteractionType.Silent);this.logger.verbose("acquireTokenSilent called",t.correlationId);r=t.account||this.getActiveAccount();if(!r){throw yt.createNoAccountError()}n={clientId:this.config.auth.clientId,authority:t.authority||"",scopes:t.scopes,homeAccountIdentifier:r.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};o=JSON.stringify(n);a=this.activeSilentTokenRequests.get(o);if(typeof a==="undefined"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t.correlationId);s=this.acquireTokenSilentAsync(t,r).then(function(e){c.activeSilentTokenRequests.delete(o);return e}).catch(function(e){c.activeSilentTokenRequests.delete(o);throw e});this.activeSilentTokenRequests.set(o,s);return[2,s]}else{this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t.correlationId);return[2,a]}})})};n.prototype.acquireTokenSilentAsync=function(t,r){return o(this,void 0,void 0,function(){var n,a;var s=this;return i(this,function(c){switch(c.label){case 0:n=new sr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t.correlationId);return[4,n.initializeSilentRequest(t,r)];case 1:a=c.sent();this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t);return[2,n.acquireToken(a).catch(function(){return o(s,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.acquireTokenByRefreshToken(a)];case 1:t=n.sent();this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,t);return[2,t];case 2:r=n.sent();this.eventHandler.emitEvent(e.EventType.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,r);throw r;case 3:return[2]}})})})]}})})};return n}(ar);
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var ur={acquireTokenPopup:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(kt.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){return},enableAccountStorageEvents:function(){return},disableAccountStorageEvents:function(){return},getTokenCache:function(){throw kt.createStubPcaInstanceCalledError()},getLogger:function(){throw kt.createStubPcaInstanceCalledError()},setLogger:function(){return},setActiveAccount:function(){return},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){return},setNavigationClient:function(){return},getConfiguration:function(){throw kt.createStubPcaInstanceCalledError()}};
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var dr=function(){function t(){}t.getInteractionStatusFromEvent=function(t,r){switch(t.eventType){case e.EventType.LOGIN_START:return e.InteractionStatus.Login;case e.EventType.SSO_SILENT_START:return e.InteractionStatus.SsoSilent;case e.EventType.ACQUIRE_TOKEN_START:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup){return e.InteractionStatus.AcquireToken}break;case e.EventType.HANDLE_REDIRECT_START:return e.InteractionStatus.HandleRedirect;case e.EventType.LOGOUT_START:return e.InteractionStatus.Logout;case e.EventType.SSO_SILENT_SUCCESS:case e.EventType.SSO_SILENT_FAILURE:if(r&&r!==e.InteractionStatus.SsoSilent){break}return e.InteractionStatus.None;case e.EventType.LOGOUT_END:if(r&&r!==e.InteractionStatus.Logout){break}return e.InteractionStatus.None;case e.EventType.HANDLE_REDIRECT_END:if(r&&r!==e.InteractionStatus.HandleRedirect){break}return e.InteractionStatus.None;case e.EventType.LOGIN_SUCCESS:case e.EventType.LOGIN_FAILURE:case e.EventType.ACQUIRE_TOKEN_SUCCESS:case e.EventType.ACQUIRE_TOKEN_FAILURE:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup){if(r&&r!==e.InteractionStatus.Login&&r!==e.InteractionStatus.AcquireToken){break}return e.InteractionStatus.None}break}return null};return t}();
/*
     * Copyright (c) Microsoft Corporation. All rights reserved.
     * Licensed under the MIT License.
     */var lr=function(){function e(e,t){var r=t&&t.loggerOptions||{};this.logger=new X(r,Gt,jt);this.cryptoOps=new bt(this.logger);this.popTokenGenerator=new Ke(this.cryptoOps);this.shrParameters=e}e.prototype.generatePublicKeyThumbprint=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:e=t.sent().kid;return[2,e]}})})};e.prototype.signRequest=function(e,t,r){return o(this,void 0,void 0,function(){return i(this,function(n){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)]})})};e.prototype.removeKeys=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}})})};return e}();e.AccountEntity=se;e.AuthError=W;e.AuthErrorMessage=z;e.AuthenticationHeaderParser=tt;e.BrowserAuthError=yt;e.BrowserAuthErrorMessage=vt;e.BrowserCacheManager=Ut;e.BrowserConfigurationAuthError=kt;e.BrowserConfigurationAuthErrorMessage=Ot;e.BrowserConstants=nt;e.BrowserUtils=qt;e.ClientAuthError=V;e.ClientAuthErrorMessage=Q;e.ClientConfigurationError=re;e.ClientConfigurationErrorMessage=te;e.DEFAULT_IFRAME_TIMEOUT_MS=Ft;e.EventHandler=zt;e.EventMessageUtils=dr;e.InteractionRequiredAuthError=Me;e.InteractionRequiredAuthErrorMessage=Ue;e.Logger=X;e.NavigationClient=Dt;e.OIDC_DEFAULT_SCOPES=g;e.PopupClient=Xt;e.PopupUtils=Qt;e.PublicClientApplication=cr;e.RedirectClient=$t;e.RedirectHandler=Zt;e.ServerError=Ce;e.SignedHttpRequest=lr;e.SilentCacheClient=sr;e.SilentIframeClient=tr;e.SilentRefreshClient=rr;e.StandardInteractionClient=Yt;e.StringUtils=J;e.UrlString=qe;e.stubbedPublicClientApplication=ur;e.version=jt;Object.defineProperty(e,"__esModule",{value:true})});
}
});
//# sourceMappingURL=library-preload.js.map
