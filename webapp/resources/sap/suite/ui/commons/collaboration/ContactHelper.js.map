{"version":3,"file":"ContactHelper.js","names":["sap","ui","loader","config","shim","amd","exports","define","Controller","GraphApiConfig","Fragment","JSONModel","mLibrary","Core","ResourceModel","oi18nModel","getLibraryResourceBundle","i18nModel","bundle","extend","constructor","oProviderConfig","this","oGraphApiConfig","getConfig","myMSALObj","msal","PublicClientApplication","msalConfig","handleMultipleAccounts","aCurrentAccounts","getAllAccounts","length","console","warn","sUserName","username","callApi","endpoint","token","oHeaders","Headers","sBearer","append","fetch","method","headers","signIn","loginPopup","loginRequest","then","response","account","Promise","resolve","getAccountByUsername","bind","catch","error","reject","getAccount","getToken","request","acquireTokenSilent","loginResponse","InteractionRequiredAuthError","acquireTokenPopup","getFullProfileByEmail","email","oUserProfilePromise","graphApiEndpoints","graphUserEndpoint","accessToken","json","oUserPresencePromise","oUserPhotoPromise","getPhotoByEmail","all","data","oFullProfileData","Object","assign","photo","checkExistingToken","blob","URL","createObjectURL","sendChatMessage","sMessage","getCore","byId","getValue","body","sEmail","createChat","text","createChatResponseData","createChatResponse","JSON","parse","bodyMessage","encodeURIComponent","id","createChatMessage","log","handleMSTeamsPress","event","getSource","type","url","URLHelper","redirect","formatUri","sValue","mailregex","test","loadContactPopover","oJsonModel","setData","load","name","controller","oPopover","_oContactPopover","setModel","afterClose","destroy"],"sources":["ContactHelper-dbg.js"],"mappings":"AAGAA,IAAIC,GAAGC,OAAOC,OAAO,CACpBC,KAAM,CACL,+CAAgD,CAC/CC,IAAK,KACLC,QAAS,mBAKZN,IAAIC,GAAGM,OAAO,CACb,6BACA,oDACA,uBACA,8BACA,gBACA,mBACA,sCACA,gDACC,SAAUC,EAAYC,EAAgBC,EAAUC,EAAWC,EAAUC,EAAMC,GAC3E,aAEA,IAAIC,EAAaF,EAAKG,yBAAyB,wBAC/C,IAAIC,EAAY,IAAIH,EAAc,CAAEI,OAAQH,IAE5C,OAAOP,EAAWW,OAAO,mDAAoD,CAC5EC,YAAa,SAAUC,GAQtBC,KAAKC,gBAAkBd,EAAee,UAAUH,GAEhDC,KAAKG,UAAY,IAAIC,KAAKC,wBAAwBL,KAAKC,gBAAgBK,WACxE,EAEAC,uBAAwB,WAEvB,IAAIC,EAAmBL,UAAUM,iBACjC,GAAID,EAAiBE,SAAW,EAAG,CAElCC,QAAQC,KAAK,uBACd,MAAO,GAAIJ,EAAiBE,OAAS,EAAG,CAEvCC,QAAQC,KAAK,8BACd,MAAO,GAAIJ,EAAiBE,SAAW,EAAG,CACzCV,KAAKa,UAAYL,EAAiB,GAAGM,QACtC,CACD,EAEAC,QAAS,SAAUC,EAAUC,GAC5B,IAAIC,EAAW,IAAIC,QACnB,IAAIC,EAAU,UAAYH,EAE1BC,EAASG,OAAO,gBAAiBD,GAEjC,OAAOE,MAAMN,EAAU,CACtBO,OAAQ,MACRC,QAASN,GAEX,EAEAO,OAAQ,WACP,OAAOzB,KAAKG,UAAUuB,WAAW1B,KAAKC,gBAAgB0B,cAAcC,KAAK,SAASC,GACjF,GAAIA,IAAa,KAAM,CACtB7B,KAAKa,UAAYgB,EAASC,QAAQhB,QACnC,KAAO,CACNd,KAAKO,wBACN,CACA,OAAOwB,QAAQC,QAAQhC,KAAKG,UAAU8B,qBAAqBjC,KAAKa,WACjE,EAAEqB,KAAKlC,OAAOmC,MAAM,SAASC,GAC5B,OAAOL,QAAQM,OAAOD,EACvB,EACD,EAEAE,WAAY,WACX,GAAItC,KAAKa,UAAW,CACnB,OAAOkB,QAAQC,QAAQhC,KAAKG,UAAU8B,qBAAqBjC,KAAKa,WACjE,KAAO,CACN,OAAOb,KAAKyB,QACb,CACD,EAEAc,SAAU,SAAUC,GACnB,OAAO,IAAIT,QAAQ,SAAUC,EAASK,GACrCrC,KAAKsC,aACJV,KAAK,SAASE,GACdU,EAAQV,QAAUA,EAClB,OAAO9B,KAAKG,UAAUsC,mBAAmBD,EAC1C,EAAEN,KAAKlC,OACN4B,KAAK,SAASX,GACdjB,KAAK0C,cAAgBzB,EACrBe,EAAQf,EACT,EAAEiB,KAAKlC,OACNmC,MAAM,SAASC,GAEf,GAAIA,aAAiBhC,KAAKuC,6BAA8B,CACvD3C,KAAKG,UAAUyC,kBAAkBJ,GAASZ,KAAK,SAASX,GACvDjB,KAAK0C,cAAgBzB,EACrBe,EAAQf,EACT,GAAGkB,MAAM,WAERxB,QAAQyB,MAAMA,GACdC,EAAOD,EACR,EACD,KAAO,CAENzB,QAAQyB,MAAMA,GACdC,EAAOD,EACR,CACD,EACD,EAAEF,KAAKlC,MACR,EAEA6C,sBAAuB,SAAUC,GAChC,OAAO9C,KAAKuC,SAASvC,KAAKC,gBAAgB0B,cAAcC,KAAK,SAASc,GACrE,IAAIK,EAAsB/C,KAAKe,QAC9Bf,KAAKC,gBAAgB+C,kBAAkBC,kBAAoB,IAAMH,EAAQ,0GACzEJ,EAAcQ,aACbtB,KAAK,SAASC,GACf,OAAOA,EAASsB,MACjB,GACA,IAAIC,EAAuBpD,KAAKe,QAC/Bf,KAAKC,gBAAgB+C,kBAAkBC,kBAAoB,IAAMH,EAAQ,YACzEJ,EAAcQ,aACbtB,KAAK,SAASC,GACf,OAAOA,EAASsB,MACjB,GACA,IAAIE,EAAoBrD,KAAKsD,gBAAgBR,GAC7C,OAAOf,QAAQwB,IAAI,CAACR,EAAqBK,EAAsBC,IAAoBzB,KAAK,SAAS4B,GAChG,IAAIC,EAAmBC,OAAOC,OAAOH,EAAK,GAAIA,EAAK,IACnDC,EAAiBG,MAAQJ,EAAK,GAC9B,OAAOC,CACR,EACD,EAAEvB,KAAKlC,MACR,EAEAsD,gBAAiB,SAAUR,GAC1B,IAAKA,GAASA,EAAMpC,SAAW,EAAG,CACjC,OAAOqB,QAAQC,SAChB,CACA,OAAOhC,KAAK6D,qBAAqBjC,KAAK,SAASc,GAC9C,OAAO1C,KAAKe,QACXf,KAAKC,gBAAgB+C,kBAAkBC,kBAAoB,IAAMH,EAAQ,gBACzEJ,EAAcQ,YAEhB,EAAEhB,KAAKlC,OACN4B,KAAK,SAASC,GACd,OAAOA,EAASiC,MACjB,GACClC,KAAK,SAASkC,GACd,OAAOC,IAAIC,gBAAgBF,EAC5B,EACD,EAEAD,mBAAoB,WACnB,GAAI7D,KAAK0C,cAAe,CACvB,OAAOX,QAAQC,QAAQhC,KAAK0C,cAC7B,KAAO,CACN,OAAO1C,KAAKuC,SAASvC,KAAKC,gBAAgB0B,aAC3C,CACD,EAEAsC,gBAAiB,WAChB,IAAIC,EAAWxF,IAAIC,GAAGwF,UAAUC,KAAK,oBAAoBC,WACzDrE,KAAK6D,qBAAqBjC,KAAK,SAASc,GACvC1C,KAAKkB,SAAW,IAAIC,QACpB,IAAIC,EAAU,UAAYsB,EAAcQ,YACxClD,KAAKgB,SAAW,yCAEhB,IAAIsD,EACH,MACA,gCACA,qBACA,cACA,6EACA,2BACA,4BACA,mBACA,4EAA8E5B,EAAcZ,QAAQhB,SAAW,SAC/G,eACA,cACA,6EACA,2BACA,4BACA,mBACA,4EAA8Ed,KAAKuE,OAAS,SAC5F,cACA,UACA,IAEDvE,KAAKkB,SAASG,OAAO,gBAAiBD,GACtCpB,KAAKkB,SAASG,OAAO,eAAgB,oBAErC,OAAOC,MAAMtB,KAAKgB,SAAU,CAC3BO,OAAQ,OACRC,QAASxB,KAAKkB,SACdoD,KAAMA,GAER,EAAEpC,KAAKlC,OACN4B,KAAK,SAAS4C,GACd,OAAOA,EAAWC,MACnB,GACC7C,KAAK,SAAS8C,GACd,IAAIC,EAAqBC,KAAKC,MAAMH,GACpC,IAAII,EAAc,MAAQ,gBAAkB,oBAAsBZ,EAAW,QAAU,QAAU,IACjG,OAAO5C,MAAMtB,KAAKgB,SAAW,IAAM+D,mBAAmBJ,EAAmBK,IAAM,YAAa,CAC3FzD,OAAQ,OACRC,QAASxB,KAAKkB,SACdoD,KAAMQ,GAER,EAAE5C,KAAKlC,OACN4B,KAAK,SAASqD,GACdtE,QAAQuE,IAAID,EACb,EACD,EAEAE,mBAAoB,SAAUC,GAC7B,IAAItC,EAAQsC,EAAMC,YAAY7B,KAAK,SACnC,IAAI8B,EAAOF,EAAMC,YAAY7B,KAAK,QAClC,IAAI+B,EAAM,GACV,OAAQD,GACP,IAAK,OACJC,EAAM,gDAAkDzC,EACxD,MACD,IAAK,YACJyC,EAAM,gDAAkDzC,EAAQ,kBAChE,MACD,IAAK,OACJyC,EAAM,gDAAkDzC,EACxD,MACD,QACC,MAEFxD,EAASkG,UAAUC,SAASF,EAAK,KAClC,EAEAG,UAAW,SAAUC,GACpB,IAAIC,EAAY,+CAChB,GAAIA,EAAUC,KAAKF,GAAS,CAC3B,MAAO,UAAYA,CACpB,KAAO,CACN,MAAO,OAASA,CACjB,CACD,EAEAG,mBAAoB,SAAUvB,GAC7BvE,KAAKuE,OAASA,EACd,OAAOvE,KAAK6C,sBAAsB0B,GAAQ3C,KAAK,SAAU4B,GACxD,GAAIA,GAAQA,EAAKpB,MAAO,CACvB,OAAOL,QAAQM,OAAOmB,EACvB,CACA,IAAIuC,EAAa,IAAI1G,EAAUmE,GAC/BuC,EAAWC,QAAQxC,GACnB,OAAOpE,EAAS6G,KAAK,CACpBC,KAAM,oDACNC,WAAYnG,KACZsF,KAAO,QACL1D,KAAK,SAAUwE,GACjBpG,KAAKqG,iBAAmBD,EACxBA,EAASE,SAASP,EAAY,YAC9BK,EAASE,SAAS3G,EAAW,QAC7B,OAAOyG,CACR,EAAElE,KAAKlC,MACR,EAAEkC,KAAKlC,MACR,EAEAuG,WAAY,WACXvG,KAAKqG,iBAAiBG,SACvB,GAEF"}