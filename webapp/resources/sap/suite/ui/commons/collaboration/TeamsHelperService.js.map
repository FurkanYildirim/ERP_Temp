{"version":3,"file":"TeamsHelperService.js","names":["sap","ui","define","Log","Core","URLListValidator","CollaborationHelper","BaseHelperService","Element","ContactHelper","Device","TeamsHelperService","extend","constructor","oProviderConfig","this","_providerConfig","shareAsLinkUrl","_getShareAsTabUrl","then","sShareAsTabUrl","shareAsTabUrl","bind","COLLABORATION_MSTEAMS_APPID","oLogger","getLogger","oResourceBundle","getLibraryResourceBundle","PARAM_SAP_CARD_TITLE","oHash","prototype","getOptions","oParams","oTeamsParams","isShareAsLinkEnabled","isShareAsTabEnabled","isShareAsCardEnabled","aOptions","aFinalOptions","system","desktop","push","text","getText","key","icon","fesrStepName","info","_isFeatureFlagEnabled","length","type","subOptions","share","oOption","url","error","validate","_shareAsChat","_shareAsTab","_shareAsCard","newWindow","window","open","sMessage","appTitle","subTitle","opener","minifyUrlForChat","compactHash","sShortURL","location","encodeURIComponent","sAppUri","iIndexOfHash","indexOf","sUriForHeaderLess","substring","iIndexOfQuestionMark","sParam","undefined","_addNavmodeInUrl","oData","subEntityId","mode","sURL","JSON","stringify","m","URLHelper","redirect","oUshellContainer","ushell","Container","oURLParsing","getService","oHashPartOfUri","parseShellHash","params","sHashOfUri","constructShellHash","_addCardTitleInUrl","sUrl","sAppTitle","_getApplicationID","sTeamsAppID","_getCurrentUrl","sCurrentUrl","sBeforeHashURL","split","oParsedUrl","parseParameters","Promise","resolve","renderers","fiori2","componentData","config","sapHorizonEnabled","isContactsCollaborationSupported","enableContactsCollaboration","sEmail","applicationId","tenantId","oContactHelper","loadContactPopover"],"sources":["TeamsHelperService-dbg.js"],"mappings":"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"}