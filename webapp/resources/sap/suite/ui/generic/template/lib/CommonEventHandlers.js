sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/m/MessageBox","sap/ui/model/Sorter","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/expressionHelper","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/js/AnnotationHelper","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/lib/MessageUtils","sap/base/util/extend","sap/base/util/isEmptyObject","sap/base/util/deepExtend","sap/suite/ui/generic/template/lib/CRUDHelper","sap/ui/core/mvc/XMLView","sap/ui/comp/util/FormatUtil","sap/suite/ui/generic/template/genericUtilities/FeError","sap/ui/unified/FileUploaderParameter","sap/ui/core/IconPool","sap/suite/ui/commons/collaboration/ServiceContainer","sap/ui/generic/app/library","sap/suite/ui/generic/template/genericUtilities/polyFill"],function(e,t,a,n,r,i,o,s,l,c,u,g,f,p,v,d,m,C,E,h,y,P){"use strict";var b=new u("lib.CommonEventHandlers").getLogger();function S(e,u,E,S){function T(e){return S.getOwnerControl(e.getSource(),true)}function I(e){var t={};for(var a in e){var n=e[a];if(typeof n==="string"){t[a]=n}else if(typeof n==="object"){if(n.value){t[a]=I(n).value}else{t[a]=n}}}return t}var x=Object.create(null);var D;function A(t,a,n){var r=D;if(r){D=null;return r}var i=S.getOwnerPresentationControl(t);var o=E.oPresentationControlHandlerFactory.getPresentationControlHandler(i);var s=o.getCurrentContexts();if(!s){return null}s=S.filterActiveContexts(s);var l=o.getBinding();var c;var g=a.getBindingContext().getPath();if(!s.some(function(e,t){if(e&&e.getPath()===g){c=t;return true}})){return null}var f=o.isMTable&&o.isMTable();var p=Object.create(null);if(f){var v=i.getTable().getSelectedItems();v.forEach(function(e){p[e.getBindingContext().getPath()]=e})}var d=o.getThreshold&&o.getThreshold();var m=a.getParent();var C=m.getId();var h=u.isDraftEnabled()&&!e.getView().getModel("ui").getProperty("/editable");var y=function(e,t,i){var o=function(e){var i=e.getPath();var o=p[i];if(!o){var s=x[C];if(!s){var l=a.isSelected&&a.isSelected();s=a.clone();s.setParent(m);if(l){a.setSelected(true)}x[C]=s}s.setBindingContext(e);o=s}D=r;te(o,n,e,true,t)};if(h&&i){E.oApplication.registerContext(e,u.getViewLevel()+1);var s=E.oApplication.getDraftSiblingPromise(e);s.then(o)}else{o(e)}};r={listBinding:l,growingThreshold:d,selectedRelativeIndex:c,objectPageNavigationContexts:s,paginate:y};return r}function O(e,t){var a=S.getOwnerControl(e);if(a.getTable){a=a.getTable()}var n=r.isAnalyticalTable(a);u.setPaginatorInfo(n?null:A(a,e,t))}function _(e){var t=e.getSource(),a=t.getParent();S.setEnabledToolbarButtons(a)}var N;function R(e){N=e;return S.getDialogFragmentAsync("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(e){var t=e.getSource().getParent();t.close()},onDelete:function(e){var t=e.getSource().getParent();var n=t.getModel("delete");var r=n.getProperty("/items");var i=[];var o=[];var s=[];var l=[];for(var c=0;c<r.length;c++){if(!r[c].draftStatus.locked&&r[c].deletable){if(!r[c].draftStatus.draft){if(r[c].draftStatus.draftActive){s.push(r[c].context.sPath)}else if(r.length===n.getProperty("/unsavedChangesItemsCount")||!r[c].draftStatus.unsavedChanges||n.getProperty("/unsavedChangesCheckboxSelected")){i.push(r[c].context.sPath)}}else{o.push(r[c].context.sPath);l.push(r[c].context.sPath)}}}o=o.concat(i).concat(s);var u={smartTable:N,pathes:o,onlyOneDraftPlusActive:o.length===2&&l.length===1&&s.length===1,suppressRefreshAllComponents:!(F()||L()),withWarningDialog:true};var f=E.oCRUDManager.deleteEntities(u);f.then(function(e){var t=0;var n=[];var r=e.some(function(e){return e.isWarning});for(var i=0;i<e.length;i++){n.push("/"+e[i].sPath.split("/")[1]);if(s.indexOf(n[i])!==-1){t=t+1}}var l=o.length-s.length;var c=e.length-t;var f=l-c;if(c>0){var p=!u.onlyOneDraftPlusActive&&l!==1;if(p){var v="";if(f>0){v+=S.getText("ST_GENERIC_NOT_DELETED_RECORDS",[c,l])}else{v=c>1?S.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):S.getText("ST_GENERIC_DELETE_ERROR")}if(r){v+="\n";if(c===1){v+=S.getText("ST_GENERIC_DELETE_WITH_WARNING_SUGGESTION_SINGULAR")}else{v+=S.getText("ST_GENERIC_DELETE_WITH_WARNING_SUGGESTION_PLURAL")}}E.oApplication.removeTransientMessages();a.error(v)}}else{var d="";d=f>1?S.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):S.getText("ST_GENERIC_OBJECT_DELETED");g.showSuccessMessageIfRequired(d,E)}},Function.prototype);t.close()}},"delete")}function F(){return u.getFclProxy()&&u.getFclProxy().isNextObjectLoadedAfterDelete()}function L(){return!!(u&&u.getSettings()&&u.getSettings().quickVariantSelectionX)}function M(e,t){return new Promise(function(a,n){t.read(e+"/SiblingEntity",{success:function(e){var n="/"+t.getKey(e);a(n)},error:function(e){var t="Error";a(t)}})})}function w(t,a){var n=e.getView().getModel();var r=n.getMetaModel();var i=r.getODataEntitySet(e.getOwnerComponent().getEntitySet());var o=i["Org.OData.Capabilities.V1.DeleteRestrictions"];var s=o&&o.Deletable&&o.Deletable.Path?o.Deletable.Path:"";var l={items:undefined,itemsCount:t.length,text:{title:undefined,text:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,unsavedChangesCheckboxSelected:true,unsavedChangesCheckboxVisible:true,undeletableLocked:0,tableMode:""};var c=[];var u=[];var g,f,p,v,d,m;var C=[];for(var E=0;E<t.length;E++){g=n.getObject(t[E].getPath());if(!g.IsActiveEntity){if(g.HasActiveEntity){C.push(M(t[E].getPath(),n))}}}var h=0;return new Promise(function(e,r){Promise.all(C).then(function(r){for(var i=0;i<t.length;i++){g=n.getObject(t[i].getPath());f={};p={};v=true;d={};m=false;if(s){if(n.getProperty(s,t[i])===false){v=false;l.undeletableCount++}}if(!g.IsActiveEntity){f.draft=true;if(g.HasActiveEntity){p.draft=false;p.draftActive=true;if(r[h]!="Error"){d["oModel"]=t[0].getModel();d["sPath"]=r[h++]}if(d.sPath&&v&&n.getProperty(s,n.getContext(d.sPath))===false){v=false;l.undeletableCount++}}}else if(g.HasDraftEntity){var o=n.getProperty("DraftAdministrativeData/CreatedByUserDescription",t[i])||n.getProperty("DraftAdministrativeData/CreatedByUser",t[i]);m=n.getProperty("DraftAdministrativeData/InProcessByUser",t[i]);if(m){if(v===false){l.undeletableLocked++}f.locked=true;f.user=o;l.lockedItemsCount++}else if(v){f.unsavedChanges=true;f.user=o;l.unsavedChangesItemsCount++}}c.push({context:t[i],draftStatus:f,deletable:v});if(!g.IsActiveEntity&&g.HasActiveEntity){u.push({context:d,draftStatus:p,deletable:v})}}if(u.length>0){c=c.concat(u)}l.items=c;l.text.unsavedChanges=S.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(l.itemsCount>1){var C=0;if(l.lockedItemsCount===l.itemsCount){l.text.text=S.getText("ST_GENERIC_DELETE_LOCKED_PLURAL")}else if(l.unsavedChangesItemsCount===l.itemsCount&&l.undeletableCount===0){l.text.text=S.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL")}else if(l.lockedItemsCount>0){C=l.itemsCount-l.lockedItemsCount;l.text.text=B(l.lockedItemsCount,"ST_GENERIC_CURRENTLY_LOCKED_PLURAL","ST_GENERIC_CURRENTLY_LOCKED",[l.lockedItemsCount,l.itemsCount]);l.text.text+="\n";l.undeletableCount=l.undeletableLocked>0?l.undeletableCount-l.undeletableLocked:l.undeletableCount;if(l.undeletableCount>0&&C>=l.undeletableCount){l.text.text+=S.getText("ST_GENERIC_DELETE_UNDELETABLE",[l.undeletableCount,l.itemsCount]);C=C-l.undeletableCount;l.text.text+="\n"}if(l.unsavedChangesItemsCount&&C===l.unsavedChangesItemsCount){l.text.text+=B(C,"ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL","ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");C=0}}else if(l.undeletableCount>0){C=l.itemsCount-l.undeletableCount;l.text.text=S.getText("ST_GENERIC_DELETE_UNDELETABLE",[l.undeletableCount,l.itemsCount]);l.text.text+="\n";if(l.unsavedChangesItemsCount&&C===l.unsavedChangesItemsCount||l.itemsCount===l.unsavedChangesItemsCount){l.text.text+=B(C,"ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL","ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");C=0}}else{l.text.text=S.getText("ST_GENERIC_DELETE_SELECTED_PLURAL")}if(C>0){l.text.text+=C>1?S.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[C]):S.getText("ST_GENERIC_DELETE_REMAINING")}}else{var E;if("getMode"in a.getTable()){E=a.getTable().getMode()}if(l.lockedItemsCount>0){l.text.text=S.getText("ST_GENERIC_DELETE_LOCKED",[" ",l.items[0].draftStatus.user])}else if(l.undeletableCount>0){if(E==="Delete"){l.tableMode=E}l.text.text=S.getText("ST_GENERIC_NOT_DELETABLE")}else if(l.unsavedChangesItemsCount>0){l.text.text=S.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",l.items[0].draftStatus.user])}else{l.text.text=G(a,t[0])}}if(l.lockedItemsCount===l.itemsCount){l.text.title=S.getText("ST_GENERIC_ERROR_TITLE")}else if(l.itemsCount&&l.lockedItemsCount+l.undeletableCount===l.itemsCount){l.text.title=S.getText("WARNING")}else{l.text.title=l.text.title=l.itemsCount>1?S.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[l.itemsCount]):S.getText("ST_GENERIC_DELETE_TITLE")}if(l.unsavedChangesItemsCount>0){if(l.unsavedChangesItemsCount!==l.itemsCount){if(l.lockedItemsCount>0){if(l.undeletableCount>0){if(l.itemsCount-l.lockedItemsCount-l.undeletableCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else if(l.itemsCount-l.lockedItemsCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else if(l.undeletableCount>0&&l.itemsCount-l.undeletableCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else{l.unsavedChangesCheckboxVisible=false}}else{l.unsavedChangesCheckboxVisible=false}e(l)})})}function B(e,t,a,n){var r;if(!n){r=e>1?S.getText(t):S.getText(a)}else if(e>1&&n.length>1){r=S.getText(t,[n[0],n[1]])}else if(n){r=S.getText(a,[n[1]])}return r}function G(e,t,a){var n=E.oPresentationControlHandlerFactory.getPresentationControlHandler(e);var r=n.getTitleInfoForItem(t);return Fe(r.title,r.subTitle,a,false,e)}function U(t){if(!t){return t}var a=e.getOwnerComponent().getModel().getMetaModel();var n=a.getMetaContext(t.getPath()).getObject();var r=Object.create(Object.prototype);var i=t.getObject();n.property.forEach(function(e){if(i&&i[e.name]!==undefined){if((!e["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||e["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"].Bool==="false")&&(!e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"].Bool==="false")){r[e.name]=i[e.name]}}});return r}function V(e,t,a,n){var r=E.oApplication.getNavigationHandler();var i={};var o={};t.parameters=I(t.parameters);for(var s in t.parameters){if(p(t.parameters[s])){i[s]=t.parameters[s]}else{o[s]=t.parameters[s]}}r.mixAttributesAndSelectionVariant(Object.create(Object.prototype),a).getSelectOptionsPropertyNames().forEach(function(e){delete i[e]});var l=U(e);return f({},i,l,n,o)}function H(e,t,a,n){var r;switch(t.length){case 0:r=[V(a,e,n,Object.create(Object.prototype))];break;case 1:r=[V(a,e,n,U(t[0]))];break;default:r=t.map(U);break}var i=E.oApplication.getNavigationHandler();return i.mixAttributesAndSelectionVariant(r,n)}function k(t,a,n,r){var i,o;if(n){i=n.getUiState().getSelectionVariant();if(typeof i!=="string"){i=JSON.stringify(i)}}o=H(t,a,e.getView().getBindingContext(),i);var s={semanticObject:t.semanticObject,action:t.action};e.adaptNavigationParameterExtension(o,s);if(!r){S.setComponentRefreshBehaviour(t)}E.oApplication.navigateExternal(t.semanticObject,t.action,o.toJSONString(),null,S.handleError)}function j(t,a){var n=E.oApplication.getNavigationHandler();var r={semanticObject:t.semanticObject,action:t.action};var i=n.mixAttributesAndSelectionVariant(t.semanticAttributes);S.removePropertiesFromNavigationContext(i,a);e.adaptNavigationParameterExtension(i,r);S.setComponentRefreshBehaviour(t);E.oApplication.navigateExternal(t.semanticObject,t.action,i.toJSONString(),null,S.handleError)}function W(e,t){var a=e.byId("icon");var n=a&&a.getSrc();if(n===""){n=undefined}var r=e.byId("title");var i=r&&r.getText();if(i===""){i=undefined}var o=e.byId("description");var s=o&&o.getText();if(s===""){s=undefined}for(var c=0;c<t.length;c++){var u=t[c];var g=l.getStableIdPartFromFacet(u)+"::contactTitleAreaIcon";var f=e.byId(g);var p=l.getStableIdPartFromFacet(u)+"::contactTitleAreaTitle";var v=e.byId(p);var d=l.getStableIdPartFromFacet(u)+"::contactTitleAreaDescription";var m=e.byId(d);var C=f&&f.getSrc();if(C===""){C=undefined}var E=v&&v.getText();if(E===""){E=undefined}var h=m&&m.getText();if(h===""){h=undefined}if(n&&C&&i&&E&&s&&h){if((n===C||!C)&&(i===E||!E)&&(s===h||!h)){var y=l.getStableIdPartFromFacet(u)+"::contactTitleArea";var P=e.byId(y);if(P&&P.setVisible){P.setVisible(false)}}}}}function K(t,a,n,r){var i=e.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var o=i.crossNavigation.outbounds[t.data("CrossNavigation")];k(o,a?[a]:[],n,r)}function q(e,t){var a=v({},e);S.fnProcessDataLossOrDraftDiscardConfirmation(function(){var e=a.data("SemanticObject");var t=a.data("Action");var n=a.data("SemanticAttributes");if(e&&t){var r={semanticObject:e,action:t};if(n){n="{"+n+"}";r.semanticAttributes=JSON.parse(n)}j(r,a)}},Function.prototype,"LeaveApp")}function J(t,a,n,r,i){var o,g,f;var p=e.getOwnerComponent().getModel().getMetaModel();var v=p.getODataEntitySet(t);var d=function(){var t=function(){var t=n.originalId;var a=e.getView().byId(t);if(!a){var r=document.querySelector("#"+t.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(r){var i=r.closest("[data-sap-ui]");if(i){a=sap.ui.getCore().byId(i.id)}}}return a};var a=u.getParameterModelForTemplating().oData.templateSpecific.targetEntities[v.entityType].mTargetEntities;g=t();f=g.getBindingContext().getPath();o=g&&g.mProperties.fieldName;if(a[o]){var r=a[o].entityType;var i=p.getODataEntityContainer().entitySet.find(function(e){return e.entityType==r}).name;var s={navigation:a[o].navName,entitySet:i,entityType:r};var l=p.getODataEntityType(r);if(l&&l["com.sap.vocabularies.UI.v1.HeaderInfo"]){var c=p.getODataEntityType(r,true)+"/com.sap.vocabularies.UI.v1.HeaderInfo";s.headerInfoPath=c}if(l&&l["com.sap.vocabularies.UI.v1.QuickViewFacets"]){var d=p.getODataEntityType(r,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";s.quickViewFacetODataPath=d}if(s.headerInfoPath||s.quickViewFacetODataPath){return s}}};var E=d();var h=false;var y=false;var b=false;var S=[];if(E){if(E.quickViewFacetODataPath){var T=p.createBindingContext(E.quickViewFacetODataPath,true);var I=T&&T.getModel().getObject(T.getPath());if(I){h=true;for(var x=0;x<I.length;x++){var D=I[x];if(D&&D.Target&&D.Target.AnnotationPath){if(D.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){y=true}else if(D.Target.AnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){b=true;S.push(D)}}}}}}var A=n.mainNavigation;var O=function(){if(h){var f,d;f=p.getODataEntitySet(t);d=p.getODataEntityType(f.entityType);var P=E.headerInfoPath&&p.createBindingContext(E.headerInfoPath,true);var I=n.semanticObject;var x,D;if(I&&A){var O=A.getTarget&&A.getTarget()||"";var _=A.getKey&&A.getKey();if(_){var N=_.split(I+"-");x=N&&N[1];if(I&&x){D={Target:O,SemanticObject:I,Action:x}}if(n.semanticAttributes){D.SemanticAttributes=n.semanticAttributes;for(var R in n.semanticAttributes){var F=n.semanticAttributes[R];if(F.indexOf('{"__deferred":')>-1){delete D.SemanticAttributes[R]}if(F.indexOf('{"__ref":')>-1){delete D.SemanticAttributes[R]}}if(D.SemanticAttributes){var L=JSON.stringify(D.SemanticAttributes);if(L&&L.length>1){D.SemanticAttributes=L.substring(1,L.length-1)}}}}}var M=p.getODataProperty(d,o);var w=new s({sourceClickedField:M,sourceEntityType:d,showFieldGroup:y,showContact:b,ignoredFields:a,navigationPath:E.navigation,mainNavigation:D});w.setDefaultBindingMode("OneWay");var B;var G=c.extend("",{oState:r,_templateEventHandlers:{onSemanticObjectLinkNavigationPressed:e._templateEventHandlers.onSemanticObjectLinkNavigationPressed.bind(e._templateEventHandlers),onDataFieldWithIntentBasedNavigation:e._templateEventHandlers.onDataFieldWithIntentBasedNavigation.bind(e._templateEventHandlers)},onInit:function(){},onExit:function(){},onAfterRendering:function(){var e=this.oView;var t=e.getParent().getParent().getParent();t.setBusy(false)}});B=new G;G.connectToView=e.connectToView.bind(B);var U=function(e){var t=e.getSource();if(t){var a=t.getParent().getParent().getParent();a.setBusy(true);a.setBusyIndicatorDelay(10)}};m.create({preprocessors:{xml:{bindingContexts:{sourceEntitySet:p.createBindingContext(p.getODataEntitySet(t,true)),entitySet:p.createBindingContext(p.getODataEntitySet(E.entitySet,true)),header:P,facetCollection:T},models:{sourceEntitySet:p,entitySet:p,header:p,facetCollection:p,quickView:w,parameter:u.getParameterModelForTemplating()}}},controller:B,viewName:"sap.suite.ui.generic.template.fragments.QuickViewSmartForm",height:"100%"}).then(function(e){n.show(undefined,undefined,undefined,e);e.attachBeforeRendering(U.bind(this));var t=function(e){var t=e.getSource();if(t){var a=t.byId("ownTitleArea");if(a){var n=t.getParent();if(n&&n.getItems){var r=n.getItems()&&n.getItems()[0];if(r&&r!=t){r.setVisible(false)}}}if(b&&S&&a){W(t,S)}}};e.attachAfterRendering(t.bind(this))}.bind(this))}else{if(g.getFieldName){var V=p.getODataEntityType(v.entityType);var H=V.property.find(function(e){return e.name===o});var k="descriptionAndId";if(H){k=l.getTextArrangement(V,H)}var j=g.getBinding("text").getValue();if(Array.isArray(j)){var K=C.getTextsFromDisplayBehaviour(k,j[0],j[1]);if(A){A.setDescription(K.secondText)}i=K.firstText}}n.show(i,A,undefined,undefined)}};O.call(this);if(false&&!y&&S&&S.length&&S.length<2){var _=e.getOwnerComponent().getModel();var N=_.getContext(f);var R=N.getProperty(E.navigation);var F=p.getODataEntityType(E.entityType);var L=S[0].Target.AnnotationPath&&S[0].Target.AnnotationPath.replace("@","");var M=F[L];var w="",B;if(M.email&&M.email[0]){B=M.email[0].type&&M.email[0].type.EnumMember;if(B&&B.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1){if(M.email[0].address&&M.email[0].address.Path){w=R[M.email[0].address.Path]}else{w=M.email[0].address&&M.email[0].address.String}}}}var G=true;if(!G){P.getServiceAsync().then(function(e){if(typeof e.isContactsCollaborationSupported==="function"&&e.isContactsCollaborationSupported()){return e.enableContactsCollaboration(w)}else{return Promise.reject()}}).then(function(e){e.openBy(g)}).catch(function(e){O.call(this)}.bind(this))}}function z(e){return new Promise(function(t){S.fnProcessDataLossOrDraftDiscardConfirmation(function(){S.setComponentRefreshBehaviour({semanticObject:e.semanticObject,action:e.href.split("?")[0].split("-")[1]});t(true)},function(){t(false)},"LeaveApp")})}function Y(e,t){var a=e.getView&&e.getView().getBindingContext();var n=a.getObject();var r=e.getOwnerComponent().getModel().getMetaModel();var i=r.getODataEntitySet(e.getOwnerComponent().getEntitySet());var o=r.getODataEntityType(i.entityType);var s=o["com.sap.vocabularies.Common.v1.SemanticKey"];var l={};if(s&&s.length>0){for(var c=0;c<s.length;c++){var u=s[c].PropertyPath;if(!l[u]){l[u]=[];l[u].push(n[u])}}}else{for(var g in o.key.propertyRef){var f=o.key.propertyRef[g].name;if(!l[f]){l[f]=[];l[f].push(n[f])}}}return l}function Q(e,t,a,n){if(e[t].entitySet==a&&n===e[t].navigationProperty&&e[t].navigation&&e[t].navigation["display"]&&(e[t].component&&e[t].component.settings&&e[t].component.settings.hideChevronForUnauthorizedExtNav===true)){return e[t].navigation.display.target}else if(e[t].entitySet==a&&e[t].navigation&&e[t].navigation["display"]&&(e[t].component&&e[t].component.settings&&e[t].component.settings.hideChevronForUnauthorizedExtNav===true)){return e[t].navigation.display.target}else if(e[t].pages){for(var r=0;r<e[t].pages.length;r++){var i=Q(e[t].pages,r,a,n);if(i!==undefined&&i!==null){return i}}}}function X(t){var a=t.getTable();var n=t.getEntitySet();var i=t.getTableBindingPath();var o=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");var s=e.getOwnerComponent().getAppComponent().getConfig().pages;var l=Q(s,0,n,i);if(l!==undefined&&l!==null&&o){var c=e.getOwnerComponent().getAppComponent().getManifestEntry("sap.app").crossNavigation.outbounds[l];if(c){var u=c.semanticObject;var g=c.action;var v=e.getView().getModel("_templPriv");var d=v.getProperty("/generic/supportedIntents/");var m=i===""?n:n+"::"+i;var C=v.getProperty("/generic/supportedIntents/"+u+"/"+g+"/"+m);if(!C){var E={},h;var y=e.getOwnerComponent().getAppComponent();for(var P in c.parameters){if(!p(c.parameters[P])){E[P]=c.parameters[P]}}if(e.getMetadata().getName()==="sap.suite.ui.generic.template.ObjectPage.view.Details"){h=Y(e,y)}var b={semanticObject:u,action:g};var S=f({},h,E);var T={target:b,params:S};var I=o.isNavigationSupported([T],y);I.done(function(e){var t=v.getProperty("/generic/supportedIntents/"+u);if(!t){d[u]={};d[u][g]={};d[u][g][m]={supported:e[0].supported}}else if(!t[g]){t[g]={};t[g][m]={supported:e[0].supported}}else{t[g][m]={supported:e[0].supported}}v.updateBindings();if(e[0].supported&&r.isUiTable(a)){var n=a.getRowActionTemplate();n.getItems()[0].setVisible(true);a.setRowActionTemplate(n)}})}}}}function $(e){if(r.isSmartTable(e)){S.setEnabledToolbarButtons(e);X(e)}}function Z(t,a){var i=t.getSource();var o=i.getTable();var s=r.isMTable(o);var l=o.getColumns();if(!a||a&&a.isPopinWithoutHeader&&s){for(var c=0;c<l.length;c++){var u=l[c].data("p13nData")&&l[c].data("p13nData").columnKey;if(u&&(u.search("template::DataFieldForIntentBasedNavigation")>-1||u.search("template::DataFieldForAction")>-1)){l[c].setPopinDisplay("WithoutHeader")}}}var g=t.getParameter("bindingParams");g.parameters=g.parameters||{};var f=a.getSearchString&&a.getSearchString();if(f){g.parameters.custom={search:f}}var p=i.getCustomData();var v={};for(var d=0;d<p.length;d++){v[p[d].getKey()]=p[d].getValue()}var m=v.InitialExpansionLevel;if(m){g.parameters.numberOfExpandedLevels=parseInt(m,10)}var C=[];var h=[];function y(e,t,n,r,i){for(var o=0;o<e.length;o++){var s=e[o];if(s){var l=t.getODataProperty(n,s);if(l){var c=l["com.sap.vocabularies.Common.v1.FieldControl"];if(c&&c!==" "&&c.Path){if(a.isFieldControlRequired||h.indexOf(s)!==-1){C.push(c.Path)}}}}}var u=r["Org.OData.Capabilities.V1.DeleteRestrictions"];C.push(u&&u.Deletable&&u.Deletable.Path);var g=r["Org.OData.Capabilities.V1.UpdateRestrictions"];C.push(g&&g.Updatable&&g.Updatable.Path);var f=n[i+"@com.sap.vocabularies.UI.v1.Criticality"];C.push(f&&f.Path)}function P(e,t,a){var n,r=[];if(e.Value&&e.Value.Path){n=t.getODataProperty(a,e.Value.Path);if(n){if(n["com.sap.vocabularies.Common.v1.Text"]){r[0]=n["com.sap.vocabularies.Common.v1.Text"].Path}if(n["sap:text"]){r[0]=n["sap:text"]}}if(!r[0]){r[0]=e.Value.Path}}if(e.SemanticObject&&e.SemanticObject.Path){r.push(e.SemanticObject.Path)}if(e.Action&&e.Action.Path){r.push(e.Action.Path)}return r}function b(e,t){var a=t.getODataFunctionImport(e.Action.String,true);if(a){var n=t.getObject(a);if(n["sap:action-for"]!==" "&&n["sap:applicable-path"]!==" "){return n["sap:applicable-path"]}}return null}function T(e,t){var a=[];if(e.Target&&e.Target.AnnotationPath){var n=e.Target.AnnotationPath;var r=n.split("@")[1];var i=t[r];if(i&&i.MeasureAttributes){if(i.MeasureAttributes[0]&&i.MeasureAttributes[0].DataPoint&&i.MeasureAttributes[0].DataPoint.AnnotationPath){var o=i.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var s=t[o];if(s){for(var l in s){a.push(s[l]&&s[l].Path);if(l==="CriticalityCalculation"&&s.CriticalityCalculation){for(var c in s.CriticalityCalculation){a.push(s.CriticalityCalculation[c].Path)}}}}}}a.push(i&&i.Measures&&i.Measures[0]&&i.Measures[0].PropertyPath)}return a}a=a||Object.create(null);a.setBindingPath=i.setTableBindingPath.bind(i);a.addNecessaryFields=function(e,t,r){var o=i.getModel().getMetaModel();var s=o.getODataEntitySet(r);var l=o.getODataEntityType(s.entityType);if(e.length>0){var c=i.data("lineItemQualifier");var u="com.sap.vocabularies.UI.v1.LineItem"+(c?"#"+c:"");var f=l[u]||[];for(var p=0;p<f.length;p++){switch(f[p].RecordType){default:break;case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":var d=P(f[p],o,l);if(d){C=C.concat(d)}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":if(a.isDataFieldForActionRequired){var m=b(f[p],o);if(m){h.push(m);C.push(m)}}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":var I=f[p];if(I.Target&&I.Target.AnnotationPath&&I.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>=0){var x=I.Target.AnnotationPath;var D=l[x.split("@")[1]];f=f.concat(D&&D.Data);continue}var A=T(I,l);for(var O=0;O<A.length;O++){if(A[O]){C.push(A[O])}}break}}if(a.isFieldControlsPathRequired){y(e,o,l,s,u);var _=S.getBreakoutActions(i);for(var N in _){C.push(_[N].requiresSelection&&_[N].applicablePath)}var R=E.oDraftController.getDraftContext();if(R.isDraftEnabled(r)&&R.isDraftRoot(r)&&R.hasDraftAdministrativeData(r)){if(e.length>0){C.push("DraftAdministrativeData")}}}}var F=i.fetchVariant();if(!v.TemplateSortOrder&&a&&a.determineSortOrder){v.TemplateSortOrder=a.determineSortOrder()}if((!F||!F.sort)&&v.TemplateSortOrder){var L=v.TemplateSortOrder.split(", ");for(var M=0;M<L.length;M++){var w=L[M].split(" ");if(w.length>1){g.sorter.push(new n(w[0],w[1]==="true"))}else{g.sorter.push(new n(w[0]))}}}for(var B=0;B<C.length;B++){t(C[B])}};var I=e.byId(i.getSmartFilterId()||"listReportFilter");S.onBeforeRebindTableOrChart(t,a,I)}function ee(n,r,i,o,s,l){var c=new t("press",n,r);o=o||n.getBindingContext();if(e.onListNavigationExtension&&e.onListNavigationExtension(c,o,s)){return}var u=T(c);if(n.data("CrossNavigation")){var f=u.getEntitySet();S.setExternalChevronRefreshBehaviour(f);K(n,o,i.oSmartFilterbar,Object.create(null),true);return}O(n,i);var p=e.getOwnerComponent();var v=!!p.getEditFlow&&p.getEditFlow()==="direct";if(v){var m=u.getEntitySet();var C=d.directEdit(E.oTransactionController,m,o.sPath,o.getModel(),E.oApplication,S,E.oViewDependencyHelper,l,v);C.then(function(e){S.navigateFromListItem(e.context,s,v)},function(t){if(t.lockedByUser){var n=S.getText("ST_GENERIC_DRAFT_LOCKED_BY_USER",[" ",t.lockedByUser]);a.error(n)}else{g.handleError(g.operations.editEntity,e,E,t);if(l&&l.navigateUp){l.navigateUp()}}})}else{S.navigateFromListItem(o,s)}}function te(e,t,a,n,i){var o,s={};if(e.getMetadata().getName()==="sap.ui.base.Event"){o=e.getSource();s=e.getParameters();if(r.isMTable(o)){o=e.getParameter("listItem");s.id=o.getId()}}else{o=e}if(n){ee(o,s,t,a,true,i)}else{var l=u.getViewLevel();var c=E.oApplication.getCurrentKeys(l+1);var g=c.length>l+1;if(o.data("CrossNavigation")||!o.data("CrossNavigation")&&!u.isDraftEnabled()){S.fnProcessDataLossOrDraftDiscardConfirmation(ee.bind(null,o,s,t,a,g),Function.prototype,"LeaveApp")}else{ee(o,s,t,a,g,i)}}}function ae(e){E.oApplication.performAfterSideEffectExecution(function(){if(E.oApplication.getBusyHelper().isBusy()){b.info("Ignore incorrect selection, since app is busy anyway");return}var t=e?"ST_GENERIC_MULTIPLE_ITEMS_SELECTED":"ST_GENERIC_NO_ITEM_SELECTED";a.error(S.getText(t),{styleClass:S.getContentDensityClass()})})}function ne(t){var n,r,i;var o=e.getOwnerComponent(),s=t.getSource().getCustomData(),l="10rem";if(s.length===0){return}for(r=0,i=s.length;r<i;r++){if(s[r].getProperty("key")==="Target"){n=s[r].getProperty("value");break}}if(!n){a.show(S.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:S.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:S.getText("ST_GENERIC_ERROR_IN_NAVIGATION_PROPERTY_MISSING",["DataFieldWithNavigationPath"])});return}var c=o.getModel(),g=c.getMetaModel();var f=t.getSource().getBindingContext().getPath(),p=f.slice(1,f.indexOf("(")),v=g.getODataEntityType(g.getODataEntitySet(p).entityType),d,m=false,C=v.navigationProperty.length;for(d=0;d<C;d++){if(v.navigationProperty[d].name===n){m=true;break}}if(!m){a.show(S.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:S.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:S.getText("ST_GENERIC_ERROR_NAVIGATION_PROPERTY_NOT_CORRECT",[n,"DataFieldWithNavigationPath"])});return}var h=g.getODataAssociationEnd(v,n),y=g.getODataEntityType(h.type),P,b;if(y){P=y.namespace+"."+y.name}var T=g.getODataEntityContainer().entitySet;for(r=0,i=T.length;r<i;r++){if(T[r].entityType===P){b=T[r].name;break}}if(!b){var I=P.split(".")[1];I=I.slice(0,I.length-4);a.show(S.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:S.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:S.getText("ST_NAV_ERROR_TARGET_ENTITYSET_IS_MISSING",[I])});return}var x=S.getNavigationKeyProperties(b),D=E.oNavigationController,A={$expand:""};if(u.isDraftEnabled()){A={$expand:"DraftAdministrativeData"}}var O=new Promise(function(e,t){c.read(f+"/"+n,{urlParameters:A,success:function(t){E.oApplicationController.synchronizeDraftAsync().then(function(){e(t);E.oApplication.invalidatePaginatorInfo();var a=S.mergeNavigationKeyPropertiesWithValues(x,t);E.oApplication.setStoredTargetLayoutToFullscreen(1);D.navigateToContext(a,null,false)})},error:function(e){t(e)}})});u.getBusyHelper().setBusy(O)}function re(e,t){var a=e.getSource();var n=E.oPresentationControlHandlerFactory.getPresentationControlHandler(S.getOwnerPresentationControl(a)).getSelectedContexts();n=n.filter(function(e){return e&&!e.isTransient()});var r=S.getCustomDataFromEvent(e);oe(r,n,t.oSmartFilterbar)}function ie(e,t){var a=e.getSource();var n=a.getParent().getBindingContext();var r=a.data("SemanticObject");var i=a.data("Action");S.fnProcessDataLossOrDraftDiscardConfirmation(function(){var e={action:i,semanticObject:r};k(e,[n],t.oSmartFilterbar||undefined)},Function.prototype,"LeaveApp")}function oe(e,t,a){var n={action:e.Action,semanticObject:e.SemanticObject};k(n,t,a||undefined)}function se(e,t,a){var n=S.getElementCustomData(e);var r=!(n.RequiresContext&&n.RequiresContext==="false");if(r&&!t.length){ae(t.length)}else{S.fnProcessDataLossOrDraftDiscardConfirmation(function(){oe(n,t,a)},Function.prototype,"LeaveApp")}}function le(e,t){S.fnProcessDataLossOrDraftDiscardConfirmation(function(){var a={semanticObject:e.data("SemanticObject"),action:e.data("Action")};var n=e.getParent().getBindingContext();k(a,[n],t.oSmartFilterbar)},Function.prototype,"LeaveApp")}function ce(e){var t=e.getSource();var a=S.getOwnerControl(t).getParent();var n=[t.getBindingContext()];var r=S.getElementCustomData(t);var i=a.getEntitySet();S.triggerAction(n,i,r,E.oPresentationControlHandlerFactory.getPresentationControlHandler(a))}var ue;var ge;function fe(e){ue=new Promise(function(t){ge=t;var a=e.getSource();var n=a.getBindingContext().getPath();var r=a.getModel();var i=r.getProperty(n);var o=r.getETag(undefined,undefined,i);a.removeAllHeaderParameters();var s=a.getModel().getHeaders()["x-csrf-token"];if(s){var l=new h;l.setName("x-csrf-token");l.setValue(s);a.addHeaderParameter(l)}if(a.FUEl.files[0].name){var c=new h;var u="filename="+a.FUEl.files[0].name;c.setName("Content-Disposition");c.setValue(u);a.addHeaderParameter(c)}if(a.FUEl.files[0].type){var g=new h;var f=a.FUEl.files[0].type;g.setName("Content-Type");g.setValue(f);a.addHeaderParameter(g)}if(o){var p=new h;p.setName("If-Match");p.setValue(o);a.addHeaderParameter(p)}var v=new h;v.setName("Accept");v.setValue("application/json");a.addHeaderParameter(v);a.checkFileReadable().then(function(){a.upload()},function(e){sap.m.MessageToast.show("The file cannot be read. It may have changed.")}).then(function(){a.clear()})});var t=E.oApplication.getBusyHelper();t.setBusy(ue)}function pe(t){ge();var n=t.getParameter("status");if(n>=400){var r=t.getParameter("responseRaw")||t.getParameter("response"),i=r&&JSON.parse(r);if(i){a.error(i.error&&i.error.message)}}else{var o=t.getSource();var s=o.getParent().data("sNavigationProperty");var l=e.getView().getModel("_templPriv");var c=e.getOwnerComponent().getEntitySet();var u;var g=o.getUploadUrl();u={};if(s){l.setProperty("/generic/controlProperties/"+"fileUploader/"+s,u)}else{l.setProperty("/generic/controlProperties/"+"fileUploader/"+c,u)}u.fileName=t.mParameters.fileName;var f=t.mParameters.requestHeaders.find(function(e){if(e.name==="Content-Type"){return e}});u.fileType=f.value;var p=y.getIconForMimeType(f.value);u.icon=p;u.url=g;if(s){l.setProperty("/generic/controlProperties/"+"fileUploader/"+s,u)}else{l.setProperty("/generic/controlProperties/"+"fileUploader/"+c,u)}var v=E.oApplication.getBusyHelper();var d=de(t.getSource());v.setBusy(d)}}function ve(t){var a=t.getSource();var n=[e.getView().getBindingContext().sPath+"/$value"];var r=E.oTransactionController.deleteEntities(n);var i=E.oApplication.getBusyHelper();r.then(function(){var e=de(a);i.setBusy(e)});i.setBusy(r)}function de(e){return new Promise(function(t){e.getModel().refresh();t()})}function me(t,a){var n=S.getCustomDataFromEvent(t);var r=a?a.getSelectedContexts():[e.getView().getBindingContext()];if(n.ActionFor&&r.length===0){ae(r.length)}else{var i=a?a.getEntitySet():e.getOwnerComponent().getEntitySet();S.triggerAction(r,i,n,a)}}function Ce(e,t){var a,n="";var i=T(e);var o=E.oPresentationControlHandlerFactory.getPresentationControlHandler(i).getSelectedContexts();var s=r.isSmartTable(i);if(s){a=i.getTable();n=i.getEntitySet()}else if(r.isSmartChart(i)){i.getChartAsync().then(function(e){a=e});n=i.getEntitySet()}var l=S.getCustomDataFromEvent(e);var c=he(o,l);var u=l.IsCopyAction==="true"?{ResultIsActiveEntity:true}:{};if(l.ActionFor&&c.inApplicableCount>0&&(s&&(a.getMode&&a.getMode()==="MultiSelect"||a.getSelectionMode&&a.getSelectionMode()==="MultiToggle"))){var g=S.getText("ST_GENERIC_WARNING_TEXT",[c.inApplicableCount]);c.warningText=g;var f={functionImportPath:l.Action,contexts:c.aApplicableContexts,sourceControl:a,label:l.Label,operationGrouping:l.InvocationGrouping,skipProperties:u,sEntitySet:n,oState:t};Ee(i).then(function(e){var t=e.getModel("Action");t.setData(f);var a=new sap.ui.model.json.JSONModel(c);e.setModel(a,"list");var n=e.getModel("list");n.setData(c);e.open()})}else{ye({functionImportPath:l.Action,contexts:o,sourceControl:a,label:l.Label,operationGrouping:l.InvocationGrouping,skipProperties:u},t,n)}}function Ee(e){return S.getDialogFragmentAsync("sap.suite.ui.generic.template.fragments.ActionConfirmation",{onCancel:function(e){var t=e.getSource().getParent();t.close()},onContinue:function(e){var t=e.getSource().getParent();var a=e.getSource().getParent().getModel("Action").getData();ye({functionImportPath:a.functionImportPath,contexts:a.contexts,sourceControl:a.sourceControl,label:a.label,operationGrouping:a.operationGrouping},a.oState,a.sEntitySet);t.close()}},"Action")}function he(t,a){var n,r,o,s,l;var c=e.getView().getModel();var u=c.getMetaModel();if(t&&t.length>0){o=t[0].sPath.substring(1,t[0].sPath.indexOf("("));s=u.getODataEntitySet(o)}if(s){var g=a.Action.split("/")[1];var f=[],p=[];var v={aInApplicableItems:undefined,inApplicableCount:0,dialogTitle:a.Label,warningText:undefined,aApplicableContexts:undefined};if(g){r=u.getODataFunctionImport(g)["sap:applicable-path"]}var d=e.getView().getModel("@i18n")&&e.getView().getModel("@i18n").getResourceBundle();var m=i.getAnnotationFormatter(c,o,"/com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value",d);for(var C=0;C<t.length;C++){l=t[C];n=c.getObject(t[C].getPath());if(r&&n[r]===false||l.isTransient()){v.inApplicableCount++;f.push({sKey:m.format(l)})}else{p.push(l)}}m.done();v.aInApplicableItems=f;v.aApplicableContexts=p}return v}function ye(t,a,n){E.oDataLossHandler.performIfNoDataLoss(function(){E.oCRUDManager.callAction({functionImportPath:t.functionImportPath,contexts:t.contexts,sourceControlHandler:E.oPresentationControlHandlerFactory.getPresentationControlHandler(S.getOwnerPresentationControl(t.sourceControl)),label:t.label,operationGrouping:t.operationGrouping,skipProperties:t.skipProperties},a).then(function(t){if(t){t.some(function(t){if(t.response&&t.context&&(!t.actionContext||t.actionContext&&t.context.getPath()!==t.actionContext.getPath())){E.oViewDependencyHelper.setMeToDirty(e.getOwnerComponent(),n);return true}})}},Function.prototype)},Function.prototype,"Proceed")}function Pe(e){E.oApplication.setNextFocus(function(e,t){t({isCreate:true})});return e}function be(e,t){E.oApplication.setNextFocus(function(){e.setFocusOnFirstEditableFieldInTableRow(t)})}function Se(t,a,n,r,i,o){var s=S.getOwnerControl(t,true);var l=s.getEntitySet();var c=e.getOwnerComponent();var g=E.oApplication.getBusyHelper();if(t.data("CrossNavigation")){E.oViewDependencyHelper.setMeToDirty(c,l,true);K(t,t.getBindingContext(),n,Object.create(null),true);return Promise.resolve()}var f=u.getNonDraftCreatePromise(l,r);if(f){var p=f.then(Pe);g.setBusy(p);return p}var v=function(e){var t=E.oCRUDManager.addEntry(s,e).then(function(e){if(o){return e}else if(!a){Pe();E.oViewDependencyHelper.setMeToDirty(c,l);E.oApplication.navigateToSubContext(e,false,4)}else if(!i){var t=E.oPresentationControlHandlerFactory.getPresentationControlHandler(s);var n=t.refresh();g.setBusy(n.then(function(){be(t,e)}));E.oApplicationController.executeSideEffects(c.getBindingContext(),[],[s.getTableBindingPath()]);return e}});t.catch(Function.prototype);return t};if(r instanceof Promise){return r.then(v)}else{return v(r)}}function Te(a){var n={batchGroupId:"Changes",changeSetId:"Changes",draftSave:true,noBlockUI:true,noShowResponse:true,onlyIfPending:true,pendingChanges:true,forceSubmit:true},r,i=true;if(a instanceof t){i=false;r=a.getSource()}if(u.isDraftEnabled()&&!i){var o=e.getView();var s=a.getSource().getBindingContext();var l=r.getDataProperty&&r.getDataProperty().typePath;var c=r.getInnerControls();var g=c&&c[0]&&c[0].getFieldGroupIds&&c[0].getFieldGroupIds()||[];for(var f=0;f<g.length;f++){var p=o.data(g[f]);var v=false;var d=E.oApplicationController._getSideEffect(p);var m=d&&d.SourceProperties||[];for(var C=0;C<m.length;C++){if(m[C].PropertyPath===l){v=true}}if(v){var h=E.oApplicationController._getSideEffectsQualifier(p.name);E.oApplicationController.registerGroupChange(h)}}a.getSource()._getComputedMetadata().then(function(e){E.oApplicationController.executeSideEffects(s,[],[e.navigationPath])})}E.oTransactionController.triggerSubmitChanges(n)}function Ie(e){var t=T(e);var a=e.getParameter("listItem");var n=a.getBindingContext();De(t,[n])}function xe(e){var t=T(e);var a=E.oPresentationControlHandlerFactory.getPresentationControlHandler(t).getSelectedContexts();De(t,a)}function De(t,n){if(n.length>0){var r=w(n,t);var i=Promise.resolve(e.beforeDeleteExtension({aContexts:n}));i.then(function(e){var a=E.oApplication.getBusyHelper();a.setBusy(r);r.then(function(a){f(a.text,e);R(t).then(function(e){var t=e.getModel("delete");t.setData(a);e.open()})},Function.prototype)})}else{a.error(S.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:S.getContentDensityClass()})}}function Ae(e){var t=e.getSource();var a=t.getModel();var n=JSON.parse(e.getSource().data("contactDetails"));var r=a.getContext(e.getSource().getBindingContext().getPath());var i="",o;if(n.email&&n.email[0]){o=n.email[0].type&&n.email[0].type.EnumMember;if(o&&o.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1){if(n.email[0].address&&n.email[0].address.Path){i=r.getProperty(n.email[0].address.Path)}else{i=n.email[0].address&&n.email[0].address.String}}}var s=function(){S.getDialogFragmentAsync("sap.suite.ui.generic.template.fragments.ContactDetails",{},"contact").then(function(e){var a=e.getModel("contact");var o;a.setProperty("/",{});a.setProperty("/device",sap.ui.Device);n.fn&&n.fn.Path?a.setProperty("/fn",r.getProperty(n.fn.Path)):a.setProperty("/fn",n.fn&&n.fn.String);n.title&&n.title.Path?a.setProperty("/title",r.getProperty(n.title.Path)):a.setProperty("/title",n.title&&n.title.String);n.photo&&n.photo.Path?a.setProperty("/photo",r.getProperty(n.photo.Path)):a.setProperty("/photo",n.photo&&n.photo.String);n.role&&n.role.Path?a.setProperty("/role",r.getProperty(n.role.Path)):a.setProperty("/role",n.role&&n.role.String);n.org&&n.org.Path?a.setProperty("/org",r.getProperty(n.org&&n.org.Path)):a.setProperty("/org",n.org&&n.org.String);a.setProperty("/email",i);if(n.adr&&n.adr[0]&&!a.getProperty("/adr")){o=n.adr[0].type&&n.adr[0].type.EnumMember;if(o&&o.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType")>-1){var s=Oe(r,n);a.setProperty("/adr",s)}}var l=n.tel&&n.tel.length||0;for(var c=0;c<l;c++){if(n.tel[c]&&!a.getProperty("/fax")){o=n.tel[c].type&&n.tel[c].type.EnumMember;if(o&&o.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/fax")>-1){if(n.tel[c].uri&&n.tel[c].uri.Path){a.setProperty("/fax",r.getProperty(n.tel[c].uri.Path))}else{a.setProperty("/fax",n.tel[c].uri&&n.tel[c].uri.String)}continue}}if(n.tel[c]&&!a.getProperty("/cell")){o=n.tel[c].type&&n.tel[c].type.EnumMember;if(o&&o.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/cell")>-1){if(n.tel[c].uri&&n.tel[c].uri.Path){a.setProperty("/cell",r.getProperty(n.tel[c].uri.Path))}else{a.setProperty("/cell",n.tel[c].uri&&n.tel[c].uri.String)}continue}}if(n.tel[c]&&!a.getProperty("/work")){o=n.tel[c].type&&n.tel[c].type.EnumMember;if(o&&o.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/work")>-1){if(n.tel[c].uri&&n.tel[c].uri.Path){a.setProperty("/work",r.getProperty(n.tel[c].uri.Path))}else{a.setProperty("/work",n.tel[c].uri&&n.tel[c].uri.String)}continue}}}e.openBy(t)})};s.call(this);var l=true;if(!l){P.getServiceAsync().then(function(e){if(typeof e.isContactsCollaborationSupported==="function"&&e.isContactsCollaborationSupported()){return e.enableContactsCollaboration(i)}else{return Promise.reject()}}).then(function(e){e.openBy(t)}).catch(function(e){s.call(this)})}}function Oe(e,t){if(t.adr[0].label&&t.adr[0].label.Path){return e.getProperty(t.adr[0].label.Path)}else if(t.adr[0].label&&t.adr[0].label.String){return t.adr[0].label.String}else{var a="";if(t.adr[0].street&&t.adr[0].street.Path){a+=e.getProperty(t.adr[0].street.Path)+", "}else if(t.adr[0].street&&t.adr[0].street.String){a+=t.adr[0].street.String+", "}if(t.adr[0].code&&t.adr[0].code.Path){a+=e.getProperty(t.adr[0].code.Path)+", "}else if(t.adr[0].code&&t.adr[0].code.String){a+=t.adr[0].code.String+", "}if(t.adr[0].locality&&t.adr[0].locality.Path){a+=e.getProperty(t.adr[0].locality.Path)+", "}else if(t.adr[0].locality&&t.adr[0].locality.String){a+=t.adr[0].locality.String+", "}if(t.adr[0].region&&t.adr[0].region.Path){a+=e.getProperty(t.adr[0].region.Path)+", "}else if(t.adr[0].region&&t.adr[0].region.String){a+=t.adr[0].region.String+", "}if(t.adr[0].country&&t.adr[0].country.Path){a+=e.getProperty(t.adr[0].country.Path)+", "}else if(t.adr[0].country&&t.adr[0].country.String){a+=t.adr[0].country.String+", "}return a.slice(0,a.length-2)}}function _e(t,a){var n=H(t,[],a);e.adaptNavigationParameterExtension(n,t);S.setComponentRefreshBehaviour(t);E.oApplication.navigateExternal(t.semanticObject,t.action,n.toJSONString(),null,S.handleError)}function Ne(e,t){var a=e.getSource();Re(a,t)}function Re(e,t){var a=e.data("LabelId");var n=t+"--"+a;var r=sap.ui.getCore().byId(n);if(r){r.attachFieldVisibilityChange(e)}}function Fe(t,a,n,r,i){var o=e.getOwnerComponent();var s=o.getAppComponent();var l;if(s.getFlexibleColumnLayout()){var c=o.getModel("_templPrivGlobal");l=c.getProperty("/generic/FCL/isVisuallyFullScreen")}else{l=true}var u=n?i:r;var g,f;if(t){if(a&&!l){f=[" ",t,a];g=u?"DELETE_SELECTED_ITEM_WITH_OBJECTINFO":"DELETE_WITH_OBJECTINFO"}else{f=[t];if(a){f.push(a)}g=u?"DELETE_SELECTED_ITEM_WITH_OBJECTTITLE":"DELETE_WITH_OBJECTTITLE"}}else{g=u?"DELETE_SELECTED_ITEM":"ST_GENERIC_DELETE_SELECTED"}return n&&i?S.getContextText(g,i.getId(),null,f):S.getText(g,f)}function Le(t){var a=t.getParameter("userExportSettings"),n=!!(a&&a.includeFilterSettings),r=t.getParameter("filterSettings"),i=t.getSource();if(n){S.transformTechnicalPropsOnExportedFile(r);S.includeEntitySetParametersToExportedFile(i,r)}var o={filterSettings:n?r:[],includeFilterSettings:n};e.onBeforeExportTableExtension(o)}var H=o.testable(H,"fnBuildSelectionVariantForNavigation");var I=o.testable(I,"fnEvaluateParameters");var k=o.testable(k,"fnNavigateIntent");var W=o.testable(W,"fnHideTitleArea");var G=o.testable(G,"fnGetSelectedItemContextForDeleteMessage");var w=o.testable(w,"getDataForDeleteDialog");var j=o.testable(j,"CommonEventHandlers_fnNavigateIntentSmartLink");return{onDataReceived:$,onBeforeRebindTable:Z,onListNavigate:te,onEditNavigateIntent:K,onRelatedAppNavigation:_e,onDataFieldWithNavigationPath:ne,onDataFieldForIntentBasedNavigation:re,onDeterminingDataFieldForIntentBasedNavigation:se,onDeterminingDataFieldForAction:me,onInlineDataFieldForIntentBasedNavigation:le,onDataFieldWithIntentBasedNavigation:ie,onInlineDataFieldForAction:ce,onMultiSelectionChange:_,onCallActionFromToolBar:Ce,addEntry:Se,deleteEntry:Ie,deleteEntries:xe,onContactDetails:Ae,onSmartFieldInitialise:Ne,onSmartLabelAttachFieldVisibility:Re,onSemanticObjectLinkNavigationTargetObtained:J,onSemanticObjectLinkNavigationPressed:q,onBeforeSemanticObjectLinkNavigationCallback:z,submitChangesForSmartMultiInput:Te,getSelectedItemContextForDeleteMessage:G,getDeleteText:Fe,uploadStream:fe,removeStream:ve,handleUploadComplete:pe,evaluateParameters:I,onBeforeExport:Le}}return e.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(e,t,a,n){f(this,S(e,t,a,n))}})});
//# sourceMappingURL=CommonEventHandlers.js.map