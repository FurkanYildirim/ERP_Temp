sap.ui.define(["sap/base/util/ObjectPath","sap/base/util/extend","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/ushell/ui/footerbar/AddBookmarkButton","sap/suite/ui/commons/collaboration/ServiceContainer","sap/ui/core/CustomData","sap/ui/performance/trace/FESRHelper"],function(e,t,a,i,n,s,r){"use strict";var o={};var u;function l(){var e=sap.ushell&&sap.ushell.Container;return e?new Promise(function(t){e.getFLPUrlAsync(true).done(function(e){t(e)})}):Promise.resolve(document.URL)}o.getCurrentUrl=l;o.setStaticShareData=function(t,a){var i=sap.ui.getCore().getLibraryResourceBundle("sap.m");a.setProperty("/emailButtonText",i.getText("SEMANTIC_CONTROL_SEND_EMAIL"));a.setProperty("/jamButtonText",i.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));var n=e.get("sap.ushell.Container.getUser");a.setProperty("/jamVisible",!!n&&n().isJamActive())};o.openJamShareDialog=function(e){l().then(function(t){var a=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:t,share:e}}});a.open()})};o.openSharePopup=function(e,t,a){var l;a.onCancelPressed=function(){l.close()};e.getDialogFragmentAsync("sap.suite.ui.generic.template.fragments.ShareSheet",a,"share",o.setStaticShareData,true).then(function(e){l=e;var o=l.getModel("share");a.getModelData().then(function(e){o.setData(e,true);var a=2;if(!o.getData().jamVisible){a=1}n.getServiceAsync().then(function(e){var n={isShareAsCardEnabled:o.getData().bEnableCollaborationShareAsCard};var c=e.getOptions(n);if(c.length>0){c.forEach(function(e){if(e.subOptions&&e.subOptions.length>1){var t=[];e.subOptions.forEach(function(e){var a=new sap.m.MenuItem({text:e.text,icon:e.icon,press:this.menuItemPress});a.addCustomData(new s({key:"data",value:e}));r.setSemanticStepname(a,"press",e.fesrStepName);t.push(a)}.bind(this));l.insertItem(new sap.m.MenuItem({text:e.text,icon:e.icon,items:t}),a)}else{var i=new sap.m.MenuItem({text:e.text,icon:e.icon,press:this.menuItemPress});i.addCustomData(new s({key:"data",value:e}));r.setSemanticStepname(i,"press",e.fesrStepName);l.insertItem(i,a)}a++}.bind(this))}u=new i("",{customUrl:o.getData().customUrl,serviceUrl:o.getData().serviceUrl,title:o.getData().title,subtitle:o.getData().subtitle,tileIcon:o.getData().icon});o.setProperty("/tileVisible",u.getEnabled());o.setProperty("/tileIcon",u.getIcon());o.setProperty("/tileText",u.getText());l.openBy(t)}.bind(this))}.bind(this))}.bind(this))};o.menuItemPress=function(){n.getServiceAsync().then(function(e){var t=this.getModel("share");var a="",i="";if(t.getData().subtitle!==undefined){a=t.getData().appTitle;i=t.getData().title+(t.getData().subtitle.length>0?" - "+t.getData().subtitle:"")}else{a=t.getData().title}var n={url:t.getData().currentUrl,appTitle:a,subTitle:i,minifyUrlForChat:true,appId:t.getData().appId};e.share(this.getCustomData()[0].getValue(),n)}.bind(this))};o.fireBookMarkPress=function(){u.firePress()};o.getCustomUrl=function(){if(!window.hasher){sap.ui.require("sap/ui/thirdparty/hasher")}var e=window.hasher.getHash();return e?"#"+e:window.location.href};return o});
//# sourceMappingURL=ShareUtils.js.map