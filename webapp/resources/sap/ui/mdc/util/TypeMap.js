/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/enums/BaseType","sap/ui/model/SimpleType","sap/base/util/ObjectPath","sap/ui/mdc/util/DateUtil","sap/base/util/merge"],function(e,t,a,n,r){"use strict";var i="yyyy-MM-dd";var s="HH:mm:ss";var o=new WeakMap;var u={};u._get=function(e){var t=this._getMap().get(e);if(typeof t==="string"){return this._get(t)}else if(t){return[e,t]}};u._set=function(e,t){var a=this._getMap();if(a._bFrozen){throw"TypeMap: You must not modify a frozen TypeMap"}a.set(e,t)};u._getMap=function(){var e=o.get(this);if(!e){e=new Map;o.set(this,e)}return e};u.set=function(e,t,a){this._set(e,[t,a])};u.setAlias=function(e,t){this._set(e,t)};u._getBaseType=function(e){var t=this._get(e);return t&&t[1][0]};u._getOptions=function(e){var t=this._get(e);return t&&t[1][1]};u._getClass=function(e){var t=this._get(e);return t&&t[0]};u.export=function(){return Array.from(this._getMap())};u.import=function(e){e.export().forEach(function(e){this._getMap().set(e[0],e[1])}.bind(this))};u.freeze=function(){this._getMap()._bFrozen=true};u.getBaseType=function(t,a,n){var r=this._getBaseType(t);return r&&(typeof r==="function"?r(a,n):r)||e.String};u.getBaseTypeForType=function(e){return this.getBaseType(e.getMetadata&&e.getMetadata().getName(),e.getFormatOptions(),e.getConstraints())};u.getDataTypeClassName=function(e){return this._getClass(e)||e};u.getDataTypeClass=function(e){var t=a.get(this.getDataTypeClassName(e)||"");if(!t){throw new Error("DataType '"+e+"' cannot be determined")}return t};u.getDataTypeInstance=function(e,t,a,n){var i=this.getDataTypeClass(e);var s=this._getOptions(i.getMetadata().getName());var o=s&&s(r({},t),r({},a),n);t=o&&o[0]||t;a=o&&o[1]||a;return new i(t,a)};u.getTypeConfig=function(e,t,a){var n=this._normalizeType.call(this,e,t,a);return{className:n.getMetadata().getName(),typeInstance:n,baseType:this.getBaseTypeForType(n)}};u.externalizeValue=function(t,a,r,o){var u=this._normalizeType.call(this,a,r,o);var p=this.getBaseTypeForType(u);switch(p){case e.DateTime:return n.typeToISO(t,u,p);case e.Date:return n.typeToString(t,u,i);case e.Time:return n.typeToString(t,u,s);case e.Boolean:return t;case e.Numeric:if(typeof t!=="string"&&(u.getMetadata().getName()==="sap.ui.model.odata.type.Int64"||u.getMetadata().getName()==="sap.ui.model.odata.type.Decimal")){return t.toString()}return t;default:return u.formatValue(t,"string")}};u.internalizeValue=function(t,a,r,o){var u=this._normalizeType.call(this,a,r,o);var p=this.getBaseTypeForType(u);switch(p){case e.DateTime:return n.ISOToType(t,u,p);case e.Date:if(t.indexOf("T")>=0){t=t.substr(0,t.indexOf("T"))}return n.stringToType(t,u,i);case e.Time:return n.stringToType(t,u,s);case e.Boolean:return t;case e.Numeric:if(typeof t!=="string"&&(u.getMetadata().getName()==="sap.ui.model.odata.type.Int64"||u.getMetadata().getName()==="sap.ui.model.odata.type.Decimal")){return t.toString()}return t;default:return u.parseValue(t,"string")}};u._normalizeType=function(e,a,n){if(e instanceof t){return e}return this.getDataTypeInstance(e,a,n)};u.initializeTypeFromValue=function(e,t){return{}};u.initializeInternalType=function(e,t){};return u});
//# sourceMappingURL=TypeMap.js.map