/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/field/content/DefaultContent","sap/ui/model/Filter","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/mdc/enums/FieldEditMode"],function(e,t,a,i,l,n){"use strict";var d=function(e,t,a,i,l,n){return e.getUnitTypeInstance?e.getUnitTypeInstance(t,l,n):e.getDataTypeInstance(t.getMetadata().getName(),a,i,{showNumber:l,showMeasure:n})};var r=Object.assign({},e,{getEdit:function(){return["sap/ui/mdc/field/FieldInput","sap/ui/core/InvisibleText"]},getEditMultiValue:function(){return["sap/ui/mdc/field/FieldMultiInput","sap/ui/mdc/field/FieldInput","sap/m/Token","sap/ui/core/InvisibleText"]},getEditMultiLine:function(){return[null]},getUseDefaultFieldHelp:function(){return false},createEdit:function(e,t,a){e.setIsMeasure(true);var i=t[0];var l=t[1];var n=e.getConditionsType();this._adjustDataTypeForUnit(e);var d=l.getStaticId("sap.ui.mdc","field.NUMBER");var r=[];var o=new i(a,{value:{path:"$field>/conditions",type:n},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",valueHelpIconSrc:"sap-icon://slim-arrow-down",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",autocomplete:false,fieldGroupIds:[e.getField().getId()],ariaDescribedBy:[d],change:e.getHandleContentChange(),liveChange:e.getHandleContentLiveChange()});o._setPreferUserInteraction(true);e.setAriaLabelledBy(o);r.push(o);r=this._addUnitControl(e,r,a,i,l);return r},createEditMultiValue:function(e,a,i){e.setIsMeasure(true);var l=a[0];var n=a[2];var d=a[1];var r=a[3];var o=e.getConditionType();var s=e.getConditionsType();this._adjustDataTypeForUnit(e);var u=[];var p=new n(i+"-token",{text:{path:"$field>",type:o}});var f=new t({path:"values",test:function(e){if(!Array.isArray(e[0])||e[0][0]){return true}else{return false}}});var g=r.getStaticId("sap.ui.mdc","field.NUMBER");var c=new l(i,{value:{path:"$field>/conditions",type:s},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",fieldGroupIds:[e.getField().getId()],ariaDescribedBy:[g],tokens:{path:"$field>/conditions",template:p,filters:[f]},dependents:[p],change:e.getHandleContentChange(),liveChange:e.getHandleContentLiveChange(),tokenUpdate:e.getHandleTokenUpdate()});c._setPreferUserInteraction(true);e.setAriaLabelledBy(c);u.push(c);u=this._addUnitControl(e,u,i,d,r);return u},createEditMultiLine:function(){throw new Error("sap.ui.mdc.field.content.UnitContent - createEditMultiLine not defined!")},_addUnitControl:function(e,t,a,i,l){var d=e.getUnitConditionsType();if(e.getField().getEditMode()===n.EditableDisplay){t[0].bindProperty("description",{path:"$field>/conditions",type:d});t[0].setWidth("100%");t[0].setFieldWidth("70%")}else{var r;var o=e.getUnitOriginalType();var s=o&&o.getMetadata().getName();if(s&&s.indexOf("Currency")>=0){r=l.getStaticId("sap.ui.mdc","field.CURRENCY")}else{r=l.getStaticId("sap.ui.mdc","field.UNIT")}var u=new i(a+"-unit",{value:{path:"$field>/conditions",type:d},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditableUnit},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueHelpIconSrc:e.getFieldHelpIcon(),valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",ariaAttributes:"{$field>/_ariaAttributes}",width:"30%",tooltip:"{$field>/tooltip}",autocomplete:false,fieldGroupIds:[e.getField().getId()],ariaDescribedBy:[r],change:e.getHandleContentChange(),liveChange:e.getHandleContentLiveChange(),valueHelpRequest:e.getHandleValueHelpRequest()});u._setPreferUserInteraction(true);e.setAriaLabelledBy(u);t.push(u)}return t},_adjustDataTypeForUnit:function(e){var t=e.getField();var l=t.getTypeMap();var n=e.retrieveDataType();var r=n.getFormatOptions();var o=n.getConstraints();var s=!r||!r.hasOwnProperty("showMeasure")||r.showMeasure;var u=!r||!r.hasOwnProperty("showNumber")||r.showNumber;if(s&&u){var p=i({},r);var f=a(o)?undefined:i({},o);var g=d(l,n,p,f,true,false);e.setUnitOriginalType(e.getDataType());l.initializeInternalType(g,e.getFieldTypeInitialization());e.setDataType(g);g=d(l,n,p,f,false,true);l.initializeInternalType(g,e.getFieldTypeInitialization());e.setUnitType(g);e.updateConditionType()}}});return r});
//# sourceMappingURL=UnitContent.js.map