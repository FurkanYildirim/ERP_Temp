/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/util/loadModules","sap/base/Log","sap/ui/mdc/BaseDelegate","sap/ui/mdc/util/mapVersions"],function(e,t,i,a){"use strict";var l=function(e){if(!e||!e.name){throw new Error("Delegate configuration '"+(e&&JSON.stringify(e))+"' invalid")}};var n=function(e){if(!this.bIsDestroyed){if(e instanceof Error){this.fnRejectDelegate(e)}else{this._oDelegate=e[0];this.fnResolveDelegate(this._oDelegate);this.bDelegateInitialized=true;a(this._oDelegate)}}this.bDelegateLoading=false;delete this.fnResolveDelegate;delete this.fnRejectDelegate};var s={};s.init=function(e){return function(){this.bDelegateInitialized=false;this.bDelegateLoading=false;this._oDelegateInitialized=new Promise(function(e,t){this.fnResolveDelegate=e;this.fnRejectDelegate=t}.bind(this));if(e){e.apply(this,arguments)}}};s.applySettings=function(e){return function(t){e.apply(this,arguments);this._bDelegateLocked=true;return this}};s.setDelegate=function(e){return function(t){if(this._bDelegateLocked){throw new Error("Runtime delegate configuration is not permitted.")}l(t);e.call(this,t);this._oPayload=t&&t.payload;return this}};s.initControlDelegate=function(i){if(this.bIsDestroyed){t.warning("Delegate module initialization omitted as control is being destroyed.")}else if(!this._oDelegate&&!this.bDelegateLoading){if(i){n.call(this,[i])}else{var a=this.getDelegate();l(a);this.bDelegateLoading=true;e(a.name).then(n.bind(this)).catch(n.bind(this))}}return this._oDelegateInitialized};s.isControlDelegateInitialized=function(){return this.bDelegateInitialized};s.getPayload=function(){if(!this._oPayload){var e=this.getDelegate();this._oPayload=e&&e.payload}return this._oPayload};s.getTypeUtil=function(){return this.getTypeMap()};s.getTypeMap=function(){if(!this._oTypeMap){if(!this._oDelegate){throw new Error("A delegate instance providing a TypeMap is not (yet) available.")}this._oTypeMap=this._oDelegate.getTypeMap(this)}return this._oTypeMap};s.getControlDelegate=function(){if(!this._oDelegate){if(this.isDestroyed()){throw new Error("A delegate instance is not available. The object instance is destroyed.")}else{throw new Error("A delegate instance is not (yet) available. You must call initControlDelegate before calling getControlDelegate.")}}a(this._oDelegate);return this._oDelegate};s.awaitControlDelegate=function(){return this._oDelegateInitialized};s.exit=function(e){return function(){this.fnResolveDelegate=null;this.fnRejectDelegate=null;this.bDelegateInitialized=false;this.bDelegateLoading=false;this._oDelegateInitialized=null;this._oDelegate=null;this._oPayload=null;this._oTypeMap=null;if(e){e.apply(this,arguments)}}};return function(){this.applySettings=s.applySettings(this.applySettings);this.exit=s.exit(this.exit);this.init=s.init(this.init);this.setDelegate=s.setDelegate(this.setDelegate);this.awaitControlDelegate=s.awaitControlDelegate;this.isControlDelegateInitialized=s.isControlDelegateInitialized;this.getControlDelegate=s.getControlDelegate;this.getPayload=s.getPayload;this.getTypeUtil=s.getTypeUtil;this.getTypeMap=s.getTypeMap;this.initControlDelegate=s.initControlDelegate}});
//# sourceMappingURL=DelegateMixin.js.map