/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject"],function(t){"use strict";var e=t.extend("sap.ui.fl.apply._internal.flexState.DataSelector",{metadata:{properties:{parentDataSelector:{type:"object"},cachedResult:{type:"any"},parameterKey:{type:"string"},initFunction:{type:"function"},executeFunction:{type:"function"},updateListeners:{type:"function[]",defaultValue:[]},checkInvalidation:{type:"function",defaultValue:function(){return true}}}},constructor:function(){t.apply(this,arguments);this._mInitialized={};if(this.getParameterKey()){this.setCachedResult({})}var e=this.getParentDataSelector();if(e){this.onParentSelectorUpdate=this.checkUpdate.bind(this);e.addUpdateListener(this.onParentSelectorUpdate)}}});e.prototype.addUpdateListener=function(t){var e=this.getUpdateListeners();if(!e.includes(t)){this.setUpdateListeners([].concat(e,t))}};e.prototype.removeUpdateListener=function(t){var e=this.getUpdateListeners();this.setUpdateListeners(e.filter(function(e){return e!==t}))};e.prototype.exit=function(){var t=this.getParentDataSelector();if(t){t.removeUpdateListener(this.onParentSelectorUpdate)}};e.prototype._getParameterizedCachedResult=function(t){var e=this.getParameterKey();if(e){var a=t[e];return this.getCachedResult()[a]}return this.getCachedResult()};e.prototype._clearCache=function(t){if(t){this._setParameterizedCachedResult(t,null)}else{var e=!!this.getParameterKey();this.setCachedResult(e?{}:null)}};e.prototype.clearCachedResult=function(t){this._clearCache(t);this.getUpdateListeners().forEach(function(t){t()})};e.prototype._setParameterizedCachedResult=function(t,e){var a=this.getParameterKey();if(a&&t){var i={};var r=t[a];i[r]=e;return this.setCachedResult(Object.assign({},this.getCachedResult(),i))}return this.setCachedResult(e)};e.prototype.get=function(t){var e=this.getParameterKey();if(e&&!(t||{})[e]){throw new Error("Parameter '"+e+"' is missing")}var a=this._getParameterizedCachedResult(t);if(a!==null&&a!==undefined){return a}var i=this.getParentDataSelector();var r=i&&i.get(t);var n=(t||{})[e];if(!this._mInitialized[n]&&this.getInitFunction()){this.getInitFunction()(r,n);this._mInitialized[n]=true}var s=this.getExecuteFunction()(r,n);this._setParameterizedCachedResult(t,s);return s};e.prototype.checkUpdate=function(t){if(this.getCheckInvalidation()(t)===true){this._clearCache(t);this.getUpdateListeners().forEach(function(t){t()})}};return e});
//# sourceMappingURL=DataSelector.js.map