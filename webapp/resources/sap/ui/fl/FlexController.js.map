{"version":3,"file":"FlexController.js","names":["sap","ui","define","ChangeHandlerStorage","Utils","Layer","ChangePersistenceFactory","Versions","Applier","Reverter","URLHandler","FlexObjectFactory","States","ControlVariantApplyAPI","JsControlTreeModifier","XmlTreeModifier","Component","Log","revertChangesAndUpdateVariantModel","oComponent","bSkipUrlUpdate","aChanges","Promise","resolve","then","length","reverse","revertMultipleChanges","appComponent","modifier","flexController","this","bind","oModel","getModel","getVariantModelName","update","parameters","updateURL","updateHashEntry","model","FlexController","sComponentName","_oChangePersistence","undefined","_sComponentName","getChangePersistenceForComponent","getComponentName","prototype","setVariantSwitchPromise","oPromise","_oVariantSwitchPromise","waitForVariantSwitch","createBaseChange","oChangeSpecificData","oAppComponent","Error","reference","packageName","oChange","createUIChange","variantReference","setVariantReference","_createChange","oControl","sControlType","controlType","getControlType","getChangeHandler","getChangeType","getLayer","oChangeHandler","completeChangeContent","view","getViewForControl","JSON","stringify","setState","LifecycleState","NEW","catch","oError","reject","createChangeWithExtensionPointSelector","mExtensionPointReference","oView","getAppComponentForControl","selector","name","viewSelector","getSelector","getId","createChangeWithControlSelector","FakePromise","sControlId","id","Object","assign","addChange","_ignoreOnce","addPreparedChange","setQueuedForApply","deleteChange","applyChange","mPropertyBag","applyChangeOnControl","oReturn","success","oException","error","checkDependencies","mDependencies","mChanges","aRelevantChanges","bResult","canChangePotentiallyBeApplied","push","sDependencyKey","aDependentChanges","dependencies","i","n","oDependentChange","getChangeFromChangesMap","aSelectors","getDependentControlSelectorList","some","oSelector","bySelector","waitForChangesToBeApplied","aPromises","map","mSelector","_waitForChangesToBeApplied","all","filterChanges","isCurrentProcessFinished","changeTypes","includes","getCore","byId","mChangesMap","getChangesMapForComponent","aChangesForControl","aNotYetProcessedChanges","filter","forEach","indexOf","concat","addChangeProcessingPromises","_removeOtherLayerChanges","sLayer","bRemoveOtherLayerChanges","aLayersToReset","values","sLayerToCheck","removeDirtyChanges","saveAll","bSkipUpdateCache","bDraft","bCondenseAnyLayer","sParentVersion","aDraftFilenames","oVersionModel","getVersionsModel","layer","CUSTOMER","getProperty","saveDirtyChanges","oResult","response","vChangeDefinition","Array","isArray","change","fileName","onAllChangesSaved","draftFilenames","processXmlView","oViewComponent","get","componentId","getChangesForView","applyAllChangesForXMLView","handleXMLApplyError","getComponentChanges","bInvalidateCache","getChangesForComponent","getOpenDependentChangesForControl","resetChanges","sGenerator","aSelectorIds","aChangeTypes","vLayer","applyVariantChanges","reduce","oPreviousPromise","_addRunTimeCreatedChangeAndUpdateDependencies","saveSequenceOfDirtyChanges","aDirtyChanges"],"sources":["FlexController-dbg.js"],"mappings":"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"}