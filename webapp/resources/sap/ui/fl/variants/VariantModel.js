/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_omit","sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/BusyIndicator","sap/ui/core/Core","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/registry/Settings","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/model/json/JSONModel"],function(e,t,a,n,r,i,o,s,c,l,f,h,u,p,g,d,v,m,C,V,y,R,D){"use strict";var b={};function S(e,t){return F(function(e,t){var a=t.model;var n=t.vmReference;var r=false;var i=o.get([n,"modified"],a.oData);var s=e.key;var c=e.key;return Promise.resolve().then(function(){if(o.get([n,"currentVariant"],a.oData)&&a.oData[n].currentVariant!==a.oData[n].originalCurrentVariant){c=a.oData[n].originalCurrentVariant;r=true;return a.updateCurrentVariant({variantManagementReference:n,newVariantReference:s,appComponent:a.oAppComponent,internallyCalled:true})}}).then(function(){if(i){var e=d.getControlChangesForVariant({reference:a.sFlexReference,vmReference:n,vReference:c});return x({changes:e,vmReference:n,vReference:c,revert:!r,model:a})}return Promise.resolve()}).then(function(){if(!r){a.callVariantSwitchListeners(n,a.oData[n].currentVariant)}})}.bind(null,e.getParameters(),t),t.model)}function x(e){var t=e.model._getDirtyChangesFromVariantChanges(e.changes);t=t.reverse();return Promise.resolve().then(function(){if(e.revert){return h.revertMultipleChanges(t,{appComponent:e.model.oAppComponent,modifier:c,flexController:e.model.oFlexController})}return undefined}).then(function(){t.forEach(function(t){e.model.oFlexController.deleteChange(t)})})}function F(e,t){t._oVariantSwitchPromise=t._oVariantSwitchPromise.catch(function(){}).then(e);t.oFlexController.setVariantSwitchPromise(t._oVariantSwitchPromise);return t._oVariantSwitchPromise}function I(e,t){b[e]=t}function M(e,t){return g.switchVariant(e).then(function(){if(this.oData[e.vmReference].updateVariantInURL){u.updateVariantInURL({vmReference:e.vmReference,newVReference:e.newVReference,model:this})}this.callVariantSwitchListeners(e.vmReference,e.newVReference,undefined,t)}.bind(this))}function P(e){var t=y.getInstanceOrUndef();if(t&&!t.isVariantPersonalizationEnabled()){e.remove=false;e.rename=false;e.change=false}}function E(e){var t=y.getInstanceOrUndef();var a=t&&(t.isKeyUser()||!t.getUserId()||t.isPublicFlVariantEnabled()&&t.getUserId().toUpperCase()===e.author.toUpperCase());e.remove=a;e.rename=a;e.change=a}function U(e,t,a){var n=a?C.getCurrentLayer():m.USER;if(e.layer===n&&e.key!==t){return true}return false}function _(e){return new Promise(function(t){if(e.getDomRef()){t()}else{e.addEventDelegate({onAfterRendering:function(){t()}})}})}function L(){var e=V.getUshellContainer();if(e){var t=[V.getUShellService("UserInfo"),V.getUShellService("URLParsing"),V.getUShellService("CrossApplicationNavigation"),V.getUShellService("ShellNavigation")];return Promise.all(t).then(function(e){I("UserInfo",e[0]);I("URLParsing",e[1]);I("CrossApplicationNavigation",e[2]);I("ShellNavigation",e[3])}).catch(function(e){throw new Error("Error getting service from Unified Shell: "+e)})}}function A(e){e.originalTitle=e.title;e.originalFavorite=e.favorite;e.originalExecuteOnSelect=e.executeOnSelect;e.originalVisible=e.visible;e.originalContexts=e.contexts}function T(e,t){return i({},e.find(function(e){return e.key===t}))}var O=D.extend("sap.ui.fl.variants.VariantModel",{constructor:function(e,t){this.pSequentialImportCompleted=Promise.resolve();D.apply(this,[e]);this.sharing={PRIVATE:"private",PUBLIC:"public"};this.oFlexController=t.flexController;this.oChangePersistence=this.oFlexController._oChangePersistence;this.sFlexReference=this.oChangePersistence.getComponentName();this.oAppComponent=t.appComponent;this._oResourceBundle=f.getLibraryResourceBundle("sap.ui.fl");this._oVariantSwitchPromise=Promise.resolve();this._oVariantAppliedListeners={};this.fnUpdateListener=this.updateData.bind(this);this.oDataSelector=d.getVariantManagementMap();this.oDataSelector.addUpdateListener(this.fnUpdateListener);this.updateData()}});O.prototype.updateData=function(){var e=this.oDataSelector.get({reference:this.sFlexReference});var t=Object.assign({},this.getData());Object.entries(e).forEach(function(e){var a=e[0];var n=Object.assign({},e[1]);if(!t[a]){t[a]={}}t[a].variants=n.variants.map(function(e){var n=(t[a].variants||[]).find(function(t){return t.key===e.key});A(e);return Object.assign({},n||{},e)});t[a].currentVariant=n.currentVariant;t[a].originalCurrentVariant=n.currentVariant;t[a].defaultVariant=n.defaultVariant;t[a].originalDefaultVariant=n.defaultVariant;t[a].modified=n.modified});this.setData(t)};O.prototype.invalidateMap=function(){this.oDataSelector.checkUpdate({reference:this.sFlexReference})};O.prototype.initialize=function(){return Promise.all([y.getInstance(),L()]).then(function(){u.initialize({model:this})}.bind(this))};O.prototype.updateCurrentVariant=function(e){var t={vmReference:e.variantManagementReference,currentVReference:this.oData[e.variantManagementReference].originalCurrentVariant,newVReference:e.newVariantReference,flexController:this.oFlexController,appComponent:e.appComponent||this.oAppComponent,modifier:c,reference:this.sFlexReference};if(e.internallyCalled){return M.call(this,t,e.scenario)}return F(M.bind(this,t,e.scenario),this)};O.prototype.getCurrentVariantReference=function(e){return this.oData[e].currentVariant};O.prototype.getVariantManagementReference=function(e){var t="";var a=-1;Object.keys(this.oData).some(function(n){return this.oData[n].variants.some(function(r,i){if(r.key===e){t=n;a=i;return true}})}.bind(this));return{variantManagementReference:t,variantIndex:a}};O.prototype.getVariant=function(e,t){var a=t||this.getVariantManagementReference(e).variantManagementReference;return T(this.oData[a].variants,e)};O.prototype.getVariantTitle=function(e,t){return T(this.oData[t].variants,e).title};function w(e,t){var a=d.getVariantChangesForVariant({vmReference:e,reference:this.sFlexReference});var n=this.oData[e].defaultVariant;if(t.getExecuteOnSelectionForStandardDefault()&&n===e&&!a.setExecuteOnSelect){var r=T(this.oData[e].variants,e);r.instance.setExecuteOnSelection(true);this.oData[e].variants[0].originalExecuteOnSelect=true;this.oData[e].variants[0].executeOnSelect=true;return true}return false}O.prototype.attachVariantApplied=function(e){var t=f.byId(e.vmControlId);var a=this.getVariantManagementReferenceForControl(t);return this.waitForVMControlInit(a).then(function(e,a){if(!this._oVariantAppliedListeners[e]){this._oVariantAppliedListeners[e]={}}var n=w.call(this,e,t);if(a.callAfterInitialVariant||n){var r={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:e,flexController:this.oFlexController};d.waitForInitialVariantChanges(r).then(function(){var t=this.oData[e].currentVariant;this.callVariantSwitchListeners(e,t,a.callback)}.bind(this))}return _(a.control).then(function(){if(v.getRelevantVariantManagementControlId(a.control,this.getVariantManagementControlIds())===a.vmControlId){this.oData[e].showExecuteOnSelection=true;this.checkUpdate(true);this._oVariantAppliedListeners[e][a.control.getId()]=a.callback}else{s.error("Error in attachVariantApplied: The passed VariantManagement ID does not match the responsible VariantManagement control")}}.bind(this))}.bind(this,a,e))};O.prototype.callVariantSwitchListeners=function(e,t,n,r){if(this._oVariantAppliedListeners[e]){var i=T(this.oData[e].variants,t);if(r){i.createScenario=r}if(n){n(i)}else{a(this._oVariantAppliedListeners[e],function(e,t){t(i)})}}};O.prototype.detachVariantApplied=function(e,t){var a=this.getVariantManagementReferenceForControl(f.byId(e));if(this._oVariantAppliedListeners[a]){delete this._oVariantAppliedListeners[a][t]}};O.prototype.eraseDirtyChangesOnVariant=function(e,t){var a=d.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:t});var n=this._getDirtyChangesFromVariantChanges(a);return x({changes:a,vmReference:e,vReference:t,model:this,revert:true}).then(function(){return n})};O.prototype.addAndApplyChangesOnVariant=function(e){return e.reduce(function(e,t){return e.then(function(){this.oFlexController.addPreparedChange(t,this.oAppComponent);var e=f.byId(c.getControlIdBySelector(t.getSelector(),this.oAppComponent));return this.oFlexController.applyChange(t,e)}.bind(this))}.bind(this),Promise.resolve())};O.prototype._getVariantTitleCount=function(e,t){var a=this.getData();return a[t].variants.reduce(function(t,a){if(e.toLowerCase()===a.title.toLowerCase()&&a.visible){t++}return t},0)};function k(e,t){var a={id:t.newVariantReference,variantName:t.title,contexts:t.contexts,layer:t.layer,adaptationId:t.adaptationId,reference:e.getFlexObjectMetadata().reference,generator:t.generator,variantManagementReference:t.variantManagementReference};if(t.currentVariantComparison===1){if(t.sourceVariantSource.instance.getLayer()===t.layer){a.variantReference=t.sourceVariantSource.instance.getVariantReference()}else{a.variantReference=e.getVariantReference()}}else if(t.currentVariantComparison===0){a.variantReference=e.getVariantReference()}else if(t.currentVariantComparison===-1){a.variantReference=t.sourceVariantReference}return p.createFlVariant(a)}O.prototype._duplicateVariant=function(t){var a=t.sourceVariantReference;var n=t.variantManagementReference;var r=this.getVariant(a);var o=d.getControlChangesForVariant({vmReference:n,vReference:a,reference:this.sFlexReference}).map(function(e){return e.convertToFileContent()});t.currentVariantComparison=C.compareAgainstCurrentLayer(r.instance.getLayer(),t.layer);if(t.currentVariantComparison===1){t.sourceVariantSource=this.getVariant(r.instance.getVariantReference())}var s={layer:t.layer,control:this.oAppComponent,reference:this.sFlexReference};var c=R.hasAdaptationsModel(s);if(c){t.adaptationId=R.getDisplayedAdaptationId(s)}else{e(t,"adaptationId")}var l={instance:k(r.instance,t),controlChanges:o,variantChanges:{}};o=l.controlChanges.slice();var f={};l.controlChanges=o.reduce(function(e,a){if(C.compareAgainstCurrentLayer(a.layer,t.layer)>=0){f=i({},a);f.layer=t.layer;f.variantReference=l.instance.getId();if(!f.support){f.support={}}f.support.sourceChangeFileName=a.fileName;f.packageName="$TMP";f.fileName=V.createDefaultFileName(f.changeType);e.push(p.createFromFileContent(f))}return e},[]);return l};O.prototype.copyVariant=function(e){var t=this._duplicateVariant(e);t.generator=e.generator;var a=y.getInstanceOrUndef().getUserId()?y.getInstanceOrUndef().getUserId():undefined;if(e.layer===m.VENDOR){a="SAP"}this.oData[e.variantManagementReference].variants.push({key:t.instance.getId(),rename:true,change:true,remove:true,sharing:e.layer===m.USER?this.sharing.PRIVATE:this.sharing.PUBLIC,author:a});var n=[];if(e.layer===m.PUBLIC){t.instance.setFavorite(false);var r={selector:c.getSelector(e.newVariantReference,e.appComponent),changeType:"setFavorite",fileType:"ctrl_variant_change",generator:e.generator,layer:m.USER,content:{favorite:true}};n.push(this.oFlexController.createBaseChange(r,e.appComponent))}[t.instance].concat(t.controlChanges).forEach(function(e){n.push(this.oChangePersistence.addDirtyChange(e))}.bind(this));return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:t.instance.getId(),appComponent:e.appComponent,internallyCalled:true,scenario:"saveAs"}).then(function(){return n})};O.prototype.removeVariant=function(e){var t=this.oChangePersistence.getDirtyChanges().filter(function(t){return t.getVariantReference&&t.getVariantReference()===e.variant.getId()||t.getId()===e.variant.getId()});return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:e.sourceVariantReference,appComponent:e.component}).then(function(){t.forEach(function(e){this.oChangePersistence.deleteChange(e)}.bind(this))}.bind(this))};O.prototype.collectModelChanges=function(e,a){var n=this.getData()[e];var r=n.variants;var i=[];var o={};var s=y.getInstanceOrUndef();r.forEach(function(e){var n=s&&s.isPublicFlVariantEnabled()&&e.layer===m.PUBLIC?m.PUBLIC:a;if(e.originalTitle!==e.title){o={variantReference:e.key,changeType:"setTitle",title:e.title,originalTitle:e.originalTitle,layer:n};i.push(o)}if(e.originalFavorite!==e.favorite){o={variantReference:e.key,changeType:"setFavorite",favorite:e.favorite,originalFavorite:e.originalFavorite,layer:a};i.push(o)}if(e.originalExecuteOnSelect!==e.executeOnSelect){o={variantReference:e.key,changeType:"setExecuteOnSelect",executeOnSelect:e.executeOnSelect,originalExecuteOnSelect:e.originalExecuteOnSelect,layer:n};i.push(o)}if(!e.visible&&e.originalVisible){o={variantReference:e.key,changeType:"setVisible",visible:false,layer:n};i.push(o)}if(!t(e.originalContexts,e.contexts)){o={variantReference:e.key,changeType:"setContexts",layer:a,contexts:e.contexts,originalContexts:e.originalContexts};i.push(o)}});if(n.originalDefaultVariant!==n.defaultVariant){o={variantManagementReference:e,changeType:"setDefault",defaultVariant:n.defaultVariant,originalDefaultVariant:n.originalDefaultVariant,layer:a};i.push(o)}return i};O.prototype.manageVariants=function(e,t,a,n,r){return new Promise(function(i){e.attachEventOnce("manage",{resolve:i,variantManagementReference:t,layer:a},this.fnManageClickRta,this);e.openManagementDialog(true,n,r)}.bind(this))};O.prototype.addVariantChange=function(e,t){var a=this.setVariantProperties(e,t);var n={};n.changeType=t.changeType;n.layer=t.layer;n.generator=t.generator;var r={layer:t.layer,control:t.appComponent,reference:this.sFlexReference};if(R.hasAdaptationsModel(r)){n.adaptationId=R.getDisplayedAdaptationId(r)}if(t.changeType==="setDefault"){n.fileType="ctrl_variant_management_change";n.selector=c.getSelector(e,t.appComponent)}else{n.fileType="ctrl_variant_change";n.selector=c.getSelector(t.variantReference,t.appComponent)}var i=this.oFlexController.createBaseChange(n,t.appComponent);i.setContent(a);if(t.changeType==="setTitle"){i.setText("title",t.title,"XFLD")}this.oChangePersistence.addDirtyChange(i);return i};O.prototype.deleteVariantChange=function(e,t,a){this.setVariantProperties(e,t);this.oChangePersistence.deleteChange(a)};O.prototype.setVariantProperties=function(e,t){var a=this.getData();var n=this.getVariant(t.variantReference,e).instance;var r={};switch(t.changeType){case"setTitle":n.setName(t.title,true);break;case"setFavorite":r.favorite=t.favorite;n.setFavorite(t.favorite);break;case"setExecuteOnSelect":r.executeOnSelect=t.executeOnSelect;n.setExecuteOnSelection(t.executeOnSelect);break;case"setVisible":r.visible=t.visible;r.createdByReset=false;n.setVisible(t.visible);break;case"setContexts":r.contexts=t.contexts;n.setContexts(t.contexts);break;case"setDefault":r.defaultVariant=t.defaultVariant;var i=u.getStoredHashParams({model:this});if(i){if(a[e].defaultVariant!==a[e].currentVariant&&i.indexOf(a[e].currentVariant)===-1){u.update({parameters:i.concat(a[e].currentVariant),updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}else if(a[e].defaultVariant===a[e].currentVariant&&i.indexOf(a[e].currentVariant)>-1){i.splice(i.indexOf(a[e].currentVariant),1);u.update({parameters:i,updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}}break;default:break}return r};O.prototype._ensureStandardVariantExists=function(t){var a=this.getData();var n=a[t]||{};var i=e(n,["initPromise"]);if(!a[t]||r(i)){var o=p.createFlVariant({id:t,variantManagementReference:t,variantName:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),user:v.DEFAULT_AUTHOR,layer:m.BASE,reference:this.sFlexReference});d.addFakeStandardVariant(this.sFlexReference,this.oAppComponent.getId(),t,o)}};O.prototype.setModelPropertiesForControl=function(e,t,a){this.oData[e].showFavorites=true;var n=this._bDesignTimeMode;if(n!==t){this._bDesignTimeMode=t;if(t){u.clearAllVariantURLParameters({model:this})}else if(n){u.update({parameters:u.getStoredHashParams({model:this}),updateURL:true,updateHashEntry:false,model:this})}}if(!(typeof this.fnManageClick==="function"&&typeof this.fnManageClickRta==="function")){this._initializeManageVariantsEvents()}a.detachManage(this.fnManageClick,this);if(t&&this.oData[e]._isEditable){this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(a){a.rename=true;a.change=true;a.sharing=this.sharing.PUBLIC;a.remove=U(a,e,t)}.bind(this))}else if(this.oData[e]._isEditable){a.attachManage({variantManagementReference:e},this.fnManageClick,this);this.oData[e].variantsEditable=true;this.oData[e].variants.forEach(function(a){a.remove=U(a,e,t);switch(a.layer){case m.USER:a.rename=true;a.change=true;a.sharing=this.sharing.PRIVATE;P(a);break;case m.PUBLIC:a.sharing=this.sharing.PUBLIC;E(a);break;default:a.rename=false;a.change=false;a.sharing=this.sharing.PUBLIC}}.bind(this))}else{this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(e){e.remove=false;e.rename=false;e.change=false})}};O.prototype._initializeManageVariantsEvents=function(){this.fnManageClickRta=function(e,t){var a=this.collectModelChanges(t.variantManagementReference,t.layer);t.resolve(a)};this.fnManageClick=function(e,t){if(!this.oFlexController||!this.getData()){return}var a=this.collectModelChanges(t.variantManagementReference,m.USER);var n=[];a.forEach(function(e){e.appComponent=this.oAppComponent;n.push(this.addVariantChange(t.variantManagementReference,e))}.bind(this));this.oChangePersistence.saveDirtyChanges(this.oAppComponent,false,n)}};function B(e,t,a,n){if(!this._bDesignTimeMode){return e.saveSequenceOfDirtyChanges(t,n).then(function(e){if(e){var t=e.response[0];this.oData[a].variants.forEach(function(e){if(e.key===t.fileName){e.author=t.support.user}})}}.bind(this))}return Promise.resolve()}O.prototype._handleSaveEvent=function(e){if(!this._bDesignTimeMode){var t=e.getSource();var a=e.getParameters();return this._handleSave(t,a)}return Promise.resolve()};O.prototype._handleSave=function(e,t){var a=V.getAppComponentForControl(e);var n=this.getLocalId(e.getId(),a);var r;return F(function(e,t,a){var n=a.def;var i=a.execute;var o=this.getCurrentVariantReference(e);var s=d.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:o});if(a.overwrite){return this.oFlexController.saveSequenceOfDirtyChanges(this._getDirtyChangesFromVariantChanges(s),t)}var c=a.layer||(a.public?m.PUBLIC:m.USER);var l=a.layer||m.USER;var f=a.newVariantReference||V.createDefaultFileName("flVariant");var h={variantManagementReference:e,appComponent:t,layer:c,title:a.name,contexts:a.contexts,sourceVariantReference:o,newVariantReference:f,generator:a.generator};return this.copyVariant(h).then(function(a){if(n){var c={changeType:"setDefault",defaultVariant:f,originalDefaultVariant:this.oData[e].defaultVariant,appComponent:t,layer:l,variantManagementReference:e};var h=this.addVariantChange(e,c);a.push(h)}if(i){var u={changeType:"setExecuteOnSelect",executeOnSelect:true,variantReference:f,appComponent:t,layer:l,variantManagementReference:e};var p=this.addVariantChange(e,u);a.push(p)}r=a;return x({changes:s,vmReference:e,vReference:o,model:this}).then(B.bind(this,this.oFlexController,a,e,t))}.bind(this))}.bind(this,n,a,t),this).then(function(){return r})};O.prototype.getLocalId=function(e,t){return c.getSelector(e,t).id};O.prototype.getVariantManagementReferenceForControl=function(e){var t=e.getId();var a=V.getAppComponentForControl(e);return a&&a.getLocalId(t)||t};O.prototype.switchToDefaultForVariantManagement=function(e){if(this.oData[e].currentVariant!==this.oData[e].defaultVariant){l.show(200);this.updateCurrentVariant({variantManagementReference:e,newVariantReference:this.oData[e].defaultVariant}).then(function(){l.hide()})}};O.prototype.switchToDefaultForVariant=function(e){Object.keys(this.oData).forEach(function(t){if(!e||this.oData[t].currentVariant===e){this.switchToDefaultForVariantManagement(t)}}.bind(this))};O.prototype.registerToModel=function(e){var t=this.getVariantManagementReferenceForControl(e);this._ensureStandardVariantExists(t);this.oData[t]._isEditable=e.getEditable();this.oData[t].showExecuteOnSelection=false;e.attachEvent("select",{vmReference:t,model:this},S);e.attachSave(this._handleSaveEvent,this);this.setModelPropertiesForControl(t,false,e);var a=e.getUpdateVariantInURL();this.oData[t].updateVariantInURL=a;u.registerControl({vmReference:t,updateURL:!!a,model:this});u.handleModelContextChange({model:this,vmControl:e});if(this.oData[t].initPromise){this.oData[t].initPromise.resolveFunction();delete this.oData[t].initPromise}this.oData[t].init=true;var n={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:t,flexController:this.oFlexController};this._oVariantSwitchPromise=this._oVariantSwitchPromise.then(d.waitForInitialVariantChanges.bind(undefined,n))};O.prototype.waitForVMControlInit=function(e){if(!this.oData[e]){this.oData[e]={}}else if(this.oData[e].init){return Promise.resolve()}this.oData[e].initPromise={};this.oData[e].initPromise.promise=new Promise(function(t){this.oData[e].initPromise.resolveFunction=t}.bind(this));return this.oData[e].initPromise.promise};O.prototype._getDirtyChangesFromVariantChanges=function(e){var t=e.map(function(e){return e.getId()});return this.oChangePersistence.getDirtyChanges().filter(function(e){return n(t,e.getId())&&!e.getSavedToVariant()})};O.prototype.getCurrentControlVariantIds=function(){return Object.keys(this.oData||{}).reduce(function(e,t){return e.concat([this.oData[t].currentVariant])}.bind(this),[])};O.prototype.getVariantManagementControlIds=function(){var e;return Object.keys(this.oData||{}).reduce(function(t,a){if(this.oAppComponent.byId(a)){e=this.oAppComponent.createId(a)}else{e=a}t.push(e);return t}.bind(this),[])};O.prototype.destroy=function(){this.oDataSelector.removeUpdateListener(this.fnUpdateListener);d.clearFakeStandardVariants(this.sFlexReference,this.oAppComponent.getId());D.prototype.destroy.apply(this)};O.prototype.getUShellService=function(e){return V.getUshellContainer()&&b[e]};return O});
//# sourceMappingURL=VariantModel.js.map