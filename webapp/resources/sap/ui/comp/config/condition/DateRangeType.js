/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/DatePicker","sap/m/Text","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/comp/config/condition/NullableInteger","sap/ui/model/Sorter","sap/ui/model/Filter","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/DynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/base/util/UriParameters","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos"],function(e,jQuery,t,a,n,i,r,o,l,s,u,g,T,p,f,E,d,c,I,h,D,y,v,N,_,m,O,A,S,R){"use strict";var C=n.ValueState;var F=r.PlacementType;var x=Object.keys(r.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var M;var P;var Y;var L=t.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(e,a,n){t.apply(this,[e,a,n]);this.oDateFormat=a&&a._oDateFormatSettings?a._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var r=this.oFieldMetadata&&this.oFieldMetadata.name,o=a&&a._oAdditionalConfiguration&&a._oAdditionalConfiguration.getControlConfigurationByKey(e)||r&&a._oAdditionalConfiguration.getControlConfigurationByKey(r);this._bSingleFilterRestriction=n&&n.filterRestriction===i.smartfilterbar.FilterType.single&&(a._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=n&&n.filterRestriction===i.smartfilterbar.FilterType.interval&&n.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});L.prototype.applySettings=function(e){t.prototype.applySettings.apply(this,arguments);if(e&&e.ignoreTime){this._bIgnoreTime=e.ignoreTime}};L.setStartTime=function(e){e=L.toUniversalDate(e);return y.resetStartTime(e)};L.setEndTime=function(e,t){e=L.toUniversalDate(e);if(!t){return y.resetEndTime(e)}else{return y.resetStartTime(e)}};L.toUniversalDate=function(t){if(t instanceof Date){return p.getInstance(t)}if(!t){return p.getInstance()}if(!(t instanceof p)){return L.toUniversalDate(e.getInstance(t))}return t};L.getWeekStartDate=function(e){return y.getWeekStartDate(e)};L.getMonthStartDate=function(e){return y.getMonthStartDate(e)};L.getQuarterStartDate=function(e){return y.getQuarterStartDate(e)};L.getYearStartDate=function(e){return y.getYearStartDate(e)};L.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new p}else{a=new p(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=y.getWeekStartDate(a);break;case"MONTH":a=y.getMonthStartDate(a);break;case"QUARTER":a=y.getQuarterStartDate(a);break;case"YEAR":a=y.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return y.getRange(e,t,a,false)};L.getTextField=function(e,a){var n=t._createStableId(e,"text");if(e._oOperationSelect){var i=e._oOperationSelect.getAriaLabelledBy();var r=false;for(var o=0;o<i.length;o++){if(n===i[o]){r=true;break}}if(!r){e._oOperationSelect.addAriaLabelledBy(n)}}if(a){return new s(n,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"}"})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:e.oDateFormat.style,pattern:e.oDateFormat.pattern}}})}};L.getIntField=function(e){return new o(t._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new c({},{minimum:0,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};L.getIntFromToField=function(e,a,n){var i=new T({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var r=e._createIntFromToControl(e,"fieldFrom","value1");i.setLabelFor(r);a.push(r);i=new T({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var o=e._createIntFromToControl(e,"fieldTo","value2");i.setLabelFor(o);a.push(o);e._setIntControlBinding(r,n,"value1");e._setIntControlBinding(o,n,"value2")};L.ControlFactory=function(e,a,n){if(n.type==="range"){var i=L.getTextField(e,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);return}if(n.type==="int"){var i=L.getIntField(e);a.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var e=n.descriptionTextKeys[0];var a=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return t.getTranslatedText(e)}else{return t.getTranslatedText(a||e)}}})}}if(n.type==="[int,int]"){L.getIntFromToField(e,a,n)}};L._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._IntFromToOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("-{0}")>=0&&this.basicLanguageText.indexOf("+{1}")>=0){var a=new RegExp(this.basicLanguageText.replace("/","\\/").replace("-{0}","(\\- (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)").replace("+{1}","(\\+ (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)")+"$","i");var n=e.match(a);if(n){var i=n[3];var r=n[9];if(i&&r){var o=parseInt(i);var l=parseInt(r);if(t._isValidFromToPeriod(o,l)){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",l);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._DateOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length);if(a.length>0&&a[0]===" "){a=a.trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=t._getDateFormatter(true);var i=n.parse(a);if(i){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",i);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}return false};L._DateWithDefaultsOnChangeHandler=function(e,t){var a,n,i,r,o,l=e.toLowerCase().indexOf(this.languageText.toLowerCase())===0;if(l){a=t._getDateFormatter(true);n=typeof this.defaultValues==="function"&&this.defaultValues();i=n[0]&&n[0].oDate;if(e.indexOf(this.languageText+" ")===0){r=e.slice(this.languageText.length+1);if(r[0]==="("&&r[r.length-1]===")"){r=r.slice(1,r.length-1)}}o=a.parse(r);if(o instanceof Date&&o.getTime()!==i.getTime()){return false}}return L._DateOnChangeHandler.apply(this,arguments)};L._DateRangeOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length).trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=a.split("-")[0];var i=a.split("-")[1];var r=t._getDateFormatter(true);var o=r.parse(n);var l=r.parse(i);if(o&&l){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",l);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._MonthOnChangeHandler=function(e,t){var a;var n=false;if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){a=e.slice(this.languageText.length).trim();if(a.indexOf("(")==0){a=a.slice(1);a=a.slice(0,a.length-1)}n=true}else{a=e}var i=this.getValueList();var r=-1;i.some(function(e,t){var n=e.text.toLowerCase()===a.toLowerCase();if(n){r=t}return n});if(r>-1){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",r);t.oModel.setProperty("inputstate","NONE",t.getContext());return true}else{if(n){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return n}};L._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};L._HideFilterSuggestItem=function(e,t,a){return false};L._IntFilterSuggestItem=function(e,a,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||t.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var l=e.split(" ");if(l.length<1||l.length>3){return false}var s=false;var u;var g=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(l[0].toLowerCase())){if(l[1]){if(g(l[1])){u=l[1];if(l[2]){if(o.toLowerCase().startsWith(l[2].toLowerCase())){s=true}}else{s=true}}}else{s=true}}else if(g(l[0])&&l.length<3){u=l[0];if(l[1]){if(o.toLowerCase().startsWith(l[1].toLowerCase())){s=true}}else{s=true}}else if(o.toLowerCase().startsWith(l[0].toLowerCase())&&l.length==1){s=true}if(s&&u){var T;switch(this.category){case"DYNAMIC.DATE.INT":T="DAY";break;case"DYNAMIC.WEEK.INT":T="WEEK";break;case"DYNAMIC.MONTH.INT":T="MONTH";break;case"DYNAMIC.QUARTER.INT":T="QUARTER";break;case"DYNAMIC.YEAR.INT":T="YEAR";break;default:T="DAY";break}var p=parseInt(u),f=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(p>n._maxIntValue){s=false}if(this.key.startsWith("LAST")){p=p*-1;f=false}var E;if(this.getDateRange){var d=this.getDateRange({operation:this.key,value1:p});E=[d.value1,d.value2]}else{E=L.getDateRange(p,T,true,f,f)}var c=n._getDateFormatter(true);if(Math.abs(p)===1&&this.singulareBasicLanguageText){a.setText(this.singulareBasicLanguageText);if(T!=="DAY"){a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}else{a.setAdditionalText(c.format(E[0]))}}else{a.setText(n._fillNumberToText(this.basicLanguageText,u));a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}a._value1=parseInt(u)}else{a.setAdditionalText(null);a.setText(this.languageText);a._value1=null}return s};L._IntFromToFilterSuggestItem=function(e,t,a){var n=new RegExp("(\\- ([0-9]+))","i"),i=new RegExp("(\\+ ([0-9]+))","i"),r=new RegExp("(\\- ((\\(-)?([0-9]+)(\\)))?)","i"),o=new RegExp("(\\+ ((\\(-)?([0-9]+)(\\)))?)","i"),l=e.match(n),s=e.match(i),u=e.match(r),g=e.match(o);if(!l&&!u||!s&&!g){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var T=function(e,t){if(e&&!isNaN(e[2])){return parseInt(e[2])}else if(t&&t[2]){var a=t[2].replace("(","").replace(")","");if(!isNaN(a)){return parseInt(a)}}return null},p,f;p=T(l,u);f=T(s,g);if(!a._isValidFromToPeriod(p,f)){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var E=a._getDateFormatter(true),d,c;d=a._getTodayFromToValueFrom(p);c=a._getTodayFromToValueTo(f);t.setText(a._fillNumberToText(this.basicLanguageText,p,f));t.setAdditionalText(E.format(d)+" - "+E.format(c));t._value1=p;t._value2=f;return true};L._DateFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i=n.parse(e);if(i){t.setText(this.languageText+" ("+n.format(i)+")");t._value1=i;return true}else{t.setText(this.languageText);t._value1=null;return false}};L._DateRangeFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i,r;var o="-";var l=false;var s=e.split(o);if(s.length===2){if(s[0].slice(s[0].length-1,s[0].length)==" "){s[0]=s[0].slice(0,s[0].length-1)}if(s[1].slice(0,1)==" "){s[1]=s[1].slice(1)}}else{s=e.split(" "+o+" ")}if(s.length<2){var u=e.split(" ");if(u.length===2){s=u}}if(s.length>=1&&s.length<=2){i=n.parse(s[0]);if(i){t._value1=i;if(s.length==2&&s[1]===""){s.splice(1,1)}if(s.length==2){r=n.parse(s[1]);if(r){t._value2=r;l=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+" "+n.format(r)+")")}}else{l=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+")")}}}if(!l){t.setText(this.languageText);t._value1=null;t._value2=null}return l};L._MonthFilterSuggestItem=function(e,t,a){var n=false;t._value1=null;var i=this.getValueList();for(var r=0;r<i.length;r++){var o=i[r];n=o.text.toLowerCase().startsWith(e.toLowerCase());if(n){t.setText(this.languageText+" ("+o.text+")");t._value1=r;break}}return n};L._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemsSelected=function(e,t,a){var n=t._value1;var i=t._value2;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("/condition/value2",i);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L.getFixedRangeOperation=function(e,t,a,n,i,r){return{key:e,textKey:t,category:a,order:r||100,defaultValues:n||null,type:"range",display:"range",filterSuggestItem:i||L._DefaultFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory}};L.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,l){return{key:e,textKey:t,singularTextKey:a,zeroNumberTextKey:l,category:n,order:o,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:r,onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory,_getInitialValues:function(e){return[e.value1,e.value2]}}};L.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:L._DateRangeOnChangeHandler,filterSuggestItem:L._DateRangeFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(e,a){var n=false,i=false,r=new T({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var o=new l(t._createStableId(e,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(t){var a=t.getSource(),i=t.getParameter("valid");a.setValueState(i?C.None:C.Error);if(!n){n=true;a.getBinding("maxDate").attachChange(function(t){e.datePickerValidateLastValue(a)})}}});r.setLabelFor(o);a.push(o);r=new T({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var s=new l(t._createStableId(e,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(t){var a=t.getSource(),n=t.getParameter("valid");a.setValueState(n?C.None:C.Error);if(!i){i=true;a.getBinding("minDate").attachChange(function(t){e.datePickerValidateLastValue(a)})}}});r.setLabelFor(s);a.push(s)}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(e,a){var n=new l(t._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(e,a){var n=new l(t._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(e,a,n){var i=new l(t._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:e.oDateFormat.style||e.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(i)}},LASTDAYS:L.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4,"CONDITION_DATERANGETYPE_TODAY"),LASTWEEKS:L.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8,"CONDITION_DATERANGETYPE_THISWEEK"),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",zeroNumberTextKey:"CONDITION_DATERANGETYPE_TODAY",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new p;return[e.getMonth()]},value1:null,onChange:L._MonthOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,filterSuggestItem:L._MonthFilterSuggestItem,getControls:function(e,a,n){var i=new u(t._createStableId(e,"field"),{ariaLabelledBy:e._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});i.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new g({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});a.push(i)},getValueList:function(){var e=new p,t=[],a=f.getDateInstance({pattern:"LLLL"});e.setDate(15);e.setMonth(0);for(var n=0;n<12;n++){t.push({text:a.format(e),key:n});e.setMonth(e.getMonth()+1)}return t}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return y.ranges.yesterday()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return y.ranges.today()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=y.ranges.tomorrow();return e},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},THISWEEK:L.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return y.ranges.currentWeek()},L._DefaultFilterSuggestItem,6),LASTWEEK:L.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return y.ranges.lastWeek()},L._DefaultFilterSuggestItem,7),LAST2WEEKS:L.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return y.ranges.lastWeeks(-2)},L._HideFilterSuggestItem,-1),LAST3WEEKS:L.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return y.ranges.lastWeeks(-3)},L._HideFilterSuggestItem,-1),LAST4WEEKS:L.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return y.ranges.lastWeeks(-4)},L._HideFilterSuggestItem,-1),LAST5WEEKS:L.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return y.ranges.lastWeeks(-5)},L._HideFilterSuggestItem,-1),NEXTWEEK:L.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return y.ranges.nextWeek()},L._DefaultFilterSuggestItem,9),NEXT2WEEKS:L.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return y.ranges.nextWeeks(2)},L._HideFilterSuggestItem,-1),NEXT3WEEKS:L.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return y.ranges.nextWeeks(3)},L._HideFilterSuggestItem,-1),NEXT4WEEKS:L.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return y.ranges.nextWeeks(4)},L._HideFilterSuggestItem,-1),NEXT5WEEKS:L.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return y.ranges.nextWeeks(5)},L._HideFilterSuggestItem,-1),THISMONTH:L.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return y.ranges.currentMonth()},L._DefaultFilterSuggestItem,12),LASTMONTH:L.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return y.ranges.lastMonth()},L._DefaultFilterSuggestItem,13),NEXTMONTH:L.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return y.ranges.nextMonth()},L._DefaultFilterSuggestItem,15),THISQUARTER:L.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return y.ranges.currentQuarter()},L._DefaultFilterSuggestItem,17),LASTQUARTER:L.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return y.ranges.lastQuarter()},L._DefaultFilterSuggestItem,18),NEXTQUARTER:L.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return y.ranges.nextQuarter()},L._DefaultFilterSuggestItem,20),YEARTODATE:L.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return y.ranges.yearToDate()},L._DefaultFilterSuggestItem,31),THISYEAR:L.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return y.ranges.currentYear()},L._DefaultFilterSuggestItem,26),LASTYEAR:L.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return y.ranges.lastYear()},L._DefaultFilterSuggestItem,27),NEXTYEAR:L.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return y.ranges.nextYear()},L._DefaultFilterSuggestItem,29),QUARTER1:L.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){return y.ranges.quarter(1)},L._DefaultFilterSuggestItem,22),QUARTER2:L.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){return y.ranges.quarter(2)},L._DefaultFilterSuggestItem,23),QUARTER3:L.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){return y.ranges.quarter(3)},L._DefaultFilterSuggestItem,24),QUARTER4:L.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){return y.ranges.quarter(4)},L._DefaultFilterSuggestItem,25),TODAYFROMTO:{key:"TODAYFROMTO",textKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",singularTextKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null,descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntFromToOnChangeHandler,filterSuggestItem:L._IntFromToFilterSuggestItem,onItemSelected:L._IntOnItemsSelected,getControls:L.ControlFactory}};L.SingleOperations={DATE:Object.assign({},L.Operations.DATE,{defaultOperation:true}),YESTERDAY:L.Operations.YESTERDAY,TODAY:L.Operations.TODAY,TOMORROW:L.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"FIRSTDAYWEEK",values:[]})}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"LASTDAYWEEK",values:[]})}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new A).toDates({operator:"LASTDAYYEAR",values:[]})}}};L.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new A).toDates({operator:"DATETOYEAR",values:[]})}}};L.DTOffsetOperations=Object.assign({NEXTMINUTES:{key:"NEXTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURS:{key:"NEXTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTES:{key:"LASTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURS:{key:"LASTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]}},L.Operations,L.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},L.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});L.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=L.ControlFactory}e.getControls(this,t,e);return t};L.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};t.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};L.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new p(n)}if(i instanceof Date){i=new p(i)}}return[n,i]};L.prototype.getOperations=function(){if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=L.Operations;if(this._isNewDynamicDateRangeEnabled()){t=Object.assign({},t,L.NewDynamicDateRangeOperations)}for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};L.prototype.getSingleOperations=function(){var e=[];for(var t in L.SingleOperations){var a=L.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype.getDTOffsetOperations=function(){var e=[];for(var t in L.DTOffsetOperations){var a=L.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype._updateOperation=function(e){t.prototype._updateOperation.apply(this,[e]);if(e.languageText&&!e.basicLanguageText){e.basicLanguageText=e.languageText;if(!e.singulareBasicLanguageText&&e.singularTextKey){e.singulareBasicLanguageText=this.getTranslatedText(e.singularTextKey)}if(!e.zeroNumberLanguageText&&e.zeroNumberTextKey){e.zeroNumberLanguageText=this.getTranslatedText(e.zeroNumberTextKey)}e.languageText=this._fillNumberToText(e.languageText)}if(e.display){var a=this.getDefaultValues(e);var n=this._getDateFormatter(false);if(e.display==="start"&&a[0]!==null){e.textValue=n.format(a[0].oDate)}else if(e.display==="range"&&a&&a[0]&&a[1]){e.textValue=n.format(a[0].oDate)+" - "+n.format(a[1].oDate)}}e.suggestText=e.languageText};L.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};L.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};L.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};L.prototype.providerDataUpdated=function(e,t){};L.prototype.initialize=function(a){t.prototype.initialize.apply(this,[a]);this.oModel.suspend();var n=Object.assign({},a,true),i,r;var o=(new p).getCalendarType();if(!a.conditionTypeInfo){if(a.ranges&&a.ranges.length==1){var l;if(this.hasSemanticDate(a)&&!this._bSingleFilterRestriction){l=a.ranges[0].semantic.operation;if(a.ranges[0].semantic.value1||a.ranges[0].semantic.value1==0){i=a.ranges[0].semantic.value1}if(a.ranges[0].semantic.value2||a.ranges[0].semantic.value2==0){r=a.ranges[0].semantic.value2}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(a):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==a.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==a.ranges[0].value2){l="DATERANGE"}}}else if(this.hasSemanticDate(a)&&this._bSingleFilterRestriction){l=a.ranges[0].semantic.operation;if(a.ranges[0].semantic.value1||a.ranges[0].semantic.value1==0){i=a.ranges[0].semantic.value1}a.ranges[0].value2=null;if(a.ranges[0].semantic.value2||a.ranges[0].semantic.value2==0){r=null}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(a):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==a.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==a.ranges[0].value2){l="DATE"}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()===i){i=a.ranges[0].value1?a.ranges[0].value1:a.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(a)){this._customSemanticOperation=a.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}}else if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}if(a.ranges[0].operation==="GE"){l="FROM"}if(a.ranges[0].operation==="LE"){l="TO"}a.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:l,value1:i||i==0?i:a.ranges[0].value1,value2:r||r==0?r:a.ranges[0].value2,calendarType:o}}}else{var s=this.getDefaultOperation(),g=s?s.key:"";if(a.value1){var T=a.value1}if(a.value2){var f=a.value2}a.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:g,calendarType:o}};if(T){a.conditionTypeInfo.data.value1=T}if(f){a.conditionTypeInfo.data.value2=f}}}if(a.conditionTypeInfo){a=a.conditionTypeInfo}if(a.name&&a.data){if(a.name!==this.getName()){D.debug("ConditionType "+this.getName()+" tries to deserialize data from "+a.name)}a=a.data}if(!a.operation){return}if(this.getOperation(a.operation)&&this.getOperation(a.operation).order<0){var E=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(a.operation);if(E>=0){a.operation="LASTWEEKS";a.value1=E+2}E=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(a.operation);if(E>=0){a.operation="NEXTWEEKS";a.value1=E+2}}var d=this.getOperation(a.operation);if(!d){if(this.getAsync()){this.setPending(true);var c=this,I=function(e){if(e.getParameter("pending")===false){c.oFilterProvider.detachPendingChange(I);c.initialize(n)}};this.oFilterProvider.attachPendingChange(I);this.oModel.resume();return}}var h;if(o!==a.calendarType&&(a.calendarType==="Islamic"||o==="Islamic")&&a.operation==="SPECIFICMONTH"){a.operation="DATERANGE";var v=parseInt(a.value1),N=p.getInstance(e.getInstance(),a.calendarType);N.setMonth(v);N=y.getMonthStartDate(N);h=y.getRange(0,"MONTH",N);a.value1=h[0].oDate.toISOString();a.value2=h[1].oDate.toISOString()}var _=this.getConditionContext().getObject();_.operation=a.operation;_.key=a.key;_.value1=null;_.value2=null;var m,O=this.oFieldMetadata&&this.oFieldMetadata.ui5Type;if(O&&O.isA("sap.ui.model.odata.type.String")){m=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));O=m}if(a.operation==="DATERANGE"){if(typeof a.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value1=O.formatValue(a.value1)}else{a.value1=a.value1===""?null:new p(a.value1).oDate}}if(typeof a.value2==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value2=O.formatValue(a.value2)}else{a.value2=a.value2===""?null:new p(a.value2).oDate}}_.value1=a.value1;_.value2=a.value2}else if(["DATE","FROM","TO"].indexOf(a.operation)!==-1){if(typeof a.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value1=O.formatValue(a.value1)}else{a.value1=a.value1===""?null:new p(a.value1).oDate}}_.value1=a.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(a.operation)!==-1){if(typeof a.value1==="string"){a.value1=a.value1===""?null:new p(a.value1).oDate}_.value1=a.value1;if(typeof a.value2==="string"){a.value2=a.value2===""?null:new p(a.value2).oDate}_.value2=a.value2}else if(["LASTMINUTES","LASTHOURS","LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTMINUTES","NEXTHOURS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(a.operation)>-1){_.value1=a.value1}else if(a.operation==="SPECIFICMONTH"){_.value1=a.value1+""}else if(a.operation==="TODAYFROMTO"){_.value1=a.value1;_.value2=a.value2}else{d=this.getOperation(a.operation);h=d&&d._getInitialValues?d._getInitialValues(a):null;if(!h){h=this._getValuesFromCurrentOperation(a)}if(!h){h=this.getDefaultValues(d)}_.value1=h[0];_.value2=h[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,a);if(m){m.destroy()}};L.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};L.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new p).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};L.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n;var i=false;var r=0;var o=0;var l=0;var s=this.oModel.getData(),u=s.currentoperation;if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"&&e.ranges[0]){var g,T=this.oFieldMetadata.ui5Type;if(T.isA("sap.ui.model.odata.type.String")){g=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));T=g}e.conditionTypeInfo.data.value1=T.parseValue(e.conditionTypeInfo.data.value1);e.conditionTypeInfo.data.value2=T.parseValue(e.conditionTypeInfo.data.value2);e.ranges[0].value1=T.parseValue(e.ranges[0].value1);if(e.ranges[0].value2){e.ranges[0].value2=T.parseValue(e.ranges[0].value2)}if(g){g.destroy()}}if(u&&u.languageText){var p=u.languageText;if(this._isIntIntInterval(u)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){p=this._formatIntIntInterval(u,e)}n="NONE";if(!this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){n="ERROR"}}else if(this._isIntInterval(u)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){p=this._formatIntInterval(u,e);n="NONE"}else if(this._bSuggestItemSelected){p=this._fillNumberToText(u.basicLanguageText);var f=u.basicLanguageText.indexOf("{0}");r=f+1;o=f;l=f+1;i=true}else{p="";n="NONE"}}else if(this._isFixedRange(u)){p=this._formatFixedRange(u,u.textValue);n="NONE"}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var E=this._calculateDateRangeValueText(u,e);var d=E.value;i=E.bSetCursor;if(d){p=this._formatFixedRange(u,d);r=p.length-1;n="NONE"}else{p=""}}else{p=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",p);if(n&&!this._isNewDynamicDateRangeEnabled()){this.oModel.setProperty("inputstate",n,this.getContext())}if(i&&!(this._oPopup&&this._oPopup.isOpen())&&this._oInput){this._oInput.$("inner").cursorPos(r);if(o<l){this._oInput.selectText(o,l)}this._oInput._lastValue=""}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};L.prototype.getFilterRanges=function(){var e,t=this.getCondition(),a=[],n;if(this._bSingleFilterRestriction){t.operation="EQ";delete t.value2}else if(t.operation==="LASTMINUTES"){if(!isNaN(t.value1)){a=y.ranges.lastMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTHOURS"){if(!isNaN(t.value1)){a=y.ranges.lastHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTDAYS"){if(!isNaN(t.value1)){a=y.ranges.lastDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTWEEKS"){if(!isNaN(t.value1)){a=y.ranges.lastWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTMONTHS"){if(!isNaN(t.value1)){a=y.ranges.lastMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTQUARTERS"){if(!isNaN(t.value1)){a=y.ranges.lastQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTYEARS"){if(!isNaN(t.value1)){a=y.ranges.lastYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMINUTES"){if(!isNaN(t.value1)){a=y.ranges.nextMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTHOURS"){if(!isNaN(t.value1)){a=y.ranges.nextHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTDAYS"){if(!isNaN(t.value1)){a=y.ranges.nextDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTWEEKS"){if(!isNaN(t.value1)){a=y.ranges.nextWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMONTHS"){if(!isNaN(t.value1)){a=y.ranges.nextMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTQUARTERS"){if(!isNaN(t.value1)){a=y.ranges.nextQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTYEARS"){if(!isNaN(t.value1)){a=y.ranges.nextYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="SPECIFICMONTH"){var i=parseInt(t.value1),r=new p;if(Number.isFinite(i)){r.setDate(1);r.setMonth(i);r=y.getMonthStartDate(r);a=y.getRange(0,"MONTH",r);t.value1=a[0];t.value2=a[1]}}else if(t.operation==="TODAYFROMTO"){if(!isNaN(parseInt(t.value1))){t.value1=this._getTodayFromToValueFrom(t.value1)}if(!isNaN(parseInt(t.value2))){t.value2=this._getTodayFromToValueTo(t.value2)}}else{var o=this.getOperation(t.operation);if(o&&o.getDateRange){n=o.getDateRange(t);if(!n){return[]}t.value1=n&&n.value1?n.value1:null;t.value2=n&&n.value2?n.value2:null}}if(t.value1 instanceof p){t.value1=t.value1.oDate}if(t.value2 instanceof p){t.value2=t.value2.oDate}if(t.operation==="DATE"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="BT";t.value2=t.value1;t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime,this._Precision).oDate}else if(t.operation==="FROM"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="GE";delete t.value2;t.value1=L.setStartTime(t.value1,this._bIgnoreTime).oDate}else if(t.operation==="TO"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="LE";delete t.value2;t.value1=L.setEndTime(t.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(!(this.isValidCondition()&&t.value1)){return[]}}else if(t.operation==="DATETIME"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="EQ";delete t.value2}else if(t.operation==="DATETIMERANGE"||t.operation==="LASTMINUTES"||t.operation==="LASTHOURS"||t.operation==="NEXTHOURS"||t.operation==="NEXTMINUTES"){if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT"}else{if(n){t.operation=n.operation;t.value1=t.value1?L.setStartTime(t.value1).oDate:null;t.value2=t.value2?L.setEndTime(t.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT";t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime).oDate}}t.exclude=false;t.keyField=t.key;delete t.key;if(this._isNewDynamicDateRangeEnabled()&&t.value2){if(typeof t.value1.getTime==="function"&&typeof t.value2.getTime==="function"&&t.value1.getTime()>t.value2.getTime()){e=t.value2;t.value2=t.value1;t.value1=e}}return[t]};L.prototype.getTokenText=function(){return""};L.prototype.getName=function(){return this.getMetadata().getName()};L.prototype.getType=function(){return"Edm.Date"};L.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return C.Error}else{return C.None}}})};L.prototype.initializeFilterItem=function(){if(this._isNewDynamicDateRangeEnabled()){return this._initializeFilterItemNew.apply(this,arguments)}return this._initializeFilterItemOld.apply(this,arguments)};L.prototype._initializeFilterItemOld=function(){this._oInput=new o(t._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var e,t,a=this._oList.$().find(".sapMDLILabel, .sapMSLITitleOnly");for(e=0;e<a.length;e++){t=a[e];t.innerHTML=this._createHighlightedText(t)}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new I("order",false,false),filters:new h("order",function(e){return e!==undefined&&e>-1}),template:new g({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(e,t){if(this._oPopup&&this._oPopup.isOpen()){return false}var a=this.getOperation(t.getKey());e=e.trim();if(e==="?"){L._DefaultFilterSuggestItem.call(a,e,t,this);return a.category!=="DYNAMIC.DATERANGE"&&a.category!=="DYNAMIC.DATE"}if(a.filterSuggestItem){return a.filterSuggestItem(e,t,this)}else{return L._DefaultFilterSuggestItem.call(a,e,t,this)}}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){var t=e.getParameter("selectedItem");if(!t){return}var a=t.getKey();var n=this.getOperation(a);var i=e.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(i,t,this);return}else{L._DefaultOnItemSelected.call(n,i,t,this)}}.bind(this));this._oInput.attachChange(function(e){var t=e.getParameter("value");if(t){var a=this.getOperations();var n=a.some(function(e){if(e.onChange){return e.onChange(t,this)}else{return L._defaultOnChangeHandler.call(e,t,this)}},this);if(!n){this.oModel.setProperty("inputstate","ERROR",this.getContext())}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext())}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(e){if(jQuery(e.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close()}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype._toggleOpen=function(e){if(!this._oPopup){if((!M||!P||a.system.phone&&!Y)&&!this._bPopoverRequested){M=sap.ui.require("sap/m/ResponsivePopover");P=sap.ui.require("sap/m/VBox");if(a.system.phone){Y=sap.ui.require("sap/m/Button");if(!M||!P||!Y){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],b.bind(this));this._bPopoverRequested=true}}else if(!M||!P){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],b.bind(this));this._bPopoverRequested=true}}if(!M||!P||a.system.phone&&!Y){return}this._oPopupLayout=new P;this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new M({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:F.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem",afterClose:function(){if(V(this._oPopup)){this._oPopup.getModel("$smartEntityFilter").refresh(true)}if(this.oFilterProvider._oSmartFilter.getLiveMode()){var e=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(e.LIVE_MODE_INTERVAL)}}.bind(this)});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(a.system.phone){this._oPopup.setBeginButton(new Y({text:t.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(e){this._oPopup.close()}.bind(this)}))}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setExtraContent([this._oInput.getDomRef()])}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon())}else{this._oPopup.close()}};function b(e,t,a){M=e;P=t;Y=a;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen()}}function V(e){var t,a,n=false,i=e.getContent()[0].getItems();for(t=0;t<i.length;t++){a=i[t];if(a.getMetadata().getName()==="sap.m.DatePicker"&&a.getValueState()!==C.None){n=true;break}}return n}L.prototype.datePickerValidateLastValue=function(e){var t;if(!e.isValidValue()){t=e.getValue();e.resetProperty("value");e.setValue(t);if(e.isValidValue()){e.setValueState(e.isValidValue()?C.None:C.Error)}}};L.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=f.getInstance(t)}return this._oDateFormatter};L.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};L.prototype._setIntControlBinding=function(e,a,n){e.setFieldWidth("auto");e.bindProperty("description",{path:"$smartEntityFilter>"+n,type:"sap.ui.model.type.Integer",formatter:function(){var e=a.descriptionTextKeys[0];var n=a.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return t.getTranslatedText(e)}else{return t.getTranslatedText(n||e)}}})};L.prototype._createIntFromToControl=function(e,a,n){return new o(t._createStableId(e,a),{value:{path:"$smartEntityFilter>"+n,type:new c({},{minimum:-e._maxIntValue,maximum:e._maxIntValue})},ariaLabelledBy:e._oOperationSelect||null,textAlign:"End",width:"100%"})};L.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};L.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=y.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return y.getRange(-e,"DAY")[0]};L.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=y.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return y.getRange(e,"DAY")[1]};L.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};L.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy()}t.prototype.destroy.apply(this,arguments)};L.prototype._initializeFilterItemNew=function(){var e={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this._oInput=new v(t._createStableId(this),{name:this.sFieldName,formatter:_.getInstance({date:e}),enableGroupHeaders:!this._bSingleFilterRestriction,standardOptions:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.reduce(function(e,t){if(x.includes(t.key)){e.push(t.key)}return e},[])}},change:this._onDDRChange.bind(this)});this._createCustomDDOptions(this.getOperations());this._oInput.setValue(this._getDefaultValueDDR());this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}if(this._isNewDynamicDateRangeEnabled()){this._createCustomDDOptions(e)}this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};L.prototype.setCondition=function(e){t.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,e);return this};L.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};L.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!x.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};L.prototype._getDDROption=function(e){if(!this._oInput){return null}if(x.includes(e)){return this._oInput.getOption(e)}return this._oInput.getOption(this._getCustomDDOptionName(e))};L.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};L.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};L.prototype._createCustomDDOptions=function(e){if(!this._oInput){return}var t=this._oInput.getValue();this._oInput.destroyAggregation("customOptions");e.forEach(this._createCustomDDOption,this);if(t&&!this._getDDROption(this._getOptionName(t.operator))){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}};L.prototype._createCustomDDOption=function(e){if(x.includes(e.key)){return}var t;var a=typeof e.category==="object"?e.category.key:e.category;if(a.toLowerCase().startsWith("fixed")||e.type==="range"){t=this._createCustomFixedDDOption(e)}else{t=this._createCustomDynamicDDOption(e)}t.getGroupHeader=function(){if(typeof e.category==="object"){var t=e.category.bundle;var a=e.category.key;if(sap.ui.getCore().getLibraryResourceBundle(t).hasText(a)){return sap.ui.getCore().getLibraryResourceBundle(t).getText(a)}}if(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText(e.category)}if(sap.ui.getCore().getLibraryResourceBundle("sap.m").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText(e.category)}return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_0")};t.getGroup=function(){return e.order};this._oInput.addAggregation("customOptions",t)};L.prototype._createCustomFixedDDOption=function(e){var a=this._getCustomDDOptionName(e.key);var n=this;var i=m.extend(a,{metadata:{library:"sap.ui.comp"},getText:function(){return e.languageText||t.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!n.getOperation(n._getOptionName(e.key))){return false}var t=typeof e.category==="object"?e.category.key:e.category;if(t.toUpperCase().startsWith("FIXED.")&&e.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(t){var a=e.defaultValues;if(typeof a==="function"){a=a()}if(t&&a.length>0&&!(a[0]instanceof Date)){var i=n.oModel.getProperty("",n.oConditionContext),r=i.operation,o=a[0],l=a[1];i.operation=n._getOptionName(t.operator);i.value1=!isNaN(a[0])?parseInt(a[0]):a[0];i.value2=!isNaN(a[1])?parseInt(a[1]):a[1];var s=n.getFilterRanges();i.operation=r;i.value1=o;i.value2=l;if(s.length===0){return[]}return[s[0].value1]}return a},parse:function(a){var n=e.basicLanguageText||e.languageText||t.getTranslatedText(e.textKey);if(a&&n&&n.toLowerCase().startsWith(a.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return new i({key:a})};L.prototype._createCustomDynamicDDOption=function(e){var a=this._getCustomDDOptionName(e.key);var n=this;var i=m.extend(a,{metadata:{library:"sap.ui.comp"},getText:function(){var a=e.languageText||t.getTranslatedText(e.textKey);if(a.indexOf("{0}")>=0){return n._fillNumberToText(a)}return a},getValueHelpUITypes:function(){if(e.type==="int"){return[new O({type:"int"})]}else if(e.type==="[int,int]"){return[new O({type:"int"}),new O({type:"int"})]}},createValueHelpUI:function(t,a){t.aControlsByParameters={};t.aControlsByParameters[this.getKey()]=[];n.setControls([]);var i=n.getControls(e),r=e.defaultValues.length,o=e.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(e){if(!e.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}e.setValue(o[0]);o.shift();n.oModel.setProperty("/condition/value"+(r-o.length),e.getValue())}if(typeof a==="function"){e.attachChange(function(){a(this)},this)}t.aControlsByParameters[this.getKey()].push(e)},this);n.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=n.oModel.getProperty("",n.oConditionContext),a=t.operation,i=t.value1,r=t.value2;t.operation=n._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=n.getFilterRanges();t.operation=a;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(t){var a=new g({key:e.key}),i=e.filterSuggestItem.call(e,t,a,n);if(i){return{operator:this.getKey(),values:[a._value1,a._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var a=this.getValueHelpUITypes();for(var i=0;i<a.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(a[i].getType()){case"int":return t.call(n,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return new i({key:a})};L.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var l=o.value;if(l){r=this._formatFixedRange(a,l)}else{r=""}}else{r=""}}}return r};L.prototype._isNewDynamicDateRangeEnabled=function(){if(!this.oFieldMetadata||this._bSingleFilterRestriction){return true}return!this.oFieldMetadata.disableNewDateRangeControl};L.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};L.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};L.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};L.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};L.prototype._isFixedRange=function(e){return e.textValue};L.prototype._formatFixedRange=function(e,t){if(this._isNewDynamicDateRangeEnabled()){return e.languageText}return e.languageText+" ("+t+")"};L.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n&&!(this._oPopup&&this._oPopup.isOpen())){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};L.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};L.prototype._prepareDDRValues=function(e,t,a){var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._oInput.toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=R.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=R.localToUiTimezone(i[1].oDate)}}return this._convertUniversalDateToDate(i)};L.prototype._setDDROperation=function(e){if(this._isNewDynamicDateRangeEnabled()&&this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=R.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=R.uiTimezoneToLocal(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return L});
//# sourceMappingURL=DateRangeType.js.map