{"version":3,"file":"ExportHandler.js","names":["sap","ui","define","library","ExportUtils","ExportDialog","MessageToast","Core","EventProvider","ODataModel","openWindow","Destination","FileType","ExportHandler","extend","constructor","mCapabilities","that","this","call","_mCapabilities","Object","XLSX","_initialized","Promise","fnResolve","isGoogleSheetSupported","then","bSupported","GSHEET","_mDialogSettings","destination","REMOTE","fileType","finally","prototype","attachBeforeExport","oData","fnHandler","oListener","attachEvent","detachBeforeExport","detachEvent","initialized","destroy","apply","arguments","_oModel","_oFileShareBinding","_oExportDialog","_oFilePicker","_oDataSource","bIsDestroyed","getFileShareContexts","getFileShareModel","oModel","resolve","bindList","requestContexts","bind","getRemoteFileLocation","sFileName","fnReject","all","getResourceBundle","aResolve","oResourceBundle","require","CloudFilePicker","oFilePicker","sharedModel","suggestedFileName","enableDuplicateCheck","fileNameMandatory","confirmButtonText","getText","title","attachSelect","oEvent","aSelectedFiles","oSelectedFolder","bReplaceFile","mCloudFileInfo","getParameter","getFileShareId","getFileShareItemId","Array","isArray","length","oCloudFile","shift","open","getExportInstance","mExportSettings","mCustomSettings","oExportInstance","aFilters","oFilterConfig","includeFilterSettings","oContext","workbook","context","metainfo","name","items","getFilters","dataSource","metaSheetName","push","mEventExportSettings","fireEvent","exportSettings","userExportSettings","filterSettings","filter","oFilter","isA","sort","firstElement","secondElement","sFirst","getLabel","toLowerCase","sSecond","forEach","key","value","getValue","attachBeforeSave","aArrayBuffer","oExportDialog","getMimeType","uInt8Array","Uint8Array","stringArray","i","String","fromCharCode","btoa","join","updateStatus","preventDefault","uploadFile","show","catch","showErrorMessage","finish","oBinding","sContentProperty","sTypeProperty","sPath","getKeepAliveContext","FileShare","FileShareItem","setProperty","getProperty","ParentFileShareItem","_createFile","sUrl","fnCreateCompleted","bSuccess","detachCreateCompleted","attachCreateCompleted","create","export","reject","build","exportAs","oSettings","fnResolveColumnLabel","mUserSettings","assign","aContexts","getExportSettingsViaDialog","oDialog","mDialogSettings","validateFileSettings","splitCells","PDF","columns","splitColumns","parseTechnicalConfiguration","oUserConfig","LOCAL","fileName","FileShareItemName","validateFileName","validateFileShare","oFileShareContext","find","isGoogleWorkspace","fetchDataSource","oDataSource","serviceUrl","uri","synchronizationMode","autoExpandSelect","some","sDescription","sVendorType","URL","window","location","href","search","indexOf"],"sources":["ExportHandler-dbg.js"],"mappings":"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"}