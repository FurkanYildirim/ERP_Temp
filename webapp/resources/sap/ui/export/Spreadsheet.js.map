{"version":3,"file":"Spreadsheet.js","names":["sap","ui","define","Core","ExportDialog","ExportBase","Device","SpreadsheetExport","Log","ExportUtils","Library","CLASS_NAME","Spreadsheet","extend","constructor","mSettings","call","this","_mSettings","customizing","showProgress","worker","forEach","sProperty","bind","codeListsPromise","Promise","resolve","addUnit","sCurrencyCode","oCurrency","mCurrencies","Object","isNaN","digits","scale","UnitSpecificScale","prototype","setDefaultExportSettings","mParameters","mCurrencySettings","mUnitSettings","currency","oCustomCurrencies","getConfiguration","getFormatSettings","getCustomCurrencies","then","aCodeLists","mCurrencyCodes","mUnitsOfMeasure","sUnitCode","Array","isArray","unit","getLibraryResourceBundle","oResourceBundle","oWorkbookContext","workbook","context","title","getText","sheetName","requestCodeLists","oMetaModel","isA","all","requestCurrencyCodes","requestUnitsOfMeasure","catch","oError","warning","attachBeforeSave","oData","fnHandler","oListener","attachEvent","detachBeforeSave","detachEvent","cancel","process","getMimeType","onprogress","iFetched","iTotal","iProgress","Math","round","debug","createDataSourceFromBinding","oBinding","oDataSource","aData","getAllCurrentContexts","oContext","push","getObject","data","type","error","getMetadata","getName","getDownloadUrl","oModel","getModel","sDataUrl","sServiceUrl","bV4ODataModel","interceptUrl","dataUrl","serviceUrl","headers","getHttpHeaders","getHeaders","count","getCountFromBinding","useBatch","bUseBatch","getMetaModel","processDataSource","mDataSource","sDataSourceType","createBuildPromise","that","fnResolve","fnReject","progressDialog","MAX_ROWS","nSizeLimit","system","desktop","nRows","dataSource","length","nColumns","columns","onmessage","oMessage","progress","updateStatus","fetched","total","finished","spreadsheet","executeDefaultAction","fireEvent","exportDialog","window","setTimeout","finish","saveAsFile","Blob","fileName","sError","message","showErrorMessage","startExport","execute","getProgressDialog","oDialogResolve","oncancel","open","oDialogSettings","rows","cellLimit","rowLimit","fileType","FileType","XLSX","showWarningDialog"],"sources":["Spreadsheet-dbg.js"],"mappings":"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"}