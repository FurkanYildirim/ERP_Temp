//@ui5-bundle sap/ui/export/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportBase", ["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,r,o){"use strict";var i=e.extend("sap.ui.export.ExportBase",{constructor:function(t,r){e.call(this,t);this._mCapabilities=r||{};this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this));if(this._mSettings.workbook){this._mSettings.workbook.hierarchyLevel=o.getHierarchyLevelProperty(t.dataSource);this._mSettings.workbook.drillState=o.getHierarchyDrillStateProperty(t.dataSource)}}});i.prototype.attachBeforeExport=function(t,e,r){return this.attachEvent("beforeExport",t,e,r)};i.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this._mSettings=null;this._mCapabilities=null;this.bIsDestroyed=true};i.prototype.cancel=function(){throw new Error("Abstract function not implemented")};i.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};i.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};i.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};i.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};i.prototype.build=function(){var t=this._mSettings;if(this.bIsDestroyed){var e=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";r.error(e);return Promise.reject(e)}return this.setDefaultExportSettings(t).then(function(){this.fireEvent("beforeExport",{exportSettings:t},false,false);o.validateSettings(t);return this.createBuildPromise(t)}.bind(this))};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportDialog", ["sap/ui/core/library","sap/ui/core/format/NumberFormat","sap/ui/export/ExportUtils","sap/m/library","sap/m/Dialog","sap/m/Button","sap/m/ProgressIndicator","sap/m/Text","sap/m/MessageBox"],function(e,t,n,s,i,a,r,o,u){"use strict";var l=e.ValueState;var T=s.DialogType;var g=s.ButtonType;function f(){return new Promise(function(e,t){var s;n.getResourceBundle().then(function(t){var n=new a({text:t.getText("CANCEL_BUTTON"),press:function(){if(s&&s.oncancel){s.oncancel()}s.finish()}});var u=new r({displayAnimation:false,displayValue:"0 / 0",showValue:true,height:"0.75rem",state:l.Information});u.addStyleClass("sapUiMediumMarginTop");var g=new o({text:t.getText("PROGRESS_FETCHING_MSG")});s=new i({title:t.getText("PROGRESS_TITLE"),type:T.Message,contentWidth:"500px",content:[g,u],endButton:n,ariaLabelledBy:[g]});s.updateStatus=function(e,s,i){var a;if(typeof e==="string"&&e){i=e;g.setText(i)}if(!isNaN(e)&!isNaN(s)){a=e/s*100}if(a>=100){u.setState(l.Success);n.setEnabled(false);g.setText(i||t.getText("PROGRESS_BUNDLE_MSG"))}u.setPercentValue(a);if(isNaN(s)||s<=0||s>=1048575){s="âˆž"}if(!isNaN(e)){u.setDisplayValue(""+e+" / "+s)}};s.finish=function(){s.close();s.destroy()};e(s)})})}function c(e){return new Promise(function(s,r){n.getResourceBundle().then(function(n){var u,f,c,p,N,_,R,x,E,m;u=[];f=false;N=t.getIntegerInstance({groupingEnabled:true});m=n.getText(e.fileType+"_FILETYPE");E=N.format(e.rowLimit);if(e.rows){_=N.format(e.rows);if(e.columns){R=N.format(e.rows*e.columns);u.push(n.getText("MSG_WARNING_CELL_COUNT",[_,e.columns,R]))}else{u.push(n.getText("MSG_WARNING_ROW_COUNT",[_]))}if(e.rows>e.rowLimit){u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,m]))}if(e.rows*e.columns>e.cellLimit){x=N.format(e.cellLimit);u.push(n.getText("MSG_WARNING_CELL_LIMIT",[x]))}}else{u.push(n.getText("MSG_WARNING_COUNT_UNKNOWN"));u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,m]));u.push(n.getText("MSG_WARNING_ADVICE"))}u.push(n.getText("MSG_WARNING_EXPORT_ANYWAY"));p=new o({text:u.join("\n\n")});c=new i({title:n.getText("WARNING_TITLE"),type:T.Message,state:l.Warning,content:p,contentWidth:"550px",ariaLabelledBy:p,endButton:new a({type:g.Transparent,text:n.getText("CANCEL_BUTTON"),press:function(){c.close()}}),beginButton:new a({type:g.Emphasized,text:n.getText("EXPORT_BUTTON"),press:function(){f=true;c.close()}}),afterClose:function(){c.destroy();f?s():r()}});c.open()})})}function p(e){if(!e){return}if(e instanceof Error){e=e.message}n.getResourceBundle().then(function(t){var n=e||t.getText("PROGRESS_ERROR_DEFAULT");if(e.toLowerCase().indexOf("invalid string length")>-1){n=t.getText("MSG_ERROR_OUT_OF_MEMORY")}u.error(n,{title:t.getText("PROGRESS_ERROR_TITLE")})})}return{getProgressDialog:f,showErrorMessage:p,showWarningDialog:c}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportHandler", ["./library","./ExportUtils","./ExportDialog","sap/m/MessageToast","sap/ui/core/Core","sap/ui/base/EventProvider","sap/ui/model/odata/v4/ODataModel","sap/ui/util/openWindow"],function(e,t,i,r,n,o,a,l){"use strict";var s=e.Destination;var u=e.FileType;var h=o.extend("sap.ui.export.ExportHandler",{constructor:function(e){var t=this;o.call(this);this._mCapabilities=e instanceof Object?e:{XLSX:{}};this._initialized=new Promise(function(e){t.isGoogleSheetSupported().then(function(e){if(e){t._mCapabilities[u.GSHEET]={};t._mDialogSettings={destination:s.REMOTE,fileType:u.GSHEET}}}).finally(e)})}});h.prototype.attachBeforeExport=function(e,t,i){return this.attachEvent("beforeExport",e,t,i)};h.prototype.detachBeforeExport=function(e,t){return this.detachEvent("beforeExport",e,t)};h.prototype.initialized=function(){return this._initialized};h.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments);if(this._oModel){this._oModel.destroy()}if(this._oFileShareBinding){this._oFileShareBinding.destroy()}if(this._oExportDialog){this._oExportDialog.destroy()}if(this._oFilePicker){this._oFilePicker.destroy()}this._mCapabilities=null;this._oDataSource=null;this._mDialogSettings=null;this._oModel=null;this._oFileShareBinding=null;this.bIsDestroyed=true};h.prototype.getFileShareContexts=function(){return this.getFileShareModel().then(function(e){if(!e){return Promise.resolve([])}if(!this._oFileShareBinding){this._oFileShareBinding=e.bindList("/FileShares")}return this._oFileShareBinding.requestContexts(0)}.bind(this))};h.prototype.getRemoteFileLocation=function(e){var i=this;return new Promise(function(r,n){Promise.all([t.getResourceBundle(),i.getFileShareModel()]).then(function(t){var o=t[0];var a=t[1];sap.ui.require(["sap/suite/ui/commons/CloudFilePicker"],function(t){var l;i._oFilePicker=l=new t({sharedModel:a,suggestedFileName:e,enableDuplicateCheck:true,fileNameMandatory:true,confirmButtonText:o.getText("EXPORT_BUTTON"),title:o.getText("DESTINATION_DIALOG_TITLE")});l.attachSelect(function(e){var t,i,a,l={};t=e.getParameter("selectedFiles");i=e.getParameter("selectedFolder");a=e.getParameter("replaceExistingFile");l={};l["FileShare"]=i.getFileShareId();l["FileShareItemKind"]="document";l["FileShareItemName"]=e.getParameter("selectedFileName");l["ParentFileShareItem"]=i.getFileShareItemId();if(a&&Array.isArray(t)&&t.length>0){var s=t.shift();l["FileShareItem"]=s.getFileShareItemId()}if(!l["FileShare"]){n(o.getText("DESTINATION_SELECTION_INCOMPLETE"))}r(l)});l.open()})})})};h.prototype.getExportInstance=function(e,n,o){var a=this;return Promise.all([t.getResourceBundle(),t.getExportInstance(e,this._mCapabilities)]).then(function(l){var s=l[0];var h=l[1];var c=[];var f;if(n&&n.includeFilterSettings){var p=e.workbook.context;if(!p){p=e.workbook.context={metainfo:[]}}f={name:s.getText("FILTER_HEADER"),items:[]};c=n.includeFilterSettings?t.getFilters(e.dataSource):[];p.metaSheetName=f.name;p.metainfo.push(f)}h.attachBeforeExport(function(e){var t=e.getParameter("exportSettings");a.fireEvent("beforeExport",{exportSettings:t,userExportSettings:n||{},filterSettings:c},false,false);c.filter(function(e){return e&&typeof e.isA==="function"&&e.isA("sap.ui.export.util.Filter")}).sort(function(e,t){var i=e.getLabel().toLowerCase();var r=t.getLabel().toLowerCase();if(i>r){return 1}if(i<r){return-1}return 0}).forEach(function(e){f.items.push({key:e.getLabel(),value:e.getValue()})})});if(o&&typeof h.attachBeforeSave==="function"){h.attachBeforeSave(function(t){var n,l;n=t.getParameter("data");l=t.getParameter("exportDialog");o["FileShareItemContentType"]=h.getMimeType();o["FileShareItemConvertToMimeType"]=h.getMimeType();if(e.fileType===u.GSHEET){o["FileShareItemConvertToMimeType"]="application/vnd.google-apps.spreadsheet"}var c=new Uint8Array(n);var f=new Array(c.length);for(var p=0;p<c.length;p++){f[p]=String.fromCharCode(c[p])}o["FileShareItemContent"]=btoa(f.join(""));l.updateStatus(s.getText("DESTINATION_DIALOG_STATUS"));t.preventDefault();a.uploadFile(o).then(function(){r.show(s.getText("DESTINATION_TRANSFER_SUCCESS"))}).catch(function(){i.showErrorMessage(s.getText("DESTINATION_TRANSFER_ERROR"))}).finally(function(){l.finish()})})}return h})};h.prototype.uploadFile=function(e){return this.getFileShareModel().then(function(t){var i,r,n,o,a;n="FileShareItemContent";o="FileShareItemContentType";if(e["FileShareItem"]){r=t.getKeepAliveContext("/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.FileShareItem+"')");r.setProperty("FileShareItemContentLink","",null);r.setProperty(o,e[o]);return r.setProperty(n,e[n]).then(function(){return r.getProperty("FileShareItemContentLink")})}if(e.ParentFileShareItem){a="/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.ParentFileShareItem+"')/_Children"}else{a="/FileShares(FileShare='"+e.FileShare+"')/_Root/_Children"}i=t.bindList(a);return this._createFile(i,e)}.bind(this)).then(function(e){if(e){l(e)}})};h.prototype._createFile=function(e,t){return new Promise(function(i,r){function n(t){var o,a;o=t.getParameter("success");a=t.getParameter("context");if(o){e.detachCreateCompleted(n);i(a.getProperty("FileShareItemContentLink"))}else{a.destroy();r()}}e.attachCreateCompleted(n);e.create(t,true)})};h.prototype.export=function(e){if(this.bIsDestroyed){Promise.reject("ExportHandler must not be used after calling #destroy")}return this.getExportInstance(e).then(function(e){return e.build().finally(function(){e.destroy()})})};h.prototype.exportAs=function(e,r){var n=this;var o;var a={};if(this.bIsDestroyed){return Promise.reject("ExportHandler must not be used after calling #destroy")}return this.initialized().then(function(){o=Object.assign({},e,n._mDialogSettings);return n.getFileShareContexts()}).then(function(e){return t.getExportSettingsViaDialog(o,n._mCapabilities,e.length>0,function(e){n._oExportDialog=e})}).then(function(e){n._mDialogSettings=e;Object.assign(o,e);t.validateFileSettings(o);a.splitCells=e.splitCells;a.includeFilterSettings=e.includeFilterSettings;if(o.fileType===u.PDF||e.splitCells){o.workbook.columns=t.splitColumns(o.workbook.columns,r)}if(o.includeFilterSettings){return t.parseTechnicalConfiguration()}return Promise.resolve()}).then(function(e){if(e){var t=o.workbook.context;if(!t){t=o.workbook.context={}}t.metainfo=Array.isArray(t.metainfo)?t.metainfo.push(e):[e]}}).then(function(){if(o.destination===s.LOCAL){return Promise.resolve()}return n.getRemoteFileLocation(o.fileName)}).then(function(e){if(e&&!e["FileShareItem"]){e.FileShareItemName=t.validateFileName(e.FileShareItemName,o.fileType)}if(o.fileType===u.GSHEET){return n.validateFileShare(e)}return e}).then(function(e){return n.getExportInstance(o,a,e).then(function(e){return e.build().finally(function(){e.destroy()})})}).catch(i.showErrorMessage)};h.prototype.validateFileShare=function(e){return Promise.all([t.getResourceBundle(),this.getFileShareContexts()]).then(function(t){var i=t[0];var r=t[1];var n=r.find(function(t){return t.getProperty("FileShare")===e.FileShare});return this.isGoogleWorkspace(n)?e:Promise.reject(i.getText("DESTINATION_ERROR_NOT_GOOGLE"))}.bind(this))};h.prototype.getFileShareModel=function(){if(this._oModel){return Promise.resolve(this._oModel)}return t.fetchDataSource().then(function(e){if(e){this._oModel=new a({serviceUrl:e.uri,synchronizationMode:"None",autoExpandSelect:true})}return this._oModel}.bind(this))};h.prototype.isGoogleSheetSupported=function(){return this.getFileShareContexts().then(function(e){return e.some(this.isGoogleWorkspace)}.bind(this))};h.prototype.isGoogleWorkspace=function(e){var t,i;i=e.getProperty("FileShareVendorType");if(new URL(window.location.href).search.indexOf("sap-ui-xx-enableGoogleSheets=true")===-1){return i==="GOOGLE"}t=e.getProperty("FileShareDescription");return i==="GOOGLE"||typeof t==="string"&&t.indexOf("Google")>-1};return h},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportUtils", ["./library","sap/base/Log","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/library","sap/ui/core/syncStyleClass","sap/ui/export/util/Filter","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/util/openWindow","sap/ui/VersionInfo","sap/ui/core/format/DateFormat","sap/ui/performance/trace/FESRHelper"],function(e,t,r,a,n,i,o,l,u,s,f,p,c){"use strict";var d=n.ValueState;var g=n.CalendarType;var y=e.FileType;var m=e.EdmType;var v=e.Destination;var h=null;var S=null;var b;var T="sap.ui.export.ExportUtils";var E=/[\\\/\?\*:\[\]]/g;f.load().then(function(e){var t=/^[0-9]+\.[0-9]+/.exec(e.version);h=t?t[0]:null});r.attachLocalizationChanged(function(){S=null});function w(e,t,r,a){var n=Object.keys(r);var i={fileName:"Standard",fileTypeCollection:[],fileType:"XLSX",destinationCollection:[{key:v.LOCAL,text:t.getText("DESTINATION_LOCAL")}],destination:v.LOCAL,paperSize:"DIN_A4",orientation:"LANDSCAPE",splitCells:false,includeFilterSettings:false,addDateTime:false,doEnableAccessibility:false,pdfArchive:false,capabilities:r,fitToPage:false,paperSizeCollection:[{key:"DIN_A4",text:t.getText("PAPER_SIZE_A4")},{key:"US_LETTER",text:t.getText("PAPER_SIZE_US_LETTER")}],orientationCollection:[{key:"LANDSCAPE",text:t.getText("ORIENTATION_LAND")},{key:"PORTRAIT",text:t.getText("ORIENTATION_PORT")}],fontSize:10,signature:false,signatureReason:"",showPageNumber:true};n.forEach(function(e){var r,a;r=e.toUpperCase();a=r+"_FILETYPE";i.fileTypeCollection.push({key:r,text:t.getText(a)})});if(a){i.destinationCollection.push({key:"REMOTE",text:t.getText("DESTINATION_REMOTE")})}var o=Object.assign({},i,e||{});if(!o.fileTypeCollection.some(function(e){return e.key===o.fileType})){o.fileType=o.fileTypeCollection[0].key}return o}function P(e){var t={};["fileName","fileType","paperSize","orientation","splitCells","includeFilterSettings","addDateTime","doEnableAccessibility","fitToPage","fontSize","signature","signatureReason","pdfArchive","destination","showPageNumber"].forEach(function(r){t[r]=e[r]});return t}var A={_INTERCEPTSERVICE:"sap/ushell/cloudServices/interceptor/InterceptService",interceptUrl:function(e){var t=sap.ui.require(A._INTERCEPTSERVICE);if(t){var r=t.getInstance();if(r&&r.interceptUrl){e=r.interceptUrl(e)}}return e},fetchDataSource:function(){var e;if(A._oDataSource){return Promise.resolve(A._oDataSource)}e=r.getConfiguration().getFileShareSupport();if(!e){return Promise.resolve()}return new Promise(function(t){sap.ui.require([e],function(e){e.getDataSource().then(function(e){A._oDataSource=e;t(e)}).catch(function(){t()})})})},normalizeUrl:function(e){return e?new URL(e,document.baseURI).toString():e},getExportSettingsViaDialog:function(e,t,n,o,s){return new Promise(function(f,p){var g;if(typeof n==="object"){s=o;o=n;n=undefined}else if(typeof n==="function"){s=n;n=undefined}else if(typeof o==="function"){s=o;o=null}A.getResourceBundle().then(function(m){var h=new l;h.setData(w(e,m,t,n));a.load({name:"sap.ui.export.fragments.SettingsDialog",type:"XML",controller:{isPDF:function(e){return e===y.PDF},isSpreadsheet:function(e){return e===y.XLSX||e===y.GSHEET},isDestinationEnabled:function(e){return e===y.XLSX},hasDestinations:function(e){return e.length>1},formatExportButton:function(e){return e===v.LOCAL?m.getText("EXPORT_BUTTON"):m.getText("DIALOG_BUTTON_CLOUD_DESTINATION")},onCancel:function(){g._bSuccess=false;g.close()},onExport:function(){g._bSuccess=true;g.close()},onFileNameChange:function(e){var t=e.getSource();var a=e.getParameter("value");var n=/[\\/:|?"*<>]/;var i=r.byId("exportSettingsDialog-exportButton");var o=n.test(a);if(o){t.setValueState(d.Error);t.setValueStateText(m.getText("FILENAME_ERROR"))}else if(a.length>100){t.setValueState(d.Warning);t.setValueStateText(m.getText("FILENAME_WARNING"))}else{t.setValueState(d.None);t.setValueStateText(null)}i.setEnabled(!o)},onFileTypeChange:function(e){var t=e.getParameter("selectedItem");if(!t){return}switch(t.getKey()){case y.PDF:h.setProperty("/includeFilterSettings",false);h.setProperty("/destination",v.LOCAL);break;case y.GSHEET:h.setProperty("/destination",v.REMOTE);break;default:r.byId("exportSettingsDialog-signatureReason").setVisible(false);r.byId("exportSettingsDialog-signatureReasonLabel").setVisible(false)}},onFontSizeChange:function(e){var t=e.getSource();var a=e.getParameter("value");var n=/[^\d]/g;var i=r.byId("exportSettingsDialog-exportButton");var o=n.test(a);if(o){t.setValueState(d.Error);t.setValueStateText(m.getText("NUMBER_ERROR"))}else{t.setValueState(d.None);t.setValueStateText(null)}i.setEnabled(!o)},onAfterClose:function(){if(g._bSuccess){f(P(h.getData()))}else{p(null)}g.destroy();g=null}}}).then(function(e){g=e;if(t.PDF&&!t.PDF["HeaderFooter"]){h.oData.showPageNumber=false}g.setModel(h);g.setModel(new u({bundle:m}),"i18n");if(o){i("sapUiSizeCompact",o,g)}c.setSemanticStepname(g.getBeginButton(),"press","oi:exp:export");c.setSemanticStepname(g.getEndButton(),"press","oi:exp:cancel");g.open();if(s){s(g)}})})})},_getReadableFilterValue:function(e){switch(e.op||e.name){case"==":case">":case"<":case"!=":case"<=":case">=":return{operator:e.op||e.name,value:e.right.value};case"between":return{operator:e.op||e.name,value:[e.args[1].value,e.args[2].value]};case"contains":case"endswith":case"startswith":return{operator:e.op||e.name,value:e.args[1].value};default:throw Error("getReadableFilter")}},_parseFilter:function(e){switch(e.type){case"Logical":return A._parseLogical(e);case"Binary":return A._parseBinary(e);case"Unary":return A._parseUnary(e);case"Call":return A._parseCall(e);default:throw Error("Filter type "+e.type+" not supported")}},_parseLogical:function(e){var t,r;try{if(e.op=="&&"&&e.left.type==="Binary"&&e.right.type==="Binary"&&e.left.op===">="&&e.right.op==="<="&&e.left.left.path===e.right.left.path){return A._parseCall({args:[{path:e.left.left.path,type:"Reference"},{type:"Literal",value:e.left.right.value},{type:"Literal",value:e.right.right.value}],name:"between",type:"Call"})}t=A._parseFilter(e.left).concat(A._parseFilter(e.right));if(e.op==="||"&&t.length){r=t[0].key;if(t.every(function(e){return e.key===r})){t=[{key:r,value:t.reduce(function(e,t){if(Array.isArray(t.value)){return e.concat(t.value)}e.push(t.value);return e},[])}]}}}catch(e){t=[]}return t},_parseBinary:function(e){if(!e.left||e.left.type!="Reference"||!e.right||e.right.type!="Literal"){return[]}return[{key:e.left.path,value:A._getReadableFilterValue(e)}]},_parseUnary:function(e){var t;if(!e.arg){return[]}t=A._parseFilter(e.arg);if(e.op==="!"&&t[0].value){t[0].value.exclude=true}return t},_parseCall:function(e){if(!e.args||e.args.length<2){return[]}return[{key:e.args[0].path,value:A._getReadableFilterValue(e)}]},parseFilterConfiguration:function(){t.error("Function is deprecated and must not be used anymore");return A.getResourceBundle().then(function(e){return{name:e.getText("FILTER_HEADER"),items:[]}})},getFilters:function(e){var r,a;r=[];if(!e||!e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){t.error("A ListBinding or TreeBinding is required for parsing the filter settings");return r}a=e.getFilterInfo();if(a){A._parseFilter(a).forEach(function(e){r.push(new o(e.key,e.value))})}return r},parseTechnicalConfiguration:function(){var e,t,r;e={};r=sap.ushell&&sap.ushell.Container;return A.getResourceBundle().then(function(r){t=r;e.name=t.getText("TECHNICAL_INFORMATION");e.items=[{key:t.getText("CREATED_TIME"),value:p.getDateTimeWithTimezoneInstance().format(new Date)}]}).then(function(){return r&&typeof r.getServiceAsync==="function"?r.getServiceAsync("UserInfo"):undefined}).then(function(r){if(r&&r.getFullName()){e.items.unshift({key:t.getText("USER_NAME"),value:r.getFullName()})}return e})},saveAsFile:function(e,t){var r,a,n;if(!(e instanceof Blob)){return}r=document.createElementNS("http://www.w3.org/1999/xhtml","a");a="download"in r;if(a){n=function(e,t){r.download=t;r.href=URL.createObjectURL(e);r.dispatchEvent(new MouseEvent("click"))}}if(typeof n==="undefined"){n=function(e){var t=new FileReader;t.onloadend=function(){var e,r;r=t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e=s(r,"_blank");if(!e){window.location.href=r}};t.readAsDataURL(e)}}n(e,t)},validateSettings:function(e){A._validateDataSource(e.dataSource);A.validateFileSettings(e);if(typeof e.showProgress!=="boolean"){e.showProgress=true}A._validateWorkbook(e.workbook);if(typeof e.worker!=="boolean"){e.worker=true}A._validateScaleCustomizing(e.customizing,"currency");A._validateScaleCustomizing(e.customizing,"unit")},validateFileSettings:function(e){e.fileType=y[e.fileType]?e.fileType:y.XLSX;e.fileName=A.validateFileName(e.fileName,e.fileType)},validateFileName:function(e,r){var a;e=e||"export";a="."+r.toLowerCase();if(!e.endsWith(a)&&r!==y.GSHEET){e+=a;t.info(T+": fileName was missing the proper file extension - extension has been added")}return e},_validateDataSource:function(e){var r;if(!e||typeof e!=="object"){throw new Error(T+": dataSource has not been specified")}e.type=typeof e.type==="string"&&e.type.toLowerCase()||"odata";if(e.type==="array"&&!Array.isArray(e.data)){t.warning(T+": Defined type does not match the provided data")}if(Array.isArray(e.data)){e.count=e.data.length}if(e.type==="odata"){if(typeof e.dataUrl!=="string"||e.dataUrl.length===0){throw new Error(T+": Unable to export data. No dataUrl provided.")}if(e.dataUrl){e.dataUrl=A.normalizeUrl(e.dataUrl)}if(e.serviceUrl){e.serviceUrl=A.normalizeUrl(e.serviceUrl)}}if(typeof e.count!=="number"||e.count<0||isNaN(e.count)||e.count%1!==0){t.info(T+": Invalid value for dataSource.count - value will be ignored");e.count=null}if(typeof e.useBatch!=="boolean"){e.useBatch=false;t.info(T+': Parameter useBatch not provided. Applying default value "false"')}else if(e.useBatch===true){if(typeof e.serviceUrl!=="string"||e.serviceUrl.length===0){e.useBatch=false;t.warning(T+": serviceUrl is required for OData batch requests")}if(typeof e.headers!=="object"){e.useBatch=false;t.warning(T+": headers are required for OData batch requests.")}}r=e.sizeLimit;if(!r||isNaN(r)||r%1!==0){var a=5e3,n=200;r=e.count?Math.round(e.count/(n*5))*n:n;r=Math.min(a,Math.max(r,n));e.sizeLimit=r;t.info(T+": No valid sizeLimit provided. sizeLimit is set to "+r)}},_validateWorkbook:function(e){if(!(e instanceof Object)||!Array.isArray(e.columns)){throw new Error(T+"column configuration is not provided. Export is not possible")}e.columns=e.columns.filter(function(e,a){var n;if(!(e instanceof Object)){t.error(T+": Column "+a+" skipped due to invalid configuration");return false}if(Array.isArray(e.property)&&e.type!==m.String&&e.type!=null){t.warning(T+": Type "+e.type+" does not support an array of properties");e.property=e.property[0]}if(typeof e.property!=="string"&&!Array.isArray(e.property)){t.error(T+": Column "+a+" skipped due to missing mandatory property");return false}e.label=e.label||(e.property instanceof Array?e.property[0]:e.property);n=e.width;if(typeof n==="string"){var i;i=n.toLowerCase();n=parseFloat(i);if(i.indexOf("em")>0){n=n*2}else if(i.indexOf("px")>0){n=n/8}}if(isNaN(n)||n<1){n=10}e.width=Math.round(n);A._validateType(e,a);A._validateString(e,"textAlign");if(e.textAlign){var o=(e.textAlign+"").toLowerCase();if(["begin","end"].indexOf(o)>-1){var l=["left","right"];o=(r.getConfiguration().getRTL()?l.reverse():l)[["begin","end"].indexOf(o)]}if(o!==""&&["left","right","center"].indexOf(o)==-1){t.warning(T+": Incorrect column alignment value "+o+' on column "'+(e.label||e.property)+'". Default alignment is used.');o=""}e.textAlign=o}["autoScale","delimiter","displayTimezone","displayUnit","utc","wrap"].forEach(function(t){A._validateProperty(e,t,"boolean")});["inputFormat","unit","unitProperty","template","trueValue","falseValue","timezone","timezoneProperty"].forEach(function(t){A._validateString(e,t)});if(e.template&&!Array.isArray(e.property)&&typeof e.inputFormat!=="string"){t.warning(T+': Template is not applicable on a single property without inputFormat - value will be discarded on column "'+(e.label||e.property)+'".');delete e.template}if(typeof e.calendar==="string"&&[g.Gregorian,g.Islamic,g.Japanese].indexOf(e.calendar)<0){t.warning(T+': Unsupported calendar "'+e.calendar+'" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.calendar}if(e.type===m.Boolean&&(e.trueValue===null||e.falseValue===null)){t.warning(T+': The properties trueValue and falseValue have to be assigned correctly on column "'+(e.label||e.property)+'". Values will be discarded.');delete e.trueValue;delete e.falseValue}if(e.autoScale===true&&(e.type!==m.Number||!e.unit&&!e.unitProperty)){t.warning(T+": autoScale cannot be taken into account due to invalid configuration.");delete e.autoScale}if(e.type===m.DateTime){if(!e.timezone){e.timezone=e.utc===false?r.getConfiguration().getTimezone():"UTC"}if(e.property===e.timezoneProperty||typeof e.timezoneProperty==="string"&&e.timezoneProperty.split(",").length>1){t.warning(T+": Property timezoneProperty is invalid.");delete e.timezoneProperty}}else if(typeof e.utc==="boolean"){t.warning(T+": Property utc is only supported for type DateTime.");delete e.utc}var u=e.scale;if(e.type===m.Number&&isNaN(u)&&u!=="variable"){t.warning(T+": scale parameter for numerical column configuration is missing.")}if(typeof u==="string"){u=parseInt(u)}if(isNaN(u)){u=null}e.scale=u;if(e.valueMap&&typeof e.valueMap!=="object"){t.warning(T+': Invalid value for property "valueMap" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.valueMap}return true});A._validateWorkbookContext(e.context);A._validateString(e,"hierarchyLevel");A._validateString(e,"drillState")},_validateType:function(e){var r,a;if(typeof e.type!=="string"){e.type=m.String;return}if(!m[e.type]){a=m.String;for(r in m){if(r.toLowerCase()==e.type.toLowerCase()){a=r}}t.warning(T+": Unsupported column type "+e.type+' on column "'+(e.label||e.property)+'". EdmType.'+a+" is applied.");e.type=a}switch(e.type){case m.Date:if(!e.format&&!e.calendar){A._validateString(e,"format",A.getFormatSettings().datePattern);A._validateString(e,"calendar",A.getFormatSettings().calendar)}break;case m.DateTime:if(!e.format&&!e.calendar){A._validateString(e,"format",A.getFormatSettings().dateTimePattern);A._validateString(e,"calendar",A.getFormatSettings().calendar)}break;case m.Time:A._validateString(e,"format",A.getFormatSettings().timePattern);break;case m.Number:break;case m.Currency:if(!e.unitProperty){t.warning(T+': Missing unitProperty for type Currency on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=m.String}break;case m.Enumeration:if(!e.valueMap||typeof e.valueMap!=="object"){t.warning(T+': Invalid valueMap for type Enumeration on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=m.String}break;default:}},_validateWorkbookContext:function(e){if(!(e instanceof Object)){return}A._validateString(e,"application","SAP UI5");A._validateString(e,"version",h);A._validateString(e,"title");A._validateString(e,"modifiedBy");A._validateString(e,"sheetName","SAPUI5 Spreadsheet Export",31,E);A._validateString(e,"metaSheetName","Metadata",31,E);if(e.metainfo){if(!Array.isArray(e.metainfo)){t.warning(T+': Invalid value for property "metainfo". Value will be discarded.');e.metainfo=null}else{e.metainfo.filter(function(e,r){if(typeof e.name!=="string"||e.name.length===0){t.warning(T+": Invalid name for metainfo group at index "+r+". Entry will be discarded.");return false}return true})}}},_validateString:function(e,r,a,n,i){var o;A._validateProperty(e,r,"string",a);o=e[r];if(typeof o==="string"&&(typeof i==="string"||i instanceof RegExp)){o=o.replace(i,"")}if(typeof o==="string"&&n&&o.length>n){t.warning(T+": The value of "+r+" exceeds the max length of "+n+" and will be truncated.");o=o.slice(0,n)}e[r]=o},_validateProperty:function(e,r,a,n){var i=e[r];if(i!=null&&typeof i!==a){t.warning(T+': Invalid value for property "'+r+". Value will be discarded.");i=null}if(i==null&&typeof n!=="undefined"){i=n}if(i==null){delete e[r]}else{e[r]=i}},_validateScaleCustomizing:function(e,r){var a,n;if(!e){return}n=e[r];if(!(n instanceof Object)||Array.isArray(n)){t.warning(T+": Invalid scale customizing for "+r+".");e[r]={}}else{for(a in n){if(!(n[a]instanceof Object)){t.warning(T+": Key "+a+" has been removed from customizing.");delete n[a]}else if(typeof n[a].scale!=="number"||n[a].scale<0){t.warning(T+": Key "+a+" has been removed from customizing due to invalid scale.");delete n[a]}}}},getExportInstance:function(e,t){var r,a;t=t?t:{};a=typeof e.fileType==="string"?e.fileType.toUpperCase():e.fileType;switch(a){case y.PDF:r="sap/ui/export/PortableDocument";break;default:r="sap/ui/export/Spreadsheet"}return new Promise(function(n){sap.ui.require([r],function(r){n(new r(e,t[a]))})})},getCountFromBinding:function(e){var t;if(typeof e.getCount==="function"){t=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){t=e.getLength()}if(typeof t!=="number"||t<0||isNaN(t)){t=null}return t},getHierarchyLevelProperty:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-level-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){var t=e.getAggregation(true);return t&&t.$DistanceFromRootProperty}return undefined},getHierarchyDrillStateProperty:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-drill-state-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){var t=e.getAggregation(true);return t&&t.$DrillStateProperty}return undefined},splitColumns:function(e,t){var r=[];if(typeof t!=="function"){t=function(){}}e.forEach(function(e){var a,n,i,o;if(Array.isArray(e.property)&&e.property.length>1){n=Object.assign({},e);n.property=e.property[0];n.label=t(n.property)||e.label;delete n.template;a=[n];e.property.slice(1).forEach(function(r,n){o=t(r);i={property:r,label:o||e.label+" ("+(n+1)+")"};a.push(i)})}if(e.unitProperty&&e.displayUnit!==false){n=Object.assign({},e);o=t(e.unitProperty);a=[n,{property:e.unitProperty,label:o||e.label+" (1)"}];if(n.type===m.Currency){n.displayUnit=false}if(n.type===m.Number){delete n.unitProperty}}if(e.timezoneProperty&&e.displayTimezone!==false){n=Object.assign({},e);o=t(e.timezoneProperty);a=[n,{property:e.timezoneProperty,label:o||e.label+" (1)"}];n.displayTimezone=false}r.push(a||e)});return r.flat()},getResourceBundle:function(){if(!b){return r.getLibraryResourceBundle("sap.ui.export",true).then(function(e){b=e;return b})}return Promise.resolve(b)},getFormatSettings:function(){if(!S){var e,t;t={};e=r.getConfiguration().getFormatSettings();t.calendar=r.getConfiguration().getCalendarType();t.datePattern=e.getDatePattern("medium");t.timePattern=e.getTimePattern("medium");t.delimiter=!!e.getNumberSymbol("group");if(typeof t.datePattern==="string"){t.datePattern=t.datePattern.toLowerCase()}if(typeof t.timePattern==="string"){t.timePattern=t.timePattern.toLowerCase().replace(/ a+/," AM/PM")}if(t.datePattern&&t.timePattern){t.dateTimePattern=t.datePattern+" "+t.timePattern}S=t}return S}};return A},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/PortableDocument", ["sap/base/Log","sap/ui/core/Core","sap/ui/export/ExportBase","sap/ui/export/ExportUtils","sap/ui/export/library","sap/ui/model/odata/v4/ODataModel","./ExportDialog","sap/m/BusyDialog"],function(e,t,r,o,i,n,a,s){"use strict";var u=i.FileType;var c=r.extend("sap.ui.export.PortableDocument",{constructor:function(e,t){r.call(this,e,t);["paperSize","orientation","font","fontSize","doEnableAccessibility","fitToPage","signature","signatureReason","pdfArchive","showPageNumber"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this))}});c.prototype.processDataSource=function(t){var r=null;var o=typeof t;if(!t){return null}if(o!="object"){e.error("Spreadsheet#processDataSource: Unable to apply data source of type "+o);return null}if(t.dataUrl&&t.serviceUrl){r=t}if(t.isA&&t.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){r=this.createDataSourceFromBinding(t)}return r};c.prototype.createDataSourceFromBinding=function(t){var r=null;if(t.isA(["sap.ui.model.ClientListBinding","sap.ui.model.ClientTreeBinding"])){e.error("Unable to create dataSource configuration due to not supported Binding: "+t.getMetadata().getName())}if(typeof t.getDownloadUrl==="function"){var i=t.getModel(),n=o.interceptUrl(t.getDownloadUrl("pdf")),a=o.interceptUrl(i.sServiceUrl),s=i.isA("sap.ui.model.odata.v4.ODataModel");var u=new URL(n,document.baseURI);u.hash="";this._oModel=i;u.search=u.search.split("&").filter(function(e){return e.indexOf("$format")==-1}).join("&");r={type:"odata",version:s?4:2,dataUrl:u.toString(),serviceUrl:this._resolveServiceUrl(a),headers:s?i.getHttpHeaders(true):i.getHeaders(),count:o.getCountFromBinding(t)}}return r};c.prototype._resolveServiceUrl=function(e){var t,r;e+=e.endsWith("/")?"":"/";t=/^[\./]/.test(e);r=this._mCapabilities.DocumentDescriptionReference;if(typeof r!=="string"){return e.split("/").slice(0,-5).join("/")+"/default/iwbep/common/0001/"}r=r.endsWith("/")?r:r.split("/").slice(0,-1).join("/")+"/";var o=new URL(e,document.baseURI);o=new URL(r,o.href);return t?o.pathname:o.href};c.prototype._createDocumentDescription=function(e){var t=e.workbook;var r,o;r={Title:t.context.title,Format:{PaperSize:e.paperSize,Orientation:e.orientation,FontSize:Number(e.fontSize),FitToPage:{IsEnabled:e.fitToPage,MinimumFontSize:4}},PDFStandard:{DoEnableAccessibility:e.doEnableAccessibility,UsePDFAConformance:e.pdfArchive},Signature:{DoSign:e.signature,Reason:e.signatureReason},CoverPage:[],TableColumns:[]};if(t.hierarchyLevel&&t.drillState){r.Hierarchy={DistanceFromRootElement:t.hierarchyLevel,DrillStateElement:t.drillState}}if(e.showPageNumber){r["Footer"]={Center:{Type:"PAGENUM"}}}o=t.context.metainfo;if(o instanceof Array){if(e.dataSource.version==2){o.forEach(function(e){e.items.forEach(function(t){var o={Title:e.name,Name:t.key,Value:t.value};r["CoverPage"].push(o)})})}else{o.forEach(function(e){var t={Title:e.name,Content:[]};e.items.forEach(function(e){t["Content"].push({Name:e.key,Value:e.value})});r["CoverPage"].push(t)})}}t.columns.filter(function(e,t,r){var o=Array.isArray(e.property)?e.property[0]:e.property;if(!o){return false}return r.findIndex(function(e){var t=Array.isArray(e.property)?e.property[0]:e.property;return o===t})===t}).forEach(function(e){r["TableColumns"].push({Name:Array.isArray(e.property)?e.property[0]:e.property,Header:e.label})});return r};c.prototype._getEntitySetName=function(e){var t,r;r=e&&e.version||2;if(this._mCapabilities&&typeof this._mCapabilities.DocumentDescriptionCollection==="string"){t=this._mCapabilities.DocumentDescriptionCollection}return t||(r==4?"MyDocumentDescriptions":"SAP__MyDocumentDescriptions")};c.prototype._getModel=function(e){var t=e.version||2;return t===4?new n({serviceUrl:e.serviceUrl,synchronizationMode:"None"}):this._oModel};c.prototype._showWarning=function(e){var t,r;t={rows:e.dataSource.count,rowLimit:this._mCapabilities.ResultSizeMaximum,fileType:u.PDF};r=Promise.resolve();if(isNaN(t.rows)||t.rows>t.rowLimit){r=a.showWarningDialog(t)}return r};c.prototype._applyResultSize=function(e){var t,r;t=parseInt(this._mCapabilities.ResultSizeMaximum);if(!isNaN(t)&&t>0){r=new URL(e);r.search+="&$top="+t;e=r.toString()}return e};c.prototype.setDefaultExportSettings=function(e){var r=e&&e.workbook&&e.workbook.context;if(!(r instanceof Object)){r=e.workbook.context={}}if(typeof r.title==="string"&&r.title){return Promise.resolve()}return t.getLibraryResourceBundle("sap.ui.export",true).then(function(e){r.title=e.getText("XLSX_DEFAULT_TITLE")})};c.prototype.postDocumentDescription=function(e,t){var r,o,i;o=this._getModel(t);i="/"+this._getEntitySetName(t);if(!o||!o.isA(["sap.ui.model.odata.v4.ODataModel","sap.ui.model.odata.v2.ODataModel"])){return Promise.reject("Unsupported Model")}return new Promise(function(t,n){if(o.isA("sap.ui.model.odata.v4.ODataModel")){r=o.bindList(i);r.attachCreateCompleted(function(e){var r=e.getParameter("success");if(r){t(e.getParameter("context").getObject()["Id"])}else{n()}});r.create(e)}else{var a=o.bUseBatch;o.setUseBatch(false);o.create(i,e,{success:function(e){o.setUseBatch(a);t(e["Id"])},error:function(e){o.setUseBatch(a);n(e)}})}})};c.prototype.createBuildPromise=function(e){var r=this;var i;var n;var u=t.getLibraryResourceBundle("sap.ui.export");n=new s("PDFExportBusyDialog",{title:u.getText("PROGRESS_TITLE"),text:u.getText("PDF_GENERATION_IN_PROGRESS"),showCancelButton:true,close:function(e){if(e.getParameter("cancelPressed")){r.cancel()}n.destroy();n=null}});i=r._createDocumentDescription(e);n.open();return this._showWarning(e).then(function(){return r.postDocumentDescription(i,e.dataSource)}).then(function(t){return n&&r.sendRequest(e.dataSource.dataUrl,t)}).then(function(t){o.saveAsFile(t,e.fileName)}).catch(function(e){if(!e){return}e.text().then(function(e){a.showErrorMessage(e)}).catch(function(){a.showErrorMessage(u.getText("PDF_GENERIC_ERROR"))})}).finally(function(){n&&n.close()})};c.prototype.sendRequest=function(e,t){e=this._applyResultSize(e);return new Promise(function(r,o){var i=this.request=new XMLHttpRequest;i.open("GET",e);i.responseType="blob";i.setRequestHeader("Accept",this.getMimeType());i.setRequestHeader("SAP-Document-Description-Id",t);i.addEventListener("abort",function(){o(null)});i.addEventListener("error",function(){o("Error occured while requesting data")});i.addEventListener("load",function(){var e=i.status;if(e>=200&&e<400){r(i.response)}else{o(i.response)}});i.send()}.bind(this))};c.prototype.getMimeType=function(){return"application/pdf"};c.prototype.cancel=function(){if(this.request&&this.request.readyState!=XMLHttpRequest.DONE){this.request.abort();this.request=null}};c.prototype.destroy=function(){r.prototype.destroy.apply(this,arguments);this._oModel=null};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/Spreadsheet", ["sap/ui/core/Core","./ExportDialog","sap/ui/export/ExportBase","sap/ui/Device","sap/ui/export/SpreadsheetExport","sap/base/Log","sap/ui/export/ExportUtils","sap/ui/export/library"],function(e,t,r,o,i,s,n,a){"use strict";var u="sap.ui.export.Spreadsheet";var c=r.extend(u,{constructor:function(e){r.call(this,e);this._mSettings.customizing={};this._mSettings.showProgress=true;this._mSettings.worker=true;["showProgress","worker"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this));this.codeListsPromise=this.codeListsPromise instanceof Promise?this.codeListsPromise:Promise.resolve()}});function p(e,t,r){if(!(r[e]instanceof Object)){r[e]={}}if(!isNaN(t.digits)){r[e].scale=t.digits}if(!isNaN(t.UnitSpecificScale)){r[e].scale=t.UnitSpecificScale}if(isNaN(r[e].scale)){delete r[e]}}c.prototype.setDefaultExportSettings=function(t){var r,o,i;o=t.customizing.currency={};var s=e.getConfiguration().getFormatSettings().getCustomCurrencies();if(s){for(r in s){p(r,s[r],o)}}return this.codeListsPromise.then(function(e){var r,s,n;if(!Array.isArray(e)){return}i=t.customizing.unit={};r=e[0];s=e[1];for(n in r){p(n,r[n],o)}for(n in s){p(n,s[n],i)}}).then(function(){return e.getLibraryResourceBundle("sap.ui.export",true)}).then(function(e){var r=t.workbook.context;if(!(r instanceof Object)){r=t.workbook.context={}}if(!r.title){r.title=e.getText("XLSX_DEFAULT_TITLE")}if(!r.sheetName){r.sheetName=e.getText("XLSX_DEFAULT_SHEETNAME")}})};c.requestCodeLists=function(e){if(!e.isA(["sap.ui.model.odata.ODataMetaModel","sap.ui.model.odata.v4.ODataMetaModel"])){return Promise.resolve([null,null])}return Promise.all([e.requestCurrencyCodes(),e.requestUnitsOfMeasure()]).catch(function(e){s.warning(u+": Code lists cannot be processed due to the following error - "+e);return Promise.resolve([null,null])})};c.prototype.attachBeforeSave=function(e,t,r){return this.attachEvent("beforeSave",e,t,r)};c.prototype.detachBeforeSave=function(e,t){return this.detachEvent("beforeSave",e,t)};c.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null}return this};c.prototype.getMimeType=function(){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};c.prototype.onprogress=function(e,t){var r;if(isNaN(e)||isNaN(t)){return}r=Math.round(e/t*100);s.debug("Spreadsheet export: "+r+"% loaded.")};c.prototype.createDataSourceFromBinding=function(e){var t=[];if(e.isA("sap.ui.model.ClientListBinding")){var r=[];e.getAllCurrentContexts().forEach(function(e){r.push(e.getObject())});t={data:r,type:"array"}}if(e.isA("sap.ui.model.ClientTreeBinding")){s.error("Unable to create dataSource configuration due to not supported Binding: "+e.getMetadata().getName())}if(typeof e.getDownloadUrl==="function"){var o=e.getModel(),i=e.getDownloadUrl("json"),a=o.sServiceUrl,u=o.isA("sap.ui.model.odata.v4.ODataModel");i=n.interceptUrl(i);a=n.interceptUrl(a);t={type:"odata",dataUrl:i,serviceUrl:a,headers:u?o.getHttpHeaders(true):o.getHeaders(),count:n.getCountFromBinding(e),useBatch:u||o.bUseBatch};if(o.getMetaModel()&&typeof o.getMetaModel().requestCurrencyCodes==="function"&&typeof o.getMetaModel().requestUnitsOfMeasure==="function"){this.codeListsPromise=c.requestCodeLists(o.getMetaModel(),this._mSettings)}}return t};c.prototype.processDataSource=function(e){var t=null;var r=typeof e;if(!e){return null}if(r=="string"){return{count:this._mSettings.count,dataUrl:e,type:"odata",useBatch:false}}if(r!="object"){s.error("Spreadsheet#processDataSource: Unable to apply data source of type "+r);return null}if(e instanceof Array){t={data:e,type:"array"}}if(e.dataUrl){t=e}if(e.isA&&e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){t=this.createDataSourceFromBinding(e)}return t};c.prototype.createBuildPromise=function(e){var r=this;return new Promise(function(s,u){var c;var p=1048576;var l=o.system.desktop?2e6:1e5;var f=e.dataSource.type=="array"?e.dataSource.data.length:e.dataSource.count;var d=e.workbook.columns.length;function g(o){if(o.progress){if(c){c.updateStatus(o.fetched,o.total)}r.onprogress(o.fetched,o.total)}if(o.finished&&r.process!==null){r.process=null;if(!o.spreadsheet){u();return}var i=r.fireEvent("beforeSave",{data:o.spreadsheet,exportDialog:c},true,true);if(i){if(c){window.setTimeout(c.finish,1e3)}n.saveAsFile(new Blob([o.spreadsheet],{type:r.getMimeType()}),e.fileName)}s()}if(typeof o.error!="undefined"){var a=o.error.message||o.error;r.process=null;if(c){c.finish()}u(a);t.showErrorMessage(a)}}function h(){if(!e.showProgress){if(r.process){u("Cannot start export: the process is already running");return}r.process=i.execute(e,g);return}t.getProgressDialog().then(function(t){c=t;if(r.process){u("Cannot start export: the process is already running");return}c.oncancel=function(){return r.process&&r.process.cancel()};c.open();c.updateStatus(0,e.dataSource.count);r.process=i.execute(e,g)})}if(d<=0){u("No columns to export.")}else if(f*d>l||!f||f>=p){var m={rows:f,columns:d,cellLimit:l,rowLimit:p,fileType:a.FileType.XLSX};t.showWarningDialog(m).then(h).catch(u)}else{h()}})};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/SpreadsheetExport", ["sap/base/Log","sap/ui/export/ExportUtils"],function(e,r){"use strict";var t="sap/ui/export/provider/DataProviderBase",n="sap/ui/export/js/XLSXBuilder",o="sap/ui/export/js/libs/JSZip3";var i={execute:function(i,a){function s(e){if(e instanceof MessageEvent&&e.data){e=e.data}if(typeof a==="function"){a(e)}}function u(e,r){s({progress:true,fetched:e||0,total:r||0})}function c(e){s({error:e.message||e})}function f(e){s({finished:true,spreadsheet:e})}function l(){var e;var r;function a(t,n){r=t.getDataConverter(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);var o=i.dataSource.data||[];var a=o.length;var s=r(o.slice());e.append(s);u(a,a);e.build().then(f)}sap.ui.require([t,n,o],a);return{cancel:f}}function p(){var e,r;function a(t,n){var o=new t(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);r=o.requestData(s)}function s(r){if(r.error||typeof r.error==="string"){c(r.error);return}e.append(r.rows);u(r.fetched,r.total);if(r.finished){e.build().then(f)}}function l(){r.cancel();f()}sap.ui.require([t,n,o],a);return{cancel:l}}function d(){var t;var n={};var o=function(){t.postMessage({cancel:true});f()};function a(e){var r=new Worker(e);r.onmessage=s;if(navigator.userAgent.indexOf("Firefox")===-1||u(e)){r.onerror=c}r.postMessage(i);return r}function u(e){return e.indexOf(window.location.host)>0||/^[^/]+\/[^/].*$|^\/[^/].*$/i.test(e)}function l(){var r,t;e.warning("Direct worker is not allowed. Load the worker via blob.");r='self.origin = "'+n.base+'"; '+'importScripts("'+n.src+'")';t=window.URL.createObjectURL(new Blob([r]));return a(t)}function d(){e.warning("Blob worker is not allowed. Use in-process export.");o=p(i).cancel}function v(){try{t=a(n.src);t.addEventListener("error",function(e){t=l();t.addEventListener("error",function(e){d();e.preventDefault()});e.preventDefault()})}catch(e){try{t=l()}catch(e){d()}}}n.base=r.normalizeUrl(sap.ui.require.toUrl("sap/ui/export/js/"));n.src=n.base+"SpreadsheetWorker.js";v();return{cancel:function(){o()}}}if(i.dataSource.type==="array"){return l()}else if(i.worker===false){return p()}else{return d()}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/library", ["sap/ui/core/library"],function(e){"use strict";var r=sap.ui.getCore().initLibrary({name:"sap.ui.export",dependencies:["sap.ui.core"],types:["sap.ui.export.EdmType","sap.ui.export.FileType"],interfaces:[],controls:[],elements:[],version:"1.115.1"});r.EdmType={BigNumber:"BigNumber",Boolean:"Boolean",Currency:"Currency",Date:"Date",DateTime:"DateTime",Enumeration:"Enumeration",Number:"Number",Percentage:"Percentage",String:"String",Time:"Time"};r.FileType={CSV:"CSV",GSHEET:"GSHEET",PDF:"PDF",XLSX:"XLSX"};r.Destination={LOCAL:"LOCAL",REMOTE:"REMOTE"};sap.ui.loader.config({shim:{"sap/ui/export/js/XLSXBuilder":{amd:true,exports:"XLSXBuilder"},"sap/ui/export/js/XLSXExportUtils":{amd:true,exports:"XLSXExportUtils"}}});return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/util/Filter", ["sap/ui/base/Object"],function(t){"use strict";var e=t.extend("sap.ui.export.util.Filter",{constructor:function(t,e,r){this.property=t;this.rawValues=Array.isArray(e)?e:[e];this.label=typeof r==="string"?r:undefined}});e.prototype.getProperty=function(){return this.property};e.prototype.getLabel=function(){return this.label||this.property};e.prototype.getValue=function(){var t,e;t=[];e=this.type?this.format||this.type.formatValue.bind(this.type):this.format;this.getRawValues().forEach(function(r){var i=r.value;if(typeof e==="function"){if(Array.isArray(r.value)){i=[];r.value.forEach(function(t){try{i.push(e(t,"string"))}catch(e){i.push(t)}})}else{try{i=e(r.value,"string")}catch(t){}}}switch(r.operator){case"==":i="="+i;break;case"between":i=i[0]+"..."+i[1];break;case"contains":i="*"+i+"*";break;case"endswith":i="*"+i;break;case"startswith":i+="*";break;default:i=r.operator+i}if(r.exclude){i="!"+i}t.push(i)});return t.join("; ")};e.prototype.getRawValues=function(){return this.rawValues};e.prototype.setFormat=function(t){if(typeof t!=="function"&&t!==null){return}this.format=t};e.prototype.setLabel=function(t){if(typeof t!=="string"||!t){return}this.label=t};e.prototype.setType=function(t){if(!t||typeof t.isA!=="function"||!t.isA("sap.ui.model.SimpleType")){return}this.type=t};return e},true);
sap.ui.require.preload({
	"sap/ui/export/fragments/SettingsDialog.fragment.xml":'<Dialog xmlns="sap.m" xmlns:core="sap.ui.core" id="exportSettingsDialog" title="{i18n>EXPORT_SETTINGS_TITLE}" horizontalScrolling="false" verticalScrolling="true" afterClose=".onAfterClose" class="sapUiContentPadding sapUiExportSettings"><content><VBox renderType="Bare" width="100%" class="sapUiExportSettingsLabel"><Label text="{i18n>FILE_NAME}" labelFor="exportSettingsDialog-fileName"/><Input id="exportSettingsDialog-fileName" value="{/fileName}" liveChange=".onFileNameChange" class="sapUiTinyMarginBottom"/><Label text="{i18n>SELECT_FORMAT}" labelFor="exportSettingsDialog-fileType"/><Select id="exportSettingsDialog-fileType" selectedKey="{/fileType}" items="{/fileTypeCollection}" change=".onFileTypeChange" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>SELECT_DESTINATION}" labelFor="exportSettingsDialog-destination" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}"/><Select id="exportSettingsDialog-destination" selectedKey="{/destination}" items="{/destinationCollection}" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}" enabled="{path: \'/fileType\', formatter: \'.isDestinationEnabled\'}" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><CheckBox id="exportSettingsDialog-includeFilterSettings" selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-includeFilterSettings-PDF" enabled="{/capabilities/PDF/CoverPage}"  selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FILTER_SETTINGS}"/><CheckBox id="exportSettingsDialog-pdfArchive" enabled="{/capabilities/PDF/ArchiveFormat}" selected="{/pdfArchive}" text="{i18n>ARCHIVE_FORMAT}"  visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_ARCHIVE_FORMAT}"/><CheckBox id="exportSettingsDialog-splitCells" selected="{/splitCells}" text="{i18n>SPLIT_CELLS}" visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-addDateTime" selected="{/addDateTime}" text="{i18n>ADD_DATE_TIME}" visible="false"/><Label text="{i18n>PAPER_SIZE}" labelFor="exportSettingsDialog-papersize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-papersize" selectedKey="{/paperSize}" items="{/paperSizeCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>ORIENTATION}" labelFor="exportSettingsDialog-orientation" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-orientation" selectedKey="{/orientation}" items="{/orientationCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>FONT_SIZE}" labelFor="exportSettingsDialog-fontSize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Input id="exportSettingsDialog-fontSize" value="{/fontSize}" enabled="{/capabilities/PDF/FontSize}" liveChange=".onFontSizeChange" class="sapUiTinyMarginBottom" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FONT_SIZE}"/><CheckBox id="exportSettingsDialog-accessibility" selected="{/doEnableAccessibility}" text="{i18n>ENABLE_ACCESSIBILITY}" tooltip="{i18n>TOOLTIP_PDF_ACCESSIBILITY}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-fitToPage" enabled="{/capabilities/PDF/FitToPage}" selected="{/fitToPage}" text="{i18n>FITTOPAGE}" tooltip="{i18n>TOOLTIP_FITTOPAGE}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-signature" enabled="{/capabilities/PDF/Signature}" selected="{/signature}" text="{i18n>ENABLE_SIGNATURE}" tooltip="{i18n>TOOLTIP_PDF_SIGNATURE}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Label id="exportSettingsDialog-signatureReasonLabel" text="{i18n>SIGNATURE_REASON}" labelFor="exportSettingsDialog-signatureReason" visible="{/signature}"/><Input id="exportSettingsDialog-signatureReason" value="{/signatureReason}" class="sapUiTinyMarginBottom" visible="{/signature}"/><CheckBox id="exportSettingsDialog-showPageNumber" enabled="{/capabilities/PDF/HeaderFooter}" selected="{/showPageNumber}" text="{i18n>SHOW_PAGENUM}" tooltip="{i18n>TOOLTIP_PDF_PAGENUMBER}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/></VBox></content><beginButton><Button id="exportSettingsDialog-exportButton" press=".onExport" text="{path:\'/destination\', formatter:\'.formatExportButton\'}" type="Emphasized"/></beginButton><endButton><Button id="exportSettingsDialog-cancelButton" press=".onCancel" text="{i18n>CANCEL_BUTTON}" type="Transparent"/></endButton></Dialog>',
	"sap/ui/export/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.export","type":"library","embeds":[],"applicationVersion":{"version":"1.115.1"},"title":"UI5 library: sap.ui.export","description":"UI5 library: sap.ui.export","ach":"CA-UI5-TBL","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"JSZip3","packagedWithMySelf":true,"version":"3.7.1"}]},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.115","libs":{"sap.ui.core":{"minVersion":"1.115.1"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":["sap.ui.export.EdmType","sap.ui.export.FileType"],"interfaces":[]}}}}',
	"sap/ui/export/provider/DataProviderBase.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
(function(e){"use strict";if(typeof sap!=="undefined"&&typeof sap.ui.define==="function"){sap.ui.define([],e,true)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof self!=="undefined"){t=self}else{t=this}t.DataProviderBase=e()}})(function(){"use strict";var e=function(t){this.mSettings=t;this.bCanceled=false;this.iAvailableRows=0;this.mRequest=null;this.iTotalRows=Math.min(t.dataSource.count||e.MAX_ROWS,e.MAX_ROWS);this.iBatchSize=Math.min(t.dataSource.sizeLimit||e.MAX_ROWS,this.iTotalRows);this._prepareDataUrl()};e.MAX_ROWS=1048575;e.HTTP_ERROR_MSG="HTTP connection error";e.HTTP_WRONG_RESPONSE_MSG="Unexpected server response:\n";e._createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})};e.getColumnsToConvert=function(e){return e.reduce(function(e,t){var r;r=t.property instanceof Array?t.property:[t.property];if(t.unitProperty){r.push(t.unitProperty)}r.forEach(function(t){var r=t.split("/");if(r.length>1){e.push({property:t,keys:r})}});return e},[])};e.getDataConverter=function(t){var r,n;r=t.workbook.columns;if(t.workbook.hierarchyLevel){r=r.concat([{property:t.workbook.hierarchyLevel}])}n=this.getColumnsToConvert(r);return function(t){return e._convertData(t,n)}};e._convertData=function(t,r){r.forEach(function(r){t.forEach(function(t){t[r.property]=e._getValue(t,r)})});return t};e._getValue=function(e,t){var r=t.keys.reduce(function(e,t){return e&&e[t]},e);return r};e.prototype.requestData=function(t){var r=this.mSettings.dataSource;this.fnConvertData=e.getDataConverter(this.mSettings);this.fnProcessCallback=t;this.mRequest={serviceUrl:this._cleanUrl(r.serviceUrl),dataUrl:this._getUrl(0,this.iBatchSize),method:r.useBatch?"BATCH":"GET",headers:r.headers};this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));return{cancel:function(){this.bCanceled=true;if(this.oPendingXHR instanceof XMLHttpRequest){this.oPendingXHR.abort()}}.bind(this)}};e.prototype.fnOnDataReceived=function(e){var t,r,n,i;var s={};this.oPendingXHR=null;if(this.bCanceled){return}t=e&&e.value||e.d&&(e.d.results||e.d)||e;t=Array.isArray(t)?t:[];n=t.length;this.iAvailableRows+=n;i=this.iTotalRows-this.iAvailableRows;s.finished=n===0||i<=0;s.progress=this.iTotalRows;s.total=this.iTotalRows;s.fetched=this.iAvailableRows;r=e&&e["@odata.nextLink"]||e.d&&e.d.__next||null;if(!s.finished){this.mRequest.dataUrl=this._getUrl(this.iAvailableRows,Math.min(this.iBatchSize,i),r);this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this))}s.rows=this.fnConvertData(t);this.fnProcessCallback(s)};e.prototype.fnOnError=function(e){this.fnProcessCallback({error:e})};e.prototype._cleanUrl=function(e){var t;if(!e){return""}t=new URL(e);t.hash=t.search="";t.pathname+=t.pathname.endsWith("/")?"":"/";return t.toString()};e.prototype._prepareDataUrl=function(){var e=this.mSettings.dataSource;var t,r=/\$skip\=[0-9]+/,n=/\$top\=[0-9]+/;if(!e.dataUrl){throw"Unable to load data - no URL provided."}t=new URL(e.dataUrl);t.search=t.search||"";if(!r.test(t.search)){t.search+=(t.search.length?"&$skip=":"$skip=")+0}if(!n.test(t.search)){t.search+="&$top="+0}this.mSettings.dataSource.dataUrl=t.toString()};e.prototype._getUrl=function(e,t,r){var n,i;n=new URL(this.mSettings.dataSource.dataUrl);if(r){i=new URL(r,n.origin);n.search=i.search}else{n.search=(n.search||"").replace(/\$skip\=[0-9]+/g,"$skip="+e).replace(/\$top\=[0-9]+/g,"$top="+t)}return n.toString()};e.prototype.sendRequest=function(e){var t;if(typeof e!=="object"||e===null||typeof e.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}t=(e.method==="BATCH"&&e.serviceUrl?this.sendBatchRequest:this.sendGetRequest).bind(this);return t(e)};e.prototype.sendBatchRequest=function(t){return new Promise(function(r,n){var i=new XMLHttpRequest;var s="batch_"+e._createGuid();var a=t.dataUrl.split(t.serviceUrl)[1];var o=[];var h,c;i.onload=function(){var t,i,s,a,o,h,c;i=this.responseText.split("\r\n");o=0;a=i.length;s=a-1;i.forEach(function(e){c=e.match(/^HTTP\/1\.[0|1] ([1-9][0-9]{2})/);if(Array.isArray(c)&&c[1]){h=c[1]}});while(o<a&&i[o].slice(0,1)!=="{"){o++}while(s>0&&i[s].slice(-1)!=="}"){s--}i=i.slice(o,s+1);t=i.join("\r\n");if(h&&parseInt(h)>=400){n(e.HTTP_WRONG_RESPONSE_MSG+t);return}try{r(JSON.parse(t))}catch(r){n(e.HTTP_WRONG_RESPONSE_MSG+t)}};i.onerror=function(){n(this.responseText||e.HTTP_ERROR_MSG)};i.open("POST",t.serviceUrl+"$batch",true);i.setRequestHeader("Accept","multipart/mixed");i.setRequestHeader("Content-Type","multipart/mixed;boundary="+s);o.push("--"+s);o.push("Content-Type: application/http");o.push("Content-Transfer-Encoding: binary");o.push("");o.push("GET "+a+" HTTP/1.1");o.push("Accept:application/json");for(h in t.headers){c=t.headers[h];if(h.toLowerCase()!="accept"){i.setRequestHeader(h,c);o.push(h+":"+c)}}o.push("");o.push("");o.push("--"+s+"--");o.push("");o=o.join("\r\n");i.send(o);this.oPendingXHR=i}.bind(this))};e.prototype.sendGetRequest=function(t){return new Promise(function(r,n){var i;var s=new XMLHttpRequest;s.onload=function(){if(this.status>=400){n(this.responseText||this.statusText||e.HTTP_ERROR_MSG);return}try{r(JSON.parse(this.responseText))}catch(t){n(e.HTTP_WRONG_RESPONSE_MSG+this.responseText)}};s.onerror=function(){n(this.responseText||e.HTTP_ERROR_MSG)};s.open("GET",t.dataUrl,true);s.setRequestHeader("accept","application/json");for(i in t.headers){if(i.toLowerCase()!=="accept"){s.setRequestHeader(i,t.headers[i])}}s.send();this.oPendingXHR=s}.bind(this))};return e});
}
});
//# sourceMappingURL=library-preload.js.map
