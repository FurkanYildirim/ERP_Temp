{"version":3,"file":"HitTester.js","names":["sap","ui","define","Log","THREE","HitTester","this","_maskMaterial","MeshBasicMaterial","side","DoubleSide","fog","_depthMaterial","ShaderMaterial","vertexShader","join","fragmentShader","clipping","_renderTarget","WebGLRenderTarget","minFilter","NearestFilter","magFilter","texture","generateMipmaps","depthBuffer","testCamera","matViewProj","Matrix4","frustum","Frustum","inverseMatrix","screenPos","Vector2","raycaster","Raycaster","ray","Ray","sphere","Sphere","objects","data","Uint8Array","point","Vector3","getMeshNode","object","parent","userData","closed","skipIt","prototype","hitTest","x","y","width","height","renderer","scene","camera","clippingPlanes","options","constructor","copy","view","w","h","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","updateMatrixWorld","updateProjectionMatrix","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromProjectionMatrix","setFromCamera","set","rBits","getContextRedBits","gBits","getContextGreenBits","bBits","getContextBlueBits","rgBits","rMask","gMask","bMask","rMaskInv","gMaskInv","bMaskInv","maskMaterial","oldClearColor","Color","getClearColor","oldClearAlpha","getClearAlpha","oldAutoClear","autoClear","setRenderTarget","setClearColor","clear","color","index","length","underlayObjects","ignoreUnderlay","regularObjects","overlayObjects","ignoreOverlay","traverseVisible","node","renderStage","visible","selectable","geometry","material","intersectsObject","matrixWorld","rg","renderGroup","boundingSphere","setFromPackedArray","computeBoundingSphere","applyMatrix4","intersectsSphere","invert","bbox","boundingBox","Box3","newFromPackedArray","intersectsBox","push","children","i","l","renderObject","setRGB","render","forEach","clearDepth","readRenderTargetPixels","z","projectionMatrixInverse","distance","origin","distanceTo","hitTestPrecise","pi","plane","dist","distanceToPoint","t","normal","dot","direction","near","Math","max","far","min","intersects","intersectObjects","Infinity","result","isBillboard","isDetailView","hitTestPoint"],"sources":["HitTester-dbg.js"],"mappings":"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"}