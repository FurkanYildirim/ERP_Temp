/*
 * ! SAPUI5

(c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/library","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/core/syncStyleClass","sap/ui/core/Fragment"],function(e,t,r,s,a,n,o){"use strict";var i=e.ValueState;var u={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var l={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var g;function c(e){var t=[],r;var s=sap.ui.getCore().getMessageManager();var a=s.getMessageModel().getData();var n=[];for(var o=0;o<a.length;o++){r=a[o];var i=r.technicalDetails&&r.technicalDetails.statusCode==="404"&&r.type==="Error";if(r.persistent){if(i){n.push(r)}else{t.push(r)}}}return e?t.concat(n):t}function p(e,t){var r;r=function(r,s){var a;var i={onMessageDialogClose:function(){s.onMessageDialogClose();a.destroy()},onActionButtonPressed:function(){s.onActionButtonPressed();a.destroy()}};return o.load({name:r,controller:i}).then(function(r){if(t){n(t,e,r)}e.addDependent(e);return r})};return r}function f(e,t,r){var n=c();var o=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");if(n.length===0){return Promise.resolve()}v();var u=i.None;for(var l=0;l<n.length&&u!==i.Error;l++){var g=n[l];switch(g.type){case sap.ui.core.MessageType.Error:u=i.Error;break;case sap.ui.core.MessageType.Warning:u=i.Warning;break;case sap.ui.core.MessageType.Success:if(u===sap.ui.core.ValueState.None){u=i.Success}break;default:break}}if(n.length===1&&(u===i.Success||u===i.None)){a.show(n[0].message);return Promise.resolve()}var f=typeof e==="function"?e:p(e.owner,e.contentDensityClass);var d,y,m;var T=function(){d.close();m.setProperty("/backButtonVisible",false);m.setProperty("/messages",[]);m.setProperty("/messageToGroupName",Object.create(null));y.navigateBack();m.getProperty("/resolve")()};var E={onMessageDialogClose:function(){T(m)},onActionButtonPressed:function(){m.getProperty("/actionButtonCallback")();T(m)},onBackButtonPress:function(){m.setProperty("/backButtonVisible",false);y.navigateBack()},onMessageSelect:function(){m.setProperty("/backButtonVisible",true)}};return f("sap.ui.generic.app.fragments.MessageDialog",E).then(function(e){d=e;y=d.getContent()[0];var a=d.getModel();var i=a&&a.getMetaModel();var l=false;var g=!!(r&&r.action);var c=Object.create(null);if(i){n.forEach(function(e){var t=e.getTarget();if(!t){return}if(t.lastIndexOf("/")>0){t=t.substring(0,t.lastIndexOf("/"))}var r=t.substring(1,t.indexOf("("));var s=r&&i.getODataEntitySet(r);var n=s&&i.getODataEntityType(s.entityType);var o=n&&n["com.sap.vocabularies.UI.v1.HeaderInfo"];var u=o&&o.Title&&o.Title.Value&&o.Title.Value.Path;var g=a.getProperty(t);var p=g&&g[u];if(p){c[e.getId()]=p;l=true}})}m=d.getModel("settings");if(!m){m=new s({genericGroupName:o.getText("GENERAL_TITLE"),backButtonVisible:false,cancelButtonText:o.getText("DIALOG_CANCEL"),closeButtonText:o.getText("DIALOG_CLOSE")});d.setModel(m,"settings")}m.setProperty("/showActionButton",g);if(g){m.setProperty("/actionButtonText",r.actionLabel);m.setProperty("/actionButtonCallback",r.action)}m.setProperty("/title",t||o.getText("DIALOG_TITLE"));m.setProperty("/messages",n);m.setProperty("/grouping",l);m.setProperty("/state",u);m.setProperty("/resolve",function(){return Promise.resolve()});m.setProperty("/messageToGroupName",c);d.open();return null})}function v(){var e=sap.ui.getCore().getMessageManager();var t=c(true);if(t.length>0){e.removeMessages(t)}}function d(e,t,r){var s=new sap.ui.core.message.Message({message:e,description:t,type:sap.ui.core.MessageType.Error,processor:r,target:"",persistent:true});sap.ui.getCore().getMessageManager().addMessages(s)}function y(e){var t;g=e&&e.url;if(g){g="/"+g.substring(0,g.indexOf(")")+1)}var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var s;if(e instanceof Error){if(e.message){r=e.message}}else if(e.response){if(e.response.message){r=e.response.message}var a=e.response.statusCode;s=!Number.isInteger(a)?Number(a):a;if(e.response.headers){for(var n in e.response.headers){if(n.toLowerCase()==="content-type"){var o=e.response.headers[n];if(o.toLowerCase().indexOf("application/json")===0){if(e.response.responseText){var i=JSON.parse(e.response.responseText);if(i&&i.error&&i.error.message&&i.error.message.value){r=i.error.message.value}}}else if(e.message){r=e.message}break}}}}var u=c();t={httpStatusCode:s,messageText:r,description:null,containsTransientMessage:u.length===0?false:true};return t}return{operations:l,httpStatusCodes:u,handleTransientMessages:f,removeTransientMessages:v,addTransientErrorMessage:d,parseErrorResponse:y,getTransientMessages:c}},true);
//# sourceMappingURL=MessageUtil.js.map