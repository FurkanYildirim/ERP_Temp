/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff2670.visualization.ui","sap/sac/df/firefly/ff3300.cell.engine"],function(e){"use strict";e.SpreadsheetModel=function(){};e.SpreadsheetModel.prototype=new e.XObject;e.SpreadsheetModel.prototype._ff_c="SpreadsheetModel";e.SpreadsheetModel.create=function(){var t=new e.SpreadsheetModel;t.m_spreadsheet=e.XSpreadsheet.create();t.m_selectedCellAddressRange=e.XCellAddressRange.createWithString("A1");return t};e.SpreadsheetModel.prototype.m_spreadsheet=null;e.SpreadsheetModel.prototype.m_selectedCellAddressRange=null;e.SpreadsheetModel.prototype.setSelectedCellAddress=function(e){this.m_selectedCellAddressRange=e};e.SpreadsheetModel.prototype.getSelectedCells=function(){return this.m_spreadsheet.getCellRangeWithAddressRange(this.m_selectedCellAddressRange)};e.SpreadsheetModel.prototype.getFirstSelectedCell=function(){return this.m_spreadsheet.getCellAtAddress(this.m_selectedCellAddressRange.getStartingAddress())};e.SpreadsheetModel.prototype.getSelectedCellAddress=function(){return this.m_selectedCellAddressRange};e.SpreadsheetModel.prototype.getAllCells=function(){return this.m_spreadsheet.getCells()};e.SpreadsheetModel.prototype.setTextAtAddress=function(t,r){var l=e.XCellAddress.create(r);this.m_spreadsheet.getCellAtAddress(l).setText(t)};e.SpreadsheetModel.prototype.getCellAtAddress=function(e){return this.m_spreadsheet.getCellAtAddress(e)};e.SpreadsheetModel.prototype.addCellProvider=function(e){this.m_spreadsheet.addCellProvider(this.m_selectedCellAddressRange.getStartingAddress(),e)};e.SpreadsheetRenderer=function(){};e.SpreadsheetRenderer.prototype=new e.XObject;e.SpreadsheetRenderer.prototype._ff_c="SpreadsheetRenderer";e.SpreadsheetRenderer.create=function(t,r){var l=new e.SpreadsheetRenderer;l.m_spreadsheetModel=r;l.m_table=t;l.m_genericRenderer=e.SacGridRendererFactory.createGridRenderer(t);return l};e.SpreadsheetRenderer.prototype.m_spreadsheetModel=null;e.SpreadsheetRenderer.prototype.m_genericRenderer=null;e.SpreadsheetRenderer.prototype.m_table=null;e.SpreadsheetRenderer.prototype.setGridConfigration=function(e){this.m_genericRenderer.setGridConfigration(e)};e.SpreadsheetRenderer.prototype.render=function(){var e=this.m_spreadsheetModel.getAllCells();this.m_table.setMinCellWidth(98);for(var t=0;t<e.size();t++){var r;if(t>=this.m_table.getDataRowAmount()){r=this.m_table.newDataRow()}else{r=this.m_table.getRowList().get(t)}r.setHeight(24);for(var l=0;l<e.get(t).size();l++){var a;if(l>=r.getCells().size()){a=r.addNewCell()}else{a=r.getCells().get(l)}var s=e.get(t).get(l);a.setFormatted(s.getFormattedString());this.formatCell(s,a)}}this.m_table.setDataColumnsAmount(e.get(0).size());this.m_table.setDataRowAmount(e.size());this.m_table.setPreColumnsAmount(0);return this.m_genericRenderer.render()};e.SpreadsheetRenderer.prototype.formatCell=function(e,t){t.getTableStyle().setFontColor(e.getTextColor());t.getTableStyle().setFillColor(e.getBackgroundColor());t.getTableStyle().setFontBold(e.getBold());t.getTableStyle().setFontItalic(e.getItalic());t.getTableStyle().setFontSize(e.getFontSize());t.getTableStyle().setHorizontalAlignment(e.getHorizontalAlignment())};e.SpreadsheetRenderer.prototype.getTableJson=function(){return this.m_genericRenderer.getTableJson()};e.SacSpreadsheetClipboardHelper=function(){};e.SacSpreadsheetClipboardHelper.prototype=new e.SacTableClipboardHelper;e.SacSpreadsheetClipboardHelper.prototype._ff_c="SacSpreadsheetClipboardHelper";e.SacSpreadsheetClipboardHelper.createForSpreadsheet=function(t,r){var l=new e.SacSpreadsheetClipboardHelper;l.setupWithTable(t);l.setupModel(r);return l};e.SacSpreadsheetClipboardHelper.prototype.m_model=null;e.SacSpreadsheetClipboardHelper.prototype.setupModel=function(e){this.m_model=e};e.SacSpreadsheetClipboardHelper.prototype.pasteCells=function(t,r,l){var a=t.getIntegerByKey(e.SacTable.SELECTION_COL_MIN);var s=t.getIntegerByKey(e.SacTable.SELECTION_ROW_MIN);var n=t.getListByKey(e.SacTable.SELECTION_LIST);var o="";var i;for(var d=0;d<n.size();d++){var p=n.getStructureAt(d);var c=p.getIntegerByKey(e.SacTableConstants.C_N_COLUMN)-a+r;var S=p.getIntegerByKey(e.SacTableConstants.C_N_ROW)-s+l;var h;if(S<this.getTable().getHeaderRowList().size()){h=this.getTable().getHeaderRowList().get(S).getCells();if(c<h.size()){i=p.getByKey(e.SacTableConstants.C_SN_PLAIN);o=e.isNull(i)?"":i.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(S,c)).setText(o)}}else if(S-this.getTable().getHeaderRowList().size()<this.getTable().getRowList().size()){h=this.getTable().getRowList().get(S-this.getTable().getHeaderRowList().size()).getCells();if(c<h.size()){i=p.getByKey(e.SacTableConstants.C_SN_PLAIN);o=e.isNull(i)?"":i.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(S,c)).setText(o)}}}};e.SacSpreadsheetClipboardHelper.prototype.getCellValueAt=function(t,r){return this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(t,r)).evaluate()};e.SpreadsheetController=function(){};e.SpreadsheetController.prototype=new e.XObject;e.SpreadsheetController.prototype._ff_c="SpreadsheetController";e.SpreadsheetController.create=function(t,r){var l=new e.SpreadsheetController;l.m_uiModel=e.SpreadsheetModel.create();l.m_functionInput=t;l.m_addressInput=r;l.internalSetup();return l};e.SpreadsheetController.prototype.m_uiModel=null;e.SpreadsheetController.prototype.m_functionInput=null;e.SpreadsheetController.prototype.m_addressInput=null;e.SpreadsheetController.prototype.m_tableView=null;e.SpreadsheetController.prototype.internalSetup=function(){this.m_functionInput.registerOnEnter(this);this.m_addressInput.setEnabled(false)};e.SpreadsheetController.prototype.setTableView=function(e){this.m_tableView=e};e.SpreadsheetController.prototype.onSelectionChange=function(e){var t=e.getParameters().getByKey("selectionArea");var r=this.getCellAddress(t);this.m_tableView.analyzeSelectionEvent(e);this.m_uiModel.setSelectedCellAddress(r);this.m_functionInput.setValue(this.m_uiModel.getSelectedCells().get(0).get(0).getStringLiteral());this.m_functionInput.focus();this.m_addressInput.setValue(this.m_uiModel.getSelectedCellAddress().getAddressString())};e.SpreadsheetController.prototype.getCellAddress=function(t){var r=e.JsonParserFactory.newInstance();var l=r.parse(t).asList();var a=l.asList().get(0).asStructure().getIntegerByKey("startRow");var s=l.asList().get(0).asStructure().getIntegerByKey("startCol");var n=l.asList().get(0).asStructure().getIntegerByKey("endRow");var o=l.asList().get(0).asStructure().getIntegerByKey("endCol");var i=e.XCellAddressRange.createWithIndices(a,n,s,o);return i};e.SpreadsheetController.prototype.getModel=function(){return this.m_uiModel};e.SpreadsheetController.prototype.setTextAtAddress=function(e,t){this.m_uiModel.setTextAtAddress(e,t)};e.SpreadsheetController.prototype.onEnter=function(e){this.setCellText(this.m_functionInput.getValue())};e.SpreadsheetController.prototype.setCellText=function(e){this.m_uiModel.getFirstSelectedCell().setText(e);this.m_tableView.renderSpreadsheet()};e.SpreadsheetController.prototype.releaseObject=function(){this.m_uiModel=e.XObjectExt.release(this.m_uiModel)};e.SpreadsheetController.prototype.addCellProvider=function(e){this.m_uiModel.addCellProvider(e)};e.SacSpreadsheetTable=function(){};e.SacSpreadsheetTable.prototype=new e.SacTable;e.SacSpreadsheetTable.prototype._ff_c="SacSpreadsheetTable";e.SacSpreadsheetTable.createWithModel=function(t){var r=new e.SacSpreadsheetTable;r.internalSetup();r.m_model=t;return r};e.SacSpreadsheetTable.prototype.m_model=null;e.SacSpreadsheetTable.prototype.m_linkedSelection=null;e.SacSpreadsheetTable.prototype.m_linkedTable=null;e.SacSpreadsheetTable.prototype.setupLinkedSelection=function(e,t){this.m_linkedSelection=t;this.m_linkedTable=e;this.updateLinkedSelection()};e.SacSpreadsheetTable.prototype.updateLinkedSelection=function(){if(e.notNull(this.m_linkedSelection)&&e.notNull(this.m_linkedTable)){var t=e.SacBasicTableClipboardHelper.create(this.m_linkedTable).copyCells(this.m_linkedSelection);var r=t.getIntegerByKey(e.SacTable.SELECTION_COL_MIN);var l=t.getIntegerByKey(e.SacTable.SELECTION_ROW_MIN);var a=t.getListByKey(e.SacTable.SELECTION_LIST);var s="";var n;for(var o=0;o<a.size();o++){var i=a.getStructureAt(o);var d=i.getIntegerByKey(e.SacTableConstants.C_N_COLUMN)-r;var p=i.getIntegerByKey(e.SacTableConstants.C_N_ROW)-l;var c;if(p<this.getHeaderRowList().size()){c=this.getHeaderRowList().get(p).getCells();if(d<c.size()){n=i.getByKey(e.SacTableConstants.C_SN_PLAIN);s=e.isNull(n)?"":n.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(p,d)).updateTextFromLinkedObject(s)}}else if(p-this.getHeaderRowList().size()<this.getRowList().size()){c=this.getRowList().get(p-this.getHeaderRowList().size()).getCells();if(d<c.size()){n=i.getByKey(e.SacTableConstants.C_SN_PLAIN);s=e.isNull(n)?"":n.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(p,d)).updateTextFromLinkedObject(s)}}}}};e.SpreadSheetTableView=function(){};e.SpreadSheetTableView.prototype=new e.DfUiContentView;e.SpreadSheetTableView.prototype._ff_c="SpreadSheetTableView";e.SpreadSheetTableView.create=function(t){var r=new e.SpreadSheetTableView;r.initView(t);return r};e.SpreadSheetTableView.prototype.m_contentLayout=null;e.SpreadSheetTableView.prototype.m_sacTable=null;e.SpreadSheetTableView.prototype.m_formulaInput=null;e.SpreadSheetTableView.prototype.m_cellAddressInput=null;e.SpreadSheetTableView.prototype.m_abstractSacTable=null;e.SpreadSheetTableView.prototype.m_abstractTableRenderer=null;e.SpreadSheetTableView.prototype.m_tableClipboardHelper=null;e.SpreadSheetTableView.prototype.m_controller=null;e.SpreadSheetTableView.prototype.m_columnMin=0;e.SpreadSheetTableView.prototype.m_rowMin=0;e.SpreadSheetTableView.prototype.m_currentSelectionElement=null;e.SpreadSheetTableView.prototype.setupView=function(){};e.SpreadSheetTableView.prototype.buildViewUi=function(t){this.m_contentLayout=t.newControl(e.UiType.FLEX_LAYOUT);this.m_contentLayout.setDirection(e.UiFlexDirection.COLUMN);this.m_contentLayout.useMaxSpace();this.setupTopBar();this.m_controller=e.SpreadsheetController.create(this.m_formulaInput,this.m_cellAddressInput);this.m_controller.setTableView(this);this.m_sacTable=this.m_contentLayout.addNewItemOfType(e.UiType.SAC_TABLE_GRID);this.m_sacTable.useMaxSpace();this.m_sacTable.registerOnResize(this);this.m_sacTable.registerOnSelectionChange(this.m_controller);this.m_abstractSacTable=e.SacSpreadsheetTable.createWithModel(this.m_controller.getModel());this.m_abstractTableRenderer=e.SpreadsheetRenderer.create(this.m_abstractSacTable,this.m_controller.getModel());this.m_tableClipboardHelper=e.SacSpreadsheetClipboardHelper.createForSpreadsheet(this.m_abstractSacTable,this.m_controller.getModel());this.createExampleCells();this.renderSpreadsheet();t.setRoot(this.m_contentLayout)};e.SpreadSheetTableView.prototype.destroyView=function(){this.m_formulaInput=e.XObjectExt.release(this.m_formulaInput);this.m_cellAddressInput=e.XObjectExt.release(this.m_cellAddressInput);this.m_sacTable=e.XObjectExt.release(this.m_sacTable);this.m_abstractSacTable=e.XObjectExt.release(this.m_abstractSacTable);this.m_abstractTableRenderer=e.XObjectExt.release(this.m_abstractTableRenderer);this.m_controller=e.XObjectExt.release(this.m_controller);this.m_tableClipboardHelper=e.XObjectExt.release(this.m_tableClipboardHelper)};e.SpreadSheetTableView.prototype.setupTopBar=function(){var t=this.m_contentLayout.addNewItemOfType(e.UiType.FLEX_LAYOUT);t.setDirection(e.UiFlexDirection.ROW);t.setAlignItems(e.UiFlexAlignItems.CENTER);t.useMaxWidth();t.setFlex("0 0 34px");t.setBackgroundColor(e.UiColor.GREY.newBrighterColor(.3));t.setBorderWidth(e.UiCssBoxEdges.create("0px 0px 1px 0px"));t.setBorderColor(e.UiColor.GREY);t.setBorderStyle(e.UiBorderStyle.SOLID);this.m_cellAddressInput=t.addNewItemOfType(e.UiType.INPUT);this.m_cellAddressInput.setTag("gdsSpreadsheetSelectedCellInput");this.m_cellAddressInput.setMargin(e.UiCssBoxEdges.create("0px 7px 0px 0px"));this.m_cellAddressInput.setFlex("0 0 100px");var r=t.addNewItemOfType(e.UiType.ICON);r.setTag("gdsSpreadsheetCancelIcon");r.setIconSize(e.UiCssLength.create("20px"));r.setIcon("decline");r.setColor(e.UiColor.RED);r.setMargin(e.UiCssBoxEdges.create("0px 7px"));var l=t.addNewItemOfType(e.UiType.ICON);l.setTag("gdsSpreadsheetEnterIcon");l.setIconSize(e.UiCssLength.create("20px"));l.setIcon("accept");l.setColor(e.UiColor.GREEN);l.setMargin(e.UiCssBoxEdges.create("0px 7px"));var a=t.addNewItemOfType(e.UiType.ICON);a.setIconSize(e.UiCssLength.create("20px"));a.setIcon("fx");a.setColor(e.UiColor.GREY);a.setMargin(e.UiCssBoxEdges.create("0px 7px"));a.setEnabled(false);this.m_formulaInput=t.addNewItemOfType(e.UiType.INPUT);this.m_formulaInput.setTag("gdsSpreadsheetFunctionInput")};e.SpreadSheetTableView.prototype.pasteCells=function(t){this.m_tableClipboardHelper.pasteCells(e.JsonParserFactory.createFromString(t).asStructure(),this.m_columnMin,this.m_rowMin);this.m_sacTable.setModelJson(this.m_abstractTableRenderer.render())};e.SpreadSheetTableView.prototype.copyCells=function(){return this.m_tableClipboardHelper.copyCells(this.m_currentSelectionElement).toString()};e.SpreadSheetTableView.prototype.onResize=function(t){var r=t.getOffsetWidth();var l=t.getOffsetHeight();if(r!==0&&l!==0){if(e.notNull(this.m_abstractSacTable)){this.m_abstractSacTable.setWidth(r);this.m_abstractSacTable.setHeight(l);this.m_sacTable.setModelJson(this.m_abstractTableRenderer.render())}}};e.SpreadSheetTableView.prototype.createExampleCells=function(){};e.SpreadSheetTableView.prototype.setStyleOnCellRange=function(e){var t=this.m_controller.getModel().getSelectedCells();for(var r=0;r<t.size();r++){for(var l=0;l<t.get(r).size();l++){e(t.get(r).get(l))}}};e.SpreadSheetTableView.prototype.toggleSelectedCellBold=function(){this.setStyleOnCellRange(function(e){e.setBold(!e.getBold())}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.toggleSelectedCellItalic=function(){this.setStyleOnCellRange(function(e){e.setItalic(!e.getItalic())}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setHorizontalAlignLeft=function(){this.setHorizontalAlignment(e.SacTableCellHorizontalAlignment.LEFT)};e.SpreadSheetTableView.prototype.setHorizontalAlignCenter=function(){this.setHorizontalAlignment(e.SacTableCellHorizontalAlignment.CENTER)};e.SpreadSheetTableView.prototype.setHorizontalAlignRight=function(){this.setHorizontalAlignment(e.SacTableCellHorizontalAlignment.RIGHT)};e.SpreadSheetTableView.prototype.addDecimalPlace=function(){this.setStyleOnCellRange(function(e){e.addRightDigit()}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.removeDecimalPlace=function(){this.setStyleOnCellRange(function(e){e.removeRightDigit()}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setHorizontalAlignment=function(e){this.setStyleOnCellRange(function(t){t.setHorizontalAlignment(e)}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellBackgroundColor=function(t){var r=e.XStringUtils.concatenate2("#",t);this.setStyleOnCellRange(function(e){e.setBackgroundColor(r)}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellFontSize=function(e){this.setStyleOnCellRange(function(t){t.setFontSize(e)}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellTextColor=function(t){var r=e.XStringUtils.concatenate2("#",t);this.setStyleOnCellRange(function(e){e.setTextColor(r)}.bind(this));this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.renderSpreadsheet=function(){var e=this.m_abstractTableRenderer.render();this.m_sacTable.setModelJson(e)};e.SpreadSheetTableView.prototype.analyzeSelectionEvent=function(t){var r=t.getParameters().getStringByKey(e.UiEventParams.PARAM_SELECTION_AREA);if(e.XStringUtils.isNotNullAndNotEmpty(r)){var l=e.JsonParserFactory.createFromString(r);if(!this.trySetupSelection(l)){this.m_columnMin=-1;this.m_rowMin=-1}}else{this.m_columnMin=-1;this.m_rowMin=-1}};e.SpreadSheetTableView.prototype.trySetupSelection=function(t){this.m_currentSelectionElement=t;var r=false;if(e.notNull(t)){if(t.isStructure()){this.analyseSelectionStructure(t.asStructure());r=true}else if(t.isList()){var l=t.asList();if(e.XCollectionUtils.hasElements(l)){for(var a=0;a<l.size();a++){this.analyseSelectionStructure(l.getStructureAt(a))}r=true}}}return r};e.SpreadSheetTableView.prototype.analyseSelectionStructure=function(t){var r=t.getIntegerByKey(e.SacTableConstants.CCD_N_START_COL);var l=t.getIntegerByKey(e.SacTableConstants.CCD_N_END_COL);var a=t.getIntegerByKey(e.SacTableConstants.CCD_N_START_ROW);var s=t.getIntegerByKey(e.SacTableConstants.CCD_N_END_ROW);this.m_columnMin=e.XMath.min(r,l);this.m_rowMin=e.XMath.min(a,s)};e.SpreadSheetTableView.prototype.getCurrentSelectionElement=function(){return this.m_currentSelectionElement};e.SpreadSheetTableView.prototype.setSelectedCellBold=function(){this.toggleSelectedCellBold()};e.SpreadSheetTableView.prototype.setSelectedCellItalic=function(){this.toggleSelectedCellItalic()};e.SpreadSheetTableView.prototype.getTable=function(){return this.m_abstractSacTable};e.SpreadSheetTableView.prototype.getGridControl=function(){return this.m_sacTable};e.SpreadSheetTableView.prototype.getColumnMin=function(){return this.m_columnMin};e.SpreadSheetTableView.prototype.getRowMin=function(){return this.m_rowMin};e.SpreadSheetTableView.prototype.addCellProvider=function(e){this.m_controller.addCellProvider(e);this.renderSpreadsheet()};e.CellEngineUiModule=function(){};e.CellEngineUiModule.prototype=new e.DfModule;e.CellEngineUiModule.prototype._ff_c="CellEngineUiModule";e.CellEngineUiModule.s_module=null;e.CellEngineUiModule.getInstance=function(){if(e.isNull(e.CellEngineUiModule.s_module)){e.DfModule.checkInitialized(e.CellEngineModule.getInstance());e.CellEngineUiModule.s_module=e.DfModule.startExt(new e.CellEngineUiModule);e.DfModule.stopExt(e.CellEngineUiModule.s_module)}return e.CellEngineUiModule.s_module};e.CellEngineUiModule.prototype.getName=function(){return"ff3350.cell.engine.ui"};e.DfModule.checkInitialized(e.VisualizationUiModule.getInstance());e.DfModule.checkInitialized(e.CellEngineModule.getInstance());e.CellEngineUiModule.getInstance();return sap.firefly});
//# sourceMappingURL=ff3350.cell.engine.ui.js.map