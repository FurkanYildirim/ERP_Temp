/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff0005.language.ext","sap/sac/df/firefly/ff0040.commons","sap/sac/df/firefly/ff0070.structures","sap/sac/df/firefly/ff2670.visualization.ui"],function(t){"use strict";t.ExportHandlerFactory=function(){};t.ExportHandlerFactory.prototype=new t.XObject;t.ExportHandlerFactory.prototype._ff_c="ExportHandlerFactory";t.ExportHandlerFactory.s_driverFactory=null;t.ExportHandlerFactory.create=function(){var e=null;if(t.notNull(t.ExportHandlerFactory.s_driverFactory)){e=t.ExportHandlerFactory.s_driverFactory.newExportHandler()}return e};t.ExportHandlerFactory.registerFactory=function(e){t.ExportHandlerFactory.s_driverFactory=e};t.Appendix=function(){};t.Appendix.prototype=new t.XObjectExt;t.Appendix.prototype._ff_c="Appendix";t.Appendix.create=function(e,o,r,i,n,l,a,p,s,d,u){var _=new t.Appendix;_.m_title=e;_.m_techTitle=o;_.m_tenantTitle=r;_.m_queryTitle=i;_.m_infoProvTitle=n;_.m_modelTitle=l;_.m_createdByTitle=a;_.m_createdOnTitle=p;_.m_varTitle=s;_.m_filterTitle=d;_.m_acctMeasureTitle=u;_.m_techRow=t.PrFactory.createStructure();_.setTechRow();_.m_tenantRow=t.PrFactory.createStructure();_.m_queryRow=t.PrFactory.createStructure();_.m_infoProvRow=t.PrFactory.createStructure();_.m_modelRow=t.PrFactory.createStructure();_.m_createdByRow=t.PrFactory.createStructure();_.m_createdOnRow=t.PrFactory.createStructure();_.m_variableRows=t.PrFactory.createList();_.m_filterRows=t.PrFactory.createList();_.m_measureFilters=t.PrFactory.createList();return _};t.Appendix.clearRow=function(e){if(e.size()>0){e.clear()}return e.putNewList(t.Model.TABLE_ROW_CELLS)};t.Appendix.getCells=function(e){if(e.containsKey(t.Model.TABLE_ROW_CELLS)){return e.getListByKey(t.Model.TABLE_ROW_CELLS)}return e.putNewList(t.Model.TABLE_ROW_CELLS)};t.Appendix.getRowSize=function(e){if(t.notNull(e)&&e.size()>0){var o=t.Appendix.getCells(e);if(t.notNull(o)){return o.size()}}return 0};t.Appendix.addRowToTableRows=function(e,o,r){if(t.Appendix.getRowSize(e)>0){var i=t.Appendix.getCells(e);var n=i.size();while(n<r){n=n+1;t.Appendix.padWithEmptyCell(i)}o.add(e)}};t.Appendix.padWithEmptyCell=function(e){t.Appendix.addDataToCellsConditionally(e,"",true)};t.Appendix.addDataToCells=function(e,o){t.Appendix.addDataToCellsConditionally(e,o,false)};t.Appendix.addDataToCellsConditionally=function(e,o,r){if(r&&t.notNull(o)||!t.XStringUtils.isNullOrEmpty(o)){e.addNewStructure().putString(t.Model.FORMATTED_VALUE,o)}};t.Appendix.prototype.m_title=null;t.Appendix.prototype.m_techTitle=null;t.Appendix.prototype.m_tenantTitle=null;t.Appendix.prototype.m_queryTitle=null;t.Appendix.prototype.m_infoProvTitle=null;t.Appendix.prototype.m_modelTitle=null;t.Appendix.prototype.m_createdByTitle=null;t.Appendix.prototype.m_createdOnTitle=null;t.Appendix.prototype.m_techRow=null;t.Appendix.prototype.m_tenantRow=null;t.Appendix.prototype.m_queryRow=null;t.Appendix.prototype.m_infoProvRow=null;t.Appendix.prototype.m_modelRow=null;t.Appendix.prototype.m_createdByRow=null;t.Appendix.prototype.m_createdOnRow=null;t.Appendix.prototype.m_variableRows=null;t.Appendix.prototype.m_filterRows=null;t.Appendix.prototype.m_measureFilters=null;t.Appendix.prototype.m_allRows=null;t.Appendix.prototype.m_varTitle=null;t.Appendix.prototype.m_filterTitle=null;t.Appendix.prototype.m_acctMeasureTitle=null;t.Appendix.prototype.getTitle=function(){return this.m_title};t.Appendix.prototype.getAllRows=function(){if(t.isNull(this.m_allRows)){var e=t.PrFactory.createStructure();var o=t.Appendix.getCells(e);t.Appendix.addDataToCellsConditionally(o,"",true);this.m_allRows=t.XList.create();this.m_allRows.add(this.m_techRow);this.m_allRows.add(this.m_tenantRow);this.m_allRows.add(this.m_queryRow);this.m_allRows.add(this.m_infoProvRow);this.m_allRows.add(this.m_modelRow);this.m_allRows.add(this.m_createdByRow);this.m_allRows.add(this.m_createdOnRow);if(!this.m_variableRows.isEmpty()){this.m_allRows.add(e);this.addRows(this.m_variableRows.getIterator())}if(!this.m_filterRows.isEmpty()){this.m_allRows.add(e);this.addRows(this.m_filterRows.getIterator())}if(!this.m_measureFilters.isEmpty()){this.m_allRows.add(e);this.addRows(this.m_measureFilters.getIterator())}}return this.m_allRows};t.Appendix.prototype.getMaxRowSize=function(){var e=0;var o=this.getAllRows();for(var r=0;r<o.size();r++){e=t.XMath.max(e,t.Appendix.getRowSize(o.get(r)))}return e};t.Appendix.prototype.setTechRow=function(){var e=t.Appendix.getCells(this.m_techRow);t.Appendix.addDataToCells(e,this.m_techTitle)};t.Appendix.prototype.setTenantData=function(e){if(t.notNull(e)){var o=t.Appendix.getCells(this.m_tenantRow);t.Appendix.addDataToCells(o,this.m_tenantTitle);t.Appendix.addDataToCells(o,e.getUrlExt(true,false,false,false,false,true,true,false,false))}};t.Appendix.prototype.setQueryData=function(e,o,r,i){if(t.XStringUtils.isNotNullAndNotEmpty(o)||t.XStringUtils.isNotNullAndNotEmpty(r)){var n=t.XString.lastIndexOf(o,"[")+1;var l=t.XString.lastIndexOf(o,"]");var a=e.hasDefaultDatasourceName()?e.getDefaultDatasourceName():t.XString.substring(o,n,l);var p;if(t.notNull(i)&&i.isTypeOf(t.SystemType.ORCA)){p=t.Appendix.getCells(this.m_modelRow);t.Appendix.addDataToCells(p,this.m_modelTitle)}else{p=t.Appendix.getCells(this.m_queryRow);t.Appendix.addDataToCells(p,this.m_queryTitle)}t.Appendix.addDataToCells(p,a);if(!t.XString.isEqual(a,r)){t.Appendix.addDataToCells(p,r)}}};t.Appendix.prototype.setInfoProviderData=function(e,o){if(t.XStringUtils.isNotNullAndNotEmpty(e)||t.XStringUtils.isNotNullAndNotEmpty(o)){var r=t.Appendix.getCells(this.m_infoProvRow);t.Appendix.addDataToCells(r,this.m_infoProvTitle);t.Appendix.addDataToCells(r,e);if(!t.XString.isEqual(e,o)){t.Appendix.addDataToCells(r,o)}}};t.Appendix.prototype.setCreatedBy=function(e){if(t.XStringUtils.isNotNullAndNotEmpty(e)){var o=t.Appendix.getCells(this.m_createdByRow);t.Appendix.addDataToCells(o,this.m_createdByTitle);t.Appendix.addDataToCells(o,e)}};t.Appendix.prototype.setCreatedOnString=function(e){var o=t.Appendix.getCells(this.m_createdOnRow);t.Appendix.addDataToCells(o,this.m_createdOnTitle);t.Appendix.addDataToCells(o,e)};t.Appendix.prototype.setCreatedOn=function(e){if(t.notNull(e)){this.setCreatedOnString(e.toIsoFormat())}};t.Appendix.prototype.populateTable=function(e){var o=e.getListByKey(t.Model.TABLE_ROWS_KEY);var r=this.getMaxRowSize();var i=e.putNewList(t.Model.COL_WIDTHS_KEY);e.putInteger(t.Model.NUM_HEADER_COLS,1);e.putInteger(t.Model.NUM_HEADER_ROWS,1);var n=true;while(i.size()<r){if(n){n=false;i.addDouble(40)}else{i.addDouble(80)}}var l=this.getAllRows();for(var a=0;a<l.size();a++){t.Appendix.addRowToTableRows(l.get(a),o,r)}};t.Appendix.prototype.releaseObject=function(){t.XObjectExt.release(this.m_techRow);t.XObjectExt.release(this.m_tenantRow);t.XObjectExt.release(this.m_queryRow);t.XObjectExt.release(this.m_infoProvRow);t.XObjectExt.release(this.m_modelRow);t.XObjectExt.release(this.m_createdByRow);t.XObjectExt.release(this.m_createdOnRow);t.XObjectExt.release(this.m_allRows);t.XObjectExt.prototype.releaseObject.call(this)};t.Appendix.prototype.addVariableRow=function(e,o,r){if(this.m_variableRows.isEmpty()){var i=t.PrFactory.createStructure();var n=t.Appendix.getCells(i);t.Appendix.addDataToCells(n,this.m_varTitle);this.m_variableRows.add(i)}this.addOperationToRows(this.m_variableRows,e,o,r)};t.Appendix.prototype.addFilterRow=function(e,o,r){if(this.m_filterRows.isEmpty()){var i=t.PrFactory.createStructure();var n=t.Appendix.getCells(i);t.Appendix.addDataToCells(n,this.m_filterTitle);this.m_filterRows.add(i)}this.addOperationToRows(this.m_filterRows,e,o,r)};t.Appendix.prototype.addOperationToRows=function(e,o,r,i){var n=t.PrFactory.createStructure();var l=t.Appendix.getCells(n);t.Appendix.addDataToCellsConditionally(l,o,true);t.Appendix.addDataToCells(l,r);t.Appendix.addDataToCellsConditionally(l,i,true);e.add(n)};t.Appendix.prototype.addMeasureFilterRow=function(e,o,r,i){if(this.m_measureFilters.isEmpty()){var n=t.PrFactory.createStructure();var l=t.Appendix.getCells(n);t.Appendix.addDataToCells(l,this.m_acctMeasureTitle);this.m_measureFilters.add(n)}var a=t.PrFactory.createStructure();var p=t.Appendix.getCells(a);t.Appendix.addDataToCellsConditionally(p,e,true);t.Appendix.addDataToCellsConditionally(p,o,true);t.Appendix.addDataToCells(p,r);t.Appendix.addDataToCells(p,i);this.m_measureFilters.add(a)};t.Appendix.prototype.addRows=function(t){while(t.hasNext()){var e=t.next().asStructure();this.m_allRows.add(e)}};t.BaseExportConfig=function(){};t.BaseExportConfig.prototype=new t.XObjectExt;t.BaseExportConfig.prototype._ff_c="BaseExportConfig";t.BaseExportConfig.CSV_EXPORT="CSV";t.BaseExportConfig.PDF_EXPORT="PDF";t.BaseExportConfig.XLSX_EXPORT="XLSX";t.BaseExportConfig.prototype.root=null;t.BaseExportConfig.prototype.m_fileName="";t.BaseExportConfig.prototype.m_flatten=false;t.BaseExportConfig.prototype.m_includeFormatting=false;t.BaseExportConfig.prototype.m_scope="";t.BaseExportConfig.prototype.m_expandHierarchy=false;t.BaseExportConfig.prototype.m_appendix=null;t.BaseExportConfig.prototype.m_enablePdfAppendix=false;t.BaseExportConfig.prototype.m_defaultDataSourceName="";t.BaseExportConfig.prototype.init=function(t){this.root=t};t.BaseExportConfig.prototype.hasDefaultDatasourceName=function(){return t.XStringUtils.isNotNullAndNotEmpty(this.m_defaultDataSourceName)};t.BaseExportConfig.prototype.getDefaultDatasourceName=function(){return this.m_defaultDataSourceName};t.BaseExportConfig.prototype.setDefaultDatasourceName=function(t){this.m_defaultDataSourceName=t};t.BaseExportConfig.prototype.getStructure=function(){return this.root};t.BaseExportConfig.prototype.setFileName=function(t){this.m_fileName=t};t.BaseExportConfig.prototype.getFileName=function(){return this.m_fileName};t.BaseExportConfig.prototype.setScope=function(t){this.m_scope=t};t.BaseExportConfig.prototype.getScope=function(){return this.m_scope};t.BaseExportConfig.prototype.setFlattenHierarchy=function(t){this.m_flatten=t};t.BaseExportConfig.prototype.getFlattenHierarchy=function(){return this.m_flatten};t.BaseExportConfig.prototype.setIncludeFormatting=function(t){this.m_includeFormatting=t};t.BaseExportConfig.prototype.getIncludeFormatting=function(){return this.m_includeFormatting};t.BaseExportConfig.prototype.setExpandHierarchy=function(t){this.m_expandHierarchy=t};t.BaseExportConfig.prototype.getExpandHierarchy=function(){return this.m_expandHierarchy};t.BaseExportConfig.prototype.setEnablePdfAppendix=function(t){this.m_enablePdfAppendix=t};t.BaseExportConfig.prototype.supportsAppendix=function(){return t.XString.isEqual(this.getType(),t.BaseExportConfig.XLSX_EXPORT)||t.XString.isEqual(this.getType(),t.BaseExportConfig.PDF_EXPORT)&&this.m_enablePdfAppendix};t.BaseExportConfig.prototype.addAppendix=function(t){this.m_appendix=t};t.BaseExportConfig.prototype.getAppendix=function(){return this.m_appendix};t.BaseExportConfig.prototype.releaseObject=function(){t.XObjectExt.release(this.root);t.XObjectExt.release(this.m_appendix);t.XObjectExt.prototype.releaseObject.call(this)};t.ExportResult=function(){};t.ExportResult.prototype=new t.XObjectExt;t.ExportResult.prototype._ff_c="ExportResult";t.ExportResult.FF_DATA_EXPORT_INSUFFICIENT_WIDTH_WARNING="FF_DATA_EXPORT_INSUFFICIENT_PAGE_WIDTH";t.ExportResult.FF_DATA_EXPORT_INSUFFICIENT_HEIGHT_WARNING="FF_DATA_EXPORT_INSUFFICIENT_PAGE_HEIGHT";t.ExportResult.FF_DATA_EXPORT_MAIN_TABLE_TEMPLATE="FF_DATA_EXPORT_MAIN_TABLE_TEMPLATE";t.ExportResult.FF_DATA_EXPORT_APPENDIX_TABLE_TEMPLATE="FF_DATA_EXPORT_APPENDIX_TABLE_TEMPLATE";t.ExportResult.FF_DATA_EXPORT_STATUS="status";t.ExportResult.FF_DATA_EXPORT_STATUS_EXPORTED="EXPORTED";t.ExportResult.FF_DATA_EXPORT_STATUS_NOT_EXPORTED="NOT_EXPORTED";t.ExportResult.FF_DATA_EXPORT_WARNINGS="warnings";t.ExportResult.createDefaultError=function(e){var o=new t.ExportResult;o.m_structure=t.PrFactory.createStructure();var r=o.m_structure.putNewStructure(t.ExportResult.FF_DATA_EXPORT_WARNINGS);r.putString("0",e);o.m_structure.putString(t.ExportResult.FF_DATA_EXPORT_STATUS,t.ExportResult.FF_DATA_EXPORT_STATUS_NOT_EXPORTED);return o};t.ExportResult.create=function(e){var o=new t.ExportResult;o.m_structure=t.JsonParserFactory.createFromString(e).asStructure();return o};t.ExportResult.createSuccessForTest=function(e){var o=new t.ExportResult;o.m_structure=t.PrFactory.createStructure();o.m_structure.putString(t.ExportResult.FF_DATA_EXPORT_STATUS,t.ExportResult.FF_DATA_EXPORT_STATUS_EXPORTED);o.exportModel=e;return o};t.ExportResult.prototype.m_structure=null;t.ExportResult.prototype.exportModel=null;t.ExportResult.prototype.hasWarnings=function(){return this.m_structure.containsKey(t.ExportResult.FF_DATA_EXPORT_WARNINGS)&&!this.m_structure.getStructureByKey(t.ExportResult.FF_DATA_EXPORT_WARNINGS).isEmpty()};t.ExportResult.prototype.success=function(){return this.m_structure.containsKey(t.ExportResult.FF_DATA_EXPORT_STATUS)&&t.XString.isEqual(this.m_structure.getStringByKey(t.ExportResult.FF_DATA_EXPORT_STATUS),t.ExportResult.FF_DATA_EXPORT_STATUS_EXPORTED)};t.ExportResult.prototype.getWarnings=function(){var e=t.XList.create();if(this.hasWarnings()){var o=this.m_structure.getStructureByKey(t.ExportResult.FF_DATA_EXPORT_WARNINGS).getStringByKey("0");var r=this.m_structure.getStructureByKey(t.ExportResult.FF_DATA_EXPORT_WARNINGS).getStringByKey("1");if(t.XStringUtils.isNotNullAndNotEmpty(o)){e.add(t.XPairOfString.create(t.ExportResult.FF_DATA_EXPORT_MAIN_TABLE_TEMPLATE,o))}if(t.XStringUtils.isNotNullAndNotEmpty(r)){e.add(t.XPairOfString.create(t.ExportResult.FF_DATA_EXPORT_APPENDIX_TABLE_TEMPLATE,r))}}return e};t.ExportResult.prototype.releaseObject=function(){t.XObjectExt.release(this.m_structure);t.XObjectExt.prototype.releaseObject.call(this)};t.ExportResult.prototype.getExportModel=function(){return this.exportModel};t.Exporter=function(){};t.Exporter.prototype=new t.XObjectExt;t.Exporter.prototype._ff_c="Exporter";t.Exporter.create=function(){var e=new t.Exporter;e.exportHandler=t.ExportHandlerFactory.create();return e};t.Exporter.prototype.exportHandler=null;t.Exporter.prototype.exportCsv=function(e){return t.ExportResult.create(this.exportHandler.exportCsv(e))};t.Exporter.prototype.exportXlsx=function(e){return t.ExportResult.create(this.exportHandler.exportXlsx(e))};t.Exporter.prototype.exportPdf=function(e){return t.ExportResult.create(this.exportHandler.exportPdf(e))};t.Model=function(){};t.Model.prototype=new t.XObjectExt;t.Model.prototype._ff_c="Model";t.Model.CELL_PLAIN_KEY="plain";t.Model.CELL_TYPE_KEY="cellType";t.Model.CELL_FORMATTED_KEY="formatted";t.Model.VALUE_KEY="value";t.Model.LINE_COLOR_KEY="lineColor";t.Model.CELL_STYLES_KEY="cellStyles";t.Model.TABLE_ROW_CELLS="cells";t.Model.FORMATTED_VALUE="formattedValue";t.Model.TABLE_ROWS_KEY="rows";t.Model.COL_WIDTHS_KEY="colWidths";t.Model.TABLE_TITLE_KEY="title";t.Model.MODEL_TABLES_KEY="tables";t.Model.PADDING_MIDDLE_KEY="middle";t.Model.PADDING_BOTTOM_KEY="bottom";t.Model.PADDING_TOP_KEY="top";t.Model.PADDING_CENTER_KEY="center";t.Model.XLSX_FORMAT_KEY="xlFormat";t.Model.TOTAL_WIDTH_KEY="totalWidth";t.Model.TOTAL_HEIGHT_KEY="totalHeight";t.Model.NUM_COLS_KEY="numCols";t.Model.PADDING_KEY="padding";t.Model.FONT_COLOR_KEY="fontColor";t.Model.LINE_SIZE_KEY="lineSize";t.Model.PADDING_LEFT_KEY="left";t.Model.PADDING_RIGHT_KEY="right";t.Model.STYLE_KEY="style";t.Model.FONT_WEIGHT_KEY="fontWeight";t.Model.HIER_PAD_RIGHT_KEY="hierPadRight";t.Model.HIER_PAD_LEFT_KEY="hierPadLeft";t.Model.HIER_PAD_TOP_KEY="hierPadTop";t.Model.FILE_NAME_KEY="fileName";t.Model.XLSX_CONF_KEY="xlsx";t.Model.CSV_CONF_KEY="csv";t.Model.PDF_CONF_KEY="pdf";t.Model.HOR_ALIGN_KEY="horAlign";t.Model.VERT_ALIGN_KEY="vertAlign";t.Model.NUM_HEADER_COLS="numHeaderCols";t.Model.NUM_HEADER_ROWS="numHeaderRows";t.Model.create=function(){var e=new t.Model;e.root=t.PrFactory.createStructure();return e};t.Model.convertToMm=function(t){return t*.26458333};t.Model.parseColor=function(e,o){var r=t.XString.containsString(o,"rgba")?"rgba(":"rgb(";var i=t.XString.replace(o,r,"");var n=t.XString.replace(i,")","");var l=t.XStringTokenizer.splitString(n,",");if(t.notNull(l)){e.putInteger("r",t.XInteger.convertFromString(l.get(0)));e.putInteger("g",t.XInteger.convertFromString(l.get(1)));e.putInteger("b",t.XInteger.convertFromString(l.get(2)))}};t.Model.requiresNumberFormat=function(e){return t.XString.isEqual(e.getType(),t.BaseExportConfig.XLSX_EXPORT)};t.Model.requiresStyle=function(e){return!t.XString.isEqual(t.BaseExportConfig.CSV_EXPORT,e.getType())};t.Model.hasStyleToApply=function(t,e){if(t.isEffectiveFontBold(e)){return true}if(t.getEffectiveVerticalAlignment(e)!==null||t.getEffectiveHorizontalAlignment(e)!==null){return true}if(!t.getEffectiveStyleLineBottom(e).isEmpty()||!t.getEffectiveStyledLineLeft(e).isEmpty()||!t.getEffectiveStyledLineRight(e).isEmpty()||!t.getEffectiveStyledLineTop(e).isEmpty()){return true}if(t.getEffectiveFontColor(e)!==null){return true}return false};t.Model.setExportPadding=function(e,o,r){var i=t.PrFactory.createStructure();var n=o.getEffectiveStyledLineTop(e);var l=o.getEffectiveStyleLineBottom(e);var a=o.getEffectiveStyledLineLeft(e);var p=o.getEffectiveStyledLineRight(e);var s=!n.isEmpty()||!l.isEmpty()||!a.isEmpty()||!p.isEmpty();if(s){if(!n.isEmpty()||!l.isEmpty()){i.putDouble(t.Model.PADDING_RIGHT_KEY,t.Model.convertToMm(t.SacTableConstants.LP_RIGHT));i.putDouble(t.Model.PADDING_LEFT_KEY,t.Model.convertToMm(t.SacTableConstants.LP_RIGHT))}else{i.putDouble(t.Model.PADDING_BOTTOM_KEY,t.Model.convertToMm(t.SacTableConstants.LP_BOTTOM));i.putDouble(t.Model.PADDING_TOP_KEY,t.Model.convertToMm(t.SacTableConstants.LP_TOP))}}var d=function(e){if(t.notNull(e)&&!e.isEmpty()&&e.hasPadding()){i.putDouble(t.Model.PADDING_RIGHT_KEY,t.Model.convertToMm(t.XDouble.convertToInt(e.getRightPadding())));i.putDouble(t.Model.PADDING_LEFT_KEY,t.Model.convertToMm(t.XDouble.convertToInt(e.getLeftPadding())))}}.bind(this);d(o.getEffectiveStyledLineTop(e));d(o.getEffectiveStyleLineBottom(e));d(o.getEffectiveStyledLineLeft(e));d(o.getEffectiveStyledLineRight(e));if(o.getHierarchyPaddingType()!==null){i.putDouble(t.Model.convertHierPadding(o.getHierarchyPaddingType()),t.Model.convertToMm(o.getHierarchyPaddingValue()*(1+o.getHierarchyLevel())))}if(i.hasElements()){r.put(t.Model.PADDING_KEY,i)}};t.Model.populateExportCellValues=function(e,o,r){var i=o.getType()===t.SacTableConstants.CT_UNBOOKED;var n=o.isRepeatedHeader()&&!o.isEffectiveRepetitiveHeaderCells();if(i||n){e.putString(t.Model.FORMATTED_VALUE,"")}else{if(o.getPlain()!==null&&o.getPlain().getValueType().isNumber()){e.putDouble(t.Model.VALUE_KEY,t.XValueUtil.getDouble(o.getPlain(),true,true));e.putString(t.Model.FORMATTED_VALUE,o.getFormatted()===null?"":o.getFormatted())}else if(r&&o.getValueException()!==null){e.putString(t.Model.FORMATTED_VALUE,"")}else{e.putString(t.Model.FORMATTED_VALUE,o.getFormatted()===null?"":o.getFormatted())}}};t.Model.ignoreValueException=function(e){return t.XString.isEqual(e.getType(),t.BaseExportConfig.CSV_EXPORT)||t.XString.isEqual(e.getType(),t.BaseExportConfig.XLSX_EXPORT)};t.Model.setAlignmentsFromCellStyle=function(e,o,r){var i=o.getEffectiveHorizontalAlignment(e);var n=o.getEffectiveVerticalAlignment(e);if(t.isNull(n)){n=t.SacTableCellVerticalAlignment.MIDDLE}if(t.isNull(i)){i=t.SacTableCellHorizontalAlignment.LEFT}r.putString(t.Model.VERT_ALIGN_KEY,t.XString.toLowerCase(n.getName()));r.putString(t.Model.HOR_ALIGN_KEY,t.XString.toLowerCase(i.getName()))};t.Model.convertHierPadding=function(e){if(t.XString.isEqual(t.SacTableConstants.C_N_HIERARCHY_PADDING_LEFT,e)){return t.Model.HIER_PAD_LEFT_KEY}else if(t.XString.isEqual(t.SacTableConstants.C_N_HIERARCHY_PADDING_TOP,e)){return t.Model.HIER_PAD_TOP_KEY}return t.Model.HIER_PAD_RIGHT_KEY};t.Model.prototype.root=null;t.Model.prototype.csvConf=null;t.Model.prototype.pdfConf=null;t.Model.prototype.xlsConf=null;t.Model.prototype.asStructure=function(){return this.root};t.Model.prototype.setFileName=function(e){this.root.putString(t.Model.FILE_NAME_KEY,e)};t.Model.prototype.getFileName=function(){return this.root.getStringByKey(t.Model.FILE_NAME_KEY)};t.Model.prototype.setConfig=function(e){if(t.XString.isEqual(t.BaseExportConfig.CSV_EXPORT,e.getType())){this.root.put(t.Model.CSV_CONF_KEY,e.getStructure())}else if(t.XString.isEqual(t.BaseExportConfig.PDF_EXPORT,e.getType())){this.root.put(t.Model.PDF_CONF_KEY,e.getStructure())}else if(t.XString.isEqual(t.BaseExportConfig.XLSX_EXPORT,e.getType())){this.getXlsxConfigs().add(e.getStructure())}};t.Model.prototype.getXlsxConfigs=function(){var e;if(!this.root.containsKey(t.Model.XLSX_CONF_KEY)){e=this.root.putNewList(t.Model.XLSX_CONF_KEY)}else{e=this.root.getListByKey(t.Model.XLSX_CONF_KEY)}return e};t.Model.prototype.addTable=function(e){var o;if(!this.root.containsKey(t.Model.MODEL_TABLES_KEY)){o=this.root.putNewList(t.Model.MODEL_TABLES_KEY)}else{o=this.root.getListByKey(t.Model.MODEL_TABLES_KEY)}var r=o.addNewStructure();r.putNewList(t.Model.TABLE_ROWS_KEY);r.putString(t.Model.TABLE_TITLE_KEY,e);return r};t.Model.prototype.releaseObject=function(){t.XObjectExt.release(this.root);t.XObjectExt.release(this.csvConf);t.XObjectExt.release(this.pdfConf);t.XObjectExt.release(this.xlsConf);t.XObjectExt.prototype.releaseObject.call(this)};t.Model.prototype.toString=function(){return this.root.toString()};t.Model.prototype.processTable=function(e,o){this.setFileName(e.getFileName());this.setConfig(e);var r=this.addTable(o.getTitle()===null?"DefaultTitle":o.getTitle());if(e.supportsAppendix()&&e.getAppendix()!==null){var i=this.addTable(e.getAppendix().getTitle());e.getAppendix().populateTable(i)}r.putInteger(t.Model.NUM_COLS_KEY,o.getHeaderColumnList().size()+o.getColumnList().size());r.putDouble(t.Model.TOTAL_HEIGHT_KEY,t.Model.convertToMm(o.getHeight()));r.putDouble(t.Model.TOTAL_WIDTH_KEY,t.Model.convertToMm(o.getWidth()));var n=r.putNewList(t.Model.COL_WIDTHS_KEY);this.populateColumnWidths(o,n);var l=t.XHashMapByString.create();var a=r.putNewList(t.Model.CELL_STYLES_KEY);var p=r.getListByKey(t.Model.TABLE_ROWS_KEY);this.addRowsToModel(o,e,l,a,p,o.getHeaderRowList(),true);this.addRowsToModel(o,e,l,a,p,o.getRowList(),false);r.putInteger(t.Model.NUM_HEADER_COLS,o.getPreColumnsAmount());r.putInteger(t.Model.NUM_HEADER_ROWS,o.getHeaderRowList().size())};t.Model.prototype.populateColumnWidths=function(e,o){var r=e.getWidth()-100;var i=e.getColumnEmWidths();var n=t.XStream.of(i).reduce(t.XIntegerValue.create(1),function(e,o){return t.XIntegerValue.create(e.getInteger()+o.getInteger())}.bind(this)).getInteger();var l=t.XMath.div(r,n);if(l>15){l=15}if(l<10){l=10}var a=e.getMinCellWidth();var p=e.getMaxCellWidth();for(var s=0;s<i.size();s++){o.addDouble(t.Model.convertToMm(t.XMath.min(p,t.XMath.max(i.get(s).getInteger()*l,a))))}};t.Model.prototype.addRowsToModel=function(e,o,r,i,n,l,a){var p=t.XLinkedHashMapByString.create();var s=t.Model.ignoreValueException(o);var d=t.Model.requiresStyle(o);var u=t.Model.requiresNumberFormat(o);for(var _=0;_<l.size();_++){var E=l.get(_);var f=n.addNewStructure();f.putDouble("height",t.Model.convertToMm(E.getHeight()));var g=f.putNewList(t.Model.TABLE_ROW_CELLS);var c=E.getCells();for(var T=0;T<c.size();T++){var A=c.get(T);var y=g.addNewStructure();t.Model.populateExportCellValues(y,A,s);if(d){var C=t.PrFactory.createStructure();var x=A.getFormattingPattern();if(u&&t.XStringUtils.isNotNullAndNotEmpty(x)){var m;if(!p.containsKey(x)){m=o.addNumberFormat(x);p.put(x,t.XIntegerValue.create(m))}else{m=p.getByKey(x).getInteger()}C.putInteger(t.Model.XLSX_FORMAT_KEY,m)}var R=A.getPrioritizedStylesList();if(t.Model.hasStyleToApply(A,R)){var S=C.putNewStructure(t.Model.FONT_COLOR_KEY);var P=A.getType()===t.SacTableConstants.CT_VALUE;var M=A.getEffectiveFontColor(R);if(t.XStringUtils.isNullOrEmpty(M)){if(P){S.putInteger("r",153);S.putInteger("g",153);S.putInteger("b",153)}else{S.putInteger("r",51);S.putInteger("g",51);S.putInteger("b",51)}}else{t.Model.parseColor(S,M)}t.Model.setAlignmentsFromCellStyle(R,A,C);var F=a&&T<=e.getPreColumnsAmount()-1;if(A.isEffectiveFontBold(R)||F){C.putInteger(t.Model.FONT_WEIGHT_KEY,700)}var h=A.getEffectiveStyleLineBottom(R);if(t.notNull(h)&&!h.isEmpty()){t.Model.parseColor(C.putNewStructure(t.Model.LINE_COLOR_KEY),h.getColor());C.putDouble(t.Model.LINE_SIZE_KEY,.26458333)}t.Model.setExportPadding(R,A,C)}if(!C.isEmpty()){var D=C.toString();if(!r.containsKey(D)){var O=i.size();r.put(D,t.XIntegerValue.create(O));i.add(C);y.putInteger(t.Model.STYLE_KEY,O)}else{var L=r.getByKey(D);y.putInteger(t.Model.STYLE_KEY,L.getInteger())}}}}}};t.CsvConfig=function(){};t.CsvConfig.prototype=new t.BaseExportConfig;t.CsvConfig.prototype._ff_c="CsvConfig";t.CsvConfig.CSV_DEFAULT_DELIM=",";t.CsvConfig.CSV_DELIM_KEY="delimiter";t.CsvConfig.createDefault=function(e,o){var r=new t.CsvConfig;r.init(e);r.setDelimiter(t.CsvConfig.CSV_DEFAULT_DELIM);r.setFileName(o);return r};t.CsvConfig.wrap=function(e){var o=new t.CsvConfig;o.init(e);return o};t.CsvConfig.prototype.getType=function(){return t.BaseExportConfig.CSV_EXPORT};t.CsvConfig.prototype.setDelimiter=function(e){this.root.putString(t.CsvConfig.CSV_DELIM_KEY,e)};t.PdfConfig=function(){};t.PdfConfig.prototype=new t.BaseExportConfig;t.PdfConfig.prototype._ff_c="PdfConfig";t.PdfConfig.PDF_PAGE_SIZE_KEY="pageSize";t.PdfConfig.PDF_BUILTIN_FONT_KEY="builtInFont";t.PdfConfig.PDF_FONT_SIZE="fontSize";t.PdfConfig.PDF_AUTO_SIZE_KEY="autoSize";t.PdfConfig.PDF_FREEZE_ROWS_KEY="freezeRows";t.PdfConfig.PDF_PAGE_ORIENT_KEY="orientation";t.PdfConfig.PDF_PAGE_NUM_LOC_KEY="pageNumberLocation";t.PdfConfig.PDF_ORIENT_LANDSCAPE="landscape";t.PdfConfig.PDF_ORIENT_PORTRAIT="portrait";t.PdfConfig.PDF_FIT_TABLE_TO_PAGE_WIDTH="fitTableToPageWidth";t.PdfConfig.PAGE_SIZE_LEGAL="Legal";t.PdfConfig.PAGE_SIZE_LETTER="Letter";t.PdfConfig.PAGE_SIZE_A5="A5";t.PdfConfig.PAGE_SIZE_A4="A4";t.PdfConfig.PAGE_SIZE_A3="A3";t.PdfConfig.PAGE_SIZE_A2="A2";t.PdfConfig.PAGE_NUMBER_LOC_FOOTER="footer";t.PdfConfig.PAGE_NUMBER_LOC_HEADER="header";t.PdfConfig.PAGE_NUMBER_LOC_NONE="none";t.PdfConfig.createDefault=function(e,o){var r=new t.PdfConfig;r.setFileName(o);r.init(e);r.setOrientation(t.PdfConfig.PDF_ORIENT_LANDSCAPE);r.setPageSize("a4");r.setBuiltInFont("Helvetica");r.setAutoSize(true);r.setFontSize(6);return r};t.PdfConfig.wrap=function(e){var o=new t.PdfConfig;o.init(e);return o};t.PdfConfig.prototype.getType=function(){return t.BaseExportConfig.PDF_EXPORT};t.PdfConfig.prototype.setFontSize=function(e){this.root.putDouble(t.PdfConfig.PDF_FONT_SIZE,e)};t.PdfConfig.prototype.setOrientation=function(e){this.root.putString(t.PdfConfig.PDF_PAGE_ORIENT_KEY,e)};t.PdfConfig.prototype.getOrientation=function(){return this.root.getStringByKey(t.PdfConfig.PDF_PAGE_ORIENT_KEY)};t.PdfConfig.prototype.setPageSize=function(e){this.root.putString(t.PdfConfig.PDF_PAGE_SIZE_KEY,t.XString.toLowerCase(e))};t.PdfConfig.prototype.setBuiltInFont=function(e){this.root.putString(t.PdfConfig.PDF_BUILTIN_FONT_KEY,e)};t.PdfConfig.prototype.setAutoSize=function(e){this.root.putBoolean(t.PdfConfig.PDF_AUTO_SIZE_KEY,e)};t.PdfConfig.prototype.getAutoSize=function(){return this.root.getBooleanByKey(t.PdfConfig.PDF_AUTO_SIZE_KEY)};t.PdfConfig.prototype.setFreezeRows=function(e){this.root.putInteger(t.PdfConfig.PDF_FREEZE_ROWS_KEY,e)};t.PdfConfig.prototype.getFreezeRows=function(){return this.root.getIntegerByKey(t.PdfConfig.PDF_FREEZE_ROWS_KEY)};t.PdfConfig.prototype.setNumberLocation=function(e){this.root.putString(t.PdfConfig.PDF_PAGE_NUM_LOC_KEY,e)};t.PdfConfig.prototype.getNumberLocation=function(){return this.root.getStringByKey(t.PdfConfig.PDF_PAGE_NUM_LOC_KEY)};t.PdfConfig.prototype.setFitTableToPageWidth=function(e){this.root.putBoolean(t.PdfConfig.PDF_FIT_TABLE_TO_PAGE_WIDTH,e)};t.XlsConfig=function(){};t.XlsConfig.prototype=new t.BaseExportConfig;t.XlsConfig.prototype._ff_c="XlsConfig";t.XlsConfig.XLSX_AUTO_FILTER="autoFilter";t.XlsConfig.XLSX_NUMBER_FORMATS="numberFormats";t.XlsConfig.createDefault=function(e,o){var r=new t.XlsConfig;r.init(e);r.setAutoFilterActive(true);r.setFileName(o);return r};t.XlsConfig.wrap=function(e){var o=new t.XlsConfig;o.init(e);return o};t.XlsConfig.prototype.setAutoFilterActive=function(e){this.root.putBoolean(t.XlsConfig.XLSX_AUTO_FILTER,e)};t.XlsConfig.prototype.getType=function(){return t.BaseExportConfig.XLSX_EXPORT};t.XlsConfig.prototype.getNumberFormats=function(){if(this.root.containsKey(t.XlsConfig.XLSX_NUMBER_FORMATS)){return this.root.getListByKey(t.XlsConfig.XLSX_NUMBER_FORMATS)}return this.root.putNewList(t.XlsConfig.XLSX_NUMBER_FORMATS)};t.XlsConfig.prototype.addNumberFormat=function(t){var e=this.getNumberFormats();var o=e.size();this.getNumberFormats().addString(t);return o};t.ExportModule=function(){};t.ExportModule.prototype=new t.DfModule;t.ExportModule.prototype._ff_c="ExportModule";t.ExportModule.s_module=null;t.ExportModule.getInstance=function(){if(t.isNull(t.ExportModule.s_module)){t.DfModule.checkInitialized(t.LanguageExtModule.getInstance());t.DfModule.checkInitialized(t.CommonsModule.getInstance());t.DfModule.checkInitialized(t.VisualizationUiModule.getInstance());t.ExportModule.s_module=t.DfModule.startExt(new t.ExportModule);t.DfModule.stopExt(t.ExportModule.s_module)}return t.ExportModule.s_module};t.ExportModule.prototype.getName=function(){return"ff2700.export"};t.ExportModule.getInstance();return sap.firefly});
//# sourceMappingURL=ff2700.export.js.map