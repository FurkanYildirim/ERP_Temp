sap.ui.define("sap/sac/df/variablebar/FilterBarDelegate",["sap/ui/mdc/FilterBarDelegate","sap/sac/df/variablebar/FilterBarHandler","sap/sac/df/variablebar/TypeUtil","sap/sac/df/thirdparty/lodash"],function(e,r,a,t){"use strict";var i=Object.assign({},e);i.apiVersion=2;i._getDataProvider=function(e){var r=e._oFilterBarHandler._getDataProvider();if(r){return Promise.resolve(r)}return new Promise(function(r){e._getMultiDimModel().attachEventOnce("queryAdded",null,function(){r(e._oFilterBarHandler._getDataProvider())},i)})};i.fetchProperties=function(e){return i._getDataProvider(e).then(function(){var r=[];t.forEach(e._oFilterBarHandler._getVariables(),function(t){var n=t.MergedVariable?t.MergedVariable:t;var o=a.getFormatOptions(n.ValueType);var l=n.ValueType.includes("Date");var u={name:n.Name,label:n.Description,typeConfig:i.getTypeUtil().getTypeConfig(n.ValueType,o?o:null,null),dataType:n.ValueType,maxConditions:l||!n.SupportsMultipleValues?1:-1,group:t.Group?t.Group:"_basicSearch",groupLabel:e.getModel("i18n").getResourceBundle().getText(t.Group?t.Group:""),required:n.Mandatory,hasValueHelp:n.SupportsValueHelp,caseSensitive:false};r.push(u)});return r})};i.addItem=function(e,a,t){return i._getDataProvider(e).then(function(){var i=e._oFilterBarHandler._getVariable(a);var n=t?t.modifier.checkControlId(r.getFilterFieldId(e,a)):false;var o=n&&sap.ui.getCore().byId(r.getFilterFieldId(e,a));o=o?o:r.createFilterField(i,e);return o})};i.addCondition=function(e,r){return i._getDataProvider(e).then(function(a){var t=e._oFilterBarHandler._getVariable(r);var i=t.MemberFilter;var n=e.getConditions()[r];var o=[];var l=[];i.forEach(function(e){if(e.Low||e.LowText){o.push(e)}});if(o.length){l=[].concat(o)}var u={ComparisonOperator:"EQUAL"};var s=false;if(n){n.forEach(function(e){var r=i.find(function(r){return e.values[0]===r.Low});if(!r||!i.length){s=true;u.Low=e.values[0];if(e.values[1]){u.LowText=e.values[1]}l.push(u)}})}if(s){e.fireBeforeFilterChange({beforeValueHelpOpen:false})}return Promise.resolve(s?a.setVariableValue(r,l):true)})};i.removeCondition=function(e,r){return i._getDataProvider(e).then(function(a){var t=e._oFilterBarHandler._getVariable(r);var i=e.getConditions()[r];var n=t.MemberFilter;var o=[];n.forEach(function(e){var r=i.find(function(r){return r.values[0]===e.Low});if(r){o.push(e)}});e.fireBeforeFilterChange({beforeValueHelpOpen:false});return Promise.resolve(a.setVariableValue(r,o))})};i.getTypeUtil=function(){return a};return i});
//# sourceMappingURL=FilterBarDelegate.js.map