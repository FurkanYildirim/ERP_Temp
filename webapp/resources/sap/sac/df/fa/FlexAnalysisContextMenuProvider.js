/*
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define("sap/sac/df/fa/FlexAnalysisContextMenuProvider",["sap/ui/base/Object","sap/sac/df/firefly/library"],function(e,t){"use strict";var n="Gds.Qb.Table.ContextMenu";var i=e.extend("sap.sac.df.fa.FlexAnalysisContextMenuProvider",{constructor:function(e){this.flexAnalysis=e;this.actions={}},isActionVisible:function(e,t){return true},isActionEnabled:function(e,t){return true},onActionTriggered:function(e,t){var n=this.actions[e];if(n&&!n.builtin){n.triggerAction(e,this.convertContext(t))}},provideMenuConfig:function(e,i,r){var o=t.PrFactory.createStructure();var s=[];if(Object.keys(this.actions).length>0&&e.getUiContext()===n){var a=o.putNewList("MenuExtensions");var u=this.convertContext(e);var l=a.addNewStructure();l.putNewList("UiContext").addString(n);var c=l.putNewList("Extension");var d=this.actions;Object.keys(d).forEach(function(e){var t=d[e];var n=c.addNewStructure();var i=n.putNewList("Items");var r=i.addNewStructure();r.putString("Action",e);if(t.getActionDescription){s.push(t.getActionDescription(e,u).then(function(e){if(e.InsertAfter){n.putString("Operation","InsertAfter");n.putString("Reference",e.InsertAfter)}else if(e.InsertBefore){n.putString("Operation","InsertBefore");n.putString("Reference",e.InsertBefore)}else{n.putString("Operation","AppendInto");n.putString("Reference","$Root")}if(!e.builtin){this.putString("Text",e.Text);if(e.Icon){this.putString("Icon",e.Icon)}}}.bind(r)))}else{n.putString("Operation","AppendInto");n.putString("Reference","$Root")}if(!t.builtin){s.push(t.isActionVisible(e,u).then(function(e){this.putBoolean("Visible",e)}.bind(r)));s.push(t.isActionEnabled(e,u).then(function(e){this.putBoolean("Enabled",e)}.bind(r)))}})}Promise.all(s).then(function(){i.onDynamicMenuConfigProvided(e,"flexAnalysisProvider",o,r)})},registerAction:function(e,t){this.actions[e]=t},unregisterAction:function(e){delete this.actions[e]},isReleaseLocked:function(){return true},convertContext:function(e){var n=this.flexAnalysis.getParent().getModel(this.flexAnalysis.getMultiDimModelId());var i=n.getDataProvider(this.flexAnalysis.getDataProvider());var r={DataProvider:i.Name,Grid:{SelectedCells:[],SelectedDataCells:[]}};var o=i.getQueryManager().getActiveResultSetContainer();var s=t.AuGdsGenericContextResolveUtil.resolveSingleColumnTuple(e);var a=t.AuGdsGenericContextResolveUtil.resolveSingleRowTuple(e);if(s&&a){var u=s.getAxisIndex()+o.getOffsetColumns();var l=a.getAxisIndex()+o.getOffsetRows();var c=t.AuGdsGenericContextResolveUtil.resolveSingleDocumentId(e);r.Grid.SelectedDataCells.push({rowIndex:l,columnIndex:u,documentId:c})}var d=t.AuGdsGenericContextResolveUtil.resolveColumn(e);var f=t.AuGdsGenericContextResolveUtil.resolveRow(e);if(d>=0&&f>=0){r.Grid.SelectedCells.push({rowIndex:f,columnIndex:d})}return r}});return i});
//# sourceMappingURL=FlexAnalysisContextMenuProvider.js.map