/* (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
/* (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/ui/utils/formatter","sap/apf/utils/exportToGlobal","sap/viz/ui5/types/legend/Common"],function(e,t,r){"use strict";function a(e){this.oUiApi=e.uiApi;this.oCoreApi=e.oCoreApi;this.oFilterIdHandler=e.oFilterIdHandler}a.prototype.constructor=a;function i(e,t,r,a,i,o){var n=new sap.apf.ui.utils.formatter({getEventCallback:e.oUiApi.getEventCallback.bind(e.oUiApi),getTextNotHtmlEncoded:e.oCoreApi.getTextNotHtmlEncoded,getExits:e.oUiApi.getCustomFormatExit()},t);var l=n.getFormattedValue(r,i);var s=n.getFormattedValue(r,o);var p=e.oCoreApi.getTextNotHtmlEncoded(a,[l,s]);return p}function o(e){var t=e.oUiApi.getSmartFilterForPrint();var r=[];if(t!==undefined&&t!==null){var a=t.getFilterData();var o=t.getAnalyticalParameters();if(o&&o.length>0){o.forEach(function(t){var o=a[t.fieldName];var n=t.fieldNameOData;e.oCoreApi.getMetadataFacade().getProperty(n).done(function(t){r.push({sFilterName:n,sFilterValue:i(e,t,n,"EQ",o)})})})}var n=t.getFilters();if(n.length>0){var l=sap.apf.core.utils.Filter.transformUI5FilterToInternal(e.oCoreApi.getMessageHandler(),n[0]);for(var s in a){var p="";var g=l.getFilterTermsForProperty(s);if(g.length>0){e.oCoreApi.getMetadataFacade().getProperty(s).done(function(t){for(var a=0;a<g.length;a++){p+=i(e,t,s,g[a]["operator"],g[a]["value"],g[a]["highValue"]);if(a!==g.length-1){p+=", "}}r.push({sFilterName:s,sFilterValue:p})})}}}}return r}function n(e){var t,r="",a;var i,o,n=[],s=[],p=[];i=e.oUiApi.getFacetFilterForPrint();if(i){o=i.getLists();for(t=0;t<o.length;t++){r=o[t].getTitle();p=o[t].getSelectedItems();if(p.length>0){s=l(p);if(r!==undefined&&r!==null){a="";for(var g=0;g<s.length;g++){if(g!==s.length-1){a+=s[g]+", "}else{a+=s[g]}}n.push({sFilterName:r,sFilterValue:a})}}else{n.push({sFilterName:r,sFilterValue:e.oCoreApi.getTextNotHtmlEncoded("noSelectionInFilter")})}}}return n}function l(e){var t=[];e.forEach(function(e){t.push(e.getText())});return t}function s(e){var t=e.oFilterIdHandler.getAllInternalIds();var r,a=[],i;if(t.length>0){for(i=0;i<t.length;i++){r=e.oFilterIdHandler.get(t[i]).getExpressions();a.push(r[0])}}return a}function p(e,t){var r=[],a,i,o="",n,l,s;var p=[];for(a=0;a<t.length;a++){for(i=0;i<t[a].length;i++){e.oCoreApi.getMetadataFacade().getProperty(t[a][i].name).done(function(t){s=t;o="";p=[];o=t.label;l=new sap.apf.ui.utils.formatter({getEventCallback:e.oUiApi.getEventCallback.bind(e.oUiApi),getTextNotHtmlEncoded:e.oCoreApi.getTextNotHtmlEncoded,getExits:e.oUiApi.getCustomFormatExit()},t)});p.push(l.getFormattedValue(s.name,t[a][i].value));if(o!==undefined&&o!==null){n="";for(var i=0;i<p.length;i++){if(i!==p.length-1){n+=p[i]+", "}else{n+=p[i]}}r.push({sFilterName:o,sFilterValue:n})}}}return r}function g(e){var t=e.oUiApi.getEventCallback(sap.apf.core.constants.eventTypes.printTriggered);var r=p(e,s(e));if(t!==undefined){var a={getTextNotHtmlEncoded:e.oCoreApi.getTextNotHtmlEncoded};r=t.apply(a,s(e))}return r}function u(e){var t,r,a;var i=n(e);r=o(e);t=g(e);a=t.concat(r,i);return a}a.prototype.getFiltersToPrint=function(){var e=this;var t=u(e);return t};a.prototype.getHeaderForFirstPage=function(){return this.oUiApi.getLayoutView().getController().oSavedPathName.getText()};a.prototype.getApplicationName=function(){var e;var t=this.applicationConfig.appName;if(!t){e=this.oCoreApi.createMessageObject({code:"6003",aParameters:["sAppName"]});this.oCoreApi.putMessage(e)}return t};a.prototype.setApplicationConfig=function(e){this.applicationConfig=e};a.prototype.getRepresentationForPrint=function(e){var t;var r;var a;var i;var o=this.oCoreApi.getTextNotHtmlEncoded(e.title);var n=e.getSelectedRepresentation();var l=n.bIsAlternateView?n.toggleInstance:n;if(l&&l.titleControl&&l.titleControl.oParent){a=l.titleControl.oParent.getItems();if(a&&a.length>1){for(r=0;r<a.length;r++){if(a[r].getMetadata()._sClassName==="sap.m.HBox"){i=a[r];i.setVisible(false)}}}}t=l.getPrintContent(o);return t.oRepresentation};t("sap.apf.ui.utils.PrintModel",a);return a});
//# sourceMappingURL=printModel.js.map