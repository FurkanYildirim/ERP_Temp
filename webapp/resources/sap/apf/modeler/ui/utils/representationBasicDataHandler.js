/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/utils/constants","sap/apf/modeler/ui/utils/propertyTypeOrchestration","sap/ui/core/mvc/ViewType"],function(e,t,r){"use strict";function o(e,t,r,o){this.oRepresentationView=e;this.oRepresentation=r.oRepresentation;this.oStepPropertyMetadataHandler=t;this.oRepresentationTypeHandler=r.oRepresentationTypeHandler;this.oRepresentationHandler=r;this.nCounter=0;this.oViewValidator=o;this.propertyTypeHandlerPromises=[]}o.prototype._prepareCommonView=function(t,o,n,a){var i,p={},s={};if(n.length===0){return}s.oConfigurationEditor=t.oRepresentationView.getViewData().oConfigurationEditor;s.oParentObject=t.oRepresentation;s.oCoreApi=t.oRepresentationView.getViewData().oCoreApi;s.oConfigurationHandler=t.oRepresentationView.getViewData().oConfigurationHandler;s.oRepresentationTypeHandler=t.oRepresentationTypeHandler;s.oRepresentationHandler=t.oRepresentationHandler;s.oStepPropertyMetadataHandler=t.oStepPropertyMetadataHandler;s.sPropertyType=o;s.oBasicDataLayout=t.oRepresentationView.getController().byId("idBasicDataLayout");s.oTextPool=t.oRepresentationView.getViewData().oConfigurationHandler.getTextPool();s.oViewValidator=t.oViewValidator;p.oViewDataForPropertyType=s;p.aPropertiesToBeCreated=n;p.oPropertyOrchestration=a;i=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.propertyTypeHandler",type:r.XML,id:t.oRepresentationView.getController().createId("id"+o),viewData:p});t.oRepresentationView.getController().byId("idBasicDataLayout").insertItem(i,t.nCounter);t.nCounter++;t.oRepresentationView.attachEvent(e.events.REMOVEALLPROPERTIESFROMPARENTOBJECT,i.getController().handleRemoveOfProperty.bind(i.getController()));t.propertyTypeHandlerPromises.push(i.getController().initPromise)};function n(t,r){t._prepareCommonView(t,e.propertyTypes.DIMENSION,t.oRepresentationHandler.getActualDimensions(),r)}function a(t,r){t._prepareCommonView(t,e.propertyTypes.LEGEND,t.oRepresentationHandler.getActualLegends(),r)}function i(t,r){t._prepareCommonView(t,e.propertyTypes.MEASURE,t.oRepresentationHandler.getActualMeasures(),r)}function p(t,r){t._prepareCommonView(t,e.propertyTypes.PROPERTY,t.oRepresentationHandler.getActualProperties(),r)}function s(t,r){t._prepareCommonView(t,e.propertyTypes.HIERARCHIALCOLUMN,t.oRepresentationHandler.getHierarchicalProperty(),r)}o.prototype.instantiateBasicDataAsPromise=function(){var r=this;var o=r.oRepresentation.getId();var l=jQuery.Deferred();this.propertyTypeHandlerPromises.push(l);t.getConsumableAndAvailablePropertiesAsPromise(o,e.aggregationRoles.DIMENSION,r.oStepPropertyMetadataHandler).then(function(y){t.getConsumableAndAvailablePropertiesAsPromise(o,e.aggregationRoles.MEASURE,r.oStepPropertyMetadataHandler).then(function(e){var o;var y;var d;r.destroyBasicData();if(r.oRepresentation.getRepresentationType()==="TreeTableRepresentation"){d=new t.PropertyTypeOrchestration;s(r,d);p(r,d)}else if(r.oRepresentation.getRepresentationType()==="TableRepresentation"){d=new t.PropertyTypeOrchestration;p(r,d)}else{y=new t.PropertyTypeOrchestration;n(r,y);a(r,y);o=new t.PropertyTypeOrchestration;i(r,o)}l.resolve()})});return jQuery.when.apply(jQuery,this.propertyTypeHandlerPromises)};o.prototype.destroyBasicData=function(){this.oViewValidator.clearFields();this.nCounter=0;this.oRepresentationView.getController().byId("idBasicDataLayout").destroyItems()};return o});
//# sourceMappingURL=representationBasicDataHandler.js.map